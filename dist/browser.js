(function(e){"use strict";function t(e,t){On[e]=t}function a(e){return On[e]}function r(e){var t=a("precision");return t?parseFloat(e.toPrecision(t)):e}function o(e){jn.reverseInputs(e);var t=new Nn(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function n(e){jn.reverseInputs(e);var t=new qn(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function s(e){jn.reverseInputs(e);var t=new Bn(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function u(e){jn.reverseInputs(e);var t=new Vn(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function p(e){jn.reverseInputs(e);var t=new Wn(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function d(e){jn.reverseInputs(e);var t=new Yn(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function c(e){jn.reverseInputs(e);var t=new Kn(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function g(e){jn.reverseInputs(e);var t=new Qn(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function h(e){jn.reverseInputs(e);var t=new ti(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function f(e){jn.reverseInputs(e);var t=new oi(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function m(e){jn.reverseInputs(e);var t=new ni(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function _(e){jn.reverseInputs(e);var t=new di(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function y(e){jn.reverseInputs(e);var t=new hi(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function x(e){jn.reverseInputs(e);var t=new mi(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function v(e){jn.reverseInputs(e);var t=new yi(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function b(e){jn.reverseInputs(e);var t=new vi(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function S(e){jn.reverseInputs(e);var t=new Si(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function P(e){jn.reverseInputs(e);var t=new Ti(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function T(e){jn.reverseInputs(e);var t=new ki(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function w(e){jn.reverseInputs(e);var t=new Fi(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function k(e){jn.reverseInputs(e);var t=new Ei(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function C(e){jn.reverseInputs(e);var t=new Ii(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function F(e){jn.reverseInputs(e);var t=new Ri(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function M(e){jn.reverseInputs(e);var t=new Li(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function D(e){jn.reverseInputs(e);var t=new zi(e).result;return e.reversedInput&&t.reverse(),jn.reverseInputs(e),t}function I(e){jn.reverseInputs(e);var t=new Ui(e).result;return e.reversedInput&&(t.open.reverse(),t.high.reverse(),t.low.reverse(),t.close.reverse(),t.volume.reverse(),t.timestamp.reverse()),jn.reverseInputs(e),t}function A(e){jn.reverseInputs(e);var t=new qi(e).result;return e.reversedInput&&(t.open.reverse(),t.high.reverse(),t.low.reverse(),t.close.reverse(),t.volume.reverse(),t.timestamp.reverse()),jn.reverseInputs(e),t}function R(e){return new Vi().hasPattern(e)}function O(e){return new Hi().hasPattern(e)}function L(e){return new Wi().hasPattern(e)}function z(e){return new Xi().hasPattern(e)}function G(e){return new Yi().hasPattern(e)}function U(e){return new $i().hasPattern(e)}function N(e){return new Ki().hasPattern(e)}function q(e){return new Zi().hasPattern(e)}function B(e){return new Qi().hasPattern(e)}function V(e){return new Ji().hasPattern(e)}function H(e){return new tl().hasPattern(e)}function W(e){return new al().hasPattern(e)}function X(e){return new rl().hasPattern(e)}function Y(e){return new ol().hasPattern(e)}function $(e){return new nl().hasPattern(e)}function K(e){return new il().hasPattern(e)}function Z(e){return new ll().hasPattern(e)}function Q(e){return new sl().hasPattern(e)}function J(e){return new pl().hasPattern(e)}function ee(e){return new dl().hasPattern(e)}function te(e){return new cl().hasPattern(e)}function ae(e){return new gl().hasPattern(e)}function re(e){return new hl().hasPattern(e)}function oe(e){return new fl().hasPattern(e)}function ne(e){return new ml().hasPattern(e)}function ie(e,t){var a=[0,23.6,38.2,50,61.8,78.6,100,127.2,161.8,261.8,423.6],r;return r=e<t?a.map(function(a){var r=t-Sn(e-t)*a/100;return 0<r?r:0}):a.map(function(a){var r=t+Sn(e-t)*a/100;return 0<r?r:0}),r}function le(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}function se(e,t){return t={exports:{}},e(t,t.exports),t.exports}function ue(e){return isFinite(e=+e)&&0!=e?0>e?-ue(-e):fn(e+Pn(e*e+1)):e}function pe(e,t){var a=3>arguments.length?e:arguments[2],r,o;return wl(e)===a?e[t]:(r=Ks.f(e,t))?vl(r,"value")?r.value:void 0===r.get?void 0:r.get.call(a):Tl(o=Du(e))?pe(o,t,a):void 0}function de(e,t,a){var r=4>arguments.length?e:arguments[3],o=Ks.f(wl(e),t),n,i;if(!o){if(Tl(i=Du(e)))return de(i,t,a,r);o=Rl(0)}return vl(o,"value")?!1!==o.writable&&Tl(r)&&(n=Ks.f(r,t)||Rl(0),n.value=a,Al.f(r,t,n),!0):void 0!==o.set&&(o.set.call(r,a),!0)}function ce(e,t){for(var a=-1,r=Array(e);++a<e;)r[a]=t(a);return r}function ge(e){var t=Tm.call(e,km),a=e[km];try{e[km]=void 0}catch(t){}var r=wm.call(e);return t?e[km]=a:delete e[km],r}function he(e){return Mm.call(e)}function fe(e){return null==e?void 0===e?Im:Dm:Am&&Am in Object(e)?Cm(e):Em(e)}function me(e){return null!=e&&"object"==("undefined"==typeof e?"undefined":wn(e))}function _e(e){return Om(e)&&Rm(e)==Lm}function ye(){return!1}function xe(e,t){return t=null==t?Xm:t,!!t&&("number"==typeof e||Ym.test(e))&&-1<e&&0==e%1&&e<t}function ve(e){return"number"==typeof e&&-1<e&&0==e%1&&e<=Km}function be(e){return Om(e)&&Zm(e.length)&&!!S_[Rm(e)]}function Se(e){return function(t){return e(t)}}function Pe(e,t){var a=Vm(e),r=!a&&qm(e),o=!a&&!r&&Wm(e),n=!a&&!r&&!o&&F_(e),i=a||r||o||n,l=i?fm(e.length,String):[],s=l.length;for(var u in e)(t||E_.call(e,u))&&!(i&&("length"==u||o&&("offset"==u||"parent"==u)||n&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||$m(u,s)))&&l.push(u);return l}function Te(e){var t=e&&e.constructor,a="function"==typeof t&&t.prototype||I_;return e===a}function we(e,t){return function(a){return e(t(a))}}function ke(e){if(!A_(e))return L_(e);var t=[];for(var a in Object(e))z_.call(e,a)&&"constructor"!=a&&t.push(a);return t}function Ce(e){var t="undefined"==typeof e?"undefined":wn(e);return null!=e&&("object"==t||"function"==t)}function Fe(e){if(!U_(e))return!1;var t=Rm(e);return t==q_||t==B_||t==N_||t==V_}function Me(e){return null!=e&&Zm(e.length)&&!H_(e)}function Ee(e){return W_(e)?D_(e):G_(e)}function De(){this.__data__=[],this.size=0}function Ie(e,t){return e===t||e!==e&&t!==t}function Ae(e,t){for(var a=e.length;a--;)if($_(e[a][0],t))return a;return-1}function Re(e){var t=this.__data__,a=K_(t,e);if(0>a)return!1;var r=t.length-1;return a==r?t.pop():Q_.call(t,a,1),--this.size,!0}function Oe(e){var t=this.__data__,a=K_(t,e);return 0>a?void 0:t[a][1]}function Le(e){return-1<K_(this.__data__,e)}function je(e,t){var a=this.__data__,r=K_(a,e);return 0>r?(++this.size,a.push([e,t])):a[r][1]=t,this}function ze(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var r=e[t];this.set(r[0],r[1])}}function Ge(){this.__data__=new ry,this.size=0}function Ue(e){var t=this.__data__,a=t["delete"](e);return this.size=t.size,a}function Ne(e){return this.__data__.get(e)}function qe(e){return this.__data__.has(e)}function Be(e){return!!py&&py in e}function Ve(e){if(null!=e){try{return gy.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function He(e){if(!U_(e)||dy(e))return!1;var t=H_(e)?by:my;return t.test(hy(e))}function We(e,t){return null==e?void 0:e[t]}function Xe(e,t){var a=Py(e,t);return Sy(a)?a:void 0}function Ye(){this.__data__=Fy?Fy(null):{},this.size=0}function $e(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Ke(e){var t=this.__data__;if(Fy){var a=t[e];return a===Dy?void 0:a}return Ay.call(t,e)?t[e]:void 0}function Ze(e){var t=this.__data__;return Fy?t[e]!==void 0:Ly.call(t,e)}function Qe(e,t){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=Fy&&void 0===t?zy:t,this}function Je(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var r=e[t];this.set(r[0],r[1])}}function et(){this.size=0,this.__data__={hash:new Uy,map:new(ky||ry),string:new Uy}}function tt(e){var t="undefined"==typeof e?"undefined":wn(e);return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function at(e,t){var a=e.__data__;return qy(t)?a["string"==typeof t?"string":"hash"]:a.map}function rt(e){var t=By(this,e)["delete"](e);return this.size-=t?1:0,t}function ot(e){return By(this,e).get(e)}function nt(e){return By(this,e).has(e)}function it(e,t){var a=By(this,e),r=a.size;return a.set(e,t),this.size+=a.size==r?0:1,this}function lt(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var r=e[t];this.set(r[0],r[1])}}function st(e,t){var a=this.__data__;if(a instanceof ry){var r=a.__data__;if(!ky||r.length<$y-1)return r.push([e,t]),this.size=++a.size,this;a=this.__data__=new Yy(r)}return a.set(e,t),this.size=a.size,this}function ut(e){var t=this.__data__=new ry(e);this.size=t.size}function pt(e){return this.__data__.set(e,Qy),this}function dt(e){return this.__data__.has(e)}function ct(e){var t=-1,a=null==e?0:e.length;for(this.__data__=new Yy;++t<a;)this.add(e[t])}function gt(e,t){for(var a=-1,r=null==e?0:e.length;++a<r;)if(t(e[a],a,e))return!0;return!1}function ht(e,t){return e.has(t)}function ft(e,t,a,r,o,n){var i=a&ox,l=e.length,s=t.length;if(l!=s&&!(i&&s>l))return!1;var u=n.get(e);if(u&&n.get(t))return u==t;var p=-1,d=!0,c=a&nx?new tx:void 0;for(n.set(e,t),n.set(t,e);++p<l;){var g=e[p],h=t[p];if(r)var f=i?r(h,g,p,t,e,n):r(g,h,p,e,t,n);if(void 0!==f){if(f)continue;d=!1;break}if(c){if(!ax(t,function(e,t){if(!rx(c,t)&&(g===e||o(g,e,a,r,n)))return c.push(t)})){d=!1;break}}else if(!(g===h||o(g,h,a,r,n))){d=!1;break}}return n["delete"](e),n["delete"](t),d}function mt(e){var t=-1,a=Array(e.size);return e.forEach(function(e,r){a[++t]=[r,e]}),a}function _t(e){var t=-1,a=Array(e.size);return e.forEach(function(e){a[++t]=e}),a}function yt(e,t,a,r,o,n,i){switch(a){case Px:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Sx:return e.byteLength==t.byteLength&&n(new sx(e),new sx(t));case gx:case hx:case _x:return $_(+e,+t);case fx:return e.name==t.name&&e.message==t.message;case yx:case vx:return e==t+"";case mx:var l=ux;case xx:var s=r&dx;if(l||(l=px),e.size!=t.size&&!s)return!1;var u=i.get(e);if(u)return u==t;r|=cx,i.set(e,t);var p=ix(l(e),l(t),r,o,n,i);return i["delete"](e),p;case bx:if(wx)return wx.call(e)==wx.call(t);}return!1}function xt(e,t){for(var a=-1,r=t.length,o=e.length;++a<r;)e[o+a]=t[a];return e}function vt(e,t,a){var r=t(e);return Vm(e)?r:Cx(r,a(e))}function bt(e,t){for(var a=-1,r=null==e?0:e.length,o=0,n=[];++a<r;){var i=e[a];t(i,a,e)&&(n[o++]=i)}return n}function St(){return[]}function Pt(e){return Fx(e,X_,Ox)}function Tt(e,t,a,r,o,n){var i=a&jx,l=Lx(e),s=l.length,u=Lx(t),p=u.length;if(s!=p&&!i)return!1;for(var d=s,c;d--;)if(c=l[d],i?!(c in t):!Gx.call(t,c))return!1;var g=n.get(e);if(g&&n.get(t))return g==t;var h=!0;n.set(e,t),n.set(t,e);for(var f=i;++d<s;){c=l[d];var m=e[c],_=t[c];if(r)var y=i?r(_,m,c,t,e,n):r(m,_,c,e,t,n);if(void 0===y?!(m===_||o(m,_,a,r,n)):!y){h=!1;break}f||(f="constructor"==c)}if(h&&!f){var x=e.constructor,v=t.constructor;x!=v&&"constructor"in e&&"constructor"in t&&!("function"==typeof x&&x instanceof x&&"function"==typeof v&&v instanceof v)&&(h=!1)}return n["delete"](e),n["delete"](t),h}function wt(e,t,a,r,o,n){var i=Vm(e),l=Vm(t),s=i?pv:lv(e),u=l?pv:lv(t);s=s==uv?dv:s,u=u==uv?dv:u;var p=s==dv,d=u==dv,c=s==u;if(c&&Wm(e)){if(!Wm(t))return!1;i=!0,p=!1}if(c&&!p)return n||(n=new Zy),i||F_(e)?ix(e,t,a,r,o,n):kx(e,t,s,a,r,o,n);if(!(a&sv)){var g=p&&gv.call(e,"__wrapped__"),h=d&&gv.call(t,"__wrapped__");if(g||h){var f=g?e.value():e,m=h?t.value():t;return n||(n=new Zy),o(f,m,a,r,n)}}return!!c&&(n||(n=new Zy),Ux(e,t,a,r,o,n))}function kt(e,t,a,r,o){return!(e!==t)||(null!=e&&null!=t&&(Om(e)||Om(t))?hv(e,t,a,r,kt,o):e!==e&&t!==t)}function Ct(e,t){return fv(e,t)}function Ft(e,t){for(var a=-1,r=null==e?0:e.length,o=Array(r);++a<r;)o[a]=t(e[a],a,e);return o}function Mt(e,t,a,r){var o=a.length,n=o,i=!r;if(null==e)return!n;for(e=Object(e);o--;){var l=a[o];if(i&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++o<n;){l=a[o];var s=l[0],u=e[s],p=l[1];if(!(i&&l[2])){var d=new Zy;if(r)var c=r(u,p,s,e,t,d);if(void 0===c?!fv(p,u,yv|xv,r,d):!c)return!1}else if(void 0===u&&!(s in e))return!1}return!0}function Et(e){return e===e&&!U_(e)}function Dt(e){for(var t=X_(e),a=t.length;a--;){var r=t[a],o=e[r];t[a]=[r,o,bv(o)]}return t}function It(e,t){return function(a){return null!=a&&a[e]===t&&(t!==void 0||e in Object(a))}}function At(e){var t=Sv(e);return 1==t.length&&t[0][2]?Pv(t[0][0],t[0][1]):function(a){return a===e||vv(a,e,t)}}function Rt(e){return"symbol"==("undefined"==typeof e?"undefined":wn(e))||Om(e)&&Rm(e)==wv}function Ot(e,t){if(Vm(e))return!1;var a="undefined"==typeof e?"undefined":wn(e);return"number"==a||"symbol"==a||"boolean"==a||null==e||kv(e)||Fv.test(e)||!Cv.test(e)||null!=t&&e in Object(t)}function Lt(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(Ev);var a=function a(){var r=arguments,o=t?t.apply(this,r):r[0],n=a.cache;if(n.has(o))return n.get(o);var i=e.apply(this,r);return a.cache=n.set(o,i)||n,i};return a.cache=new(Lt.Cache||Yy),a}function jt(e){var t=Dv(e,function(e){return a.size===Iv&&a.clear(),e}),a=t.cache;return t}function zt(e){if("string"==typeof e)return e;if(Vm(e))return _v(e,zt)+"";if(kv(e))return Nv?Nv.call(e):"";var t=e+"";return"0"==t&&1/e==-Gv?"-0":t}function Gt(e){return null==e?"":qv(e)}function Ut(e,t){return Vm(e)?e:Mv(e,t)?[e]:zv(Bv(e))}function Nt(e){if("string"==typeof e||kv(e))return e;var t=e+"";return"0"==t&&1/e==-Hv?"-0":t}function qt(e,t){t=Vv(t,e);for(var a=0,r=t.length;null!=e&&a<r;)e=e[Wv(t[a++])];return a&&a==r?e:void 0}function Bt(e,t,a){var r=null==e?void 0:Xv(e,t);return r===void 0?a:r}function Vt(e,t){return null!=e&&t in Object(e)}function Ht(e,t,a){t=Vv(t,e);for(var r=-1,o=t.length,n=!1,i;++r<o&&(i=Wv(t[r]),!!(n=null!=e&&a(e,i)));)e=e[i];return n||++r!=o?n:(o=null==e?0:e.length,!!o&&Zm(o)&&$m(i,o)&&(Vm(e)||qm(e)))}function Wt(e,t){return null!=e&&Kv(e,t,$v)}function Xt(e,t){return Mv(e)&&bv(t)?Pv(Wv(e),t):function(a){var r=Yv(a,e);return r===void 0&&r===t?Zv(a,e):fv(t,r,Qv|Jv)}}function Yt(e){return e}function $t(e){return function(t){return null==t?void 0:t[e]}}function Kt(e){return function(t){return Xv(t,e)}}function Zt(e){return Mv(e)?ab(Wv(e)):rb(e)}function Qt(e){return"function"==typeof e?e:null==e?tb:"object"==("undefined"==typeof e?"undefined":wn(e))?Vm(e)?eb(e[0],e[1]):Tv(e):ob(e)}function Jt(e){return function(t,a,r){for(var o=-1,n=Object(t),i=r(t),l=i.length;l--;){var s=i[e?l:++o];if(!1===a(n[s],s,n))break}return t}}function ea(e,t){return e&&sb(e,t,X_)}function ta(e,t){return function(a,r){if(null==a)return a;if(!W_(a))return e(a,r);for(var o=a.length,n=t?o:-1,i=Object(a);(t?n--:++n<o)&&!(!1===r(i[n],n,i)););return a}}function aa(e,t){var a=-1,r=W_(e)?Array(e.length):[];return cb(e,function(e,o,n){r[++a]=t(e,o,n)}),r}function ra(e,t){var a=Vm(e)?_v:gb;return a(e,nb(t,3))}function oa(e,t){for(var a=-1,r=null==e?0:e.length;++a<r;)if(!t(e[a],a,e))return!1;return!0}function na(e,t){var a=!0;return cb(e,function(e,r,o){return a=!!t(e,r,o),a}),a}function ia(e,t,a){if(!U_(a))return!1;var r="undefined"==typeof t?"undefined":wn(t);return!("number"==r?!(W_(a)&&$m(t,a.length)):!("string"==r&&t in a))&&$_(a[t],e)}function la(e,t,a){var r=Vm(e)?fb:mb;return a&&_b(e,t,a)&&(t=void 0),r(e,nb(t,3))}function sa(e){return function(t,a,r){var o=Object(t);if(!W_(t)){var n=nb(a,3);t=X_(t),a=function(e){return n(o[e],e,o)}}var i=e(t,a,r);return-1<i?o[n?t[i]:i]:void 0}}function ua(e,t,a,r){for(var o=e.length,n=a+(r?1:-1);r?n--:++n<o;)if(t(e[n],n,e))return n;return-1}function pa(e){if("number"==typeof e)return e;if(kv(e))return bb;if(U_(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=U_(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Sb,"");var a=Tb.test(e);return a||wb.test(e)?kb(e.slice(2),a?2:8):Pb.test(e)?bb:+e}function da(e){if(!e)return 0===e?e:0;if(e=Cb(e),e===Fb||e===-Fb){var t=0>e?-1:1;return t*Mb}return e===e?e:0}function ca(e){var t=Eb(e),a=t%1;return t===t?a?t-a:t:0}function ga(e,t,a){var r=null==e?0:e.length;if(!r)return-1;var o=null==a?0:Db(a);return 0>o&&(o=Ib(r+o,0)),vb(e,nb(t,3),o)}function ha(e,t,a){"__proto__"==t&&jb?jb(e,t,{configurable:!0,enumerable:!0,value:a,writable:!0}):e[t]=a}function fa(e,t,a){var r=e[t];Ub.call(e,t)&&$_(r,a)&&(a!==void 0||t in e)||zb(e,t,a)}function ma(e,t,a,r){if(!U_(e))return e;t=Vv(t,e);for(var o=-1,n=t.length,i=e;null!=i&&++o<n;){var l=Wv(t[o]),s=a;if(o!=n-1){var u=i[l];s=r?r(u,l,i):void 0,s===void 0&&(s=U_(u)?u:$m(t[o+1])?[]:{})}Nb(i,l,s),i=i[l]}return e}function _a(e,t,a){for(var r=-1,o=t.length,n={};++r<o;){var i=t[r],l=Xv(e,i);a(l,i)&&qb(n,Vv(i,e),l)}return n}function ya(e,t){return Bb(e,t,function(t,a){return Zv(e,a)})}function xa(e){return Vm(e)||qm(e)||!!(Hb&&e&&e[Hb])}function va(e,t,a,r,o){var n=-1,i=e.length;for(a||(a=Wb),o||(o=[]);++n<i;){var l=e[n];0<t&&a(l)?1<t?va(l,t-1,a,r,o):Cx(o,l):!r&&(o[o.length]=l)}return o}function ba(e){var t=null==e?0:e.length;return t?Xb(e,1):[]}function Sa(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2]);}return e.apply(t,a)}function Pa(e,t,a){return t=Kb(void 0===t?e.length-1:t,0),function(){for(var r=arguments,o=-1,n=Kb(r.length-t,0),i=Array(n);++o<n;)i[o]=r[t+o];o=-1;for(var l=Array(t+1);++o<t;)l[o]=r[o];return l[t]=a(i),$b(e,this,l)}}function Ta(e){return function(){return e}}function wa(e){var t=0,a=0;return function(){var r=rS(),o=aS-(r-a);if(a=r,!(0<o))t=0;else if(++t>=tS)return arguments[0];return e.apply(void 0,arguments)}}function ka(e){return iS(Zb(e,void 0,Yb),e+"")}function Ca(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function Fa(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&Ca(e.slice(0,0))}function Ma(e){return"[object Array]"===gS.call(e)}function Ea(e){return"[object ArrayBuffer]"===gS.call(e)}function Da(e){return"undefined"!=typeof FormData&&e instanceof FormData}function Ia(e){var t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer,t}function Aa(e){return"string"==typeof e}function Ra(e){return"number"==typeof e}function Oa(e){return"undefined"==typeof e}function La(e){return null!==e&&"object"===("undefined"==typeof e?"undefined":wn(e))}function ja(e){return"[object Date]"===gS.call(e)}function za(e){return"[object File]"===gS.call(e)}function Ga(e){return"[object Blob]"===gS.call(e)}function Ua(e){return"[object Function]"===gS.call(e)}function Na(e){return La(e)&&Ua(e.pipe)}function qa(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}function Ba(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function Va(){return"undefined"!=typeof navigator&&"ReactNative"===navigator.product?!1:"undefined"!=typeof window&&"undefined"!=typeof document}function Ha(e,t){if(null!==e&&"undefined"!=typeof e)if("object"!==("undefined"==typeof e?"undefined":wn(e))&&(e=[e]),Ma(e))for(var a=0,r=e.length;a<r;a++)t.call(null,e[a],a,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}function Wa(){function e(e,a){t[a]="object"===wn(t[a])&&"object"===("undefined"==typeof e?"undefined":wn(e))?Wa(t[a],e):e}for(var t={},a=0,r=arguments.length;a<r;a++)Ha(arguments[a],e);return t}function Xa(e,t,a){return Ha(t,function(t,r){e[r]=a&&"function"==typeof t?dS(t,a):t}),e}function Ya(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function $a(){this.message="String contains an invalid character"}function E(e){for(var t=e+"",a="",r=0,o=PS,n,i;t.charAt(0|r)||(o="=",r%1);a+=o.charAt(63&n>>8-8*(r%1))){if(i=t.charCodeAt(r+=3/4),255<i)throw new $a;n=n<<8|i}return a}function Ka(e,t){!hS.isUndefined(e)&&hS.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function Za(){var e;return"undefined"==typeof XMLHttpRequest?"undefined"!=typeof process&&(e=CS):e=CS,e}function Qa(){this.handlers=[]}function Ja(e){e.cancelToken&&e.cancelToken.throwIfRequested()}function er(e){this.defaults=e,this.interceptors={request:new DS,response:new DS}}function tr(e){this.message=e}function ar(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var a=this;e(function(e){a.reason||(a.reason=new zS(e),t(a.reason))})}function rr(e){var t=new jS(e),a=dS(jS.prototype.request,t);return hS.extend(a,jS.prototype,t),hS.extend(a,t),a}function or(e,t,a,r){for(var o=-1,n=KS($S((t-e)/(a||1)),0),i=Array(n);n--;)i[r?n:++o]=e,e+=a;return i}function nr(e){return function(t,a,r){return r&&"number"!=typeof r&&_b(t,a,r)&&(a=r=void 0),t=Eb(t),void 0===a?(a=t,t=0):a=Eb(a),r=void 0===r?t<a?1:-1:Eb(r),ZS(t,a,r,e)}}function ir(e){for(var t=Array(e),a=0;a<e;++a)t[a]=a;return t}function lr(e,t){return e[0]-t[0]}function sr(){var e=this.stride,t=Array(e.length),a;for(a=0;a<t.length;++a)t[a]=[Sn(e[a]),a];t.sort(lr);var r=Array(t.length);for(a=0;a<r.length;++a)r[a]=t[a][1];return r}function ur(e,t){var a=["View",t,"d",e].join("");0>t&&(a="View_Nil"+e);var r="generic"===e;if(-1===t){var o="function "+a+"(a){this.data=a;};var proto="+a+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+a+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+a+"(a){return new "+a+"(a);}",n=new Function(o);return n()}if(0===t){var o="function "+a+"(a,d) {this.data = a;this.offset = d};var proto="+a+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+a+"_copy() {return new "+a+"(this.data,this.offset)};proto.pick=function "+a+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+a+"_get(){return "+(r?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+a+"_set(v){return "+(r?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+a+"(a,b,c,d){return new "+a+"(a,d)}",n=new Function("TrivialArray",o);return n(rP[e][0])}var o=["'use strict'"],l=tP(t),s=l.map(function(e){return"i"+e}),u="this.offset+"+l.map(function(e){return"this.stride["+e+"]*i"+e}).join("+"),p=l.map(function(e){return"b"+e}).join(","),d=l.map(function(e){return"c"+e}).join(",");o.push("function "+a+"(a,"+p+","+d+",d){this.data=a","this.shape=["+p+"]","this.stride=["+d+"]","this.offset=d|0}","var proto="+a+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),o.push("Object.defineProperty(proto,'size',{get:function "+a+"_size(){return "+l.map(function(e){return"this.shape["+e+"]"}).join("*"),"}})"),1===t?o.push("proto.order=[0]"):(o.push("Object.defineProperty(proto,'order',{get:"),4>t?(o.push("function "+a+"_order(){"),2===t?o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):o.push("ORDER})")),o.push("proto.set=function "+a+"_set("+s.join(",")+",v){"),r?o.push("return this.data.set("+u+",v)}"):o.push("return this.data["+u+"]=v}"),o.push("proto.get=function "+a+"_get("+s.join(",")+"){"),r?o.push("return this.data.get("+u+")}"):o.push("return this.data["+u+"]}"),o.push("proto.index=function "+a+"_index(",s.join(),"){return "+u+"}"),o.push("proto.hi=function "+a+"_hi("+s.join(",")+"){return new "+a+"(this.data,"+l.map(function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")}).join(",")+","+l.map(function(e){return"this.stride["+e+"]"}).join(",")+",this.offset)}");var c=l.map(function(e){return"a"+e+"=this.shape["+e+"]"}),g=l.map(function(e){return"c"+e+"=this.stride["+e+"]"});o.push("proto.lo=function "+a+"_lo("+s.join(",")+"){var b=this.offset,d=0,"+c.join(",")+","+g.join(","));for(var h=0;h<t;++h)o.push("if(typeof i"+h+"==='number'&&i"+h+">=0){d=i"+h+"|0;b+=c"+h+"*d;a"+h+"-=d}");o.push("return new "+a+"(this.data,"+l.map(function(e){return"a"+e}).join(",")+","+l.map(function(e){return"c"+e}).join(",")+",b)}"),o.push("proto.step=function "+a+"_step("+s.join(",")+"){var "+l.map(function(e){return"a"+e+"=this.shape["+e+"]"}).join(",")+","+l.map(function(e){return"b"+e+"=this.stride["+e+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var h=0;h<t;++h)o.push("if(typeof i"+h+"==='number'){d=i"+h+"|0;if(d<0){c+=b"+h+"*(a"+h+"-1);a"+h+"=ceil(-a"+h+"/d)}else{a"+h+"=ceil(a"+h+"/d)}b"+h+"*=d}");o.push("return new "+a+"(this.data,"+l.map(function(e){return"a"+e}).join(",")+","+l.map(function(e){return"b"+e}).join(",")+",c)}");for(var i=Array(t),f=Array(t),h=0;h<t;++h)i[h]="a[i"+h+"]",f[h]="b[i"+h+"]";o.push("proto.transpose=function "+a+"_transpose("+s+"){"+s.map(function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+a+"(this.data,"+i.join(",")+","+f.join(",")+",this.offset)}"),o.push("proto.pick=function "+a+"_pick("+s+"){var a=[],b=[],c=this.offset");for(var h=0;h<t;++h)o.push("if(typeof i"+h+"==='number'&&i"+h+">=0){c=(c+this.stride["+h+"]*i"+h+")|0}else{a.push(this.shape["+h+"]);b.push(this.stride["+h+"])}");o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),o.push("return function construct_"+a+"(data,shape,stride,offset){return new "+a+"(data,"+l.map(function(e){return"shape["+e+"]"}).join(",")+","+l.map(function(e){return"stride["+e+"]"}).join(",")+",offset)}");var n=new Function("CTOR_LIST","ORDER",o.join("\n"));return n(rP[e],sr)}function pr(e){if(cS(e))return"buffer";if(aP)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";}return Array.isArray(e)?"array":"generic"}function dr(e,t,a,r){if(e===void 0){var o=rP.array[0];return o([])}"number"==typeof e&&(e=[e]);t===void 0&&(t=[e.length]);var n=t.length;if(a===void 0){a=Array(n);for(var l=n-1,i=1;0<=l;--l)a[l]=i,i*=t[l]}if(void 0===r){r=0;for(var l=0;l<n;++l)0>a[l]&&(r-=(t[l]-1)*a[l])}for(var s=pr(e),u=rP[s];u.length<=n+1;)u.push(ur(s,u.length-1));var o=u[n+1];return o(e,t,a,r)}function cr(e,t){for(var r=1,o=e.length,n=e[0],a=e[0],l=1;l<o;++l)if(a=n,n=e[l],t(n,a)){if(l===r){r++;continue}e[r++]=n}return e.length=r,e}function gr(e){for(var t=1,r=e.length,o=e[0],a=e[0],n=1;n<r;++n,a=o)if(a=o,o=e[n],o!==a){if(n===t){t++;continue}e[t++]=o}return e.length=t,e}function hr(e,t,a){return 0===e.length?e:t?(a||e.sort(t),cr(e,t)):(a||e.sort(),gr(e))}function fr(e,t,a){var r=e.length,o=t.arrayArgs.length,n=0<t.indexArgs.length,l=[],s=[],u=0,p=0,d,i;for(d=0;d<r;++d)s.push(["i",d,"=0"].join(""));for(i=0;i<o;++i)for(d=0;d<r;++d)p=u,u=e[d],0===d?s.push(["d",i,"s",d,"=t",i,"p",u].join("")):s.push(["d",i,"s",d,"=(t",i,"p",u,"-s",p,"*t",i,"p",p,")"].join(""));for(0<s.length&&l.push("var "+s.join(",")),d=r-1;0<=d;--d)u=e[d],l.push(["for(i",d,"=0;i",d,"<s",u,";++i",d,"){"].join(""));for(l.push(a),d=0;d<r;++d){for(p=u,u=e[d],i=0;i<o;++i)l.push(["p",i,"+=d",i,"s",d].join(""));n&&(0<d&&l.push(["index[",p,"]-=s",p].join("")),l.push(["++index[",u,"]"].join(""))),l.push("}")}return l.join("\n")}function mr(e,t,a,r){for(var o=t.length,n=a.arrayArgs.length,l=a.blockSize,s=0<a.indexArgs.length,u=[],p=0;p<n;++p)u.push(["var offset",p,"=p",p].join(""));for(var p=e;p<o;++p)u.push(["for(var j"+p+"=SS[",t[p],"]|0;j",p,">0;){"].join("")),u.push(["if(j",p,"<",l,"){"].join("")),u.push(["s",t[p],"=j",p].join("")),u.push(["j",p,"=0"].join("")),u.push(["}else{s",t[p],"=",l].join("")),u.push(["j",p,"-=",l,"}"].join("")),s&&u.push(["index[",t[p],"]=j",p].join(""));for(var p=0,i;p<n;++p){i=["offset"+p];for(var d=e;d<o;++d)i.push(["j",d,"*t",p,"p",t[d]].join(""));u.push(["p",p,"=(",i.join("+"),")"].join(""))}u.push(fr(t,a,r));for(var p=e;p<o;++p)u.push("}");return u.join("\n")}function _r(e){for(var t=0,a=e[0].length;t<a;){for(var r=1;r<e.length;++r)if(e[r][t]!==e[0][t])return t;++t}return t}function yr(e,t,a){for(var r=e.body,o=[],n=[],l=0,i;l<e.args.length;++l)if(i=e.args[l],!(0>=i.count)){var s=new RegExp(i.name,"g"),u="",p=t.arrayArgs.indexOf(l);switch(t.argTypes[l]){case"offset":var d=t.offsetArgIndex.indexOf(l),c=t.offsetArgs[d];p=c.array,u="+q"+d;case"array":u="p"+p+u;var g="l"+l,h="a"+p;if(0===t.arrayBlockIndices[p])1===i.count?"generic"===a[p]?i.lvalue?(o.push(["var ",g,"=",h,".get(",u,")"].join("")),r=r.replace(s,g),n.push([h,".set(",u,",",g,")"].join(""))):r=r.replace(s,[h,".get(",u,")"].join("")):r=r.replace(s,[h,"[",u,"]"].join("")):"generic"===a[p]?(o.push(["var ",g,"=",h,".get(",u,")"].join("")),r=r.replace(s,g),i.lvalue&&n.push([h,".set(",u,",",g,")"].join(""))):(o.push(["var ",g,"=",h,"[",u,"]"].join("")),r=r.replace(s,g),i.lvalue&&n.push([h,"[",u,"]=",g].join("")));else{for(var f=[i.name],m=[u],_=0;_<Sn(t.arrayBlockIndices[p]);_++)f.push("\\s*\\[([^\\]]+)\\]"),m.push("$"+(_+1)+"*t"+p+"b"+_);if(s=new RegExp(f.join(""),"g"),u=m.join("+"),"generic"===a[p])throw new Error("cwise: Generic arrays not supported in combination with blocks!");else r=r.replace(s,[h,"[",u,"]"].join(""))}break;case"scalar":r=r.replace(s,"Y"+t.scalarArgs.indexOf(l));break;case"index":r=r.replace(s,"index");break;case"shape":r=r.replace(s,"shape");}}return[o.join("\n"),r,n.join("\n")].join("\n").trim()}function xr(e){for(var a=Array(e.length),r=!0,o=0;o<e.length;++o){var n=e[o],t=n.match(/\d+/);t=t?t[0]:"",a[o]=0===n.charAt(0)?"u"+n.charAt(1)+t:n.charAt(0)+t,0<o&&(r=r&&a[o]===a[o-1])}return r?a[0]:a.join("")}function vr(e,t){for(var a=0|t[1].length-Sn(e.arrayBlockIndices[0]),r=Array(e.arrayArgs.length),o=Array(e.arrayArgs.length),n=0;n<e.arrayArgs.length;++n)o[n]=t[2*n],r[n]=t[2*n+1];for(var i=[],l=[],s=[],u=[],p=[],n=0;n<e.arrayArgs.length;++n){0>e.arrayBlockIndices[n]?(s.push(0),u.push(a),i.push(a),l.push(a+e.arrayBlockIndices[n])):(s.push(e.arrayBlockIndices[n]),u.push(e.arrayBlockIndices[n]+a),i.push(0),l.push(e.arrayBlockIndices[n]));for(var d=[],c=0;c<r[n].length;c++)s[n]<=r[n][c]&&r[n][c]<u[n]&&d.push(r[n][c]-s[n]);p.push(d)}for(var g=["SS"],h=["'use strict'"],m=[],c=0;c<a;++c)m.push(["s",c,"=SS[",c,"]"].join(""));for(var n=0;n<e.arrayArgs.length;++n){g.push("a"+n),g.push("t"+n),g.push("p"+n);for(var c=0;c<a;++c)m.push(["t",n,"p",c,"=t",n,"[",s[n]+c,"]"].join(""));for(var c=0;c<Sn(e.arrayBlockIndices[n]);++c)m.push(["t",n,"b",c,"=t",n,"[",i[n]+c,"]"].join(""))}for(var n=0;n<e.scalarArgs.length;++n)g.push("Y"+n);if(0<e.shapeArgs.length&&m.push("shape=SS.slice(0)"),0<e.indexArgs.length){for(var _=Array(a),n=0;n<a;++n)_[n]="0";m.push(["index=[",_.join(","),"]"].join(""))}for(var n=0;n<e.offsetArgs.length;++n){for(var y=e.offsetArgs[n],x=[],c=0;c<y.offset.length;++c)if(0===y.offset[c])continue;else 1===y.offset[c]?x.push(["t",y.array,"p",c].join("")):x.push([y.offset[c],"*t",y.array,"p",c].join(""));0===x.length?m.push("q"+n+"=0"):m.push(["q",n,"=",x.join("+")].join(""))}var v=nP([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));m=m.concat(v),0<m.length&&h.push("var "+m.join(","));for(var n=0;n<e.arrayArgs.length;++n)h.push("p"+n+"|=0");3<e.pre.body.length&&h.push(yr(e.pre,e,o));var b=yr(e.body,e,o),S=_r(p);S<a?h.push(mr(S,p[0],e,b)):h.push(fr(p[0],e,b)),3<e.post.body.length&&h.push(yr(e.post,e,o)),e.debug&&console.log("-----Generated cwise routine for ",t,":\n"+h.join("\n")+"\n----------");var P=[e.funcName||"unnamed","_cwise_loop_",r[0].join("s"),"m",S,xr(o)].join(""),T=new Function(["function ",P,"(",g.join(","),"){",h.join("\n"),"} return ",P].join(""));return T()}function br(e){var t=["'use strict'","var CACHED={}"],a=[],r=e.funcName+"_cwise_thunk";t.push(["return function ",r,"(",e.shimArgs.join(","),"){"].join(""));for(var o=[],n=[],l=[["array",e.arrayArgs[0],".shape.slice(",bn(0,e.arrayBlockIndices[0]),0>e.arrayBlockIndices[0]?","+e.arrayBlockIndices[0]+")":")"].join("")],s=[],u=[],p=0,i;p<e.arrayArgs.length;++p)i=e.arrayArgs[p],a.push(["t",i,"=array",i,".dtype,","r",i,"=array",i,".order"].join("")),o.push("t"+i),o.push("r"+i),n.push("t"+i),n.push("r"+i+".join()"),l.push("array"+i+".data"),l.push("array"+i+".stride"),l.push("array"+i+".offset|0"),0<p&&(s.push("array"+e.arrayArgs[0]+".shape.length===array"+i+".shape.length+"+(Sn(e.arrayBlockIndices[0])-Sn(e.arrayBlockIndices[p]))),u.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+bn(0,e.arrayBlockIndices[0])+"]===array"+i+".shape[shapeIndex+"+bn(0,e.arrayBlockIndices[p])+"]"));1<e.arrayArgs.length&&(t.push("if (!("+s.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+Sn(e.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),t.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}"));for(var p=0;p<e.scalarArgs.length;++p)l.push("scalar"+e.scalarArgs[p]);a.push(["type=[",n.join(","),"].join()"].join("")),a.push("proc=CACHED[type]"),t.push("var "+a.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",o.join(","),"])}","return proc(",l.join(","),")}"].join("")),e.debug&&console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------");var d=new Function("compile",t.join("\n"));return d(iP.bind(void 0,e))}function Sr(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function Pr(e){var t=new Sr;t.pre=e.pre,t.body=e.body,t.post=e.post;var a=e.args.slice(0);t.argTypes=a;for(var r=0,o;r<a.length;++r)if(o=a[r],"array"===o||"object"===("undefined"==typeof o?"undefined":wn(o))&&o.blockIndices){if(t.argTypes[r]="array",t.arrayArgs.push(r),t.arrayBlockIndices.push(o.blockIndices?o.blockIndices:0),t.shimArgs.push("array"+r),r<t.pre.args.length&&0<t.pre.args[r].count)throw new Error("cwise: pre() block may not reference array args");if(r<t.post.args.length&&0<t.post.args[r].count)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===o)t.scalarArgs.push(r),t.shimArgs.push("scalar"+r);else if("index"===o){if(t.indexArgs.push(r),r<t.pre.args.length&&0<t.pre.args[r].count)throw new Error("cwise: pre() block may not reference array index");if(r<t.body.args.length&&t.body.args[r].lvalue)throw new Error("cwise: body() block may not write to array index");if(r<t.post.args.length&&0<t.post.args[r].count)throw new Error("cwise: post() block may not reference array index")}else if("shape"===o){if(t.shapeArgs.push(r),r<t.pre.args.length&&t.pre.args[r].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(r<t.body.args.length&&t.body.args[r].lvalue)throw new Error("cwise: body() block may not write to array shape");if(r<t.post.args.length&&t.post.args[r].lvalue)throw new Error("cwise: post() block may not write to array shape")}else if("object"===("undefined"==typeof o?"undefined":wn(o))&&o.offset)t.argTypes[r]="offset",t.offsetArgs.push({array:o.array,offset:o.offset}),t.offsetArgIndex.push(r);else throw new Error("cwise: Unknown argument type "+a[r]);if(0>=t.arrayArgs.length)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>a.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>a.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>a.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,lP(t)}function Tr(e,t){var a=[],r=[],o;if(t!==void 0&&!Array.isArray(t))throw new Error("axes must be an Array list of dimensions to squeeze");for(o=0;o<e.shape.length;o++)(1!==e.shape[o]||void 0!==t&&-1===t.indexOf(o))&&(a.push(e.shape[o]),r.push(e.stride[o]));return oP(e.data,a,r,e.offset)}function wr(e,t,a){this.name=e,this.lvalue=t,this.rvalue=a,this.count=0}function kr(e,t,a,r){this.body=e,this.args=t,this.thisVars=a,this.localVars=r}function Cr(e){if("eval"===e)throw new Error("cwise-parser: eval() not allowed");return"undefined"==typeof window?"undefined"==typeof _l?"undefined"!=typeof self&&e in self:e in _l:e in window}function Fr(e){for(var t=e.body[0].expression.callee.params,a=Array(t.length),r=0;r<t.length;++r)a[r]=t[r].name;return a}function Mr(e){function t(e){var t=p+e.replace(/\_/g,"__");return n.push(t),t}function a(e){var t="this_"+e.replace(/\_/g,"__");return f.push(t),t}function r(e,t){for(var a=e.range[0],r=e.range[1],o=a+1;o<r;++o)h[o]="";h[a]=t}function o(e){return"'"+e.replace(/\_/g,"\\_").replace(/\'/g,"'")+"'"}function l(e){return"AssignmentExpression"===e.parent.type&&e.parent.left===e?"="===e.parent.operator?m:m|_:"UpdateExpression"===e.parent.type?m|_:_}for(var s=["(",e,")()"].join(""),u=fP.parse(s,{range:!0}),p="_inline_"+mP++ +"_",d=Fr(u),c=Array(d.length),g=0;g<d.length;++g)c[g]=new wr([p,"arg",g,"_"].join(""),!1,!1);for(var h=Array(s.length),g=0,i=s.length;g<i;++g)h[g]=s.charAt(g);var n=[],f=[],m=1,_=2;(function e(s,u){if(s.parent=u,"MemberExpression"===s.type)s.computed?(e(s.object,s),e(s.property,s)):"ThisExpression"===s.object.type?r(s,a(s.property.name)):e(s.object,s);else if("ThisExpression"===s.type)throw new Error("cwise-parser: Computed this is not allowed");else if("Identifier"===s.type){var p=s.name,g=d.indexOf(p);if(0<=g){var h=c[g],f=l(s);f&m&&(h.lvalue=!0),f&_&&(h.rvalue=!0),++h.count,r(s,h.name)}else if(Cr(p));else r(s,t(p))}else if("Literal"===s.type)"string"==typeof s.value&&r(s,o(s.value));else if("WithStatement"===s.type)throw new Error("cwise-parser: with() statements not allowed");else for(var y=Object.keys(s),x=0,i=y.length;x<i;++x)if("parent"!==y[x]){var n=s[y[x]];if(n)if(n instanceof Array)for(var v=0;v<n.length;++v)n[v]&&"string"==typeof n[v].type&&e(n[v],s);else"string"==typeof n.type&&e(n,s)}})(u.body[0].expression.callee.body,void 0),nP(n),nP(f);var y=new kr(function(e){return h.slice(e.range[0],e.range[1]).join("")}(u.body[0].expression.callee.body),c,f,n);return y}function Er(e){for(var t in e)0>yP.indexOf(t)&&0>xP.indexOf(t)&&console.warn("cwise: Unknown argument '"+t+"' passed to expression compiler");for(var a=0;a<yP.length;++a)if(!e[yP[a]])throw new Error("cwise: Missing argument: "+yP[a]);return sP({args:e.args,pre:_P(e.pre||function(){}),body:_P(e.body),post:_P(e.post||function(){}),debug:!!e.printCode,funcName:e.funcName||e.body.name||"cwise",blockSize:e.blockSize||64})}function Dr(e,t,a){var r=-1,o=e.length;0>t&&(t=-t>o?0:o+t),a=a>o?o:a,0>a&&(a+=o),o=t>a?0:a-t>>>0,t>>>=0;for(var n=Array(o);++r<o;)n[r]=e[r+t];return n}function Ir(e,t,a){return e&&e.length?(t=a||void 0===t?1:Db(t),zP(e,0,0>t?0:t)):[]}function Ar(e,t){for(var a=-1,r=e.length,o;++a<r;){var n=t(e[a]);n!==void 0&&(o=o==void 0?n:o+n)}return o}function Rr(e){return e&&e.length?UP(e,tb):0}function Or(e,t){return"native"===t[1]?[e,"d0=",e,".length,",e,"d1=",e,"[0].length,"].join(""):[e,"d0=",e,".shape[0],",e,"d1=",e,".shape[1],",e,"s0=",e,".stride[0],",e,"s1=",e,".stride[1],",e,"o=",e,".offset,",e,"d=",e,".data,"].join("")}function Lr(e,t,a,r,o,n){var i=[];return"native"===a[1]?e[0]&&(r?i.push("var ",t,"p=",t,"[",r,"];"):i.push("var ",t,"p=",t,"[0];")):r&&o?n?i.push("var ",t,"t0=",t,"s",e[0],",",t,"t1=",t,"s",e[1],"-",t,"s",e[0],"*",n,",",t,"p=",t,"o+",r,"*",t,"s0+",o,"*",t,"s1;"):i.push("var ",t,"t0=",t,"s",e[0],",",t,"p=",t,"o+",r,"*",t,"s0+",o,"*",t,"s1;"):r?i.push("var ",t,"t0=",t,"s",e[0],",",t,"p=",t,"o+",r,"*",t,"s0;"):o?i.push("var ",t,"t0=",t,"s",e[0],",",t,"p=",t,"o+",o,"*",t,"s1;"):i.push("var ",t,"t0=",t,"s",e[0],",",t,"t1=",t,"s",e[1],"-",t,"s",e[0],"*",t,"d",e[0],",",t,"p=",t,"o;"),i}function jr(e,t,a,r,o){var n=[];return"native"===a[1]?e[0]&&1===r&&n.push(t,"p=",t,"[",o,"+1]"):n.push(t,"p+=",t,"t",r,";"),n}function zr(e,t,a,r,o,n){var i=[];return"native"===a[1]?e[0]?i.push(t,"p[",o,"]=",n,";"):i.push(t,"[",r,"][",o,"]=",n,";"):"generic"===a[1]?i.push(t,"d.set(",t,"p,",n,");"):i.push(t,"d[",t,"p]=",n,";"),i}function Gr(e,t,a,r,o){var n=[];return"native"===a[1]?e[0]?n.push(t,"p[",o,"]"):n.push(t,"[",r,"][",o,"]"):"generic"===a[1]?n.push(t,"d.get(",t,"p)"):n.push(t,"d[",t,"p]"),n.join("")}function Ur(e,t,a,r,o){var n=[],i="r"===e[0]?[1,0]:[0,1],l=[1,0],s=[0,1],u=["i","j"];return n.push.apply(n,Lr(i,"o",e)),i[1]?(n.push("for(j=0;j<od1;++j){"),n.push("for(i=0;i<od0;++i){")):(n.push("for(i=0;i<od0;++i){"),n.push("for(j=0;j<od1;++j){")),n.push.apply(n,Lr(l,"a",t,"i")),n.push.apply(n,Lr(s,"b",a,void 0,"j")),n.push("var r=0.0;","for(k=0;k<ad1;++k){","r+=",Gr(l,"a",t,"i","k"),"*",Gr(s,"b",a,"k","j"),";"),n.push.apply(n,jr(l,"a",t,0,"k")),n.push.apply(n,jr(s,"b",a,0,"k")),n.push("}"),r&&n.push("r*=A;"),o&&n.push("r+=B*",Gr(i,"o",e,"i","j"),";"),n.push.apply(n,zr(i,"o",e,"i","j","r")),n.push.apply(n,jr(i,"o",e,0,u[1])),n.push("}"),n.push.apply(n,jr(i,"o",e,1,u[0])),n.push("}"),n}function Nr(e,t){var a=[],r="r"===e[0]?[1,0]:[0,1],o;return t&&a.push("if(B!==1.0){"),a.push.apply(a,Lr(r,"o",e)),r[0]?(a.push("for(i=0;i<od0;++i){for(j=0;j<od1;++j){"),o=["i","j"]):(a.push("for(j=0;j<od1;++j){for(i=0;i<od0;++i){"),o=["j","i"]),t?a.push.apply(a,zr(r,"o",e,"i","j","B*"+Gr(r,"o",e,"i","j"))):a.push.apply(a,zr(r,"o",e,"i","j","0")),a.push.apply(a,jr(r,"o",e,0,o[1])),a.push("}"),a.push.apply(a,jr(r,"o",e,1,o[0])),a.push("}"),t&&a.push("}"),a}function qr(e,t,a,r,o){var n=[],l=["od0","od1","ad1"],s=[1,0],u=[1,0],p=[0,1];n.push.apply(n,Nr(e,o));for(var d=0;3>d;++d)n.push("for(var i",d,"=",l[d],";i",d,">0;){","var w",d,"=",QP,";","if(i",d,"<",QP,"){","w",d,"=i",d,";","i",d,"=0;","}else{","i",d,"-=",QP,";","}");n.push.apply(n,Lr(s,"o",e,"i0","i1","w1")),n.push("for(i=0;i<w0;++i){for(j=0;j<w1;++j){var r=0.0;"),n.push.apply(n,Lr(u,"a",t,"(i0+i)","i2")),n.push.apply(n,Lr(p,"b",a,"i2","(i1+j)")),n.push("for(k=0;k<w2;++k){"),n.push("r+=",Gr(u,"a",t,"(i0+i)","(i2+k)"),"*",Gr(p,"b",a,"(i2+k)","(i1+j)"),";"),n.push.apply(n,jr(u,"a",t,0,"(i2+k)")),n.push.apply(n,jr(p,"b",a,0,"(i2+k)")),n.push("}");var i="r";return r&&(i="A*r"),n.push.apply(n,zr(s,"o",e,"(i0+i)","(i1+j)",i+"+"+Gr(s,"o",e,"(i0+i)","(i1+j)"))),n.push.apply(n,jr(s,"o",e,0,"(i1+j)")),n.push("}"),n.push.apply(n,jr(s,"o",e,1,"(i0+i)")),n.push("}}}}"),n}function Br(e,t,a,r,o){var n=["gemm",e[0],e[1],"a",t[0],t[1],"b",a[0],a[1],r?"alpha":"",o?"beta":""].join(""),i=["function ",n,"(o,a,b,A,B){","var ",Or("o",e),Or("a",t),Or("b",a),"i,j,k;"];"r"===t[0]&&"c"===a[0]?i.push.apply(i,Ur(e,t,a,r,o)):i.push.apply(i,qr(e,t,a,r,o)),i.push("}return ",n);var l=new Function(i.join(""));return l()}function Vr(e){return Array.isArray(e)?[e.length,e[0].length]:e.shape}function Hr(e,t,a){var r=Vr(e),o=Vr(t),n=Vr(a);if(r[0]!==o[0]||r[1]!==n[1]||o[1]!==n[0])throw new Error("Mismatched array shapes for matrix product")}function Wr(e){if(Array.isArray(e)){if(Array.isArray(e))return["r","native"];}else if(e.shape&&2===e.shape.length)return e.order[0]?["r",e.dtype]:["c",e.dtype];throw new Error("Unrecognized data type")}function Xr(e,t,a,r,o){void 0===r&&(r=1),void 0===o&&(o=0);var n=1!==r,i=0!==o,l=Wr(e),s=Wr(t),u=Wr(a);Hr(e,t,a);var p=[l,s,u,n,i].join(":"),d=eT[p];return d||(d=eT[p]=ZP(l,s,u,n,i)),d(e,t,a,r,o)}function Yr(e,t){var a,r;if(void 0!==t&&(!Number.isFinite(t)||t%1!==t))throw new Error("axis of dimension to unsqueeze must be an integer");return t=void 0===t?e.shape.length:t,a=e.shape.slice(0),r=e.stride.slice(0),a.splice(t||0,0,1),r.splice(t||0,0,(r[t]||1)*(a[t+1]||1)),oP(e.data,a,r,e.offset)}function $r(e,t,a,r,o){for(var n=GT.dot,l=t.shape[0]-1;0<=l;l--)o.set(l,o.get(l)*r+e*n(t.pick(l,null),a));return!0}function Kr(e,t,a,o,l,s,u){for(var p=0,r=0,i=0,d=0,c=0,g=e.shape[0],h=e.shape[1],n=vn(t,g-1),f=vn(a,h-1),m=void 0===s?1:s,_=void 0===u?0:u;p<=n;){d=0;var y=vn(p+f,h-1);for(i=0;i<=y;i++)d+=e.get(p,i)*o.get(i);l.set(p,d*m+_*l.get(p)),p++}if(p<g)for(r=0;p+f<h;){for(d=0,i=0;i<=n+f;i++)c=r+i+1,d+=e.get(p,c)*o.get(c);if(l.set(p,d*m+_*l.get(p)),p++,r++,p===g)break}if(p<g)for(r++;p-n<h;){for(d=0,i=r;i<h;i++)d+=e.get(p,i)*o.get(i);if(l.set(p,d*m+_*l.get(p)),p++,r++,p===g)break}return!0}function Zr(e,t,a,r,o,l){var s=e.shape[0],n=r||!0,u=o===void 0?1:o,p=l===void 0?0:l,d=0,i=0,c=0,g=0;if(0===p)for(d=0;d<a.shape[0];++d)a.set(d,0);else 1!==p&&GT.scal(p,a);if(0===u)return!0;if(1===u){if(n)for(i=0;i<s;++i){for(c=t.get(i),g=0,a.set(i,a.get(i)+c*e.get(i,i)),d=i+1;d<s;++d)a.set(d,a.get(d)+c*e.get(d,i)),g+=e.get(d,i)*t.get(d);a.set(i,a.get(i)+g)}else for(i=0;i<s;++i){for(c=t.get(i),g=0,d=0;d<=i-1;++d)a.set(d,a.get(d)+c*e.get(d,i)),g+=e.get(d,i)*t.get(d);a.set(i,a.get(i)+c*e.get(i,i)+g)}}else if(n)for(i=0;i<s;++i){for(c=u*t.get(i),g=0,a.set(i,a.get(i)+c*e.get(i,i)),d=i+1;d<s;++d)a.set(d,a.get(d)+c*e.get(d,i)),g+=e.get(d,i)*t.get(d);a.set(i,a.get(i)+u*g)}else for(i=0;i<s;++i){for(c=u*t.get(i),g=0,d=0;d<=i-1;++d)a.set(d,a.get(d)+c*e.get(d,i)),g+=e.get(d,i)*t.get(d);a.set(i,a.get(i)+c*e.get(i,i)+u*g)}return!0}function Qr(){console.error("SBMV (symmetric banded matrix vector multiply) not yet implemented")}function Jr(e,t,a){var r=GT.dot,o=e.shape[1],n=0;if(a)for(n=o-1;0<=n;n--)t.set(n,r(e.pick(n,null).hi(n+1),t.hi(n+1)));else for(n=0;n<o;n++)t.set(n,r(e.pick(n,null).lo(n),t.lo(n)));return!0}function eo(){console.error("TBMV (triangular banded matrix vector multiply) not yet implemented")}function to(e,t,a){var r=GT.dot,o=e.shape[1],n=0;if(a)for(t.set(0,t.get(0)/e.get(0,0)),n=1;n<o;n++)t.set(n,(t.get(n)-r(e.pick(n,null).hi(n),t.hi(n)))/e.get(n,n));else for(t.set(o-1,t.get(o-1)/e.get(o-1,o-1)),n=o-2;0<=n;n--)t.set(n,(t.get(n)-r(e.pick(n,null).lo(n+1),t.lo(n+1)))/e.get(n,n));return!0}function ao(){console.error("TPSV (triangular packed matrix solver) not yet implemented")}function ro(){console.error("GER (rank 1 operation A := alpha*x*y' + A) not yet implemented")}function oo(){console.error("SYR (symmetric rank 1 operation A := alpha*x*y' + A) not yet implemented")}function no(){console.error("SPR (symmetric packed rank 1 operation A := alpha*x*y' + A) not yet implemented")}function io(){console.error("SYR (symmetric rank 2 operation A := alpha*x*y' + alpha*y*x' + A) not yet implemented")}function lo(){console.error("SPR (symmetric packed rank 2 operation A := alpha*x*y' + alpha*y*x' + A) not yet implemented")}function so(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}function uo(e){var t=32;return e&=-e,e&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}function po(e,t,a){var r=0|e[a];if(0>=r)return[];var o=Array(r),n;if(a===e.length-1)for(n=0;n<r;++n)o[n]=t;else for(n=0;n<r;++n)o[n]=po(e,t,a+1);return o}function co(e,t){var a,r;for(a=Array(e),r=0;r<e;++r)a[r]=t;return a}function go(e,t){switch("undefined"==typeof t&&(t=0),"undefined"==typeof e?"undefined":wn(e)){case"number":if(0<e)return co(0|e,t);break;case"object":if("number"==typeof e.length)return po(e,t,0);}return[]}function ho(e){var t=e.dtype;("generic"===t||"array"===t)&&(t="double");var a=jw.malloc(e.size,t),r=oP(a,e.shape);return uP.assign(r,e),r}function fo(e,t){t||(t="double");for(var a=1,r=Array(e.length),o=e.length-1;0<=o;--o)r[o]=a,a*=e[o];return oP(jw.malloc(a,t),e,r,0)}function mo(e){"generic"===e.dtype||"array"===e.dtype||jw.free(e.data)}function _o(e,t){t||(t="double");for(var a=1,r=Array(e.length),o=e.length-1;0<=o;--o)r[o]=a,a*=e[o];for(var n=jw.malloc(a,t),o=0;o<a;++o)n[o]=0;return oP(n,e,r,0)}function yo(e,t){t||(t="double");for(var a=1,r=Array(e.length),o=e.length-1;0<=o;--o)r[o]=a,a*=e[o];for(var n=jw.malloc(a,t),o=0;o<a;++o)n[o]=1;return oP(n,e,r,0)}function xo(e,t){var a,r;t||(t="double");var o=1,n=Array(e.length);for(a=e.length-1;0<=a;--a)n[a]=o,o*=e[a];var i=jw.malloc(o,t);for(a=0;a<o;++a)i[a]=0;var l=Infinity,s=0;for(a=e.length-1;0<=a;a--)s+=n[a],l=vn(l,e[a]);for(a=0,r=0;a<l;a++,r+=s)i[r]=1;return oP(i,e,n,0)}function vo(){var e,t,a,r;if(2===arguments.length?(t=arguments[0],r=arguments[1]):3===arguments.length&&(a=arguments[0],t=arguments[1],r=arguments[2]),!Array.isArray(r))throw new Error("second argument of tile must be an array of repetition counts for each dimension");var o=t.shape.slice(0),n=o.slice(0),i=bn(n.length,r.length);for(e=0;e<i;e++)if(o[e]=void 0===o[e]?1:o[e],r[e]=void 0===r[e]?1:r[e],n[e]=(void 0===n[e]?1:n[e])*r[e],0===n[e])throw new Error("Number of tiles must be greater than zero");a||(a=Vw.zeros(n,t.dtype));var l=1;for(e=0;e<r.length;e++)l*=r[e];var s=Array(r.length);for(e=0;e<r.length;e++)s[e]=0;var u=n.slice(0);for(c=0;c<n.length;c++)u[c]=c<t.dimension?null:0;for(e=0;e<l;e++){for(c=t.dimension;c<n.length;c++)u[c]=s[c];var p=a.pick.apply(a,u);if(p=p.lo.apply(p,s),p=p.hi.apply(p,t.shape),uP.assign(p,t),e===l-1)break;for(var c=i-1;0<=c&&(s[c]+=o[c],s[c]===n[c]);)s[c]=0,c--}return a}function bo(e,t){if(!t||"object"!==("undefined"==typeof t?"undefined":wn(t)))return e;for(var a=Object.keys(t),r=a.length;r--;)e[a[r]]=t[a[r]];return e}function So(){var e,t,a,r,o,n,i,s,u,l;if(r=rk({},nk),0===arguments.length)throw new Error("Array of ndarrays to concatenate must not be empty");if(Array.isArray(arguments[0])?(a=arguments[0],rk(r,arguments[1]||{})):2===arguments.length&&(a=arguments[1],e=arguments[0],rk(r,arguments[2]||{})),0===a.length)throw new Error("Array of ndarrays to concatenate must not be empty");for(o=0;o<a.length;o++)if(!i)i=a[o].shape.slice(0);else{if(a[o].dimension!==i.length)throw new Error("all arrays must have the same dimensionality");for(n=1;n<a[o].shape.length;n++)if(a[o].shape[n]!==i[n])throw new Error("last n-1 dimensions of concatenated rows must have the same size");i[0]+=a[o].shape[0]}if(!e)e=Vw.zeros(i,r.dtype);else if(i[0]!==e.shape[0])throw new Error("first dimension of output array must match the total number of concatenated rows");for(n=0,s=0;n<a.length;n++)t=a[n],u=t.shape[0],l=e.lo(s).hi(u),uP.assign(l,t),s+=u;return e}function Po(e,t){for(var a=Array(arguments.length-1),r=0,o=2,n=!0;o<arguments.length;)a[r++]=arguments[o++];return new Promise(function(o,i){a[r]=function(e){if(n)if(n=!1,e)i(e);else{for(var t=Array(arguments.length-1),a=0;a<t.length;)t[a++]=arguments[a];o.apply(null,t)}};try{e.apply(t||null,a)}catch(e){n&&(n=!1,i(e))}})}function To(){this._listeners={}}function wo(e){return"undefined"==typeof Float32Array?function(){function t(e,t,a,r){var o=0>t?1:0;if(o&&(t=-t),0===t)e(0<1/t?0:2147483648,a,r);else if(isNaN(t))e(2143289344,a,r);else if(3.4028234663852886e38<t)e((2139095040|o<<31)>>>0,a,r);else if(1.1754943508222875e-38>t)e((o<<31|xn(t/1.401298464324817e-45))>>>0,a,r);else{var n=_n(fn(t)/hn),i=8388607&xn(8388608*(t*Tn(2,-n)));e((o<<31|n+127<<23|i)>>>0,a,r)}}function a(e,t,a){var r=e(t,a),o=2*(r>>31)+1,n=255&r>>>23,i=8388607&r;return 255==n?i?NaN:o*Infinity:0==n?1.401298464324817e-45*o*i:o*Tn(2,n-150)*(i+8388608)}e.writeFloatLE=t.bind(null,ko),e.writeFloatBE=t.bind(null,Co),e.readFloatLE=a.bind(null,Fo),e.readFloatBE=a.bind(null,Mo)}():function(){function t(e,t,a){n[0]=e,t[a]=i[0],t[a+1]=i[1],t[a+2]=i[2],t[a+3]=i[3]}function a(e,t,a){n[0]=e,t[a]=i[3],t[a+1]=i[2],t[a+2]=i[1],t[a+3]=i[0]}function r(e,t){return i[0]=e[t],i[1]=e[t+1],i[2]=e[t+2],i[3]=e[t+3],n[0]}function o(e,t){return i[3]=e[t],i[2]=e[t+1],i[1]=e[t+2],i[0]=e[t+3],n[0]}var n=new Float32Array([0]),i=new Uint8Array(n.buffer),l=128===i[3];e.writeFloatLE=l?t:a,e.writeFloatBE=l?a:t,e.readFloatLE=l?r:o,e.readFloatBE=l?o:r}(),"undefined"==typeof Float64Array?function(){function t(e,t,a,r,o,n){var i=0>r?1:0;if(i&&(r=-r),0===r)e(0,o,n+t),e(0<1/r?0:2147483648,o,n+a);else if(isNaN(r))e(0,o,n+t),e(2146959360,o,n+a);else if(1.7976931348623157e308<r)e(0,o,n+t),e((2146435072|i<<31)>>>0,o,n+a);else{var l;if(2.2250738585072014e-308>r)l=r/5e-324,e(l>>>0,o,n+t),e((i<<31|l/4294967296)>>>0,o,n+a);else{var s=_n(fn(r)/hn);1024===s&&(s=1023),l=r*Tn(2,-s),e(4503599627370496*l>>>0,o,n+t),e((i<<31|s+1023<<20|1048575&1048576*l)>>>0,o,n+a)}}}function a(e,t,a,r,o){var n=e(r,o+t),i=e(r,o+a),l=2*(i>>31)+1,s=2047&i>>>20,u=4294967296*(1048575&i)+n;return 2047==s?u?NaN:l*Infinity:0==s?5e-324*l*u:l*Tn(2,s-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,ko,0,4),e.writeDoubleBE=t.bind(null,Co,4,0),e.readDoubleLE=a.bind(null,Fo,0,4),e.readDoubleBE=a.bind(null,Mo,4,0)}():function(){function t(e,t,a){n[0]=e,t[a]=i[0],t[a+1]=i[1],t[a+2]=i[2],t[a+3]=i[3],t[a+4]=i[4],t[a+5]=i[5],t[a+6]=i[6],t[a+7]=i[7]}function a(e,t,a){n[0]=e,t[a]=i[7],t[a+1]=i[6],t[a+2]=i[5],t[a+3]=i[4],t[a+4]=i[3],t[a+5]=i[2],t[a+6]=i[1],t[a+7]=i[0]}function r(e,t){return i[0]=e[t],i[1]=e[t+1],i[2]=e[t+2],i[3]=e[t+3],i[4]=e[t+4],i[5]=e[t+5],i[6]=e[t+6],i[7]=e[t+7],n[0]}function o(e,t){return i[7]=e[t],i[6]=e[t+1],i[5]=e[t+2],i[4]=e[t+3],i[3]=e[t+4],i[2]=e[t+5],i[1]=e[t+6],i[0]=e[t+7],n[0]}var n=new Float64Array([0]),i=new Uint8Array(n.buffer),l=128===i[7];e.writeDoubleLE=l?t:a,e.writeDoubleBE=l?a:t,e.readDoubleLE=l?r:o,e.readDoubleBE=l?o:r}(),e}function ko(e,t,a){t[a]=255&e,t[a+1]=255&e>>>8,t[a+2]=255&e>>>16,t[a+3]=e>>>24}function Co(e,t,a){t[a]=e>>>24,t[a+1]=255&e>>>16,t[a+2]=255&e>>>8,t[a+3]=255&e}function Fo(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function Mo(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}function Eo(e){try{var t=eval("quire".replace(/^/,"re"))(e);if(t&&(t.length||Object.keys(t).length))return t}catch(t){}return null}function Do(e,t,a){var r=a||8192,o=null,n=r;return function(a){if(1>a||a>r>>>1)return e(a);n+a>r&&(o=e(r),n=0);var i=t.call(o,n,n+=a);return 7&n&&(n=(7|n)+1),i}}function Io(e,t){this.lo=e>>>0,this.hi=t>>>0}function Ao(e,t,a){this.fn=e,this.len=t,this.next=void 0,this.val=a}function Ro(){}function Oo(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Lo(){this.len=0,this.head=new Ao(Ro,0,0),this.tail=this.head,this.states=null}function jo(e,t,a){t[a]=255&e}function zo(e,t,a){for(;127<e;)t[a++]=128|127&e,e>>>=7;t[a]=e}function Go(e,t){this.len=e,this.next=void 0,this.val=t}function Uo(e,t,a){for(;e.hi;)t[a++]=128|127&e.lo,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;127<e.lo;)t[a++]=128|127&e.lo,e.lo>>>=7;t[a++]=e.lo}function No(e,t,a){t[a]=255&e,t[a+1]=255&e>>>8,t[a+2]=255&e>>>16,t[a+3]=e>>>24}function qo(){tC.call(this)}function Bo(e,t,a){40>e.length?eC.utf8.write(e,t,a):t.utf8Write(e,a)}function Vo(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Ho(e){this.buf=e,this.pos=0,this.len=e.length}function Wo(){var e=new dC(0,0),t=0;if(4<this.len-this.pos){for(;4>t;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,128>this.buf[this.pos++])return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,128>this.buf[this.pos++])return e;t=0}else{for(;3>t;++t){if(this.pos>=this.len)throw Vo(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,128>this.buf[this.pos++])return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}if(4<this.len-this.pos){for(;5>t;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,128>this.buf[this.pos++])return e;}else for(;5>t;++t){if(this.pos>=this.len)throw Vo(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,128>this.buf[this.pos++])return e}throw Error("invalid varint encoding")}function Xo(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function Yo(){if(this.pos+8>this.len)throw Vo(this,8);return new dC(Xo(this.buf,this.pos+=4),Xo(this.buf,this.pos+=4))}function $o(e){pC.call(this,e)}function Ko(e,t,a){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");eC.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!t,this.responseDelimited=!!a}function Zo(e){return"number"==typeof e&&kC(e)}function Qo(e){var t=null==e?0:e.length;return t?Xb(e,FC):[]}function Jo(e,t){var a=function(e,t,a){return e+(t-e)*a},r=[],o=new Number((e.length-1)/(t-1));r[0]=e[0];for(var n=1;n<t-1;n++){var i=n*o,l=new Number(_n(i)).toFixed(),s=new Number(yn(i)).toFixed();r[n]=a(e[l],e[s],i-l)}return r[t-1]=e[e.length-1],r}function en(e){var t=e.reduce(function(e,t){return e+t*t},0),a=Pn(t);return e.map(function(e){return e/a})}function tn(t){return OC(this,void 0,void 0,regeneratorRuntime.mark(function a(){var r,o,n,i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return 200>t.values.length&&console.warn("Pattern detector requires atleast 250 data for a reliable prediction, received just ",t.values.length),a.next=3,zC.ready();case 3:return jn.reverseInputs(t),r=t.values,o=en(Jo(r,400)),a.next=8,zC.predict({input:new Float32Array(o)});case 8:return n=a.sent,i=n.output.indexOf(bn.apply(Math,In(n.output))),jn.reverseInputs(t),a.abrupt("return",{pattern:e.AvailablePatterns[i],patternId:i,probability:100*n.output[i]});case 12:case"end":return a.stop();}},a,this)}))}function an(t){return OC(this,void 0,void 0,regeneratorRuntime.mark(function a(){var r;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,tn(t);case 2:return r=a.sent,a.abrupt("return",r.patternId===e.AvailablePatterns.DB&&75<r.probability);case 4:case"end":return a.stop();}},a,this)}))}function rn(t){return OC(this,void 0,void 0,regeneratorRuntime.mark(function a(){var r;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,tn(t);case 2:return r=a.sent,a.abrupt("return",r.patternId===e.AvailablePatterns.DT&&75<r.probability);case 4:case"end":return a.stop();}},a,this)}))}function on(t){return OC(this,void 0,void 0,regeneratorRuntime.mark(function a(){var r;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,tn(t);case 2:return r=a.sent,a.abrupt("return",r.patternId===e.AvailablePatterns.HS&&75<r.probability);case 4:case"end":return a.stop();}},a,this)}))}function nn(t){return OC(this,void 0,void 0,regeneratorRuntime.mark(function a(){var r;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,tn(t);case 2:return r=a.sent,a.abrupt("return",r.patternId===e.AvailablePatterns.IHS&&75<r.probability);case 4:case"end":return a.stop();}},a,this)}))}function ln(t){return OC(this,void 0,void 0,regeneratorRuntime.mark(function a(){var r;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,tn(t);case 2:return r=a.sent,a.abrupt("return",r.patternId===e.AvailablePatterns.TU&&75<r.probability);case 4:case"end":return a.stop();}},a,this)}))}function sn(t){return OC(this,void 0,void 0,regeneratorRuntime.mark(function a(){var r;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,tn(t);case 2:return r=a.sent,a.abrupt("return",r.patternId===e.AvailablePatterns.TD&&75<r.probability);case 4:case"end":return a.stop();}},a,this)}))}function un(){return["sma","ema","wma","wema","macd","rsi","bollingerbands","adx","atr","truerange","roc","kst","psar","stochastic","williamsr","adl","obv","trix","cci","forceindex","vwap","renko","heikinashi","averagegain","averageloss","sd","bullish","bearish","abandonedbaby","doji","bearishengulfingpattern","bullishengulfingpattern","darkcloudcover","downsidetasukigap","dragonflydoji","gravestonedoji","bullishharami","bearishharami","bullishharamicross","bearishharamicross","eveningdojistar","eveningstar","morningdojistar","morningstar","bullishmarubozu","bearishmarubozu","piercingline","bullishspinningtop","bearishspinningtop","threeblackcrows","threewhitesoldiers","predictPattern","hasDoubleBottom","hasDoubleTop","hasHeadAndShoulder","hasInverseHeadAndShoulder","isTrendingUp","isTrendingDown"]}var pn=String.fromCharCode,dn=Math.expm1,cn=Math.exp,gn=Math.sign,hn=Math.LN2,fn=Math.log,mn=String.prototype,_n=Math.floor,yn=Math.ceil,xn=Math.round,vn=Math.min,bn=Math.max,Sn=Math.abs,Pn=Math.sqrt,Tn=Math.pow,wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kn=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Cn=function(){function e(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),Fn=function e(t,a,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,a);if(void 0===o){var n=Object.getPrototypeOf(t);return null===n?void 0:e(n,a,r)}if("value"in o)return o.value;var i=o.get;return void 0===i?void 0:i.call(r)},Mn=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},En=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"==typeof t||"function"==typeof t)?t:e},Dn=function(){function e(e,t){var a=[],r=!0,o=!1,n;try{for(var i=e[Symbol.iterator](),l;!(r=(l=i.next()).done)&&(a.push(l.value),!(t&&a.length===t));r=!0);}catch(e){o=!0,n=e}finally{try{!r&&i["return"]&&i["return"]()}finally{if(o)throw n}}return a}return function(t,a){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),In=function(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)},An=function e(){kn(this,e)},Rn=function e(){kn(this,e),this.open=[],this.high=[],this.low=[],this.close=[],this.volume=[],this.timestamp=[]},On={},Ln=function e(){kn(this,e)},jn=function(){function e(t){kn(this,e),this.format=t.format||r}return Cn(e,[{key:"getResult",value:function(){return this.result}}],[{key:"reverseInputs",value:function(e){e.reversedInput&&(e.values?e.values.reverse():void 0,e.open?e.open.reverse():void 0,e.high?e.high.reverse():void 0,e.low?e.low.reverse():void 0,e.close?e.close.reverse():void 0,e.volume?e.volume.reverse():void 0,e.timestamp?e.timestamp.reverse():void 0)}}]),e}(),zn=function e(t,a,r){kn(this,e),this.next=r,r&&(r.prev=this),this.prev=a,a&&(a.next=this),this.data=t},Gn=function(){function e(){kn(this,e),this._length=0}return Cn(e,[{key:"push",value:function(e){this._tail=new zn(e,this._tail),0===this._length&&(this._head=this._tail,this._current=this._head,this._next=this._head),this._length++}},{key:"pop",value:function(){var e=this._tail;if(0!==this._length)return(this._length--,0===this._length)?(this._head=this._tail=this._current=this._next=void 0,e.data):(this._tail=e.prev,this._tail.next=void 0,this._current===e&&(this._current=this._tail,this._next=void 0),e.data)}},{key:"shift",value:function(){var e=this._head;if(0!==this._length)return(this._length--,0===this._length)?(this._head=this._tail=this._current=this._next=void 0,e.data):(this._head=this._head.next,this._current===e&&(this._current=this._head,this._next=this._current.next),e.data)}},{key:"unshift",value:function(e){this._head=new zn(e,void 0,this._head),0===this._length&&(this._tail=this._head,this._next=this._head),this._length++}},{key:"unshiftCurrent",value:function(){var e=this._current;return e===this._head||2>this._length?e&&e.data:(e===this._tail?(this._tail=e.prev,this._tail.next=void 0,this._current=this._tail):(e.next.prev=e.prev,e.prev.next=e.next,this._current=e.prev),this._next=this._current.next,e.next=this._head,e.prev=void 0,this._head.prev=e,this._head=e,e.data)}},{key:"removeCurrent",value:function(){var e=this._current;if(0!==this._length)return(this._length--,0===this._length)?(this._head=this._tail=this._current=this._next=void 0,e.data):(e===this._tail?(this._tail=e.prev,this._tail.next=void 0,this._current=this._tail):e===this._head?(this._head=e.next,this._head.prev=void 0,this._current=this._head):(e.next.prev=e.prev,e.prev.next=e.next,this._current=e.prev),this._next=this._current.next,e.data)}},{key:"resetCursor",value:function(){return this._current=this._next=this._head,this}},{key:"next",value:function(){var e=this._next;if(void 0!==e)return this._next=e.next,this._current=e,e.data}},{key:"head",get:function(){return this._head&&this._head.data}},{key:"tail",get:function(){return this._tail&&this._tail.data}},{key:"current",get:function(){return this._current&&this._current.data}},{key:"length",get:function(){return this._length}}]),e}(),Un=function(e){function t(e,a){kn(this,t);var r=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.period=e,r.values=a,r}return Mn(t,e),t}(Ln),Nn=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.period=e.period,a.price=e.values;var r=regeneratorRuntime.mark(function e(t){var a,r,o,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Gn,r=0,o=1,void(e.next=5);case 5:n=e.sent,a.push(0);case 7:return o<t?(o++,a.push(n),r+=n):(r=r-a.shift()+n,i=r/t,a.push(n)),e.next=11,i;case 11:n=e.sent,e.next=7;break;case 14:case"end":return e.stop();}},e,this)});return a.generator=r(a.period),a.generator.next(),a.result=[],a.price.forEach(function(e){var t=a.generator.next(e);void 0!==t.value&&a.result.push(a.format(t.value))}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){var t=this.generator.next(e).value;if(void 0!=t)return this.format(t)}}]),t}(jn);Nn.calculate=o;var qn=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.period,o=e.values,n;a.result=[],n=new Nn({period:r,values:[]});var i=regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void(e.next=2);case 2:t=e.sent;case 3:if(!(a&&t)){e.next=11;break}return a=(t-a)*(2/(r+1))+a,e.next=8,a;case 8:t=e.sent,e.next=19;break;case 11:return void(e.next=13);case 13:if(t=e.sent,a=n.nextValue(t),!a){e.next=19;break}return e.next=18,a;case 18:t=e.sent;case 19:e.next=3;break;case 21:case"end":return e.stop();}},e,this)});return a.generator=i(),a.generator.next(),a.generator.next(),o.forEach(function(e){var t=a.generator.next(e);void 0!=t.value&&a.result.push(a.format(t.value))}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){var t=this.generator.next(e).value;if(void 0!=t)return this.format(t)}}]),t}(jn);qn.calculate=n;var Bn=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.period,o=e.values;return a.result=[],a.generator=regeneratorRuntime.mark(function e(){var t,a,o,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=new Gn,a=r*(r+1)/2;case 2:if(!(t.length<r)){e.next=11;break}return e.t0=t,void(e.next=7);case 7:e.t1=e.sent,e.t0.push.call(e.t0,e.t1),e.next=19;break;case 11:for(t.resetCursor(),o=0,n=1;n<=r;n++)o+=t.next()*n/a;return e.next=16,o;case 16:i=e.sent,t.shift(),t.push(i);case 19:e.next=2;break;case 21:case"end":return e.stop();}},e,this)})(),a.generator.next(),o.forEach(function(e){var t=a.generator.next(e);void 0!=t.value&&a.result.push(a.format(t.value))}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){var t=this.generator.next(e).value;if(void 0!=t)return this.format(t)}}]),t}(jn);Bn.calculate=s;var Vn=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.period,o=e.values,n;a.result=[],n=new Nn({period:r,values:[]});var i=regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void(e.next=2);case 2:t=e.sent;case 3:if(!(a&&void 0!=t)){e.next=11;break}return a=(t-a)*(1/r)+a,e.next=8,a;case 8:t=e.sent,e.next=19;break;case 11:return void(e.next=13);case 13:if(t=e.sent,a=n.nextValue(t),!a){e.next=19;break}return e.next=18,a;case 18:t=e.sent;case 19:e.next=3;break;case 21:case"end":return e.stop();}},e,this)});return a.generator=i(),a.generator.next(),a.generator.next(),o.forEach(function(e){var t=a.generator.next(e);void 0!=t.value&&a.result.push(a.format(t.value))}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){var t=this.generator.next(e).value;if(void 0!=t)return this.format(t)}}]),t}(jn);Vn.calculate=u;var Hn=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.values=e,a.SimpleMAOscillator=!0,a.SimpleMASignal=!0,a}return Mn(t,e),t}(Ln),Wn=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.SimpleMAOscillator?Nn:qn,o=e.SimpleMASignal?Nn:qn,n=new r({period:e.fastPeriod,values:[],format:function(e){return e}}),i=new r({period:e.slowPeriod,values:[],format:function(e){return e}}),l=new o({period:e.signalPeriod,values:[],format:function(e){return e}}),s=a.format;return a.result=[],a.generator=regeneratorRuntime.mark(function t(){var a,r,o,u,p,d,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=0;case 1:if(!(a<e.slowPeriod)){t.next=10;break}return void(t.next=5);case 5:return r=t.sent,d=n.nextValue(r),c=i.nextValue(r),a++,t.abrupt("continue",1);case 10:return d&&c&&(o=d-c,u=l.nextValue(o)),p=o-u,t.next=14,{MACD:s(o),signal:u?s(u):void 0,histogram:isNaN(p)?void 0:s(p)};case 14:r=t.sent,d=n.nextValue(r),c=i.nextValue(r),t.next=1;break;case 19:case"end":return t.stop();}},t,this)})(),a.generator.next(),e.values.forEach(function(e){var t=a.generator.next(e);void 0!=t.value&&a.result.push(t.value)}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){var t=this.generator.next(e).value;return t}}]),t}(jn);Wn.calculate=p;var Xn=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),Yn=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.values,o=e.period,n=a.format;return a.generator=regeneratorRuntime.mark(function e(t){var a,r,o,i,l,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void(e.next=2);case 2:a=e.sent,r=1,o=0;case 5:return l=s?a-s:0,l=l?l:0,0<l&&(o+=l),r<t+1?r++:i?i=(i*(t-1)+(0<l?l:0))/t:i=o/t,s=a,i=i?n(i):void 0,e.next=14,i;case 14:a=e.sent,e.next=5;break;case 17:case"end":return e.stop();}},e,this)})(o),a.generator.next(),a.result=[],r.forEach(function(e){var t=a.generator.next(e);void 0!==t.value&&a.result.push(t.value)}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){return this.generator.next(e).value}}]),t}(jn);Yn.calculate=d;var $n=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),Kn=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.values,o=e.period,n=a.format;return a.generator=regeneratorRuntime.mark(function e(t){var a,r,o,i,l,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void(e.next=2);case 2:a=e.sent,r=1,o=0;case 5:return l=s?s-a:0,l=l?l:0,0<l&&(o+=l),r<t+1?r++:i?i=(i*(t-1)+(0<l?l:0))/t:i=o/t,s=a,i=i?n(i):void 0,e.next=14,i;case 14:a=e.sent,e.next=5;break;case 17:case"end":return e.stop();}},e,this)})(o),a.generator.next(),a.result=[],r.forEach(function(e){var t=a.generator.next(e);void 0!==t.value&&a.result.push(t.value)}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){return this.generator.next(e).value}}]),t}(jn);Kn.calculate=c;var Zn=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),Qn=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.period,o=e.values,n=new Yn({period:r,values:[]}),i=new Kn({period:r,values:[]}),l=1;return a.generator=regeneratorRuntime.mark(function e(t){var a,r,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void(e.next=2);case 2:a=e.sent;case 3:return r=n.nextValue(a),o=i.nextValue(a),r&&o?0===o?u=100:(s=r/o,u=parseFloat((100-100/(1+s)).toFixed(2))):r&&!o?u=100:o&&!r?u=0:l>=t&&(u=0),l++,e.next=10,u;case 10:a=e.sent,e.next=3;break;case 13:case"end":return e.stop();}},e,this)})(r),a.generator.next(),a.result=[],o.forEach(function(e){var t=a.generator.next(e);void 0!==t.value&&a.result.push(t.value)}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){return this.generator.next(e).value}}]),t}(jn);Qn.calculate=g;var Jn=function(e){function t(e,a,r){kn(this,t);var o=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(o.size=e,o.maintainHigh=a,o.maintainLow=r,o.periodHigh=0,o.periodLow=Infinity,!e||"number"!=typeof e)throw"Size required and should be a number.";return o._push=o.push,o.push=function(e){this.add(e)},o}return Mn(t,e),Cn(t,[{key:"add",value:function(e){this.length===this.size?(this.lastShift=this.shift(),this._push(e),this.maintainHigh&&this.lastShift==this.periodHigh&&this.calculatePeriodHigh(),this.maintainLow&&this.lastShift==this.periodLow&&this.calculatePeriodLow()):this._push(e),this.maintainHigh&&this.periodHigh<=e&&(this.periodHigh=e),this.maintainLow&&this.periodLow>=e&&(this.periodLow=e)}},{key:"iterator",value:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.resetCursor();case 1:if(!this.next()){e.next=6;break}return e.next=4,this.current;case 4:e.next=1;break;case 6:case"end":return e.stop();}},e,this)})},{key:"calculatePeriodHigh",value:function(){for(this.resetCursor(),this.next()&&(this.periodHigh=this.current);this.next();)this.periodHigh<=this.current&&(this.periodHigh=this.current)}},{key:"calculatePeriodLow",value:function(){for(this.resetCursor(),this.next()&&(this.periodLow=this.current);this.next();)this.periodLow>=this.current&&(this.periodLow=this.current)}}]),t}(Gn),ei=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),ti=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.period,o=e.values,n=new Nn({period:r,values:[],format:function(e){return e}});return a.result=[],a.generator=regeneratorRuntime.mark(function e(){var t,a,o,i,l,s,u,p,d,c,g;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=new Jn(r);;return void(e.next=4);case 4:t=e.sent;case 5:if(o.push(t),a=n.nextValue(t),!a){e.next=30;break}for(l=0,s=!0,u=!1,p=void 0,e.prev=13,d=o.iterator()[Symbol.iterator]();!(s=(c=d.next()).done);s=!0)g=c.value,l+=Tn(g-a,2);e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](13),u=!0,p=e.t0;case 21:e.prev=21,e.prev=22,!s&&d.return&&d.return();case 24:if(e.prev=24,!u){e.next=27;break}throw p;case 27:return e.finish(24);case 28:return e.finish(21);case 29:i=Pn(l/r);case 30:return e.next=32,i;case 32:t=e.sent,e.next=5;break;case 35:case"end":return e.stop();}},e,this,[[13,17,21,29],[22,,24,28]])})(),a.generator.next(),o.forEach(function(e){var t=a.generator.next(e);void 0!=t.value&&a.result.push(a.format(t.value))}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){var t=this.generator.next(e);if(void 0!=t.value)return this.format(t.value)}}]),t}(jn);ti.calculate=h;var ai=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),ri=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),oi=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.period,o=e.values,n=e.stdDev,i=a.format,l,s;return a.result=[],l=new Nn({period:r,values:[],format:function(e){return e}}),s=new ti({period:r,values:[],format:function(e){return e}}),a.generator=regeneratorRuntime.mark(function e(){var t,a,r,o,u,p,d,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void(e.next=2);case 2:a=e.sent;case 3:return r=l.nextValue(a),o=s.nextValue(a),r&&(u=i(r),p=i(r+o*n),d=i(r-o*n),c=i((a-d)/(p-d)),t={middle:u,upper:p,lower:d,pb:c}),e.next=9,t;case 9:a=e.sent,e.next=3;break;case 12:case"end":return e.stop();}},e,this)})(),a.generator.next(),o.forEach(function(e){var t=a.generator.next(e);void 0!=t.value&&a.result.push(t.value)}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){return this.generator.next(e).value}}]),t}(jn);oi.calculate=f;var ni=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.period=e.period,a.price=e.values;var r=regeneratorRuntime.mark(function e(t){var a,r,o,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Gn,r=0,o=1,void(e.next=5);case 5:n=e.sent,i=0;case 7:return o<t?(o++,r+=n,i=void 0):o==t?(o++,r+=n,i=r):i=i-i/t+n,e.next=11,i;case 11:n=e.sent,e.next=7;break;case 14:case"end":return e.stop();}},e,this)});return a.generator=r(a.period),a.generator.next(),a.result=[],a.price.forEach(function(e){var t=a.generator.next(e);void 0!=t.value&&a.result.push(a.format(t.value))}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){var t=this.generator.next(e).value;if(void 0!=t)return this.format(t)}}]),t}(jn);ni.calculate=m;var ii=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),li=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.low,o=e.high,n=a.format;if(r.length!=o.length)throw"Inputs(low,high) not of equal size";return a.result=[],a.generator=regeneratorRuntime.mark(function e(){var t,a,r,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void(e.next=2);case 2:a=e.sent;case 3:return r&&(o=a.high-r.high,i=r.low-a.low,t=n(i>o&&0<i?i:0)),r=a,e.next=8,t;case 8:a=e.sent,e.next=3;break;case 11:case"end":return e.stop();}},e,this)})(),a.generator.next(),r.forEach(function(e,t){var n=a.generator.next({high:o[t],low:r[t]});void 0!==n.value&&a.result.push(n.value)}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){return this.generator.next(e).value}}],[{key:"calculate",value:function(e){jn.reverseInputs(e);var a=new t(e).result;return e.reversedInput&&a.reverse(),jn.reverseInputs(e),a}}]),t}(jn),si=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),ui=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.low,o=e.high,n=a.format;if(r.length!=o.length)throw"Inputs(low,high) not of equal size";return a.result=[],a.generator=regeneratorRuntime.mark(function e(){var t,a,r,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void(e.next=2);case 2:a=e.sent;case 3:return r&&(o=a.high-r.high,i=r.low-a.low,t=n(o>i&&0<o?o:0)),r=a,e.next=8,t;case 8:a=e.sent,e.next=3;break;case 11:case"end":return e.stop();}},e,this)})(),a.generator.next(),r.forEach(function(e,t){var n=a.generator.next({high:o[t],low:r[t]});void 0!==n.value&&a.result.push(n.value)}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){return this.generator.next(e).value}}],[{key:"calculate",value:function(e){jn.reverseInputs(e);var a=new t(e).result;return e.reversedInput&&a.reverse(),jn.reverseInputs(e),a}}]),t}(jn),pi=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),di=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.low,o=e.high,n=e.close,i=a.format;if(r.length!=o.length)throw"Inputs(low,high) not of equal size";return a.result=[],a.generator=regeneratorRuntime.mark(function e(){var t,a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void(e.next=2);case 2:t=e.sent;case 3:if(void 0!=a){e.next=9;break}return a=t.close,e.next=8,r;case 8:t=e.sent;case 9:return r=bn(t.high-t.low,isNaN(Sn(t.high-a))?0:Sn(t.high-a),isNaN(Sn(t.low-a))?0:Sn(t.low-a)),a=t.close,void 0!=r&&(r=i(r)),e.next=14,r;case 14:t=e.sent,e.next=3;break;case 17:case"end":return e.stop();}},e,this)})(),a.generator.next(),r.forEach(function(e,t){var i=a.generator.next({high:o[t],low:r[t],close:n[t]});void 0!=i.value&&a.result.push(i.value)}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){return this.generator.next(e).value}}]),t}(jn);di.calculate=_;var ci=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),gi=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),hi=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.low,o=e.high,n=e.close,i=e.period,l=a.format,s=new ui({high:[],low:[]}),u=new li({high:[],low:[]}),p=new ni({period:i,values:[],format:function(e){return e}}),d=new ni({period:i,values:[],format:function(e){return e}}),c=new ni({period:i,values:[],format:function(e){return e}}),g=new Vn({period:i,values:[],format:function(e){return e}}),h=new di({low:[],high:[],close:[]});if(r.length!==o.length||o.length!==n.length)throw"Inputs(low,high, close) not of equal size";return a.result=[],gi,a.generator=regeneratorRuntime.mark(function e(){var t,a,r,o,n,i,l,f,m,_,y,x,v,b,S,P,T;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void(e.next=2);case 2:t=e.sent,a=0,r=0,o=0,n=0;case 7:if(_=h.nextValue(t),y=s.nextValue(t),x=u.nextValue(t),void 0!==_){e.next=16;break}return void(e.next=14);case 14:return t=e.sent,e.abrupt("continue",7);case 16:return v=c.nextValue(_),b=p.nextValue(y),S=d.nextValue(x),void 0!=v&&void 0!=b&&void 0!=S&&(i=100*b/v,l=100*S/v,P=Sn(i-l),T=i+l,f=100*(P/T),m=g.nextValue(f)),e.next=22,{adx:m,pdi:i,mdi:l};case 22:t=e.sent,e.next=7;break;case 25:case"end":return e.stop();}},e,this)})(),a.generator.next(),r.forEach(function(e,t){var i=a.generator.next({high:o[t],low:r[t],close:n[t]});void 0!=i.value&&void 0!=i.value.adx&&a.result.push({adx:l(i.value.adx),pdi:l(i.value.pdi),mdi:l(i.value.mdi)})}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){var t=this.generator.next(e).value;if(void 0!=t&&void 0!=t.adx)return{adx:this.format(t.adx),pdi:this.format(t.pdi),mdi:this.format(t.mdi)}}}]),t}(jn);hi.calculate=y;var fi=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),mi=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.low,o=e.high,n=e.close,i=e.period,l=a.format;if(r.length!==o.length||o.length!==n.length)throw"Inputs(low,high, close) not of equal size";var s=new di({low:[],high:[],close:[]}),u=new Vn({period:i,values:[],format:function(e){return e}});return a.result=[],a.generator=regeneratorRuntime.mark(function e(){var t,a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void(e.next=2);case 2:t=e.sent;;case 4:return r=s.nextValue({low:t.low,high:t.high,close:t.close}),a=void 0===r?void 0:u.nextValue(r),e.next=9,a;case 9:t=e.sent,e.next=4;break;case 12:case"end":return e.stop();}},e,this)})(),a.generator.next(),r.forEach(function(e,t){var i=a.generator.next({high:o[t],low:r[t],close:n[t]});void 0!==i.value&&a.result.push(l(i.value))}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){return this.generator.next(e).value}}]),t}(jn);mi.calculate=x;var _i=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),yi=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.period,o=e.values;return a.result=[],a.generator=regeneratorRuntime.mark(function e(){var t,a,o,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=1,a=new Jn(r);;return void(e.next=5);case 5:o=e.sent;case 6:return a.push(o),t<r?t++:n=100*((o-a.lastShift)/a.lastShift),e.next=11,n;case 11:o=e.sent,e.next=6;break;case 14:case"end":return e.stop();}},e,this)})(),a.generator.next(),o.forEach(function(e){var t=a.generator.next(e);void 0==t.value||isNaN(t.value)||a.result.push(a.format(t.value))}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){var t=this.generator.next(e);if(void 0!=t.value&&!isNaN(t.value))return this.format(t.value)}}]),t}(jn);yi.calculate=v;var xi=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),vi=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.values,o=e.ROCPer1,n=e.ROCPer2,i=e.ROCPer3,l=e.ROCPer4,s=e.SMAROCPer1,u=e.SMAROCPer2,p=e.SMAROCPer3,d=e.SMAROCPer4,c=e.signalPeriod,g=new yi({period:o,values:[]}),h=new yi({period:n,values:[]}),f=new yi({period:i,values:[]}),m=new yi({period:l,values:[]}),_=new Nn({period:s,values:[],format:function(e){return e}}),y=new Nn({period:u,values:[],format:function(e){return e}}),x=new Nn({period:p,values:[],format:function(e){return e}}),v=new Nn({period:d,values:[],format:function(e){return e}}),b=new Nn({period:c,values:[],format:function(e){return e}}),S=a.format;a.result=[];var P=bn(o+s,n+u,i+p,l+d);return a.generator=regeneratorRuntime.mark(function e(){var t,a,r,o,n,i,l,s,u,p,d,c,T;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=1,void(e.next=3);case 3:a=e.sent,r=void 0,o=void 0,n=void 0,i=void 0,l=void 0,s=void 0,u=void 0;case 6:return p=g.nextValue(a),d=h.nextValue(a),c=f.nextValue(a),T=m.nextValue(a),o=void 0===p?void 0:_.nextValue(p),n=void 0===d?void 0:y.nextValue(d),i=void 0===c?void 0:x.nextValue(c),l=void 0===T?void 0:v.nextValue(T),t<P?t++:r=1*o+2*n+3*i+4*l,s=void 0===r?void 0:b.nextValue(r),u=void 0===r?void 0:{kst:S(r),signal:s?S(s):void 0},e.next=20,u;case 20:a=e.sent,e.next=6;break;case 23:case"end":return e.stop();}},e,this)})(),a.generator.next(),r.forEach(function(e){var t=a.generator.next(e);void 0!=t.value&&a.result.push(t.value)}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){var t=this.generator.next(e);if(void 0!=t.value)return t.value}}]),t}(jn);vi.calculate=b;var bi=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),Si=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.high||[],o=e.low||[],n=regeneratorRuntime.mark(function e(t,a){var r,o,n,i,l,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,o=void 0,n=void 0,i=void 0,l=!0,s=t,void(e.next=5);case 5:u=e.sent;case 6:return r?(n+=s*(o-n),l?(n=vn(n,i.low,u.low),r.high>o&&(o=r.high,s=vn(s+t,a))):(n=bn(n,i.high,u.high),r.low<o&&(o=r.low,s=vn(s+t,a))),(l&&r.low<n||!l&&r.high>n)&&(s=t,n=o,l=!l,o=l?r.high:r.low)):(n=u.low,o=u.high),i=u,r&&(u=r),e.next=12,n;case 12:r=e.sent,e.next=6;break;case 15:case"end":return e.stop();}},e,this)});return a.result=[],a.generator=n(e.step,e.max),a.generator.next(),o.forEach(function(e,t){var n=a.generator.next({high:r[t],low:o[t]});void 0!==n.value&&a.result.push(n.value)}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){var t=this.generator.next(e);if(void 0!==t.value)return t.value}}]),t}(jn);Si.calculate=S;var Pi=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),Ti=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.low,o=e.high,n=e.close,i=e.period,l=e.signalPeriod,s=a.format;if(r.length!==o.length||o.length!==n.length)throw"Inputs(low,high, close) not of equal size";return a.result=[],a.generator=regeneratorRuntime.mark(function e(){var t,a,r,o,n,u,p,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=1,a=new Jn(i,!0,!1),r=new Jn(i,!1,!0),o=new Nn({period:l,values:[],format:function(e){return e}}),n=void 0,u=void 0,void(e.next=7);case 7:p=e.sent;case 8:if(a.push(p.high),r.push(p.low),!(t<i)){e.next=17;break}return t++,void(e.next=15);case 15:return p=e.sent,e.abrupt("continue",8);case 17:return d=r.periodLow,n=100*((p.close-d)/(a.periodHigh-d)),u=o.nextValue(n),e.next=22,{k:s(n),d:u?s(u):void 0};case 22:p=e.sent,e.next=8;break;case 25:case"end":return e.stop();}},e,this)})(),a.generator.next(),r.forEach(function(e,t){var i=a.generator.next({high:o[t],low:r[t],close:n[t]});void 0!==i.value&&a.result.push(i.value)}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){var t=this.generator.next(e);if(void 0!==t.value)return t.value}}]),t}(jn);Ti.calculate=P;var wi=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),ki=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.low,o=e.high,n=e.close,i=e.period,l=a.format;if(r.length!==o.length||o.length!==n.length)throw"Inputs(low,high, close) not of equal size";return a.result=[],a.generator=regeneratorRuntime.mark(function e(){var t,a,r,o,n,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=1,a=new Jn(i,!0,!1),r=new Jn(i,!1,!0),o=void 0,n=void 0,void(e.next=7);case 7:s=e.sent,u=void 0;case 9:if(a.push(s.high),r.push(s.low),!(t<i)){e.next=18;break}return t++,void(e.next=16);case 16:return s=e.sent,e.abrupt("continue",9);case 18:return o=r.periodLow,n=a.periodHigh,u=l(-100*((n-s.close)/(n-o))),e.next=23,u;case 23:s=e.sent,e.next=9;break;case 26:case"end":return e.stop();}},e,this)})(),a.generator.next(),r.forEach(function(e,t){var i=a.generator.next({high:o[t],low:r[t],close:n[t]});void 0!==i.value&&a.result.push(i.value)}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){var t=this.generator.next(e);if(void 0!=t.value)return this.format(t.value)}}]),t}(jn);ki.calculate=T;var Ci=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),Fi=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.high,o=e.low,n=e.close,i=e.volume;if(o.length!==r.length||r.length!==n.length||r.length!==i.length)throw"Inputs(low,high, close, volumes) not of equal size";return a.result=[],a.generator=regeneratorRuntime.mark(function e(){var t,a,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0,void(e.next=3);case 3:a=e.sent;case 4:return r=(a.close-a.low-(a.high-a.close))/(a.high-a.low),o=r*a.volume,t+=o,e.next=10,xn(t);case 10:a=e.sent,e.next=4;break;case 13:case"end":return e.stop();}},e,this)})(),a.generator.next(),r.forEach(function(e,t){var r={high:e,low:o[t],close:n[t],volume:i[t]},l=a.generator.next(r);void 0!=l.value&&a.result.push(l.value)}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){return this.generator.next(e).value}}]),t}(jn);Fi.calculate=w;var Mi=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),Ei=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.close,o=e.volume;return a.result=[],a.generator=regeneratorRuntime.mark(function e(){var t,a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0,void(e.next=3);case 3:if(a=e.sent,!(a.close&&"number"==typeof a.close)){e.next=9;break}return r=a.close,void(e.next=8);case 8:a=e.sent;case 9:return r<a.close?t+=a.volume:a.close<r&&(t-=a.volume),r=a.close,e.next=14,t;case 14:a=e.sent,e.next=9;break;case 17:case"end":return e.stop();}},e,this)})(),a.generator.next(),r.forEach(function(e,t){var n={close:r[t],volume:o[t]},i=a.generator.next(n);void 0!=i.value&&a.result.push(i.value)}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){return this.generator.next(e).value}}]),t}(jn);Ei.calculate=k;var Di=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),Ii=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.values,o=e.period,n=a.format,i=new qn({period:o,values:[],format:function(e){return e}}),l=new qn({period:o,values:[],format:function(e){return e}}),s=new qn({period:o,values:[],format:function(e){return e}}),u=new yi({period:1,values:[],format:function(e){return e}});return a.result=[],a.generator=regeneratorRuntime.mark(function e(){var t,a,r,o,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void(e.next=2);case 2:t=e.sent;case 3:return a=i.nextValue(t),r=a?l.nextValue(a):void 0,o=r?s.nextValue(r):void 0,p=o?u.nextValue(o):void 0,e.next=10,p?n(p):void 0;case 10:t=e.sent,e.next=3;break;case 13:case"end":return e.stop();}},e,this)})(),a.generator.next(),r.forEach(function(e){var t=a.generator.next(e);void 0!==t.value&&a.result.push(t.value)}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){var t=this.generator.next(e);if(void 0!==t.value)return t.value}}]),t}(jn);Ii.calculate=C;var Ai=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.period=1,e}return Mn(t,e),t}(Ln),Ri=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.close,o=e.volume,n=e.period||1;if(o.length!==r.length)throw"Inputs(volume, close) not of equal size";var i=new qn({values:[],period:n});return a.result=[],a.generator=regeneratorRuntime.mark(function e(){var t,a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void(e.next=2);case 2:return t=e.sent,void(e.next=5);case 5:a=e.sent,r=void 0;case 7:return r=(a.close-t.close)*a.volume,t=a,e.next=12,i.nextValue(r);case 12:a=e.sent,e.next=7;break;case 15:case"end":return e.stop();}},e,this)})(),a.generator.next(),o.forEach(function(e,t){var n=a.generator.next({close:r[t],volume:o[t]});void 0!=n.value&&a.result.push(n.value)}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){var t=this.generator.next(e).value;if(void 0!=t)return t}}]),t}(jn);Ri.calculate=F;var Oi=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),Li=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.low,o=e.high,n=e.close,i=e.period,l=a.format,s=new Jn(i),u=new Nn({period:i,values:[],format:function(e){return e}});if(r.length!==o.length||o.length!==n.length)throw"Inputs(low,high, close) not of equal size";return a.result=[],a.generator=regeneratorRuntime.mark(function e(){var t,a,r,o,n,i,l,p,d,c,g,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void(e.next=2);case 2:t=e.sent;case 3:if(a=(t.high+t.low+t.close)/3,s.push(a),r=u.nextValue(a),o=null,n=void 0,i=0,void 0==r){e.next=32;break}for(l=!0,p=!1,d=void 0,e.prev=14,c=s.iterator()[Symbol.iterator]();!(l=(g=c.next()).done);l=!0)h=g.value,i+=Sn(h-r);e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](14),p=!0,d=e.t0;case 22:e.prev=22,e.prev=23,!l&&c.return&&c.return();case 25:if(e.prev=25,!p){e.next=28;break}throw d;case 28:return e.finish(25);case 29:return e.finish(22);case 30:o=i/20,n=(a-r)/(.015*o);case 32:return e.next=34,n;case 34:t=e.sent,e.next=3;break;case 37:case"end":return e.stop();}},e,this,[[14,18,22,30],[23,,25,29]])})(),a.generator.next(),r.forEach(function(e,t){var i=a.generator.next({high:o[t],low:r[t],close:n[t]});void 0!=i.value&&a.result.push(i.value)}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){var t=this.generator.next(e).value;if(void 0!=t)return t}}]),t}(jn);Li.calculate=M;var ji=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),zi=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.low,o=e.high,n=e.close,i=e.volume,l=a.format;if(r.length!==o.length||o.length!==n.length)throw"Inputs(low,high, close) not of equal size";return a.result=[],a.generator=regeneratorRuntime.mark(function e(){var t,a,r,o,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void(e.next=2);case 2:t=e.sent,a=0,r=0;case 5:return o=(t.high+t.low+t.close)/3,n=t.volume*o,a+=n,r+=t.volume,e.next=12,a/r;case 12:t=e.sent;;e.next=5;break;case 16:case"end":return e.stop();}},e,this)})(),a.generator.next(),r.forEach(function(e,t){var l=a.generator.next({high:o[t],low:r[t],close:n[t],volume:i[t]});void 0!=l.value&&a.result.push(l.value)}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){var t=this.generator.next(e).value;if(void 0!=t)return t}}]),t}(jn);zi.calculate=D;var Gi=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),Ui=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=a.format,o=e.useATR,n=e.brickSize||0;if(o){var i=x(Object.assign({},e));n=i[i.length-1]}if(a.result=new Rn,0===n)return console.error("Not enough data to calculate brickSize for renko when using ATR"),En(a);var l=0,s=0,u=Infinity,p=0,d=0,c=0;return a.generator=regeneratorRuntime.mark(function e(){var t,a,r,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void(e.next=2);case 2:t=e.sent;case 3:if(0!=l){e.next=15;break}return l=t.close,s=t.high,u=t.low,p=t.close,d=t.volume,c=t.timestamp,void(e.next=13);case 13:return t=e.sent,e.abrupt("continue",3);case 15:if(a=Sn(t.close-p),r=Sn(t.close-l),!(a>=n&&r>=n)){e.next=30;break}return o=a>r?l:p,i={open:o,high:s>t.high?s:t.high,low:u<t.Low?u:t.low,close:o>t.close?o-n:o+n,volume:d+t.volume,timestamp:t.timestamp},l=i.open,s=i.close,u=i.close,p=i.close,d=0,e.next=27,i;case 27:t=e.sent,e.next=37;break;case 30:return s=s>t.high?s:t.high,u=u<t.Low?u:t.low,d+=t.volume,c=t.timestamp,void(e.next=36);case 36:t=e.sent;case 37:e.next=3;break;case 39:case"end":return e.stop();}},e,this)})(),a.generator.next(),e.low.forEach(function(t,r){var o=a.generator.next({open:e.open[r],high:e.high[r],low:e.low[r],close:e.close[r],volume:e.volume[r],timestamp:e.timestamp[r]});o.value&&(a.result.open.push(o.value.open),a.result.high.push(o.value.high),a.result.low.push(o.value.low),a.result.close.push(o.value.close),a.result.volume.push(o.value.volume),a.result.timestamp.push(o.value.timestamp))}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(){return console.error("Cannot calculate next value on Renko, Every value has to be recomputed for every change, use calcualte method"),null}}]),t}(jn);Ui.calculate=I;var Ni=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(Ln),qi=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=a.format;a.result=new Rn;var o=null,n=0,i=Infinity,l=0,s=0,u=0;return a.generator=regeneratorRuntime.mark(function e(){var t,a,r,p,d,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void(e.next=2);case 2:t=e.sent,a=null;case 4:return null==o?(o=(t.close+t.open)/2,n=t.high,i=t.low,l=(t.close+t.open+t.high+t.low)/4,s=t.volume||0,u=t.timestamp||0,a={open:o,high:n,low:i,close:l,volume:t.volume||0,timestamp:t.timestamp||0}):(r=(t.close+t.open+t.high+t.low)/4,p=(o+l)/2,d=bn(p,r,t.high),c=vn(t.low,p,r),a={close:r,open:p,high:d,low:c,volume:t.volume||0,timestamp:t.timestamp||0},l=r,o=p,n=d,i=c),e.next=8,a;case 8:t=e.sent,e.next=4;break;case 11:case"end":return e.stop();}},e,this)})(),a.generator.next(),e.low.forEach(function(t,r){var o=a.generator.next({open:e.open[r],high:e.high[r],low:e.low[r],close:e.close[r],volume:e.volume?e.volume[r]:e.volume,timestamp:e.timestamp?e.timestamp[r]:e.timestamp});o.value&&(a.result.open.push(o.value.open),a.result.high.push(o.value.high),a.result.low.push(o.value.low),a.result.close.push(o.value.close),a.result.volume.push(o.value.volume),a.result.timestamp.push(o.value.timestamp))}),a}return Mn(t,e),Cn(t,[{key:"nextValue",value:function(e){var t=this.generator.next(e).value;return t}}]),t}(jn);qi.calculate=A;var Bi=function(){function e(){kn(this,e)}return Cn(e,[{key:"approximateEqual",value:function(e,t){var a=1*parseFloat(Sn(e-t).toPrecision(4)),r=1*parseFloat((1e-3*e).toPrecision(4));return a<=r}},{key:"logic",value:function(){throw"this has to be implemented"}},{key:"getAllPatternIndex",value:function(e){var t=this;if(e.close.length<this.requiredCount)return console.warn("Data count less than data required for the strategy ",this.name),[];e.reversedInput&&(e.open.reverse(),e.high.reverse(),e.low.reverse(),e.close.reverse());var a=this.logic;return this._generateDataForCandleStick(e).map(function(e,r){return a.call(t,e)?r:void 0}).filter(function(e){return e})}},{key:"hasPattern",value:function(e){if(e.close.length<this.requiredCount)return console.warn("Data count less than data required for the strategy ",this.name),!1;e.reversedInput&&(e.open.reverse(),e.high.reverse(),e.low.reverse(),e.close.reverse());var t=this.logic;return t.call(this,this._getLastDataForCandleStick(e))}},{key:"_getLastDataForCandleStick",value:function(e){var t=this.requiredCount;if(e.close.length===t)return e;for(var a={open:[],high:[],low:[],close:[]},r=0,o=e.close.length-t;r<t;)a.open.push(e.open[o+r]),a.high.push(e.high[o+r]),a.low.push(e.low[o+r]),a.close.push(e.close[o+r]),r++;return a}},{key:"_generateDataForCandleStick",value:function(e){var t=this.requiredCount,a=e.close.map(function(a,r){for(var o=0,n={open:[],high:[],low:[],close:[]};o<t;)n.open.push(e.open[r+o]),n.high.push(e.high[r+o]),n.low.push(e.low[r+o]),n.close.push(e.close[r+o]),o++;return n}).filter(function(a,r){return r<=e.close.length-t});return a}}]),e}(),Vi=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="MorningStar",e.requiredCount=3,e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=e.open[1],i=e.close[1],l=e.high[1],s=e.low[1],u=e.open[2],p=e.close[2],d=e.high[2],c=e.low[2];return a<t&&o>s&&o>l&&l<o&&s<o&&u>l&&i<u&&u<p&&p>(t+a)/2}}]),t}(Bi),Hi=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="BullishEngulfingPattern",e.requiredCount=2,e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=e.open[1],i=e.close[1],l=e.high[1],s=e.low[1];return a<t&&t>n&&a>n&&t<i}}]),t}(Bi),Wi=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.requiredCount=2,e.name="BullishHarami",e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=e.open[1],i=e.close[1],l=e.high[1],s=e.low[1];return t<n&&a>n&&a>i&&t<s&&r>l}}]),t}(Bi),Xi=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.requiredCount=2,e.name="BullishHaramiCross",e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=e.open[1],i=e.close[1],l=e.high[1],s=e.low[1],u=this.approximateEqual(n,i);return t<n&&a>n&&a>i&&t<s&&r>l&&u}}]),t}(Bi),Yi=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="Doji",e.requiredCount=1,e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0];return this.approximateEqual(t,a)}}]),t}(Bi),$i=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="MorningDojiStar",e.requiredCount=3,e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=e.open[1],i=e.close[1],l=e.high[1],s=e.low[1],u=e.open[2],p=e.close[2],d=e.high[2],c=e.low[2],g=new Yi().hasPattern({open:[n],close:[i],high:[l],low:[s]});return a<t&&g&&u<p&&l<o&&s<o&&u>l&&i<u&&p>(t+a)/2}}]),t}(Bi),Ki=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.requiredCount=3,e.name="DownsideTasukiGap",e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=e.open[1],i=e.close[1],l=e.high[1],s=e.low[1],u=e.open[2],p=e.close[2],d=e.high[2],c=e.low[2];return a<t&&i<n&&p>u&&l<o&&n>u&&i<u&&p>n&&p<a}}]),t}(Bi),Zi=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="BullishMarubozu",e.requiredCount=1,e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=this.approximateEqual(a,r)&&this.approximateEqual(o,t)&&t<a&&t<r;return n}}]),t}(Bi),Qi=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.requiredCount=2,e.name="PiercingLine",e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=e.open[1],i=e.close[1],l=e.high[1],s=e.low[1];return s<o&&a<t&&o>n&&i>(t+a)/2&&i>n}}]),t}(Bi),Ji=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="ThreeWhiteSoldiers",e.requiredCount=3,e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=e.open[1],i=e.close[1],l=e.high[1],s=e.low[1],u=e.open[2],p=e.close[2],d=e.high[2],c=e.low[2];return l>r&&d>l&&t<a&&n<i&&u<p&&a>n&&n<r&&l>u&&u<i}}]),t}(Bi),el=[new Hi,new Ki,new Wi,new Xi,new $i,new Vi,new Zi,new Qi,new Ji],tl=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="Bullish Candlesticks",e}return Mn(t,e),Cn(t,[{key:"hasPattern",value:function(e){return el.reduce(function(t,a){var r=a.hasPattern(e);return t||r},!1)}}]),t}(Bi),al=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="BearishEngulfingPattern",e.requiredCount=2,e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=e.open[1],i=e.close[1],l=e.high[1],s=e.low[1];return a>t&&t<n&&a<n&&t>i}}]),t}(Bi),rl=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.requiredCount=2,e.name="BearishHarami",e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=e.open[1],i=e.close[1],l=e.high[1],s=e.low[1];return t>n&&a<n&&a<i&&t>s&&r>l}}]),t}(Bi),ol=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.requiredCount=2,e.name="BearishHaramiCross",e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=e.open[1],i=e.close[1],l=e.high[1],s=e.low[1],u=this.approximateEqual(n,i);return t>n&&a<n&&a<i&&t>s&&r>l&&u}}]),t}(Bi),nl=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="EveningDojiStar",e.requiredCount=3,e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=e.open[1],i=e.close[1],l=e.high[1],s=e.low[1],u=e.open[2],p=e.close[2],d=e.high[2],c=e.low[2],g=new Yi().hasPattern({open:[n],close:[i],high:[l],low:[s]});return a>t&&g&&l>r&&s>r&&u<s&&i>u&&u>p&&p<(t+a)/2}}]),t}(Bi),il=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="EveningStar",e.requiredCount=3,e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=e.open[1],i=e.close[1],l=e.high[1],s=e.low[1],u=e.open[2],p=e.close[2],d=e.high[2],c=e.low[2];return a>t&&r<s&&r<l&&l>r&&s>r&&u<s&&i>u&&u>p&&p<(t+a)/2}}]),t}(Bi),ll=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="BearishMarubozu",e.requiredCount=1,e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=this.approximateEqual(t,r)&&this.approximateEqual(o,a)&&t>a&&t>o;return n}}]),t}(Bi),sl=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="ThreeBlackCrows",e.requiredCount=3,e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=e.open[1],i=e.close[1],l=e.high[1],s=e.low[1],u=e.open[2],p=e.close[2],d=e.high[2],c=e.low[2];return o>s&&s>c&&t>a&&n>i&&u>p&&t>n&&n>a&&n>u&&u>i}}]),t}(Bi),ul=[new al,new rl,new ol,new nl,new il,new ll,new sl],pl=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="Bearish Candlesticks",e}return Mn(t,e),Cn(t,[{key:"hasPattern",value:function(e){return ul.reduce(function(t,a){return t||a.hasPattern(e)},!1)}}]),t}(Bi),dl=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="AbandonedBaby",e.requiredCount=3,e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=e.open[1],i=e.close[1],l=e.high[1],s=e.low[1],u=e.open[2],p=e.close[2],d=e.high[2],c=e.low[2],g=new Yi().hasPattern({open:[n],close:[i],high:[l],low:[s]});return a<t&&g&&l<o&&c>l&&p>u&&d<t}}]),t}(Bi),cl=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="DarkCloudCover",e.requiredCount=2,e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=e.open[1],i=e.close[1],l=e.high[1],s=e.low[1];return a>t&&i<n&&n>r&&i<(a+t)/2&&i>t}}]),t}(Bi),gl=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.requiredCount=1,e.name="DragonFlyDoji",e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=this.approximateEqual(t,a),n=this.approximateEqual(t,r);return o&&n}}]),t}(Bi),hl=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.requiredCount=1,e.name="GraveStoneDoji",e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.low[0],o=this.approximateEqual(t,a),n=this.approximateEqual(t,r);return o&&n}}]),t}(Bi),fl=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="BullishSpinningTop",e.requiredCount=1,e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=Sn(a-t),i=Sn(r-a),l=Sn(t-o);return n<i&&n<l}}]),t}(Bi),ml=function(e){function t(){kn(this,t);var e=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="BearishSpinningTop",e.requiredCount=1,e}return Mn(t,e),Cn(t,[{key:"logic",value:function(e){var t=e.open[0],a=e.close[0],r=e.high[0],o=e.low[0],n=Sn(a-t),i=Sn(r-t),l=Sn(r-o);return n<i&&n<l}}]),t}(Bi),_l="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?{}:self:global:window,yl=se(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)}),xl={}.hasOwnProperty,vl=function(e,t){return xl.call(e,t)},bl=function(e){try{return!!e()}catch(t){return!0}},Sl=!bl(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),Pl=se(function(e){var t=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=t)}),Tl=function(e){return"object"===("undefined"==typeof e?"undefined":wn(e))?null!==e:"function"==typeof e},wl=function(e){if(!Tl(e))throw TypeError(e+" is not an object!");return e},kl=yl.document,Cl=Tl(kl)&&Tl(kl.createElement),Fl=function(e){return Cl?kl.createElement(e):{}},Ml=!Sl&&!bl(function(){return 7!=Object.defineProperty(Fl("div"),"a",{get:function(){return 7}}).a}),El=function(e,t){if(!Tl(e))return e;var a,r;if(t&&"function"==typeof(a=e.toString)&&!Tl(r=a.call(e)))return r;if("function"==typeof(a=e.valueOf)&&!Tl(r=a.call(e)))return r;if(!t&&"function"==typeof(a=e.toString)&&!Tl(r=a.call(e)))return r;throw TypeError("Can't convert object to primitive value")},Dl=Object.defineProperty,Il=Sl?Object.defineProperty:function(e,t,a){if(wl(e),t=El(t,!0),wl(a),Ml)try{return Dl(e,t,a)}catch(t){}if("get"in a||"set"in a)throw TypeError("Accessors not supported!");return"value"in a&&(e[t]=a.value),e},Al={f:Il},Rl=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},Ol=Sl?function(e,t,a){return Al.f(e,t,Rl(1,a))}:function(e,t,a){return e[t]=a,e},Ll=0,jl=Math.random(),zl=function(e){return"Symbol(".concat(e===void 0?"":e,")_",(++Ll+jl).toString(36))},Gl=se(function(e){var t=zl("src"),a="toString",r=Function[a],o=(""+r).split(a);Pl.inspectSource=function(e){return r.call(e)},(e.exports=function(e,a,r,n){var i="function"==typeof r;i&&(vl(r,"name")||Ol(r,"name",a));e[a]===r||(i&&(vl(r,t)||Ol(r,t,e[a]?""+e[a]:o.join(a+""))),e===yl?e[a]=r:n?e[a]?e[a]=r:Ol(e,a,r):(delete e[a],Ol(e,a,r)))})(Function.prototype,a,function(){return"function"==typeof this&&this[t]||r.call(this)})}),Ul=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e},Nl=function(e,t,a){return(Ul(e),void 0===t)?e:1===a?function(r){return e.call(t,r)}:2===a?function(r,a){return e.call(t,r,a)}:3===a?function(r,a,o){return e.call(t,r,a,o)}:function(){return e.apply(t,arguments)}},ql="prototype",Bl=function e(t,a,r){var o=t&e.F,n=t&e.G,i=t&e.S,l=t&e.P,s=t&e.B,u=n?yl:i?yl[a]||(yl[a]={}):(yl[a]||{})[ql],p=n?Pl:Pl[a]||(Pl[a]={}),d=p[ql]||(p[ql]={}),c,g,h,f;for(c in n&&(r=a),r)g=!o&&u&&void 0!==u[c],h=(g?u:r)[c],f=s&&g?Nl(h,yl):l&&"function"==typeof h?Nl(Function.call,h):h,u&&Gl(u,c,h,t&e.U),p[c]!=h&&Ol(p,c,f),l&&d[c]!=h&&(d[c]=h)};yl.core=Pl,Bl.F=1,Bl.G=2,Bl.S=4,Bl.P=8,Bl.B=16,Bl.W=32,Bl.U=64,Bl.R=128;var Vl=Bl,Hl=se(function(e){var t=zl("meta"),a=Al.f,r=0,o=Object.isExtensible||function(){return!0},n=!bl(function(){return o(Object.preventExtensions({}))}),i=function(e){a(e,t,{value:{i:"O"+ ++r,w:{}}})},l=e.exports={KEY:t,NEED:!1,fastKey:function(e,a){if(!Tl(e))return"symbol"==("undefined"==typeof e?"undefined":wn(e))?e:("string"==typeof e?"S":"P")+e;if(!vl(e,t)){if(!o(e))return"F";if(!a)return"E";i(e)}return e[t].i},getWeak:function(e,a){if(!vl(e,t)){if(!o(e))return!0;if(!a)return!1;i(e)}return e[t].w},onFreeze:function(e){return n&&l.NEED&&o(e)&&!vl(e,t)&&i(e),e}}}),Wl="__core-js_shared__",Xl=yl[Wl]||(yl[Wl]={}),Yl=function(e){return Xl[e]||(Xl[e]={})},$l=se(function(e){var t=Yl("wks"),a=yl.Symbol,r="function"==typeof a,o=e.exports=function(e){return t[e]||(t[e]=r&&a[e]||(r?a:zl)("Symbol."+e))};o.store=t}),Kl=Al.f,Zl=$l("toStringTag"),Ql=function(e,t,a){e&&!vl(e=a?e:e.prototype,Zl)&&Kl(e,Zl,{configurable:!0,value:t})},Jl=$l,es={f:Jl},ts=!1,as=Al.f,rs=function(e){var t=Pl.Symbol||(Pl.Symbol=yl.Symbol||{});"_"==e.charAt(0)||e in t||as(t,e,{value:es.f(e)})},os={}.toString,ns=function(e){return os.call(e).slice(8,-1)},is=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==ns(e)?e.split(""):Object(e)},ls=function(e){if(e==void 0)throw TypeError("Can't call method on  "+e);return e},ss=function(e){return is(ls(e))},us=yn,ps=_n,ds=function(e){return isNaN(e=+e)?0:(0<e?ps:us)(e)},cs=vn,gs=function(e){return 0<e?cs(ds(e),9007199254740991):0},hs=bn,fs=vn,ms=function(e,t){return e=ds(e),0>e?hs(e+t,0):fs(e,t)},_s=function(e){return function(t,a,r){var o=ss(t),n=gs(o.length),i=ms(r,n),l;if(e&&a!=a){for(;n>i;)if(l=o[i++],l!=l)return!0;}else for(;n>i;i++)if((e||i in o)&&o[i]===a)return e||i||0;return!e&&-1}},ys=Yl("keys"),xs=function(e){return ys[e]||(ys[e]=zl(e))},vs=_s(!1),bs=xs("IE_PROTO"),Ss=function(e,t){var a=ss(e),r=0,o=[],n;for(n in a)n!=bs&&vl(a,n)&&o.push(n);for(;t.length>r;)vl(a,n=t[r++])&&(~vs(o,n)||o.push(n));return o},Ps=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ts=Object.keys||function(e){return Ss(e,Ps)},ws=function(e,t){for(var a=ss(e),r=Ts(a),o=r.length,n=0,i;o>n;)if(a[i=r[n++]]===t)return i},ks=Object.getOwnPropertySymbols,Cs={f:ks},Fs={}.propertyIsEnumerable,Ms={f:Fs},Es=function(e){var t=Ts(e),a=Cs.f;if(a)for(var r=a(e),o=Ms.f,n=0,i;r.length>n;)o.call(e,i=r[n++])&&t.push(i);return t},Ds=Array.isArray||function(e){return"Array"==ns(e)},Is=Sl?Object.defineProperties:function(e,t){wl(e);for(var a=Ts(t),r=a.length,o=0,n;r>o;)Al.f(e,n=a[o++],t[n]);return e},As=yl.document&&document.documentElement,Rs=xs("IE_PROTO"),Os=function(){},Ls="prototype",js=function(){var e=Fl("iframe"),t=Ps.length,a="<",r=">",o;for(e.style.display="none",As.appendChild(e),e.src="javascript:",o=e.contentWindow.document,o.open(),o.write(a+"script"+r+"document.F=Object"+a+"/script"+r),o.close(),js=o.F;t--;)delete js[Ls][Ps[t]];return js()},zs=Object.create||function(e,t){var a;return null===e?a=js():(Os[Ls]=wl(e),a=new Os,Os[Ls]=null,a[Rs]=e),void 0===t?a:Is(a,t)},Gs=Ps.concat("length","prototype"),Us=Object.getOwnPropertyNames||function(e){return Ss(e,Gs)},Ns={f:Us},qs=Ns.f,Bs={}.toString,Vs="object"==("undefined"==typeof window?"undefined":wn(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Hs=function(e){try{return qs(e)}catch(t){return Vs.slice()}},Ws=function(e){return Vs&&"[object Window]"==Bs.call(e)?Hs(e):qs(ss(e))},Xs={f:Ws},Ys=Object.getOwnPropertyDescriptor,$s=Sl?Ys:function(e,t){if(e=ss(e),t=El(t,!0),Ml)try{return Ys(e,t)}catch(t){}return vl(e,t)?Rl(!Ms.f.call(e,t),e[t]):void 0},Ks={f:$s},Zs=Hl.KEY,Qs=Ks.f,Js=Al.f,eu=Xs.f,tu=yl.Symbol,au=yl.JSON,ru=au&&au.stringify,ou="prototype",nu=$l("_hidden"),iu=$l("toPrimitive"),lu={}.propertyIsEnumerable,su=Yl("symbol-registry"),uu=Yl("symbols"),pu=Yl("op-symbols"),du=Object[ou],cu="function"==typeof tu,gu=yl.QObject,hu=!gu||!gu[ou]||!gu[ou].findChild,fu=Sl&&bl(function(){return 7!=zs(Js({},"a",{get:function(){return Js(this,"a",{value:7}).a}})).a})?function(e,t,a){var r=Qs(du,t);r&&delete du[t],Js(e,t,a),r&&e!==du&&Js(du,t,r)}:Js,mu=function(e){var t=uu[e]=zs(tu[ou]);return t._k=e,t},_u=cu&&"symbol"==wn(tu.iterator)?function(e){return"symbol"==("undefined"==typeof e?"undefined":wn(e))}:function(e){return e instanceof tu},yu=function(e,t,a){return e===du&&yu(pu,t,a),wl(e),t=El(t,!0),wl(a),vl(uu,t)?(a.enumerable?(vl(e,nu)&&e[nu][t]&&(e[nu][t]=!1),a=zs(a,{enumerable:Rl(0,!1)})):(!vl(e,nu)&&Js(e,nu,Rl(1,{})),e[nu][t]=!0),fu(e,t,a)):Js(e,t,a)},xu=function(e,t){wl(e);for(var a=Es(t=ss(t)),r=0,o=a.length,n;o>r;)yu(e,n=a[r++],t[n]);return e},vu=function(e,t){return t===void 0?zs(e):xu(zs(e),t)},bu=function(e){var t=lu.call(this,e=El(e,!0));return this===du&&vl(uu,e)&&!vl(pu,e)?!1:t||!vl(this,e)||!vl(uu,e)||vl(this,nu)&&this[nu][e]?t:!0},Su=function(e,t){if(e=ss(e),t=El(t,!0),e!==du||!vl(uu,t)||vl(pu,t)){var a=Qs(e,t);return a&&vl(uu,t)&&!(vl(e,nu)&&e[nu][t])&&(a.enumerable=!0),a}},Pu=function(e){for(var t=eu(ss(e)),a=[],r=0,o;t.length>r;)vl(uu,o=t[r++])||o==nu||o==Zs||a.push(o);return a},Tu=function(e){for(var t=e===du,a=eu(t?pu:ss(e)),r=[],o=0,n;a.length>o;)vl(uu,n=a[o++])&&(!t||vl(du,n))&&r.push(uu[n]);return r};cu||(tu=function(){if(this instanceof tu)throw TypeError("Symbol is not a constructor!");var e=zl(0<arguments.length?arguments[0]:void 0);return Sl&&hu&&fu(du,e,{configurable:!0,set:function t(a){this===du&&t.call(pu,a),vl(this,nu)&&vl(this[nu],e)&&(this[nu][e]=!1),fu(this,e,Rl(1,a))}}),mu(e)},Gl(tu[ou],"toString",function(){return this._k}),Ks.f=Su,Al.f=yu,Ns.f=Xs.f=Pu,Ms.f=bu,Cs.f=Tu,Sl&&!ts&&Gl(du,"propertyIsEnumerable",bu,!0),es.f=function(e){return mu($l(e))}),Vl(Vl.G+Vl.W+Vl.F*!cu,{Symbol:tu});for(var wu=["hasInstance","isConcatSpreadable","iterator","match","replace","search","species","split","toPrimitive","toStringTag","unscopables"],ku=0;wu.length>ku;)$l(wu[ku++]);for(var wu=Ts($l.store),ku=0;wu.length>ku;)rs(wu[ku++]);Vl(Vl.S+Vl.F*!cu,"Symbol",{for:function(e){return vl(su,e+="")?su[e]:su[e]=tu(e)},keyFor:function(e){if(_u(e))return ws(su,e);throw TypeError(e+" is not a symbol!")},useSetter:function(){hu=!0},useSimple:function(){hu=!1}}),Vl(Vl.S+Vl.F*!cu,"Object",{create:vu,defineProperty:yu,defineProperties:xu,getOwnPropertyDescriptor:Su,getOwnPropertyNames:Pu,getOwnPropertySymbols:Tu}),au&&Vl(Vl.S+Vl.F*(!cu||bl(function(){var e=tu();return"[null]"!=ru([e])||"{}"!=ru({a:e})||"{}"!=ru(Object(e))})),"JSON",{stringify:function(e){if(!(void 0===e||_u(e))){for(var t=[e],a=1,r,o;arguments.length>a;)t.push(arguments[a++]);return r=t[1],"function"==typeof r&&(o=r),(o||!Ds(r))&&(r=function(e,t){if(o&&(t=o.call(this,e,t)),!_u(t))return t}),t[1]=r,ru.apply(au,t)}}}),tu[ou][iu]||Ol(tu[ou],iu,tu[ou].valueOf),Ql(tu,"Symbol"),Ql(Math,"Math",!0),Ql(yl.JSON,"JSON",!0),Vl(Vl.S,"Object",{create:zs}),Vl(Vl.S+Vl.F*!Sl,"Object",{defineProperty:Al.f}),Vl(Vl.S+Vl.F*!Sl,"Object",{defineProperties:Is});var i=function(e,t){var a=(Pl.Object||{})[e]||Object[e],r={};r[e]=t(a),Vl(Vl.S+Vl.F*bl(function(){a(1)}),"Object",r)},Cu=Ks.f;i("getOwnPropertyDescriptor",function(){return function(e,t){return Cu(ss(e),t)}});var Fu=function(e){return Object(ls(e))},Mu=xs("IE_PROTO"),Eu=Object.prototype,Du=Object.getPrototypeOf||function(e){return e=Fu(e),vl(e,Mu)?e[Mu]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Eu:null};i("getPrototypeOf",function(){return function(e){return Du(Fu(e))}}),i("keys",function(){return function(e){return Ts(Fu(e))}}),i("getOwnPropertyNames",function(){return Xs.f});var Iu=Hl.onFreeze;i("freeze",function(e){return function(t){return e&&Tl(t)?e(Iu(t)):t}});var Au=Hl.onFreeze;i("seal",function(e){return function(t){return e&&Tl(t)?e(Au(t)):t}});var Ru=Hl.onFreeze;i("preventExtensions",function(e){return function(t){return e&&Tl(t)?e(Ru(t)):t}}),i("isFrozen",function(e){return function(t){return!Tl(t)||!!e&&e(t)}}),i("isSealed",function(e){return function(t){return!Tl(t)||!!e&&e(t)}}),i("isExtensible",function(e){return function(t){return!!Tl(t)&&(!e||e(t))}});var Ou=Object.assign,Lu=!Ou||bl(function(){var e={},t={},a=Symbol(),r="abcdefghijklmnopqrst";return e[a]=7,r.split("").forEach(function(e){t[e]=e}),7!=Ou({},e)[a]||Object.keys(Ou({},t)).join("")!=r})?function(e){for(var t=Fu(e),a=arguments.length,r=1,o=Cs.f,n=Ms.f;a>r;)for(var i=is(arguments[r++]),l=o?Ts(i).concat(o(i)):Ts(i),s=l.length,u=0,p;s>u;)n.call(i,p=l[u++])&&(t[p]=i[p]);return t}:Ou;Vl(Vl.S+Vl.F,"Object",{assign:Lu});var ju=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t};Vl(Vl.S,"Object",{is:ju});var zu=function(e,t){if(wl(e),!Tl(t)&&null!==t)throw TypeError(t+": can't set as prototype!")},Gu={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,a){try{a=Nl(Function.call,Ks.f(Object.prototype,"__proto__").set,2),a(e,[]),t=!(e instanceof Array)}catch(a){t=!0}return function(e,r){return zu(e,r),t?e.__proto__=r:a(e,r),e}}({},!1):void 0),check:zu};Vl(Vl.S,"Object",{setPrototypeOf:Gu.set});var Uu=$l("toStringTag"),Nu="Arguments"==ns(function(){return arguments}()),qu=function(e,t){try{return e[t]}catch(t){}},Bu=function(e){var t,a,r;return e===void 0?"Undefined":null===e?"Null":"string"==typeof(a=qu(t=Object(e),Uu))?a:Nu?ns(t):"Object"==(r=ns(t))&&"function"==typeof t.callee?"Arguments":r},Vu={};Vu[$l("toStringTag")]="z",Gl(Object.prototype,"toString",function(){return"[object "+Bu(this)+"]"},!0);var Hu=function(e,t,a){var r=a===void 0;switch(t.length){case 0:return r?e():e.call(a);case 1:return r?e(t[0]):e.call(a,t[0]);case 2:return r?e(t[0],t[1]):e.call(a,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(a,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(a,t[0],t[1],t[2],t[3]);}return e.apply(a,t)},Wu=[].slice,Xu={},Yu=function(e,t,a){if(!(t in Xu)){for(var r=[],o=0;o<t;o++)r[o]="a["+o+"]";Xu[t]=Function("F,a","return new F("+r.join(",")+")")}return Xu[t](e,a)},$u=Function.bind||function(e){var t=Ul(this),a=Wu.call(arguments,1),r=function r(){var o=a.concat(Wu.call(arguments));return this instanceof r?Yu(t,o.length,o):Hu(t,o,e)};return Tl(t.prototype)&&(r.prototype=t.prototype),r};Vl(Vl.P,"Function",{bind:$u});var Ku=Al.f,Zu=Function.prototype,Qu=/^\s*function ([^ (]*)/,Ju="name",ep=Object.isExtensible||function(){return!0};Ju in Zu||Sl&&Ku(Zu,Ju,{configurable:!0,get:function(){try{var e=this,t=(""+e).match(Qu)[1];return vl(e,Ju)||!ep(e)||Ku(e,Ju,Rl(5,t)),t}catch(t){return""}}});var tp=$l("hasInstance"),ap=Function.prototype;tp in ap||Al.f(ap,tp,{value:function(e){if("function"!=typeof this||!Tl(e))return!1;if(!Tl(this.prototype))return e instanceof this;for(;e=Du(e);)if(this.prototype===e)return!0;return!1}});var rp="\t\n\x0B\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF",op="["+rp+"]",np="\u200B\x85",ip=/^[	\n\v\f\r \u2028\u2029][	\n\v\f\r \u2028\u2029]*/,lp=/[	\n\v\f\r \u2028\u2029][	\n\v\f\r \u2028\u2029]*$/,sp=function(e,t,a){var r={},o=bl(function(){return!!rp[e]()||np[e]()!=np}),n=r[e]=o?t(up):rp[e];a&&(r[a]=n),Vl(Vl.P+Vl.F*o,"String",r)},up=sp.trim=function(e,t){return e=ls(e)+"",1&t&&(e=e.replace(ip,"")),2&t&&(e=e.replace(lp,"")),e},pp=sp,dp=yl.parseInt,cp=pp.trim,gp=/^[\-+]?0[xX]/,hp=8!==dp(rp+"08")||22!==dp(rp+"0x16")?function(e,t){var a=cp(e+"",3);return dp(a,t>>>0||(gp.test(a)?16:10))}:dp;Vl(Vl.G+Vl.F*(parseInt!=hp),{parseInt:hp});var fp=yl.parseFloat,mp=pp.trim,_p=1/fp(rp+"-0")==-Infinity?fp:function(e){var t=mp(e+"",3),a=fp(t);return 0===a&&"-"==t.charAt(0)?-0:a};Vl(Vl.G+Vl.F*(parseFloat!=_p),{parseFloat:_p});var yp=Gu.set,xp=function(e,t,a){var r=t.constructor,o;return r!==a&&"function"==typeof r&&(o=r.prototype)!==a.prototype&&Tl(o)&&yp&&yp(e,o),e},vp=Ns.f,bp=Ks.f,Sp=Al.f,Pp=pp.trim,Tp="Number",wp=yl[Tp],kp=wp,Cp=wp.prototype,Fp=ns(zs(Cp))==Tp,Mp="trim"in mn,Ep=function(e){var t=El(e,!1);if("string"==typeof t&&2<t.length){t=Mp?t.trim():Pp(t,3);var a=t.charCodeAt(0),r,o,n;if(43===a||45===a){if(r=t.charCodeAt(2),88===r||120===r)return NaN;}else if(48===a){switch(t.charCodeAt(1)){case 66:case 98:o=2,n=49;break;case 79:case 111:o=8,n=55;break;default:return+t;}for(var s=t.slice(2),u=0,i=s.length,l;u<i;u++)if(l=s.charCodeAt(u),48>l||l>n)return NaN;return parseInt(s,o)}}return+t};if(!wp(" 0o1")||!wp("0b1")||wp("+0x1")){wp=function(e){var t=1>arguments.length?0:e,a=this;return a instanceof wp&&(Fp?bl(function(){Cp.valueOf.call(a)}):ns(a)!=Tp)?xp(new kp(Ep(t)),a,wp):Ep(t)};for(var Dp=Sl?vp(kp):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),Ip=0,j;Dp.length>Ip;Ip++)vl(kp,j=Dp[Ip])&&!vl(wp,j)&&Sp(wp,j,bp(kp,j));wp.prototype=Cp,Cp.constructor=wp,Gl(yl,Tp,wp)}var Ap=function(e,t){if("number"!=typeof e&&"Number"!=ns(e))throw TypeError(t);return+e},Rp=function(e){var t=ls(this)+"",a="",r=ds(e);if(0>r||r==Infinity)throw RangeError("Count can't be negative");for(;0<r;(r>>>=1)&&(t+=t))1&r&&(a+=t);return a},Op=1 .toFixed,Lp=_n,jp=[0,0,0,0,0,0],zp="Number.toFixed: incorrect invocation!",Gp="0",Up=function(e,t){for(var a=-1,r=t;6>++a;)r+=e*jp[a],jp[a]=r%1e7,r=Lp(r/1e7)},Np=function(e){for(var t=6,a=0;0<=--t;)a+=jp[t],jp[t]=Lp(a/e),a=1e7*(a%e)},qp=function(){for(var e=6,a="";0<=--e;)if(""!=a||0==e||0!==jp[e]){var r=jp[e]+"";a=""==a?r:a+Rp.call(Gp,7-r.length)+r}return a},Bp=function e(t,a,r){return 0===a?r:1==a%2?e(t,a-1,r*t):e(t*t,a/2,r)},Vp=function(e){for(var t=0,a=e;4096<=a;)t+=12,a/=4096;for(;2<=a;)t+=1,a/=2;return t};Vl(Vl.P+Vl.F*("0.000"!==8e-5.toFixed(3)||"1"!==0.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==1000000000000000100 .toFixed(0)||!bl(function(){Op.call({})})),"Number",{toFixed:function(t){var a=Ap(this,zp),r=ds(t),o="",n=Gp,i,l,s,u;if(0>r||20<r)throw RangeError(zp);if(a!=a)return"NaN";if(-1e21>=a||1e21<=a)return a+"";if(0>a&&(o="-",a=-a),1e-21<a)if(i=Vp(a*Bp(2,69,1))-69,l=0>i?a*Bp(2,-i,1):a/Bp(2,i,1),l*=4503599627370496,i=52-i,0<i){for(Up(0,l),s=r;7<=s;)Up(1e7,0),s-=7;for(Up(Bp(10,s,1),0),s=i-1;23<=s;)Np(8388608),s-=23;Np(1<<s),Up(1,1),Np(2),n=qp()}else Up(0,l),Up(1<<-i,0),n=qp()+Rp.call(Gp,r);return 0<r?(u=n.length,n=o+(u<=r?"0."+Rp.call(Gp,r-u)+n:n.slice(0,u-r)+"."+n.slice(u-r))):n=o+n,n}});var Hp=1 .toPrecision;Vl(Vl.P+Vl.F*(bl(function(){return"1"!==Hp.call(1,void 0)})||!bl(function(){Hp.call({})})),"Number",{toPrecision:function(e){var t=Ap(this,"Number#toPrecision: incorrect invocation!");return e===void 0?Hp.call(t):Hp.call(t,e)}}),Vl(Vl.S,"Number",{EPSILON:2.220446049250313e-16});var Wp=yl.isFinite;Vl(Vl.S,"Number",{isFinite:function(e){return"number"==typeof e&&Wp(e)}});var Xp=_n,Yp=function(e){return!Tl(e)&&isFinite(e)&&Xp(e)===e};Vl(Vl.S,"Number",{isInteger:Yp}),Vl(Vl.S,"Number",{isNaN:function(e){return e!=e}});var $p=Sn;Vl(Vl.S,"Number",{isSafeInteger:function(e){return Yp(e)&&9007199254740991>=$p(e)}}),Vl(Vl.S,"Number",{MAX_SAFE_INTEGER:9007199254740991}),Vl(Vl.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991}),Vl(Vl.S+Vl.F*(Number.parseFloat!=_p),"Number",{parseFloat:_p}),Vl(Vl.S+Vl.F*(Number.parseInt!=hp),"Number",{parseInt:hp});var Kp=Math.log1p||function(e){return-1e-8<(e=+e)&&1e-8>e?e-e*e/2:fn(1+e)},Zp=Pn,Qp=Math.acosh;Vl(Vl.S+Vl.F*!(Qp&&710==_n(Qp(Number.MAX_VALUE))&&Qp(Infinity)==Infinity),"Math",{acosh:function(e){return 1>(e=+e)?NaN:94906265.62425156<e?fn(e)+hn:Kp(e-1+Zp(e-1)*Zp(e+1))}});var Jp=Math.asinh;Vl(Vl.S+Vl.F*!(Jp&&0<1/Jp(0)),"Math",{asinh:ue});var ed=Math.atanh;Vl(Vl.S+Vl.F*!(ed&&0>1/ed(-0)),"Math",{atanh:function(e){return 0==(e=+e)?e:fn((1+e)/(1-e))/2}});var td=gn||function(e){return 0==(e=+e)||e!=e?e:0>e?-1:1};Vl(Vl.S,"Math",{cbrt:function(e){return td(e=+e)*Tn(Sn(e),1/3)}}),Vl(Vl.S,"Math",{clz32:function(e){return(e>>>=0)?31-_n(fn(e+0.5)*Math.LOG2E):32}});var ad=cn;Vl(Vl.S,"Math",{cosh:function(e){return(ad(e=+e)+ad(-e))/2}});var rd=dn,od=!rd||22025.465794806718<rd(10)||22025.465794806718>rd(10)||-2e-17!=rd(-2e-17)?function(e){return 0==(e=+e)?e:-1e-6<e&&1e-6>e?e+e*e/2:cn(e)-1}:rd;Vl(Vl.S+Vl.F*(od!=dn),"Math",{expm1:od});var nd=Tn,id=nd(2,-52),ld=nd(2,-23),sd=nd(2,127)*(2-ld),ud=nd(2,-126),pd=function(e){return e+1/id-1/id};Vl(Vl.S,"Math",{fround:function(e){var t=Sn(e),r=td(e),o,a;return t<ud?r*pd(t/ud/ld)*ud*ld:(o=(1+ld/id)*t,a=o-(o-t),a>sd||a!=a?r*Infinity:r*a)}});var dd=Sn;Vl(Vl.S,"Math",{hypot:function(){for(var e=0,t=0,a=arguments.length,r=0,o,n;t<a;)o=dd(arguments[t++]),r<o?(n=r/o,e=e*n*n+1,r=o):0<o?(n=o/r,e+=n*n):e+=o;return r==Infinity?Infinity:r*Pn(e)}});var cd=Math.imul;Vl(Vl.S+Vl.F*bl(function(){return-5!=cd(4294967295,5)||2!=cd.length}),"Math",{imul:function(e,t){var a=65535,r=+e,o=+t,n=a&r,i=a&o;return 0|n*i+((a&r>>>16)*i+n*(a&o>>>16)<<16>>>0)}}),Vl(Vl.S,"Math",{log10:function(e){return fn(e)/Math.LN10}}),Vl(Vl.S,"Math",{log1p:Kp}),Vl(Vl.S,"Math",{log2:function(e){return fn(e)/hn}}),Vl(Vl.S,"Math",{sign:td});var gd=cn;Vl(Vl.S+Vl.F*bl(function(){return!0}),"Math",{sinh:function(e){return 1>Sn(e=+e)?(od(e)-od(-e))/2:(gd(e-1)-gd(-e-1))*(Math.E/2)}});var hd=cn;Vl(Vl.S,"Math",{tanh:function(e){var t=od(e=+e),a=od(-e);return t==Infinity?1:a==Infinity?-1:(t-a)/(hd(e)+hd(-e))}}),Vl(Vl.S,"Math",{trunc:function(e){return(0<e?_n:yn)(e)}});var fd=pn,md=String.fromCodePoint;Vl(Vl.S+Vl.F*(!!md&&1!=md.length),"String",{fromCodePoint:function(){for(var e=[],t=arguments.length,a=0,r;t>a;){if(r=+arguments[a++],ms(r,1114111)!==r)throw RangeError(r+" is not a valid code point");e.push(65536>r?fd(r):fd(((r-=65536)>>10)+55296,r%1024+56320))}return e.join("")}}),Vl(Vl.S,"String",{raw:function(e){for(var t=ss(e.raw),a=gs(t.length),r=arguments.length,o=[],n=0;a>n;)o.push(t[n++]+""),n<r&&o.push(arguments[n]+"");return o.join("")}}),pp("trim",function(e){return function(){return e(this,3)}});var _d=function(e){return function(t,r){var o=ls(t)+"",n=ds(r),i=o.length,l,a;return 0>n||n>=i?e?"":void 0:(l=o.charCodeAt(n),55296>l||56319<l||n+1===i||56320>(a=o.charCodeAt(n+1))||57343<a?e?o.charAt(n):l:e?o.slice(n,n+2):(l-55296<<10)+(a-56320)+65536)}},yd={},xd={};Ol(xd,$l("iterator"),function(){return this});var vd=function(e,t,a){e.prototype=zs(xd,{next:Rl(1,a)}),Ql(e,t+" Iterator")},bd=$l("iterator"),Sd=!([].keys&&"next"in[].keys()),Pd="@@iterator",Td="keys",wd="values",kd=function(){return this},Cd=function(e,t,a,r,o,n,i){vd(a,t,r);var l=function(e){return!Sd&&e in d?d[e]:e===Td?function(){return new a(this,e)}:e===wd?function(){return new a(this,e)}:function(){return new a(this,e)}},s=t+" Iterator",u=o==wd,p=!1,d=e.prototype,c=d[bd]||d[Pd]||o&&d[o],g=c||l(o),h=o?u?l("entries"):g:void 0,f="Array"==t?d.entries||c:c,m,_,y;if(f&&(y=Du(f.call(new e)),y!==Object.prototype&&(Ql(y,s,!0),!vl(y,bd)&&Ol(y,bd,kd))),u&&c&&c.name!==wd&&(p=!0,g=function(){return c.call(this)}),(Sd||p||!d[bd])&&Ol(d,bd,g),yd[t]=g,yd[s]=kd,o)if(m={values:u?g:l(wd),keys:n?g:l(Td),entries:h},i)for(_ in m)_ in d||Gl(d,_,m[_]);else Vl(Vl.P+Vl.F*(Sd||p),t,m);return m},Fd=_d(!0);Cd(String,"String",function(e){this._t=e+"",this._i=0},function(){var e=this._t,t=this._i,a;return t>=e.length?{value:void 0,done:!0}:(a=Fd(e,t),this._i+=a.length,{value:a,done:!1})});var Md=_d(!1);Vl(Vl.P,"String",{codePointAt:function(e){return Md(this,e)}});var Ed=$l("match"),Dd=function(e){var t;return Tl(e)&&((t=e[Ed])===void 0?"RegExp"==ns(e):!!t)},Id=function(e,t,a){if(Dd(t))throw TypeError("String#"+a+" doesn't accept regex!");return ls(e)+""},Ad=$l("match"),Rd=function(e){var t=/./;try{"/./"[e](t)}catch(a){try{return t[Ad]=!1,!"/./"[e](t)}catch(e){}}return!0},Od="endsWith",Ld=""[Od];Vl(Vl.P+Vl.F*Rd(Od),"String",{endsWith:function(e){var t=Id(this,e,Od),a=1<arguments.length?arguments[1]:void 0,r=gs(t.length),o=a===void 0?r:vn(gs(a),r),n=e+"";return t.slice(o-n.length,o)===n}});var jd="includes";Vl(Vl.P+Vl.F*Rd(jd),"String",{includes:function(e){return!!~Id(this,e,jd).indexOf(e,1<arguments.length?arguments[1]:void 0)}}),Vl(Vl.P,"String",{repeat:Rp});var zd="startsWith",Gd=""[zd];Vl(Vl.P+Vl.F*Rd(zd),"String",{startsWith:function(e){var t=Id(this,e,zd),a=gs(vn(1<arguments.length?arguments[1]:void 0,t.length)),r=e+"";return t.slice(a,a+r.length)===r}});var Ud=/"/g,Nd=function(e,t,a,r){var o=ls(e)+"",n="<"+t;return""!==a&&(n+=" "+a+"=\""+(r+"").replace(Ud,"&quot;")+"\""),n+">"+o+"</"+t+">"},qd=function(e,t){var a={};a[e]=t(Nd),Vl(Vl.P+Vl.F*bl(function(){var t=""[e]("\"");return t!==t.toLowerCase()||3<t.split("\"").length}),"String",a)};qd("anchor",function(e){return function(t){return e(this,"a","name",t)}}),qd("big",function(e){return function(){return e(this,"big","","")}}),qd("blink",function(e){return function(){return e(this,"blink","","")}}),qd("bold",function(e){return function(){return e(this,"b","","")}}),qd("fixed",function(e){return function(){return e(this,"tt","","")}}),qd("fontcolor",function(e){return function(t){return e(this,"font","color",t)}}),qd("fontsize",function(e){return function(t){return e(this,"font","size",t)}}),qd("italics",function(e){return function(){return e(this,"i","","")}}),qd("link",function(e){return function(t){return e(this,"a","href",t)}}),qd("small",function(e){return function(){return e(this,"small","","")}}),qd("strike",function(e){return function(){return e(this,"strike","","")}}),qd("sub",function(e){return function(){return e(this,"sub","","")}}),qd("sup",function(e){return function(){return e(this,"sup","","")}}),Vl(Vl.S,"Date",{now:function(){return new Date().getTime()}}),Vl(Vl.P+Vl.F*bl(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(){var e=Fu(this),t=El(e);return"number"!=typeof t||isFinite(t)?e.toISOString():null}});var Bd=Date.prototype.getTime,Vd=function(e){return 9<e?e:"0"+e};Vl(Vl.P+Vl.F*(bl(function(){return"0385-07-25T07:06:39.999Z"!=new Date(-50000000000001).toISOString()})||!bl(function(){new Date(NaN).toISOString()})),"Date",{toISOString:function(){if(!isFinite(Bd.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),a=e.getUTCMilliseconds(),r=0>t?"-":9999<t?"+":"";return r+("00000"+Sn(t)).slice(r?-6:-4)+"-"+Vd(e.getUTCMonth()+1)+"-"+Vd(e.getUTCDate())+"T"+Vd(e.getUTCHours())+":"+Vd(e.getUTCMinutes())+":"+Vd(e.getUTCSeconds())+"."+(99<a?a:"0"+Vd(a))+"Z"}});var Hd=Date.prototype,Wd="Invalid Date",Xd="toString",Yd=Hd[Xd],$d=Hd.getTime;new Date(NaN)+""!=Wd&&Gl(Hd,Xd,function(){var e=$d.call(this);return e===e?Yd.call(this):Wd});var Kd="number",Zd=function(e){if("string"!==e&&e!==Kd&&"default"!==e)throw TypeError("Incorrect hint");return El(wl(this),e!=Kd)},Qd=$l("toPrimitive"),Jd=Date.prototype;Qd in Jd||Ol(Jd,Qd,Zd),Vl(Vl.S,"Array",{isArray:Ds});var ec=function(t,e,a,r){try{return r?e(wl(a)[0],a[1]):e(a)}catch(a){var o=t["return"];throw void 0!==o&&wl(o.call(t)),a}},tc=$l("iterator"),ac=Array.prototype,rc=function(e){return e!==void 0&&(yd.Array===e||ac[tc]===e)},oc=function(e,t,a){t in e?Al.f(e,t,Rl(0,a)):e[t]=a},nc=$l("iterator"),ic=Pl.getIteratorMethod=function(e){if(e!=void 0)return e[nc]||e["@@iterator"]||yd[Bu(e)]},lc=$l("iterator"),sc=!1;try{var uc=[7][lc]();uc["return"]=function(){sc=!0},Array.from(uc,function(){throw 2})}catch(t){}var pc=function(e,t){if(!t&&!sc)return!1;var a=!1;try{var r=[7],o=r[lc]();o.next=function(){return{done:a=!0}},r[lc]=function(){return o},e(r)}catch(t){}return a};Vl(Vl.S+Vl.F*!pc(function(e){Array.from(e)}),"Array",{from:function(e){var t=Fu(e),a="function"==typeof this?this:Array,r=arguments.length,o=1<r?arguments[1]:void 0,n=void 0!==o,i=0,l=ic(t),s,u,p,d;if(n&&(o=Nl(o,2<r?arguments[2]:void 0,2)),void 0!=l&&!(a==Array&&rc(l)))for(d=l.call(t),u=new a;!(p=d.next()).done;i++)oc(u,i,n?ec(d,o,[p.value,i],!0):p.value);else for(s=gs(t.length),u=new a(s);s>i;i++)oc(u,i,n?o(t[i],i):t[i]);return u.length=i,u}}),Vl(Vl.S+Vl.F*bl(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,a=new("function"==typeof this?this:Array)(t);t>e;)oc(a,e,arguments[e++]);return a.length=t,a}});var dc=function(e,t){return!!e&&bl(function(){t?e.call(null,function(){},1):e.call(null)})},cc=[].join;Vl(Vl.P+Vl.F*(is!=Object||!dc(cc)),"Array",{join:function(e){return cc.call(ss(this),e===void 0?",":e)}});var gc=[].slice;Vl(Vl.P+Vl.F*bl(function(){As&&gc.call(As)}),"Array",{slice:function(e,t){var a=gs(this.length),r=ns(this);if(t=void 0===t?a:t,"Array"==r)return gc.call(this,e,t);for(var o=ms(e,a),n=ms(t,a),l=gs(n-o),s=Array(l),u=0;u<l;u++)s[u]="String"==r?this.charAt(o+u):this[o+u];return s}});var hc=[].sort,fc=[1,2,3];Vl(Vl.P+Vl.F*(bl(function(){fc.sort(void 0)})||!bl(function(){fc.sort(null)})||!dc(hc)),"Array",{sort:function(e){return e===void 0?hc.call(Fu(this)):hc.call(Fu(this),Ul(e))}});var mc=$l("species"),_c=function(e){var t;return Ds(e)&&(t=e.constructor,"function"==typeof t&&(t===Array||Ds(t.prototype))&&(t=void 0),Tl(t)&&(t=t[mc],null===t&&(t=void 0))),void 0===t?Array:t},yc=function(e,t){return new(_c(e))(t)},xc=function(e,t){var a=1==e,r=4==e,o=6==e,n=t||yc;return function(t,i,l){for(var s=Fu(t),u=is(s),p=Nl(i,l,3),d=gs(u.length),c=0,g=a?n(t,d):2==e?n(t,0):void 0,h,f;d>c;c++)if((5==e||o||c in u)&&(h=u[c],f=p(h,c,s),e))if(a)g[c]=f;else if(f)switch(e){case 3:return!0;case 5:return h;case 6:return c;case 2:g.push(h);}else if(r)return!1;return o?-1:3==e||r?r:g}},vc=xc(0),bc=dc([].forEach,!0);Vl(Vl.P+Vl.F*!bc,"Array",{forEach:function(e){return vc(this,e,arguments[1])}});var Sc=xc(1);Vl(Vl.P+Vl.F*!dc([].map,!0),"Array",{map:function(e){return Sc(this,e,arguments[1])}});var Pc=xc(2);Vl(Vl.P+Vl.F*!dc([].filter,!0),"Array",{filter:function(e){return Pc(this,e,arguments[1])}});var Tc=xc(3);Vl(Vl.P+Vl.F*!dc([].some,!0),"Array",{some:function(e){return Tc(this,e,arguments[1])}});var wc=xc(4);Vl(Vl.P+Vl.F*!dc([].every,!0),"Array",{every:function(e){return wc(this,e,arguments[1])}});var kc=function(e,t,a,r,o){Ul(t);var n=Fu(e),l=is(n),s=gs(n.length),u=o?s-1:0,p=o?-1:1;if(2>a)for(;;){if(u in l){r=l[u],u+=p;break}if(u+=p,o?0>u:s<=u)throw TypeError("Reduce of empty array with no initial value")}for(;o?0<=u:s>u;u+=p)u in l&&(r=t(r,l[u],u,n));return r};Vl(Vl.P+Vl.F*!dc([].reduce,!0),"Array",{reduce:function(e){return kc(this,e,arguments.length,arguments[1],!1)}}),Vl(Vl.P+Vl.F*!dc([].reduceRight,!0),"Array",{reduceRight:function(e){return kc(this,e,arguments.length,arguments[1],!0)}});var Cc=_s(!1),Fc=[].indexOf,Mc=!!Fc&&0>1/[1].indexOf(1,-0);Vl(Vl.P+Vl.F*(Mc||!dc(Fc)),"Array",{indexOf:function(e){return Mc?Fc.apply(this,arguments)||0:Cc(this,e,arguments[1])}});var Ec=[].lastIndexOf,Dc=!!Ec&&0>1/[1].lastIndexOf(1,-0);Vl(Vl.P+Vl.F*(Dc||!dc(Ec)),"Array",{lastIndexOf:function(e){if(Dc)return Ec.apply(this,arguments)||0;var t=ss(this),a=gs(t.length),r=a-1;for(1<arguments.length&&(r=vn(r,ds(arguments[1]))),0>r&&(r=a+r);0<=r;r--)if(r in t&&t[r]===e)return r||0;return-1}});var Ic=[].copyWithin||function(e,t){var a=Fu(this),r=gs(a.length),o=ms(e,r),n=ms(t,r),i=2<arguments.length?arguments[2]:void 0,l=vn((i===void 0?r:ms(i,r))-n,r-o),s=1;for(n<o&&o<n+l&&(s=-1,n+=l-1,o+=l-1);0<l--;)n in a?a[o]=a[n]:delete a[o],o+=s,n+=s;return a},Ac=$l("unscopables"),Rc=Array.prototype;Rc[Ac]==void 0&&Ol(Rc,Ac,{});var Oc=function(e){Rc[Ac][e]=!0};Vl(Vl.P,"Array",{copyWithin:Ic}),Oc("copyWithin");var Lc=function(e){for(var t=Fu(this),a=gs(t.length),r=arguments.length,o=ms(1<r?arguments[1]:void 0,a),n=2<r?arguments[2]:void 0,i=void 0===n?a:ms(n,a);i>o;)t[o++]=e;return t};Vl(Vl.P,"Array",{fill:Lc}),Oc("fill");var jc=xc(5),zc="find",Gc=!0;zc in[]&&[,][zc](function(){Gc=!1}),Vl(Vl.P+Vl.F*Gc,"Array",{find:function(e){return jc(this,e,1<arguments.length?arguments[1]:void 0)}}),Oc(zc);var Uc=xc(6),Nc="findIndex",qc=!0;Nc in[]&&[,][Nc](function(){qc=!1}),Vl(Vl.P+Vl.F*qc,"Array",{findIndex:function(e){return Uc(this,e,1<arguments.length?arguments[1]:void 0)}}),Oc(Nc);var Bc=$l("species"),Vc=function(e){var t=yl[e];Sl&&t&&!t[Bc]&&Al.f(t,Bc,{configurable:!0,get:function(){return this}})};Vc("Array");var Hc=function(e,t){return{value:t,done:!!e}},Wc=Cd(Array,"Array",function(e,t){this._t=ss(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,a=this._i++;return!e||a>=e.length?(this._t=void 0,Hc(1)):"keys"==t?Hc(0,a):"values"==t?Hc(0,e[a]):Hc(0,[a,e[a]])},"values");yd.Arguments=yd.Array,Oc("keys"),Oc("values"),Oc("entries");var Xc=function(){var e=wl(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},Yc=Al.f,$c=Ns.f,Kc=yl.RegExp,Zc=Kc,Qc=Kc.prototype,Jc=/a/g,eg=/a/g,tg=new Kc(Jc)!==Jc;if(Sl&&(!tg||bl(function(){return eg[$l("match")]=!1,Kc(Jc)!=Jc||Kc(eg)==eg||"/a/i"!=Kc(Jc,"i")}))){Kc=function(e,t){var a=this instanceof Kc,r=Dd(e),o=t===void 0;return!a&&r&&e.constructor===Kc&&o?e:xp(tg?new Zc(r&&!o?e.source:e,t):Zc((r=e instanceof Kc)?e.source:e,r&&o?Xc.call(e):t),a?this:Qc,Kc)};for(var ag=function(e){(e in Kc)||Yc(Kc,e,{configurable:!0,get:function(){return Zc[e]},set:function(t){Zc[e]=t}})},rg=$c(Zc),og=0;rg.length>og;)ag(rg[og++]);Qc.constructor=Kc,Kc.prototype=Qc,Gl(yl,"RegExp",Kc)}Vc("RegExp"),Sl&&"g"!=/./g.flags&&Al.f(RegExp.prototype,"flags",{configurable:!0,get:Xc});var ng="toString",ig=/./[ng],lg=function(e){Gl(RegExp.prototype,ng,e,!0)};bl(function(){return"/a/b"!=ig.call({source:"a",flags:"b"})})?lg(function(){var e=wl(this);return"/".concat(e.source,"/","flags"in e?e.flags:!Sl&&e instanceof RegExp?Xc.call(e):void 0)}):ig.name!=ng&&lg(function(){return ig.call(this)});var sg=function(e,t,a){var r=$l(e),o=a(ls,r,""[e]),n=o[0],i=o[1];bl(function(){var t={};return t[r]=function(){return 7},7!=""[e](t)})&&(Gl(String.prototype,e,n),Ol(RegExp.prototype,r,2==t?function(e,t){return i.call(e,this,t)}:function(e){return i.call(e,this)}))};sg("match",1,function(e,t,a){return[function(a){var r=e(this),o=a==void 0?void 0:a[t];return o===void 0?new RegExp(a)[t](r+""):o.call(a,r)},a]}),sg("replace",2,function(e,t,a){return[function(r,o){var n=e(this),i=r==void 0?void 0:r[t];return i===void 0?a.call(n+"",r,o):i.call(r,n,o)},a]}),sg("search",1,function(e,t,a){return[function(a){var r=e(this),o=a==void 0?void 0:a[t];return o===void 0?new RegExp(a)[t](r+""):o.call(a,r)},a]}),sg("split",2,function(e,t,a){var r=a,o=[].push,n="split",l="length",s="lastIndex";if("c"=="abbc"[n](/(b)*/)[1]||4!="test"[n](/(?:)/,-1)[l]||2!="ab"[n](/(?:ab)*/)[l]||4!="."[n](/(.?)(.?)/)[l]||1<"."[n](/()()/)[l]||""[n](/.?/)[l]){var u=/()??/.exec("")[1]===void 0;a=function(e,t){var a=this+"";if(void 0===e&&0===t)return[];if(!Dd(e))return r.call(a,e,t);var n=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,c=void 0===t?4294967295:t>>>0,g=new RegExp(e.source,p+"g"),h,f,m,_,y;for(u||(h=new RegExp("^"+g.source+"$(?!\\s)",p));(f=g.exec(a))&&(m=f.index+f[0][l],!(m>d&&(n.push(a.slice(d,f.index)),!u&&1<f[l]&&f[0].replace(h,function(){for(y=1;y<arguments[l]-2;y++)void 0===arguments[y]&&(f[y]=void 0)}),1<f[l]&&f.index<a[l]&&o.apply(n,f.slice(1)),_=f[0][l],d=m,n[l]>=c)));)g[s]===f.index&&g[s]++;return d===a[l]?(_||!g.test(""))&&n.push(""):n.push(a.slice(d)),n[l]>c?n.slice(0,c):n}}else"0"[n](void 0,0)[l]&&(a=function(e,t){return void 0===e&&0===t?[]:r.call(this,e,t)});return[function(r,o){var n=e(this),i=r==void 0?void 0:r[t];return i===void 0?a.call(n+"",r,o):i.call(r,n,o)},a]});var ug=function(e,t,a,r){if(!(e instanceof t)||r!==void 0&&r in e)throw TypeError(a+": incorrect invocation!");return e},pg=se(function(e){var t={},a={},r=e.exports=function(e,r,o,n,i){var l=i?function(){return e}:ic(e),s=Nl(o,n,r?2:1),u=0,p,d,c,g;if("function"!=typeof l)throw TypeError(e+" is not iterable!");if(rc(l)){for(p=gs(e.length);p>u;u++)if(g=r?s(wl(d=e[u])[0],d[1]):s(e[u]),g===t||g===a)return g;}else for(c=l.call(e);!(d=c.next()).done;)if(g=ec(c,s,d.value,r),g===t||g===a)return g};r.BREAK=t,r.RETURN=a}),dg=$l("species"),cg=function(e,t){var a=wl(e).constructor,r;return a===void 0||(r=wl(a)[dg])==void 0?t:Ul(r)},gg=yl.process,hg=yl.setImmediate,fg=yl.clearImmediate,mg=yl.MessageChannel,_g=0,yg={},xg="onreadystatechange",vg=function(){var e=+this;if(yg.hasOwnProperty(e)){var t=yg[e];delete yg[e],t()}},bg=function(e){vg.call(e.data)},Sg,Pg,Tg;hg&&fg||(hg=function(e){for(var t=[],a=1;arguments.length>a;)t.push(arguments[a++]);return yg[++_g]=function(){Hu("function"==typeof e?e:Function(e),t)},Sg(_g),_g},fg=function(e){delete yg[e]},"process"==ns(gg)?Sg=function(e){gg.nextTick(Nl(vg,e,1))}:mg?(Pg=new mg,Tg=Pg.port2,Pg.port1.onmessage=bg,Sg=Nl(Tg.postMessage,Tg,1)):yl.addEventListener&&"function"==typeof postMessage&&!yl.importScripts?(Sg=function(e){yl.postMessage(e+"","*")},yl.addEventListener("message",bg,!1)):xg in Fl("script")?Sg=function(e){As.appendChild(Fl("script"))[xg]=function(){As.removeChild(this),vg.call(e)}}:Sg=function(e){setTimeout(Nl(vg,e,1),0)});var wg={set:hg,clear:fg},kg=wg.set,Cg=yl.MutationObserver||yl.WebKitMutationObserver,Fg=yl.process,Mg=yl.Promise,Eg="process"==ns(Fg),Dg=function(){var e=function(){var e,o;for(Eg&&(e=Fg.domain)&&e.exit();t;){o=t.fn,t=t.next;try{o()}catch(o){throw t?r():a=void 0,o}}a=void 0,e&&e.enter()},t,a,r;if(Eg)r=function(){Fg.nextTick(e)};else if(Cg){var o=!0,n=document.createTextNode("");new Cg(e).observe(n,{characterData:!0}),r=function(){n.data=o=!o}}else if(Mg&&Mg.resolve){var i=Mg.resolve();r=function(){i.then(e)}}else r=function(){kg.call(yl,e)};return function(e){var o={fn:e,next:void 0};a&&(a.next=o),t||(t=o,r()),a=o}},Ig=function(e,t,a){for(var r in t)Gl(e,r,t[r],a);return e},Ag=wg.set,Rg=Dg(),Og="Promise",Lg=yl.TypeError,jg=yl.process,zg=yl[Og],jg=yl.process,Gg="process"==Bu(jg),Ug=function(){},Ng=!!function(){try{var e=zg.resolve(1),t=(e.constructor={})[$l("species")]=function(e){e(Ug,Ug)};return(Gg||"function"==typeof PromiseRejectionEvent)&&e.then(Ug)instanceof t}catch(t){}}(),qg=function(e,t){return e===t||e===zg&&t===th},Bg=function(e){var t;return Tl(e)&&"function"==typeof(t=e.then)&&t},Vg=function(e){return qg(zg,e)?new Hg(e):new eh(e)},Hg=eh=function(e){var t,a;this.promise=new e(function(e,r){if(t!=void 0||a!=void 0)throw Lg("Bad Promise constructor");t=e,a=r}),this.resolve=Ul(t),this.reject=Ul(a)},Wg=function(e){try{e()}catch(t){return{error:t}}},Xg=function(e,t){if(!e._n){e._n=!0;var a=e._c;Rg(function(){for(var r=e._v,o=1==e._s,n=0,i=function(t){var a=o?t.ok:t.fail,n=t.resolve,i=t.reject,l=t.domain,s,u;try{a?(!o&&(2==e._h&&Kg(e),e._h=1),!0===a?s=r:(l&&l.enter(),s=a(r),l&&l.exit()),s===t.promise?i(Lg("Promise-chain cycle")):(u=Bg(s))?u.call(s,n,i):n(s)):i(r)}catch(t){i(t)}};a.length>n;)i(a[n++]);e._c=[],e._n=!1,t&&!e._h&&Yg(e)})}},Yg=function(e){Ag.call(yl,function(){var t=e._v,a,r,o;if($g(e)&&(a=Wg(function(){Gg?jg.emit("unhandledRejection",t,e):(r=yl.onunhandledrejection)?r({promise:e,reason:t}):(o=yl.console)&&o.error&&o.error("Unhandled promise rejection",t)}),e._h=Gg||$g(e)?2:1),e._a=void 0,a)throw a.error})},$g=function e(t){if(1==t._h)return!1;for(var a=t._a||t._c,r=0,o;a.length>r;)if(o=a[r++],o.fail||!e(o.promise))return!1;return!0},Kg=function(e){Ag.call(yl,function(){var t;Gg?jg.emit("rejectionHandled",e):(t=yl.onrejectionhandled)&&t({promise:e,reason:e._v})})},Zg=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,!t._a&&(t._a=t._c.slice()),Xg(t,!0))},Qg=function e(t){var a=this,r;if(!a._d){a._d=!0,a=a._w||a;try{if(a===t)throw Lg("Promise can't be resolved itself");(r=Bg(t))?Rg(function(){var o={_w:a,_d:!1};try{r.call(t,Nl(e,o,1),Nl(Zg,o,1))}catch(t){Zg.call(o,t)}}):(a._v=t,a._s=1,Xg(a,!1))}catch(t){Zg.call({_w:a,_d:!1},t)}}},Jg,eh,th;Ng||(zg=function(e){ug(this,zg,Og,"_h"),Ul(e),Jg.call(this);try{e(Nl(Qg,this,1),Nl(Zg,this,1))}catch(e){Zg.call(this,e)}},Jg=function(){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},Jg.prototype=Ig(zg.prototype,{then:function(e,t){var a=Vg(cg(this,zg));return a.ok="function"!=typeof e||e,a.fail="function"==typeof t&&t,a.domain=Gg?jg.domain:void 0,this._c.push(a),this._a&&this._a.push(a),this._s&&Xg(this,!1),a.promise},catch:function(e){return this.then(void 0,e)}}),Hg=function(){var e=new Jg;this.promise=e,this.resolve=Nl(Qg,e,1),this.reject=Nl(Zg,e,1)}),Vl(Vl.G+Vl.W+Vl.F*!Ng,{Promise:zg}),Ql(zg,Og),Vc(Og),th=Pl[Og],Vl(Vl.S+Vl.F*!Ng,Og,{reject:function(e){var t=Vg(this),a=t.reject;return a(e),t.promise}}),Vl(Vl.S+Vl.F*!Ng,Og,{resolve:function(e){if(e instanceof zg&&qg(e.constructor,this))return e;var t=Vg(this),a=t.resolve;return a(e),t.promise}}),Vl(Vl.S+Vl.F*!(Ng&&pc(function(e){zg.all(e)["catch"](Ug)})),Og,{all:function(e){var t=this,a=Vg(t),r=a.resolve,o=a.reject,n=Wg(function(){var a=[],n=0,i=1;pg(e,!1,function(e){var l=n++,s=!1;a.push(void 0),i++,t.resolve(e).then(function(e){s||(s=!0,a[l]=e,--i||r(a))},o)}),--i||r(a)});return n&&o(n.error),a.promise},race:function(e){var t=this,a=Vg(t),r=a.reject,o=Wg(function(){pg(e,!1,function(e){t.resolve(e).then(a.resolve,r)})});return o&&r(o.error),a.promise}});var ah=Al.f,rh=Hl.fastKey,oh=Sl?"_s":"size",nh=function(e,t){var a=rh(t),r;if("F"!==a)return e._i[a];for(r=e._f;r;r=r.n)if(r.k==t)return r},ih={getConstructor:function(e,t,a,r){var o=e(function(e,n){ug(e,o,t,"_i"),e._i=zs(null),e._f=void 0,e._l=void 0,e[oh]=0,void 0!=n&&pg(n,a,e[r],e)});return Ig(o.prototype,{clear:function(){for(var e=this,t=e._i,a=e._f;a;a=a.n)a.r=!0,a.p&&(a.p=a.p.n=void 0),delete t[a.i];e._f=e._l=void 0,e[oh]=0},delete:function(e){var t=this,a=nh(t,e);if(a){var r=a.n,o=a.p;delete t._i[a.i],a.r=!0,o&&(o.n=r),r&&(r.p=o),t._f==a&&(t._f=r),t._l==a&&(t._l=o),t[oh]--}return!!a},forEach:function(e){ug(this,o,"forEach");for(var t=Nl(e,1<arguments.length?arguments[1]:void 0,3),a;a=a?a.n:this._f;)for(t(a.v,a.k,this);a&&a.r;)a=a.p},has:function(e){return!!nh(this,e)}}),Sl&&ah(o.prototype,"size",{get:function(){return ls(this[oh])}}),o},def:function(e,t,a){var r=nh(e,t),o,n;return r?r.v=a:(e._l=r={i:n=rh(t,!0),k:t,v:a,p:o=e._l,n:void 0,r:!1},!e._f&&(e._f=r),o&&(o.n=r),e[oh]++,"F"!==n&&(e._i[n]=r)),e},getEntry:nh,setStrong:function(e,t,a){Cd(e,t,function(e,t){this._t=e,this._k=t,this._l=void 0},function(){for(var e=this,t=e._k,a=e._l;a&&a.r;)a=a.p;return e._t&&(e._l=a=a?a.n:e._t._f)?"keys"==t?Hc(0,a.k):"values"==t?Hc(0,a.v):Hc(0,[a.k,a.v]):(e._t=void 0,Hc(1))},a?"entries":"values",!a,!0),Vc(t)}},lh=function(e,t,a,r,o,n){var i=yl[e],l=i,s=o?"set":"add",u=l&&l.prototype,p={},d=function(e){var t=u[e];Gl(u,e,"delete"==e?function(e){return n&&!Tl(e)?!1:t.call(this,0===e?0:e)}:"has"==e?function(e){return n&&!Tl(e)?!1:t.call(this,0===e?0:e)}:"get"==e?function(e){return n&&!Tl(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,a){return t.call(this,0===e?0:e,a),this})};if("function"!=typeof l||!(n||u.forEach&&!bl(function(){new l().entries().next()})))l=r.getConstructor(t,e,o,s),Ig(l.prototype,a),Hl.NEED=!0;else{var c=new l,g=c[s](n?{}:-0,1)!=c,h=bl(function(){c.has(1)}),f=pc(function(e){new l(e)}),m=!n&&bl(function(){for(var e=new l,t=5;t--;)e[s](t,t);return!e.has(-0)});f||(l=t(function(t,a){ug(t,l,e);var r=xp(new i,t,l);return void 0!=a&&pg(a,o,r[s],r),r}),l.prototype=u,u.constructor=l),(h||m)&&(d("delete"),d("has"),o&&d("get")),(m||g)&&d(s),n&&u.clear&&delete u.clear}return Ql(l,e),p[e]=l,Vl(Vl.G+Vl.W+Vl.F*(l!=i),p),n||r.setStrong(l,e,o),l},sh=lh("Map",function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{get:function(e){var t=ih.getEntry(this,e);return t&&t.v},set:function(e,t){return ih.def(this,0===e?0:e,t)}},ih,!0),uh=lh("Set",function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{add:function(e){return ih.def(this,e=0===e?0:e,e)}},ih),ph=Hl.getWeak,dh=xc(5),ch=xc(6),gh=0,hh=function(e){return e._l||(e._l=new fh)},fh=function(){this.a=[]},mh=function(e,t){return dh(e.a,function(e){return e[0]===t})};fh.prototype={get:function(e){var t=mh(this,e);if(t)return t[1]},has:function(e){return!!mh(this,e)},set:function(e,t){var a=mh(this,e);a?a[1]=t:this.a.push([e,t])},delete:function(e){var t=ch(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}};var _h={getConstructor:function(e,t,a,r){var o=e(function(e,n){ug(e,o,t,"_i"),e._i=gh++,e._l=void 0,void 0!=n&&pg(n,a,e[r],e)});return Ig(o.prototype,{delete:function(e){if(!Tl(e))return!1;var t=ph(e);return!0===t?hh(this)["delete"](e):t&&vl(t,this._i)&&delete t[this._i]},has:function(e){if(!Tl(e))return!1;var t=ph(e);return!0===t?hh(this).has(e):t&&vl(t,this._i)}}),o},def:function(e,t,a){var r=ph(wl(t),!0);return!0===r?hh(e).set(t,a):r[e._i]=a,e},ufstore:hh},yh=se(function(e){var t=xc(0),a=Hl.getWeak,r=Object.isExtensible,o=_h.ufstore,n={},i=function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},l={get:function(e){if(Tl(e)){var t=a(e);return!0===t?o(this).get(e):t?t[this._i]:void 0}},set:function(e,t){return _h.def(this,e,t)}},s=e.exports=lh("WeakMap",i,l,_h,!0,!0),u;7!=new s().set((Object.freeze||Object)(n),7).get(n)&&(u=_h.getConstructor(i),Lu(u.prototype,l),Hl.NEED=!0,t(["delete","has","get","set"],function(e){var t=s.prototype,o=t[e];Gl(t,e,function(t,a){if(Tl(t)&&!r(t)){this._f||(this._f=new u);var n=this._f[e](t,a);return"set"==e?this:n}return o.call(this,t,a)})}))});lh("WeakSet",function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{add:function(e){return _h.def(this,e,!0)}},_h,!1,!0);for(var xh=zl("typed_array"),vh=zl("view"),bh=!!(yl.ArrayBuffer&&yl.DataView),Sh=bh,Ph=0,Th=9,l=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"],wh;Ph<Th;)(wh=yl[l[Ph++]])?(Ol(wh.prototype,xh,!0),Ol(wh.prototype,vh,!0)):Sh=!1;var kh={ABV:bh,CONSTR:Sh,TYPED:xh,VIEW:vh},Ch=se(function(e,t){var a=Ns.f,r=Al.f,o="ArrayBuffer",n="DataView",i="prototype",l="Wrong length!",s="Wrong index!",u=yl[o],p=yl[n],d=yl.Math,c=yl.RangeError,g=yl.Infinity,h=u,f=Tn,m="buffer",_="byteLength",y="byteOffset",x=Sl?"_b":m,v=Sl?"_l":_,b=Sl?"_o":y,S=function(t,a,r){var o=Array(r),n=8*r-a-1,l=(1<<n)-1,u=l>>1,p=23===a?f(2,-24)-f(2,-77):0,d=0,i=0>t||0===t&&0>1/t?1:0,s,h,m;for(t=Sn(t),t!=t||t===g?(h=t==t?0:1,s=l):(s=_n(fn(t)/hn),1>t*(m=f(2,-s))&&(s--,m*=2),t+=1<=s+u?p/m:p*f(2,1-u),2<=t*m&&(s++,m/=2),s+u>=l?(h=0,s=l):1<=s+u?(h=(t*m-1)*f(2,a),s+=u):(h=t*f(2,u-1)*f(2,a),s=0));8<=a;o[d++]=255&h,h/=256,a-=8);for(s=s<<a|h,n+=a;0<n;o[d++]=255&s,s/=256,n-=8);return o[--d]|=128*i,o},P=function(t,a,r){var o=8*r-a-1,n=(1<<o)-1,l=n>>1,u=o-7,p=r-1,i=t[p--],s=127&i,e;for(i>>=7;0<u;s=256*s+t[p],p--,u-=8);for(e=s&(1<<-u)-1,s>>=-u,u+=a;0<u;e=256*e+t[p],p--,u-=8);if(0===s)s=1-l;else{if(s===n)return e?NaN:i?-g:g;e+=f(2,a),s-=l}return(i?-1:1)*e*f(2,s-a)},T=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},w=function(e){return[255&e]},k=function(e){return[255&e,255&e>>8]},C=function(e){return[255&e,255&e>>8,255&e>>16,255&e>>24]},F=function(e){return S(e,52,8)},M=function(e){return S(e,23,4)},E=function(e,t,a){r(e[i],t,{get:function(){return this[a]}})},D=function(e,t,a,r){var o=+a,n=ds(o);if(o!=n||0>n||n+t>e[v])throw c(s);var i=e[x]._b,l=n+e[b],u=i.slice(l,l+t);return r?u:u.reverse()},I=function(e,t,a,r,o,n){var l=+a,u=ds(l);if(l!=u||0>u||u+t>e[v])throw c(s);for(var p=e[x]._b,d=u+e[b],g=r(+o),h=0;h<t;h++)p[d+h]=g[n?h:t-h-1]},A=function(e,t){ug(e,u,o);var a=+t,r=gs(a);if(a!=r)throw c(l);return r};if(!kh.ABV)u=function(e){var t=A(this,e);this._b=Lc.call(Array(t),0),this[v]=t},p=function(e,t,a){ug(this,p,n),ug(e,u,n);var r=e[v],o=ds(t);if(0>o||o>r)throw c("Wrong offset!");if(a=void 0===a?r-o:gs(a),o+a>r)throw c(l);this[x]=e,this[b]=o,this[v]=a},Sl&&(E(u,_,"_l"),E(p,m,"_b"),E(p,_,"_l"),E(p,y,"_o")),Ig(p[i],{getInt8:function(e){return D(this,1,e)[0]<<24>>24},getUint8:function(e){return D(this,1,e)[0]},getInt16:function(e){var t=D(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=D(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return T(D(this,4,e,arguments[1]))},getUint32:function(e){return T(D(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return P(D(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return P(D(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){I(this,1,e,w,t)},setUint8:function(e,t){I(this,1,e,w,t)},setInt16:function(e,t){I(this,2,e,k,t,arguments[2])},setUint16:function(e,t){I(this,2,e,k,t,arguments[2])},setInt32:function(e,t){I(this,4,e,C,t,arguments[2])},setUint32:function(e,t){I(this,4,e,C,t,arguments[2])},setFloat32:function(e,t){I(this,4,e,M,t,arguments[2])},setFloat64:function(e,t){I(this,8,e,F,t,arguments[2])}});else{if(!bl(function(){new u})||!bl(function(){new u(.5)})){u=function(e){return new h(A(this,e))};for(var R=u[i]=h[i],O=a(h),L=0,j;O.length>L;)(j=O[L++])in u||Ol(u,j,h[j]);R.constructor=u}var z=new p(new u(2)),G=p[i].setInt8;z.setInt8(0,2147483648),z.setInt8(1,2147483649),(z.getInt8(0)||!z.getInt8(1))&&Ig(p[i],{setInt8:function(e,t){G.call(this,e,t<<24>>24)},setUint8:function(e,t){G.call(this,e,t<<24>>24)}},!0)}Ql(u,o),Ql(p,n),Ol(p[i],kh.VIEW,!0),t[o]=u,t[n]=p}),Fh=yl.ArrayBuffer,Mh=Ch.ArrayBuffer,Eh=Ch.DataView,Dh=kh.ABV&&Fh.isView,Ih=Mh.prototype.slice,Ah=kh.VIEW,Rh="ArrayBuffer";Vl(Vl.G+Vl.W+Vl.F*(Fh!==Mh),{ArrayBuffer:Mh}),Vl(Vl.S+Vl.F*!kh.CONSTR,Rh,{isView:function(e){return Dh&&Dh(e)||Tl(e)&&Ah in e}}),Vl(Vl.P+Vl.U+Vl.F*bl(function(){return!new Mh(2).slice(1,void 0).byteLength}),Rh,{slice:function(e,t){if(Ih!==void 0&&t===void 0)return Ih.call(wl(this),e);for(var a=wl(this).byteLength,r=ms(e,a),o=ms(void 0===t?a:t,a),n=new(cg(this,Mh))(gs(o-r)),i=new Eh(this),l=new Eh(n),s=0;r<o;)l.setUint8(s++,i.getUint8(r++));return n}}),Vc(Rh),Vl(Vl.G+Vl.W+Vl.F*!kh.ABV,{DataView:Ch.DataView});var Oh=se(function(e){if(Sl){var t=yl,a=bl,r=Vl,o=kh,n=Ch,i=ug,l=Ol,s=Ig,u=gs,p=ms,d=El,c=vl,g=Bu,h=Tl,f=Fu,m=Ns.f,_=zl,y=$l,x=xc,v=_s,b=cg,S=Wc,P=Al,T=Ks,w=P.f,k=T.f,C=t.RangeError,F=t.TypeError,M=t.Uint8Array,E="ArrayBuffer",D="Shared"+E,I="BYTES_PER_ELEMENT",A="prototype",R=Array[A],O=n.ArrayBuffer,L=n.DataView,j=x(0),z=x(2),G=x(3),U=x(4),N=x(5),q=x(6),B=v(!0),V=v(!1),H=S.values,W=S.keys,X=S.entries,Y=R.lastIndexOf,$=R.reduce,K=R.reduceRight,Z=R.join,Q=R.sort,J=R.slice,ee=R.toString,te=R.toLocaleString,ae=y("iterator"),re=y("toStringTag"),oe=_("typed_constructor"),ne=_("def_constructor"),ie=o.CONSTR,le=o.TYPED,se=o.VIEW,ue="Wrong length!",pe=x(1,function(e,t){return me(b(e,e[ne]),t)}),de=a(function(){return 1===new M(new Uint16Array([1]).buffer)[0]}),ce=!!M&&!!M[A].set&&a(function(){new M(1).set({})}),ge=function(e,t){if(e===void 0)throw F(ue);var a=u(e);if(t&&!ju(+e,a))throw C(ue);return a},he=function(e,t){var a=ds(e);if(0>a||a%t)throw C("Wrong offset!");return a},fe=function(e){if(h(e)&&le in e)return e;throw F(e+" is not a typed array!")},me=function(e,t){if(!(h(e)&&oe in e))throw F("It is not a typed array constructor!");return new e(t)},_e=function(e,t){return ye(b(e,e[ne]),t)},ye=function(e,t){for(var a=0,r=t.length,o=me(e,r);r>a;)o[a]=t[a++];return o},xe=function(e,t,a){w(e,t,{get:function(){return this._d[a]}})},ve=function(e){var t=f(e),a=arguments.length,r=1<a?arguments[1]:void 0,o=r!==void 0,n=ic(t),l,i,s,p,d,c;if(n!=void 0&&!rc(n)){for(c=n.call(t),s=[],l=0;!(d=c.next()).done;l++)s.push(d.value);t=s}for(o&&2<a&&(r=Nl(r,arguments[2],2)),l=0,i=u(t.length),p=me(this,i);i>l;l++)p[l]=o?r(t[l],l):t[l];return p},be=function(){for(var e=0,t=arguments.length,a=me(this,t);t>e;)a[e]=arguments[e++];return a},Se=!!M&&a(function(){te.call(new M(1))}),Pe=function(){return te.apply(Se?J.call(fe(this)):fe(this),arguments)},Te={copyWithin:function(e,t){return Ic.call(fe(this),e,t,2<arguments.length?arguments[2]:void 0)},every:function(e){return U(fe(this),e,1<arguments.length?arguments[1]:void 0)},fill:function(){return Lc.apply(fe(this),arguments)},filter:function(e){return _e(this,z(fe(this),e,1<arguments.length?arguments[1]:void 0))},find:function(e){return N(fe(this),e,1<arguments.length?arguments[1]:void 0)},findIndex:function(e){return q(fe(this),e,1<arguments.length?arguments[1]:void 0)},forEach:function(e){j(fe(this),e,1<arguments.length?arguments[1]:void 0)},indexOf:function(e){return V(fe(this),e,1<arguments.length?arguments[1]:void 0)},includes:function(e){return B(fe(this),e,1<arguments.length?arguments[1]:void 0)},join:function(){return Z.apply(fe(this),arguments)},lastIndexOf:function(){return Y.apply(fe(this),arguments)},map:function(e){return pe(fe(this),e,1<arguments.length?arguments[1]:void 0)},reduce:function(){return $.apply(fe(this),arguments)},reduceRight:function(){return K.apply(fe(this),arguments)},reverse:function(){for(var e=this,t=fe(e).length,a=_n(t/2),r=0,o;r<a;)o=e[r],e[r++]=e[--t],e[t]=o;return e},some:function(e){return G(fe(this),e,1<arguments.length?arguments[1]:void 0)},sort:function(e){return Q.call(fe(this),e)},subarray:function(e,t){var a=fe(this),r=a.length,o=p(e,r);return new(b(a,a[ne]))(a.buffer,a.byteOffset+o*a.BYTES_PER_ELEMENT,u((t===void 0?r:p(t,r))-o))}},we=function(e,t){return _e(this,J.call(fe(this),e,t))},ke=function(e){fe(this);var t=he(arguments[1],1),a=this.length,r=f(e),o=u(r.length),n=0;if(o+t>a)throw C(ue);for(;n<o;)this[t+n]=r[n++]},Ce={entries:function(){return X.call(fe(this))},keys:function(){return W.call(fe(this))},values:function(){return H.call(fe(this))}},Fe=function(e,t){return h(e)&&e[le]&&"symbol"!=("undefined"==typeof t?"undefined":wn(t))&&t in e&&+t+""==t+""},Me=function(e,t){return Fe(e,t=d(t,!0))?Rl(2,e[t]):k(e,t)},Ee=function(e,t,a){return Fe(e,t=d(t,!0))&&h(a)&&c(a,"value")&&!c(a,"get")&&!c(a,"set")&&!a.configurable&&(!c(a,"writable")||a.writable)&&(!c(a,"enumerable")||a.enumerable)?(e[t]=a.value,e):w(e,t,a)};ie||(T.f=Me,P.f=Ee),r(r.S+r.F*!ie,"Object",{getOwnPropertyDescriptor:Me,defineProperty:Ee}),a(function(){ee.call({})})&&(ee=te=function(){return Z.call(this)});var De=s({},Te);s(De,Ce),l(De,ae,Ce.values),s(De,{slice:we,set:ke,constructor:function(){},toString:ee,toLocaleString:Pe}),xe(De,"buffer","b"),xe(De,"byteOffset","o"),xe(De,"byteLength","l"),xe(De,"length","e"),w(De,re,{get:function(){return this[le]}}),e.exports=function(e,n,s,p){p=!!p;var d=e+(p?"Clamped":"")+"Array",c=t[d],f=c||{},_=c&&Du(c),y=!c||!o.ABV,x={},v=c&&c[A],b=function(t,a){var r=t._d;return r.v["get"+e](a*n+r.o,de)},S=function(t,a,r){var o=t._d;p&&(r=0>(r=xn(r))?0:255<r?255:255&r),o.v["set"+e](a*n+o.o,r,de)},P=function(e,t){w(e,t,{get:function(){return b(this,t)},set:function(e){return S(this,t,e)},enumerable:!0})};y?(c=s(function(e,t,a,r){i(e,c,d,"_d");var o=0,s=0,p,f,m,_;if(!h(t))m=ge(t,!0),f=m*n,p=new O(f);else if(t instanceof O||(_=g(t))==E||_==D){p=t,s=he(a,n);var y=t.byteLength;if(void 0===r){if(y%n)throw C(ue);if(f=y-s,0>f)throw C(ue)}else if(f=u(r)*n,f+s>y)throw C(ue);m=f/n}else return le in t?ye(c,t):ve.call(c,t);for(l(e,"_d",{b:p,o:s,l:f,e:m,v:new L(p)});o<m;)P(e,o++)}),v=c[A]=zs(De),l(v,"constructor",c)):!pc(function(e){new c(null),new c(e)},!0)&&(c=s(function(e,t,a,r){i(e,c,d);var o;return h(t)?t instanceof O||(o=g(t))==E||o==D?void 0===r?void 0===a?new f(t):new f(t,he(a,n)):new f(t,he(a,n),r):le in t?ye(c,t):ve.call(c,t):new f(ge(t,"Uint8Array"!=d))}),j(_===Function.prototype?m(f):m(f).concat(m(_)),function(e){e in c||l(c,e,f[e])}),c[A]=v,v.constructor=c);var T=v[ae],k=!!T&&("values"==T.name||T.name==void 0),F=Ce.values;l(c,oe,!0),l(v,le,d),l(v,se,!0),l(v,ne,c),(p?new c(1)[re]!=d:!(re in v))&&w(v,re,{get:function(){return d}}),x[d]=c,r(r.G+r.W+r.F*(c!=f),x),r(r.S,d,{BYTES_PER_ELEMENT:n,from:ve,of:be}),I in v||l(v,I,n),r(r.P,d,Te),Vc(d),r(r.P+r.F*ce,d,{set:ke}),r(r.P+r.F*!k,d,Ce),r(r.P+r.F*(v.toString!=ee),d,{toString:ee}),r(r.P+r.F*a(function(){new c(1).slice()}),d,{slice:we}),r(r.P+r.F*(a(function(){return[1,2].toLocaleString()!=new c([1,2]).toLocaleString()})||!a(function(){v.toLocaleString.call([1,2])})),d,{toLocaleString:Pe}),yd[d]=k?T:F,k||l(v,ae,F)}}else e.exports=function(){}});Oh("Int8",1,function(e){return function(t,a,r){return e(this,t,a,r)}}),Oh("Uint8",1,function(e){return function(t,a,r){return e(this,t,a,r)}}),Oh("Uint8",1,function(e){return function(t,a,r){return e(this,t,a,r)}},!0),Oh("Int16",2,function(e){return function(t,a,r){return e(this,t,a,r)}}),Oh("Uint16",2,function(e){return function(t,a,r){return e(this,t,a,r)}}),Oh("Int32",4,function(e){return function(t,a,r){return e(this,t,a,r)}}),Oh("Uint32",4,function(e){return function(t,a,r){return e(this,t,a,r)}}),Oh("Float32",4,function(e){return function(t,a,r){return e(this,t,a,r)}}),Oh("Float64",8,function(e){return function(t,a,r){return e(this,t,a,r)}});var Lh=(yl.Reflect||{}).apply,jh=Function.apply;Vl(Vl.S+Vl.F*!bl(function(){Lh(function(){})}),"Reflect",{apply:function(e,t,a){var r=Ul(e),o=wl(a);return Lh?Lh(r,t,o):jh.call(r,t,o)}});var zh=(yl.Reflect||{}).construct,Gh=bl(function(){function e(){}return!(zh(function(){},[],e)instanceof e)}),Uh=!bl(function(){zh(function(){})});Vl(Vl.S+Vl.F*(Gh||Uh),"Reflect",{construct:function(e,t){Ul(e),wl(t);var a=3>arguments.length?e:Ul(arguments[2]);if(Uh&&!Gh)return zh(e,t,a);if(e==a){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);}var r=[null];return r.push.apply(r,t),new($u.apply(e,r))}var o=a.prototype,n=zs(Tl(o)?o:Object.prototype),i=Function.apply.call(e,n,t);return Tl(i)?i:n}}),Vl(Vl.S+Vl.F*bl(function(){Reflect.defineProperty(Al.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,t,a){wl(e),t=El(t,!0),wl(a);try{return Al.f(e,t,a),!0}catch(t){return!1}}});var Nh=Ks.f;Vl(Vl.S,"Reflect",{deleteProperty:function(e,t){var a=Nh(wl(e),t);return a&&!a.configurable?!1:delete e[t]}});var qh=function(e){this._t=wl(e),this._i=0;var t=this._k=[],a;for(a in e)t.push(a)};vd(qh,"Object",function(){var e=this,t=e._k,a;do if(e._i>=t.length)return{value:void 0,done:!0};while(!((a=t[e._i++])in e._t));return{value:a,done:!1}}),Vl(Vl.S,"Reflect",{enumerate:function(e){return new qh(e)}}),Vl(Vl.S,"Reflect",{get:pe}),Vl(Vl.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return Ks.f(wl(e),t)}}),Vl(Vl.S,"Reflect",{getPrototypeOf:function(e){return Du(wl(e))}}),Vl(Vl.S,"Reflect",{has:function(e,t){return t in e}});var Bh=Object.isExtensible;Vl(Vl.S,"Reflect",{isExtensible:function(e){return wl(e),!Bh||Bh(e)}});var Vh=yl.Reflect,Hh=Vh&&Vh.ownKeys||function(e){var t=Ns.f(wl(e)),a=Cs.f;return a?t.concat(a(e)):t};Vl(Vl.S,"Reflect",{ownKeys:Hh});var Wh=Object.preventExtensions;Vl(Vl.S,"Reflect",{preventExtensions:function(e){wl(e);try{return Wh&&Wh(e),!0}catch(t){return!1}}}),Vl(Vl.S,"Reflect",{set:de}),Gu&&Vl(Vl.S,"Reflect",{setPrototypeOf:function(e,t){Gu.check(e,t);try{return Gu.set(e,t),!0}catch(t){return!1}}});var Xh=_s(!0);Vl(Vl.P,"Array",{includes:function(e){return Xh(this,e,1<arguments.length?arguments[1]:void 0)}}),Oc("includes");var Yh=_d(!0);Vl(Vl.P,"String",{at:function(e){return Yh(this,e)}});var $h=function(e,t,a,r){var o=ls(e)+"",n=o.length,i=void 0===a?" ":a+"",l=gs(t);if(l<=n||""==i)return o;var s=l-n,u=Rp.call(i,yn(s/i.length));return u.length>s&&(u=u.slice(0,s)),r?u+o:o+u};Vl(Vl.P,"String",{padStart:function(e){return $h(this,e,1<arguments.length?arguments[1]:void 0,!0)}}),Vl(Vl.P,"String",{padEnd:function(e){return $h(this,e,1<arguments.length?arguments[1]:void 0,!1)}}),pp("trimLeft",function(e){return function(){return e(this,1)}},"trimStart"),pp("trimRight",function(e){return function(){return e(this,2)}},"trimEnd");var Kh=RegExp.prototype,Zh=function(e,t){this._r=e,this._s=t};vd(Zh,"RegExp String",function(){var e=this._r.exec(this._s);return{value:e,done:null===e}}),Vl(Vl.P,"String",{matchAll:function(e){if(ls(this),!Dd(e))throw TypeError(e+" is not a regexp!");var t=this+"",a="flags"in Kh?e.flags+"":Xc.call(e),r=new RegExp(e.source,~a.indexOf("g")?a:"g"+a);return r.lastIndex=gs(e.lastIndex),new Zh(r,t)}}),rs("asyncIterator"),rs("observable"),Vl(Vl.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t=ss(e),a=Ks.f,r=Hh(t),o={},n=0,i;r.length>n;)oc(o,i=r[n++],a(t,i));return o}});var Qh=Ms.f,Jh=function(e){return function(t){for(var a=ss(t),r=Ts(a),o=r.length,n=0,i=[],l;o>n;)Qh.call(a,l=r[n++])&&i.push(e?[l,a[l]]:a[l]);return i}},ef=Jh(!1);Vl(Vl.S,"Object",{values:function(e){return ef(e)}});var tf=Jh(!0);Vl(Vl.S,"Object",{entries:function(e){return tf(e)}});var af=!bl(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete yl[e]});Sl&&Vl(Vl.P+af,"Object",{__defineGetter__:function(e,t){Al.f(Fu(this),e,{get:Ul(t),enumerable:!0,configurable:!0})}}),Sl&&Vl(Vl.P+af,"Object",{__defineSetter__:function(e,t){Al.f(Fu(this),e,{set:Ul(t),enumerable:!0,configurable:!0})}});var rf=Ks.f;Sl&&Vl(Vl.P+af,"Object",{__lookupGetter__:function(e){var t=Fu(this),a=El(e,!0),r;do if(r=rf(t,a))return r.get;while(t=Du(t))}});var of=Ks.f;Sl&&Vl(Vl.P+af,"Object",{__lookupSetter__:function(e){var t=Fu(this),a=El(e,!0),r;do if(r=of(t,a))return r.set;while(t=Du(t))}});var nf=function(e,t){var a=[];return pg(e,!1,a.push,a,t),a},lf=function(e){return function(){if(Bu(this)!=e)throw TypeError(e+"#toJSON isn't generic");return nf(this)}};Vl(Vl.P+Vl.R,"Map",{toJSON:lf("Map")}),Vl(Vl.P+Vl.R,"Set",{toJSON:lf("Set")}),Vl(Vl.S,"System",{global:yl}),Vl(Vl.S,"Error",{isError:function(e){return"Error"===ns(e)}}),Vl(Vl.S,"Math",{iaddh:function(e,t,a,r){var o=e>>>0,n=a>>>0;return 0|(t>>>0)+(r>>>0)+((o&n|(o|n)&~(o+n>>>0))>>>31)}}),Vl(Vl.S,"Math",{isubh:function(e,t,a,r){var o=e>>>0,n=a>>>0;return 0|(t>>>0)-(r>>>0)-((~o&n|~(o^n)&o-n>>>0)>>>31)}}),Vl(Vl.S,"Math",{imulh:function(e,a){var r=65535,o=+e,n=+a,i=o&r,l=n&r,s=o>>16,p=n>>16,d=(s*l>>>0)+(i*l>>>16);return s*p+(d>>16)+((i*p>>>0)+(d&r)>>16)}}),Vl(Vl.S,"Math",{umulh:function(e,a){var r=65535,o=+e,n=+a,i=o&r,l=n&r,s=o>>>16,p=n>>>16,d=(s*l>>>0)+(i*l>>>16);return s*p+(d>>>16)+((i*p>>>0)+(d&r)>>>16)}});var sf=Yl("metadata"),uf=sf.store||(sf.store=new yh),pf=function(e,t,a){var r=uf.get(e);if(!r){if(!a)return;uf.set(e,r=new sh)}var o=r.get(t);if(!o){if(!a)return;r.set(t,o=new sh)}return o},df=function(e,t,a){var r=pf(t,a,!1);return r!==void 0&&r.has(e)},cf=function(e,t,a){var r=pf(t,a,!1);return r===void 0?void 0:r.get(e)},gf=function(e,t,a,r){pf(a,r,!0).set(e,t)},hf=function(e,t){var a=pf(e,t,!1),r=[];return a&&a.forEach(function(e,t){r.push(t)}),r},ff=function(e){return e===void 0||"symbol"==("undefined"==typeof e?"undefined":wn(e))?e:e+""},mf=function(e){Vl(Vl.S,"Reflect",e)},_f={store:uf,map:pf,has:df,get:cf,set:gf,keys:hf,key:ff,exp:mf},yf=_f.key,xf=_f.set;_f.exp({defineMetadata:function(e,t,a,r){xf(e,t,wl(a),yf(r))}});var vf=_f.key,bf=_f.map,Sf=_f.store;_f.exp({deleteMetadata:function(e,t){var a=3>arguments.length?void 0:vf(arguments[2]),r=bf(wl(t),a,!1);if(void 0===r||!r["delete"](e))return!1;if(r.size)return!0;var o=Sf.get(t);return o["delete"](a),!!o.size||Sf["delete"](t)}});var Pf=_f.has,Tf=_f.get,wf=_f.key,kf=function e(t,a,r){var o=Pf(t,a,r);if(o)return Tf(t,a,r);var n=Du(a);return null===n?void 0:e(t,n,r)};_f.exp({getMetadata:function(e,t){return kf(e,wl(t),3>arguments.length?void 0:wf(arguments[2]))}});var Cf=_f.keys,Ff=_f.key,Mf=function e(t,a){var r=Cf(t,a),o=Du(t);if(null===o)return r;var n=e(o,a);return n.length?r.length?nf(new uh(r.concat(n))):n:r};_f.exp({getMetadataKeys:function(e){return Mf(wl(e),2>arguments.length?void 0:Ff(arguments[1]))}});var Ef=_f.get,Df=_f.key;_f.exp({getOwnMetadata:function(e,t){return Ef(e,wl(t),3>arguments.length?void 0:Df(arguments[2]))}});var If=_f.keys,Af=_f.key;_f.exp({getOwnMetadataKeys:function(e){return If(wl(e),2>arguments.length?void 0:Af(arguments[1]))}});var Rf=_f.has,Of=_f.key,Lf=function e(t,a,r){var o=Rf(t,a,r);if(o)return!0;var n=Du(a);return null!==n&&e(t,n,r)};_f.exp({hasMetadata:function(e,t){return Lf(e,wl(t),3>arguments.length?void 0:Of(arguments[2]))}});var jf=_f.has,zf=_f.key;_f.exp({hasOwnMetadata:function(e,t){return jf(e,wl(t),3>arguments.length?void 0:zf(arguments[2]))}});var Gf=_f.key,Uf=_f.set;_f.exp({metadata:function(e,t){return function(a,r){Uf(e,t,(r===void 0?Ul:wl)(a),Gf(r))}}});var Nf=Dg(),qf=yl.process,Bf="process"==ns(qf);Vl(Vl.G,{asap:function(e){var t=Bf&&qf.domain;Nf(t?t.bind(e):e)}});var Vf=Dg(),Hf=$l("observable"),Wf=pg.RETURN,Xf=function(e){return null==e?void 0:Ul(e)},Yf=function(e){var t=e._c;t&&(e._c=void 0,t())},$f=function(e){return e._o===void 0},Kf=function(e){$f(e)||(e._o=void 0,Yf(e))},Zf=function(t,e){wl(t),this._c=void 0,this._o=t,t=new Qf(this);try{var a=e(t),r=a;null!=a&&("function"==typeof a.unsubscribe?a=function(){r.unsubscribe()}:Ul(a),this._c=a)}catch(a){return void t.error(a)}$f(this)&&Yf(this)};Zf.prototype=Ig({},{unsubscribe:function(){Kf(this)}});var Qf=function(e){this._s=e};Qf.prototype=Ig({},{next:function(e){var t=this._s;if(!$f(t)){var a=t._o;try{var r=Xf(a.next);if(r)return r.call(a,e)}catch(a){try{Kf(t)}finally{throw a}}}},error:function(e){var t=this._s;if($f(t))throw e;var a=t._o;t._o=void 0;try{var r=Xf(a.error);if(!r)throw e;e=r.call(a,e)}catch(a){try{Yf(t)}finally{throw a}}return Yf(t),e},complete:function(e){var t=this._s;if(!$f(t)){var a=t._o;t._o=void 0;try{var r=Xf(a.complete);e=r?r.call(a,e):void 0}catch(a){try{Yf(t)}finally{throw a}}return Yf(t),e}}});var Jf=function(e){ug(this,Jf,"Observable","_f")._f=Ul(e)};Ig(Jf.prototype,{subscribe:function(e){return new Zf(e,this._f)},forEach:function(e){var t=this;return new(Pl.Promise||yl.Promise)(function(a,r){Ul(e);var o=t.subscribe({next:function(t){try{return e(t)}catch(t){r(t),o.unsubscribe()}},error:r,complete:a})})}}),Ig(Jf,{from:function(e){var t="function"==typeof this?this:Jf,a=Xf(wl(e)[Hf]);if(a){var r=wl(a.call(e));return r.constructor===t?r:new t(function(e){return r.subscribe(e)})}return new t(function(t){var a=!1;return Vf(function(){if(!a){try{if(pg(e,!1,function(e){if(t.next(e),a)return Wf})===Wf)return}catch(r){if(a)throw r;return void t.error(r)}t.complete()}}),function(){a=!0}})},of:function(){for(var e=0,t=arguments.length,a=Array(t);e<t;)a[e]=arguments[e++];return new("function"==typeof this?this:Jf)(function(e){var t=!1;return Vf(function(){if(!t){for(var r=0;r<a.length;++r)if(e.next(a[r]),t)return;e.complete()}}),function(){t=!0}})}}),Ol(Jf.prototype,Hf,function(){return this}),Vl(Vl.G,{Observable:Jf}),Vc("Observable");var em=yl,tm=function(){for(var e=Ul(this),t=arguments.length,a=Array(t),r=0,o=em._,n=!1;t>r;)(a[r]=arguments[r++])===o&&(n=!0);return function(){var r=this,i=arguments.length,l=0,s=0,u;if(!n&&!i)return Hu(e,a,r);if(u=a.slice(),n)for(;t>l;l++)u[l]===o&&(u[l]=arguments[s++]);for(;i>s;)u.push(arguments[s++]);return Hu(e,u,r)}},am=yl.navigator,rm=!!am&&/MSIE .\./.test(am.userAgent),om=function(e){return rm?function(t,a){return e(Hu(tm,[].slice.call(arguments,2),"function"==typeof t?t:Function(t)),a)}:e};Vl(Vl.G+Vl.B+Vl.F*rm,{setTimeout:om(yl.setTimeout),setInterval:om(yl.setInterval)}),Vl(Vl.G+Vl.B,{setImmediate:wg.set,clearImmediate:wg.clear});for(var nm=$l("iterator"),im=$l("toStringTag"),lm=yd.Array,sm=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],um=0;5>um;um++){var pm=sm[um],dm=yl[pm],cm=dm&&dm.prototype,gm;if(cm)for(gm in cm[nm]||Ol(cm,nm,lm),cm[im]||Ol(cm,im,pm),yd[pm]=lm,Wc)cm[gm]||Gl(cm,gm,Wc[gm],!0)}var hm=se(function(e){!function(t){function a(e,t,a,r){var n=t&&t.prototype instanceof o?t:o,i=Object.create(n.prototype),l=new g(r||[]);return i._invoke=u(e,a,l),i}function r(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(e){return{type:"throw",arg:e}}}function o(){}function n(){}function i(){}function l(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function s(e){function t(a,o,n,i){var l=r(e[a],e,o);if("throw"===l.type)i(l.arg);else{var s=l.arg,u=s.value;return u&&"object"===("undefined"==typeof u?"undefined":wn(u))&&_.call(u,"__await")?Promise.resolve(u.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):Promise.resolve(u).then(function(e){s.value=e,n(s)},i)}}var a;this._invoke=function(e,r){function o(){return new Promise(function(a,o){t(e,r,a,o)})}return a=a?a.then(o,o):o()}}function u(e,t,a){var o=P;return function(n,i){if(o==w)throw new Error("Generator is already running");if(o==k){if("throw"===n)throw i;return f()}for(a.method=n,a.arg=i;;){var l=a.delegate;if(l){var s=p(l,a);if(s){if(s===C)continue;return s}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(o==P)throw o=k,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);o=w;var u=r(e,t,a);if("normal"===u.type){if(o=a.done?k:T,u.arg===C)continue;return{value:u.arg,done:a.done}}"throw"===u.type&&(o=k,a.method="throw",a.arg=u.arg)}}}function p(e,t){var a=e.iterator[t.method];if(void 0===a){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,p(e,t),"throw"===t.method))return C;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return C}var o=r(a,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,C;var n=o.arg;if(!n)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,C;if(n.done)t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0);else return n;return t.delegate=null,C}function d(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function c(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function g(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(d,this),this.reset(!0)}function h(e){if(e){var t=e[x];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,r=function t(){for(;++a<e.length;)if(_.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:f}}function f(){return{value:void 0,done:!0}}var m=Object.prototype,_=m.hasOwnProperty,y="function"==typeof Symbol?Symbol:{},x=y.iterator||"@@iterator",v=y.asyncIterator||"@@asyncIterator",b=y.toStringTag||"@@toStringTag",S=t.regeneratorRuntime;if(S)return void(e.exports=S);S=t.regeneratorRuntime=e.exports,S.wrap=a;var P="suspendedStart",T="suspendedYield",w="executing",k="completed",C={},F={};F[x]=function(){return this};var M=Object.getPrototypeOf,E=M&&M(M(h([])));E&&E!==m&&_.call(E,x)&&(F=E);var D=i.prototype=o.prototype=Object.create(F);n.prototype=D.constructor=i,i.constructor=n,i[b]=n.displayName="GeneratorFunction",S.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))},S.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,i):(e.__proto__=i,!(b in e)&&(e[b]="GeneratorFunction")),e.prototype=Object.create(D),e},S.awrap=function(e){return{__await:e}},l(s.prototype),s.prototype[v]=function(){return this},S.AsyncIterator=s,S.async=function(e,t,r,o){var n=new s(a(e,t,r,o));return S.isGeneratorFunction(t)?n:n.next().then(function(e){return e.done?e.value:n.next()})},l(D),D[b]="Generator",D[x]=function(){return this},D.toString=function(){return"[object Generator]"},S.keys=function(e){var t=[];for(var a in e)t.push(a);return t.reverse(),function a(){for(;t.length;){var r=t.pop();if(r in e)return a.value=r,a.done=!1,a}return a.done=!0,a}},S.values=h,g.prototype={constructor:g,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(c),!e)for(var t in this)"t"===t.charAt(0)&&_.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,r){return n.type="throw",n.arg=e,a.next=t,r&&(a.method="next",a.arg=void 0),!!r}if(this.done)throw e;for(var a=this,r=this.tryEntries.length-1;0<=r;--r){var o=this.tryEntries[r],n=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var i=_.call(o,"catchLoc"),l=_.call(o,"finallyLoc");if(i&&l){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);}else if(!l)throw new Error("try statement without catch or finally");else if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}},abrupt:function(e,t){for(var a=this.tryEntries.length-1,r;0<=a;--a)if(r=this.tryEntries[a],r.tryLoc<=this.prev&&_.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var n=o?o.completion:{};return n.type=e,n.arg=t,o?(this.method="next",this.next=o.finallyLoc,C):this.complete(n)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),C},finish:function(e){for(var t=this.tryEntries.length-1,a;0<=t;--t)if(a=this.tryEntries[t],a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),c(a),C},catch:function(e){for(var t=this.tryEntries.length-1,a;0<=t;--t)if(a=this.tryEntries[t],a.tryLoc===e){var r=a.completion;if("throw"===r.type){var o=r.arg;c(a)}return o}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:h(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),C}}}(function(){return this}()||Function("return this")())});if(_l._babelPolyfill)throw new Error("only one instance of @babel/polyfill is allowed");_l._babelPolyfill=!0;var fm=ce,mm="object"==wn(_l)&&_l&&_l.Object===Object&&_l,_m=mm,ym="object"==("undefined"==typeof self?"undefined":wn(self))&&self&&self.Object===Object&&self,xm=_m||ym||Function("return this")(),vm=xm,bm=vm.Symbol,Sm=bm,Pm=Object.prototype,Tm=Pm.hasOwnProperty,wm=Pm.toString,km=Sm?Sm.toStringTag:void 0,Cm=ge,Fm=Object.prototype,Mm=Fm.toString,Em=he,Dm="[object Null]",Im="[object Undefined]",Am=Sm?Sm.toStringTag:void 0,Rm=fe,Om=me,Lm="[object Arguments]",jm=_e,zm=Object.prototype,Gm=zm.hasOwnProperty,Um=zm.propertyIsEnumerable,Nm=jm(function(){return arguments}())?jm:function(e){return Om(e)&&Gm.call(e,"callee")&&!Um.call(e,"callee")},qm=Nm,Bm=Array.isArray,Vm=Bm,Hm=ye,Wm=se(function(e,t){var a=t&&!t.nodeType&&t,r=a&&!0&&e&&!e.nodeType&&e,o=r&&r.exports===a,n=o?vm.Buffer:void 0,i=n?n.isBuffer:void 0;e.exports=i||Hm}),Xm=9007199254740991,Ym=/^(?:0|[1-9]\d*)$/,$m=xe,Km=9007199254740991,Zm=ve,Qm="[object Arguments]",Jm="[object Array]",e_="[object Boolean]",t_="[object Date]",a_="[object Error]",r_="[object Function]",o_="[object Map]",n_="[object Number]",i_="[object Object]",l_="[object RegExp]",s_="[object Set]",u_="[object String]",p_="[object WeakMap]",d_="[object ArrayBuffer]",c_="[object DataView]",g_="[object Float32Array]",h_="[object Float64Array]",f_="[object Int8Array]",m_="[object Int16Array]",__="[object Int32Array]",y_="[object Uint8Array]",x_="[object Uint8ClampedArray]",v_="[object Uint16Array]",b_="[object Uint32Array]",S_={};S_[g_]=S_[h_]=S_[f_]=S_[m_]=S_[__]=S_[y_]=S_[x_]=S_[v_]=S_[b_]=!0,S_[Qm]=S_[Jm]=S_[d_]=S_[e_]=S_[c_]=S_[t_]=S_[a_]=S_[r_]=S_[o_]=S_[n_]=S_[i_]=S_[l_]=S_[s_]=S_[u_]=S_[p_]=!1;var P_=be,T_=Se,w_=se(function(e,t){var a=t&&!t.nodeType&&t,r=a&&!0&&e&&!e.nodeType&&e,o=r&&r.exports===a,n=o&&_m.process,i=function(){try{return n&&n.binding&&n.binding("util")}catch(t){}}();e.exports=i}),k_=w_&&w_.isTypedArray,C_=k_?T_(k_):P_,F_=C_,M_=Object.prototype,E_=M_.hasOwnProperty,D_=Pe,I_=Object.prototype,A_=Te,R_=we,O_=R_(Object.keys,Object),L_=O_,j_=Object.prototype,z_=j_.hasOwnProperty,G_=ke,U_=Ce,N_="[object AsyncFunction]",q_="[object Function]",B_="[object GeneratorFunction]",V_="[object Proxy]",H_=Fe,W_=Me,X_=Ee,Y_=De,$_=Ie,K_=Ae,Z_=Array.prototype,Q_=Z_.splice,J_=Re,ey=Oe,ty=Le,ay=je;ze.prototype.clear=Y_,ze.prototype["delete"]=J_,ze.prototype.get=ey,ze.prototype.has=ty,ze.prototype.set=ay;var ry=ze,oy=Ge,ny=Ue,iy=Ne,ly=qe,sy=vm["__core-js_shared__"],uy=sy,py=function(){var e=/[^.]+$/.exec(uy&&uy.keys&&uy.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),dy=Be,cy=Function.prototype,gy=cy.toString,hy=Ve,fy=/[\\^$.*+?()[\]{}|]/g,my=/^\[object .+?Constructor\]$/,_y=Function.prototype,yy=Object.prototype,xy=_y.toString,vy=yy.hasOwnProperty,by=RegExp("^"+xy.call(vy).replace(fy,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Sy=He,Py=We,Ty=Xe,wy=Ty(vm,"Map"),ky=wy,Cy=Ty(Object,"create"),Fy=Cy,My=Ye,Ey=$e,Dy="__lodash_hash_undefined__",Iy=Object.prototype,Ay=Iy.hasOwnProperty,Ry=Ke,Oy=Object.prototype,Ly=Oy.hasOwnProperty,jy=Ze,zy="__lodash_hash_undefined__",Gy=Qe;Je.prototype.clear=My,Je.prototype["delete"]=Ey,Je.prototype.get=Ry,Je.prototype.has=jy,Je.prototype.set=Gy;var Uy=Je,Ny=et,qy=tt,By=at,Vy=rt,Hy=ot,Wy=nt,Xy=it;lt.prototype.clear=Ny,lt.prototype["delete"]=Vy,lt.prototype.get=Hy,lt.prototype.has=Wy,lt.prototype.set=Xy;var Yy=lt,$y=200,Ky=st;ut.prototype.clear=oy,ut.prototype["delete"]=ny,ut.prototype.get=iy,ut.prototype.has=ly,ut.prototype.set=Ky;var Zy=ut,Qy="__lodash_hash_undefined__",Jy=pt,ex=dt;ct.prototype.add=ct.prototype.push=Jy,ct.prototype.has=ex;var tx=ct,ax=gt,rx=ht,ox=1,nx=2,ix=ft,lx=vm.Uint8Array,sx=lx,ux=mt,px=_t,dx=1,cx=2,gx="[object Boolean]",hx="[object Date]",fx="[object Error]",mx="[object Map]",_x="[object Number]",yx="[object RegExp]",xx="[object Set]",vx="[object String]",bx="[object Symbol]",Sx="[object ArrayBuffer]",Px="[object DataView]",Tx=Sm?Sm.prototype:void 0,wx=Tx?Tx.valueOf:void 0,kx=yt,Cx=xt,Fx=vt,Mx=bt,Ex=St,Dx=Object.prototype,Ix=Dx.propertyIsEnumerable,Ax=Object.getOwnPropertySymbols,Rx=Ax?function(e){return null==e?[]:(e=Object(e),Mx(Ax(e),function(t){return Ix.call(e,t)}))}:Ex,Ox=Rx,Lx=Pt,jx=1,zx=Object.prototype,Gx=zx.hasOwnProperty,Ux=Tt,Nx=Ty(vm,"DataView"),qx=Nx,Bx=Ty(vm,"Promise"),Vx=Bx,Hx=Ty(vm,"Set"),Wx=Hx,Xx=Ty(vm,"WeakMap"),Yx=Xx,$x="[object Map]",Kx="[object Object]",Zx="[object Promise]",Qx="[object Set]",Jx="[object WeakMap]",ev="[object DataView]",tv=hy(qx),av=hy(ky),rv=hy(Vx),ov=hy(Wx),nv=hy(Yx),iv=Rm;(qx&&iv(new qx(new ArrayBuffer(1)))!=ev||ky&&iv(new ky)!=$x||Vx&&iv(Vx.resolve())!=Zx||Wx&&iv(new Wx)!=Qx||Yx&&iv(new Yx)!=Jx)&&(iv=function(e){var t=Rm(e),a=t==Kx?e.constructor:void 0,r=a?hy(a):"";if(r)switch(r){case tv:return ev;case av:return $x;case rv:return Zx;case ov:return Qx;case nv:return Jx;}return t});var lv=iv,sv=1,uv="[object Arguments]",pv="[object Array]",dv="[object Object]",cv=Object.prototype,gv=cv.hasOwnProperty,hv=wt,fv=kt,mv=Ct,_v=Ft,yv=1,xv=2,vv=Mt,bv=Et,Sv=Dt,Pv=It,Tv=At,wv="[object Symbol]",kv=Rt,Cv=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Fv=/^\w*$/,Mv=Ot,Ev="Expected a function";Lt.Cache=Yy;var Dv=Lt,Iv=500,Av=jt,Rv=/^\./,Ov=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Lv=/\\(\\)?/g,jv=Av(function(e){var t=[];return Rv.test(e)&&t.push(""),e.replace(Ov,function(e,a,r,o){t.push(r?o.replace(Lv,"$1"):a||e)}),t}),zv=jv,Gv=1/0,Uv=Sm?Sm.prototype:void 0,Nv=Uv?Uv.toString:void 0,qv=zt,Bv=Gt,Vv=Ut,Hv=1/0,Wv=Nt,Xv=qt,Yv=Bt,$v=Vt,Kv=Ht,Zv=Wt,Qv=1,Jv=2,eb=Xt,tb=Yt,ab=$t,rb=Kt,ob=Zt,nb=Qt,ib=Jt,lb=ib(),sb=lb,ub=ea,pb=ta,db=pb(ub),cb=db,gb=aa,hb=ra,fb=oa,mb=na,_b=ia,yb=la,xb=sa,vb=ua,bb=0/0,Sb=/^\s+|\s+$/g,Pb=/^[-+]0x[0-9a-f]+$/i,Tb=/^0b[01]+$/i,wb=/^0o[0-7]+$/i,kb=parseInt,Cb=pa,Fb=1/0,Mb=1.7976931348623157e308,Eb=da,Db=ca,Ib=bn,Ab=ga,Rb=xb(Ab),Ob=Rb,Lb=function(){try{var e=Ty(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),jb=Lb,zb=ha,Gb=Object.prototype,Ub=Gb.hasOwnProperty,Nb=fa,qb=ma,Bb=_a,Vb=ya,Hb=Sm?Sm.isConcatSpreadable:void 0,Wb=xa,Xb=va,Yb=ba,$b=Sa,Kb=bn,Zb=Pa,Qb=Ta,Jb=jb?function(e,t){return jb(e,"toString",{configurable:!0,enumerable:!1,value:Qb(t),writable:!0})}:tb,eS=Jb,tS=800,aS=16,rS=Date.now,oS=wa,nS=oS(eS),iS=nS,lS=ka,sS=lS(function(e,t){return null==e?{}:Vb(e,t)}),uS=sS,pS=se(function(t,e){!function(a){t.exports=a()}(function(){var e,t,a;return function p(d,e,t){function a(i,o){if(!e[i]){if(!d[i]){var n="function"==typeof _dereq_&&_dereq_;if(!o&&n)return n(i,!0);if(r)return r(i,!0);var s=new Error("Cannot find module '"+i+"'");throw s.code="MODULE_NOT_FOUND",s}var c=e[i]={exports:{}};d[i][0].call(c.exports,function(t){var e=d[i][1][t];return a(e?e:t)},c,c.exports,p,d,e,t)}return e[i].exports}for(var r="function"==typeof _dereq_&&_dereq_,n=0;n<t.length;n++)a(t[n]);return a}({1:[function(e,t){t.exports=function(e){function t(e){var t=new a(e),r=t.promise();return t.setHowMany(1),t.setUnwrap(),t.init(),r}var a=e._SomePromiseArray;e.any=function(e){return t(e)},e.prototype.any=function(){return t(this)}}},{}],2:[function(e,t){function a(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new s(16),this._normalQueue=new s(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=l}function r(e,t,a){this._lateQueue.push(e,t,a),this._queueTick()}function o(e,t,a){this._normalQueue.push(e,t,a),this._queueTick()}function n(e){this._normalQueue._pushOne(e),this._queueTick()}var i;try{throw new Error}catch(t){i=t}var l=e("./schedule"),s=e("./queue"),u=e("./util");a.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},a.prototype.hasCustomScheduler=function(){return this._customScheduler},a.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},a.prototype.disableTrampolineIfNecessary=function(){u.hasDevTools&&(this._trampolineEnabled=!1)},a.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},a.prototype.fatalError=function(t,e){e?(process.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),process.exit(2)):this.throwLater(t)},a.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout(function(){e(t)},0);else try{this._schedule(function(){e(t)})}catch(t){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},u.hasDevTools?(a.prototype.invokeLater=function(e,t,a){this._trampolineEnabled?r.call(this,e,t,a):this._schedule(function(){setTimeout(function(){e.call(t,a)},100)})},a.prototype.invoke=function(e,t,a){this._trampolineEnabled?o.call(this,e,t,a):this._schedule(function(){e.call(t,a)})},a.prototype.settlePromises=function(e){this._trampolineEnabled?n.call(this,e):this._schedule(function(){e._settlePromises()})}):(a.prototype.invokeLater=r,a.prototype.invoke=o,a.prototype.settlePromises=n),a.prototype._drainQueue=function(e){for(;0<e.length();){var t=e.shift();if("function"!=typeof t){t._settlePromises();continue}var a=e.shift(),r=e.shift();t.call(a,r)}},a.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},a.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},a.prototype._reset=function(){this._isTickUsed=!1},t.exports=a,t.exports.firstLineError=i},{"./queue":26,"./schedule":29,"./util":36}],3:[function(e,t){t.exports=function(e,t,a,r){var o=!1,n=function(t,a){this._reject(a)},i=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(n,n,null,this,t)},l=function(e,t){0==(50397184&this._bitField)&&this._resolveCallback(t.target)},s=function(t,e){e.promiseRejectionQueued||this._reject(t)};e.prototype.bind=function(n){o||(o=!0,e.prototype._propagateFrom=r.propagateFromFunction(),e.prototype._boundValue=r.boundValueFunction());var u=a(n),p=new e(t);p._propagateFrom(this,1);var d=this._target();if(p._setBoundTo(u),u instanceof e){var c={promiseRejectionQueued:!1,promise:p,target:d,bindingPromise:u};d._then(t,i,void 0,p,c),u._then(l,s,void 0,p,c),p._setOnCancel(u)}else p._resolveCallback(d);return p},e.prototype._setBoundTo=function(e){e===void 0?this._bitField&=-2097153:(this._bitField|=2097152,this._boundTo=e)},e.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},e.bind=function(t,a){return e.resolve(a).bind(t)}}},{}],4:[function(e,t){var a;"undefined"!=typeof Promise&&(a=Promise);var r=e("./promise")();r.noConflict=function(){try{Promise===r&&(Promise=a)}catch(t){}return r},t.exports=r},{"./promise":22}],5:[function(e,t){var a=Object.create;if(a){var r=a(null),o=a(null);r[" size"]=o[" size"]=0}t.exports=function(t){function a(e,a){var r;if(null!=e&&(r=e[a]),"function"!=typeof r){var o="Object "+i.classString(e)+" has no method '"+i.toString(a)+"'";throw new t.TypeError(o)}return r}function r(e){var t=this.pop(),r=a(e,t);return r.apply(e,this)}function o(e){return e[this]}function n(e){var t=+this;return 0>t&&(t=bn(0,t+e.length)),e[t]}var i=e("./util"),l=i.canEvaluate,s=i.isIdentifier,u;t.prototype.call=function(e){var t=[].slice.call(arguments,1);return t.push(e),this._then(r,void 0,void 0,t,void 0)},t.prototype.get=function(e){var t;if(!!("number"==typeof e))t=n;else if(l){var a=u(e);t=null===a?o:a}else t=o;return this._then(t,void 0,void 0,e,void 0)}}},{"./util":36}],6:[function(e,t){t.exports=function(t,a,r,o){var n=e("./util"),i=n.tryCatch,l=n.errorObj,s=t._async;t.prototype["break"]=t.prototype.cancel=function(){if(!o.cancellation())return this._warn("cancellation is disabled");for(var e=this,t=e;e._isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var a=e._cancellationParent;if(null==a||!a._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}else e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),t=e,e=a}},t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},t.prototype._enoughBranchesHaveCancelled=function(){return this._branchesRemainingToCancel===void 0||0>=this._branchesRemainingToCancel},t.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):!(this._branchHasCancelled(),!this._enoughBranchesHaveCancelled())&&(this._invokeOnCancel(),!0)},t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},t.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),s.invoke(this._cancelPromises,this,void 0))},t.prototype._cancelPromises=function(){0<this._length()&&this._settlePromises()},t.prototype._unsetOnCancel=function(){this._onCancelField=void 0},t.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},t.prototype._doInvokeOnCancel=function(t,a){if(n.isArray(t))for(var r=0;r<t.length;++r)this._doInvokeOnCancel(t[r],a);else if(t!==void 0)if("function"!=typeof t)t._resultCancelled(this);else if(!a){var o=i(t).call(this._boundValue());o===l&&(this._attachExtraTrace(o.e),s.throwLater(o.e))}},t.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),s.invoke(this._doInvokeOnCancel,this,e)},t.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},t.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(e,t){t.exports=function(t){var a=e("./util"),r=e("./es5").keys,o=a.tryCatch,n=a.errorObj;return function(l,s,u){return function(p){var e=u._boundValue();predicateLoop:for(var d=0,i;d<l.length;++d)if(i=l[d],i===Error||null!=i&&i.prototype instanceof Error){if(p instanceof i)return o(s).call(e,p);}else if("function"==typeof i){var c=o(i).call(e,p);if(c===n)return c;if(c)return o(s).call(e,p)}else if(a.isObject(p)){for(var g=r(i),h=0,f;h<g.length;++h)if(f=g[h],i[f]!=p[f])continue predicateLoop;return o(s).call(e,p)}return t}}}},{"./es5":13,"./util":36}],8:[function(e,t){t.exports=function(e){function t(){this._trace=new t.CapturedTrace(a())}function a(){var e=o.length-1;return 0<=e?o[e]:void 0}var r=!1,o=[];return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},t.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,o.push(this._trace))},t.prototype._popContext=function(){if(void 0!==this._trace){var e=o.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},t.CapturedTrace=null,t.create=function(){if(r)return new t},t.deactivateLongStackTraces=function(){},t.activateLongStackTraces=function(){var o=e.prototype._pushContext,n=e.prototype._popContext,i=e._peekContext,l=e.prototype._peekContext,s=e.prototype._promiseCreated;t.deactivateLongStackTraces=function(){e.prototype._pushContext=o,e.prototype._popContext=n,e._peekContext=i,e.prototype._peekContext=l,e.prototype._promiseCreated=s,r=!1},r=!0,e.prototype._pushContext=t.prototype._pushContext,e.prototype._popContext=t.prototype._popContext,e._peekContext=e.prototype._peekContext=a,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},t}},{}],9:[function(e,t){t.exports=function(t,a){function r(e,t){return{promise:t}}function o(){return!1}function n(e,t,a){var r=this;try{e(t,a,function(e){if("function"!=typeof e)throw new TypeError("onCancel must be a function, got: "+D.toString(e));r._attachCancellationCallback(e)})}catch(t){return t}}function i(e){if(!this._isCancellable())return this;var t=this._onCancel();void 0===t?this._setOnCancel(e):D.isArray(t)?t.push(e):this._setOnCancel([t,e])}function l(){return this._onCancelField}function s(e){this._onCancelField=e}function u(){this._cancellationParent=void 0,this._onCancelField=void 0}function p(e,t){if(0!=(1&t)){this._cancellationParent=e;var a=e._branchesRemainingToCancel;void 0===a&&(a=0),e._branchesRemainingToCancel=a+1}0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}function d(){var e=this._boundTo;return void 0!==e&&e instanceof t?e.isFulfilled()?e.value():void 0:e}function c(){this._trace=new C(this._peekContext())}function g(e,t){if(I(e)){var a=this._trace;if(void 0!==a&&t&&(a=a._parent),void 0!==a)a.attachExtraTrace(e);else if(!e.__stackCleaned__){var r=v(e);D.notEnumerableProp(e,"stack",r.message+"\n"+r.stack.join("\n")),D.notEnumerableProp(e,"__stackCleaned__",!0)}}}function h(e,a,r){if(te.warnings){var o=new E(e),n;if(a)r._attachExtraTrace(o);else if(te.longStackTraces&&(n=t._peekContext()))n.attachExtraTrace(o);else{var i=v(o);o.stack=i.message+"\n"+i.stack.join("\n")}K("warning",o)||b(o,"",!0)}}function f(e,t){for(var a=0;a<t.length-1;++a)t[a].push("From previous event:"),t[a]=t[a].join("\n");return a<t.length&&(t[a]=t[a].join("\n")),e+"\n"+t.join("\n")}function m(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}function _(e){for(var t=e[0],a=1;a<e.length;++a){for(var r=e[a],o=t.length-1,n=t[o],i=-1,l=r.length-1;0<=l;--l)if(r[l]===n){i=l;break}for(var l=i,s;0<=l&&(s=r[l],t[o]===s);--l)t.pop(),o--;t=r}}function y(e){for(var t=[],a=0;a<e.length;++a){var r=e[a],o="    (No stack trace)"===r||L.test(r),n=o&&Q(r);o&&!n&&(z&&" "!==r.charAt(0)&&(r="    "+r),t.push(r))}return t}function x(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),a=0,r;a<t.length&&(r=t[a],!("    (No stack trace)"===r||L.test(r)));++a);return 0<a&&"SyntaxError"!=e.name&&(t=t.slice(a)),t}function v(e){var t=e.stack,a=e.toString();return t="string"==typeof t&&0<t.length?x(e):["    (No stack trace)"],{message:a,stack:"SyntaxError"==e.name?t:y(t)}}function b(e,t,a){if("undefined"!=typeof console){var r;if(D.isObject(e)){var o=e.stack;r=t+j(o,e)}else r=t+(e+"");"function"==typeof H?H(r,a):("function"==typeof console.log||"object"===wn(console.log))&&console.log(r)}}function S(e,t,a,r){var o=!1;try{"function"==typeof t&&(o=!0,"rejectionHandled"===e?t(r):t(a,r))}catch(t){M.throwLater(t)}"unhandledRejection"===e?!K(e,a,r)&&!o&&b(a,"Unhandled rejection "):K(e,r)}function P(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{t=e&&"function"==typeof e.toString?e.toString():D.toString(e);var a=/\[object [a-zA-Z0-9$_]+\]/;if(a.test(t))try{var r=JSON.stringify(e);t=r}catch(t){}0===t.length&&(t="(empty array)")}return"(<"+T(t)+">, no stack trace)"}function T(e){var t=41;return e.length<t?e:e.substr(0,t-3)+"..."}function w(){return"function"==typeof ee}function k(e){var t=e.match(J);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}function C(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);ee(this,C),32<t&&this.uncycle()}var F=t._getDomain,M=t._async,E=e("./errors").Warning,D=e("./util"),I=D.canAttachTrace,A=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,R=/\((?:timers\.js):\d+:\d+\)/,O=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,L=null,j=null,z=!1,G=!(0==D.env("BLUEBIRD_DEBUG")||0),U=!!(0!=D.env("BLUEBIRD_WARNINGS")&&(G||D.env("BLUEBIRD_WARNINGS"))),N=!!(0!=D.env("BLUEBIRD_LONG_STACK_TRACES")&&(G||D.env("BLUEBIRD_LONG_STACK_TRACES"))),q=0!=D.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(U||!!D.env("BLUEBIRD_W_FORGOTTEN_RETURN")),B,V,H;t.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=524288|-1048577&e._bitField},t.prototype._ensurePossibleRejectionHandled=function(){if(0==(524288&this._bitField)){this._setRejectionIsUnhandled();var e=this;setTimeout(function(){e._notifyUnhandledRejection()},1)}},t.prototype._notifyUnhandledRejectionIsHandled=function(){S("rejectionHandled",B,void 0,this)},t.prototype._setReturnedNonUndefined=function(){this._bitField|=268435456},t.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),S("unhandledRejection",V,e,this)}},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField|=262144},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField&=-262145},t.prototype._isUnhandledRejectionNotified=function(){return 0<(262144&this._bitField)},t.prototype._setRejectionIsUnhandled=function(){this._bitField|=1048576},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField&=-1048577,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return 0<(1048576&this._bitField)},t.prototype._warn=function(e,t,a){return h(e,t,a||this)},t.onPossiblyUnhandledRejection=function(e){var t=F();V="function"==typeof e?null===t?e:D.domainBind(t,e):void 0},t.onUnhandledRejectionHandled=function(e){var t=F();B="function"==typeof e?null===t?e:D.domainBind(t,e):void 0};var W=function(){};t.longStackTraces=function(){if(M.haveItemsQueued()&&!te.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!te.longStackTraces&&w()){var e=t.prototype._captureStackTrace,r=t.prototype._attachExtraTrace;te.longStackTraces=!0,W=function(){if(M.haveItemsQueued()&&!te.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");t.prototype._captureStackTrace=e,t.prototype._attachExtraTrace=r,a.deactivateLongStackTraces(),M.enableTrampoline(),te.longStackTraces=!1},t.prototype._captureStackTrace=c,t.prototype._attachExtraTrace=g,a.activateLongStackTraces(),M.disableTrampolineIfNecessary()}},t.hasLongStackTraces=function(){return te.longStackTraces&&w()};var X=function(){try{if("function"==typeof CustomEvent){var e=new CustomEvent("CustomEvent");return D.global.dispatchEvent(e),function(e,t){var a=new CustomEvent(e.toLowerCase(),{detail:t,cancelable:!0});return!D.global.dispatchEvent(a)}}if("function"==typeof Event){var e=new Event("CustomEvent");return D.global.dispatchEvent(e),function(e,t){var a=new Event(e.toLowerCase(),{cancelable:!0});return a.detail=t,!D.global.dispatchEvent(a)}}var e=document.createEvent("CustomEvent");return e.initCustomEvent("testingtheevent",!1,!0,{}),D.global.dispatchEvent(e),function(e,t){var a=document.createEvent("CustomEvent");return a.initCustomEvent(e.toLowerCase(),!1,!0,t),!D.global.dispatchEvent(a)}}catch(t){}return function(){return!1}}(),Y=function(){return D.isNode?function(){return process.emit.apply(process,arguments)}:D.global?function(e){var t="on"+e.toLowerCase(),a=D.global[t];return!!a&&(a.apply(D.global,[].slice.call(arguments,1)),!0)}:function(){return!1}}(),$={promiseCreated:r,promiseFulfilled:r,promiseRejected:r,promiseResolved:r,promiseCancelled:r,promiseChained:function(e,t,a){return{promise:t,child:a}},warning:function(e,t){return{warning:t}},unhandledRejection:function(e,t,a){return{reason:t,promise:a}},rejectionHandled:r},K=function(e){var t=!1;try{t=Y.apply(null,arguments)}catch(a){M.throwLater(a),t=!0}var a=!1;try{a=X(e,$[e].apply(null,arguments))}catch(t){M.throwLater(t),a=!0}return a||t};t.config=function(e){if(e=Object(e),"longStackTraces"in e&&(e.longStackTraces?t.longStackTraces():!e.longStackTraces&&t.hasLongStackTraces()&&W()),"warnings"in e){var a=e.warnings;te.warnings=!!a,q=te.warnings,D.isObject(a)&&"wForgottenReturn"in a&&(q=!!a.wForgottenReturn)}if("cancellation"in e&&e.cancellation&&!te.cancellation){if(M.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");t.prototype._clearCancellationData=u,t.prototype._propagateFrom=p,t.prototype._onCancel=l,t.prototype._setOnCancel=s,t.prototype._attachCancellationCallback=i,t.prototype._execute=n,Z=p,te.cancellation=!0}return"monitoring"in e&&(e.monitoring&&!te.monitoring?(te.monitoring=!0,t.prototype._fireEvent=K):!e.monitoring&&te.monitoring&&(te.monitoring=!1,t.prototype._fireEvent=o)),t},t.prototype._fireEvent=o,t.prototype._execute=function(e,t,a){try{e(t,a)}catch(t){return t}},t.prototype._onCancel=function(){},t.prototype._setOnCancel=function(){},t.prototype._attachCancellationCallback=function(){},t.prototype._captureStackTrace=function(){},t.prototype._attachExtraTrace=function(){},t.prototype._clearCancellationData=function(){},t.prototype._propagateFrom=function(){};var Z=function(e,t){0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)},Q=function(){return!1},J=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;D.inherits(C,Error),a.CapturedTrace=C,C.prototype.uncycle=function(){var e=this._length;if(!(2>e)){for(var t=[],a={},r=0,o=this;void 0!==o;++r)t.push(o),o=o._parent;e=this._length=r;for(var r=e-1,n;0<=r;--r)n=t[r].stack,void 0===a[n]&&(a[n]=r);for(var r=0;r<e;++r){var i=t[r].stack,l=a[i];if(void 0!==l&&l!==r){0<l&&(t[l-1]._parent=void 0,t[l-1]._length=1),t[r]._parent=void 0,t[r]._length=1;var s=0<r?t[r-1]:this;l<e-1?(s._parent=t[l+1],s._parent.uncycle(),s._length=s._parent._length+1):(s._parent=void 0,s._length=1);for(var u=s._length+1,p=r-2;0<=p;--p)t[p]._length=u,u++;return}}}},C.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=v(e),a=t.message,r=[t.stack],o=this;void 0!==o;)r.push(y(o.stack.split("\n"))),o=o._parent;_(r),m(r),D.notEnumerableProp(e,"stack",f(a,r)),D.notEnumerableProp(e,"__stackCleaned__",!0)}};var ee=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():P(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,L=e,j=t;var a=Error.captureStackTrace;return Q=function(e){return A.test(e)},function(e,t){Error.stackTraceLimit+=6,a(e,t),Error.stackTraceLimit-=6}}var r=new Error;if("string"==typeof r.stack&&0<=r.stack.split("\n")[0].indexOf("stackDetection@"))return L=/@/,j=t,z=!0,function(e){e.stack=new Error().stack};var o;try{throw new Error}catch(t){o="stack"in t}return!("stack"in r)&&o&&"number"==typeof Error.stackTraceLimit?(L=e,j=t,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(a){t.stack=a.stack}Error.stackTraceLimit-=6}):(j=function(e,t){return"string"==typeof e?e:("object"===("undefined"==typeof t?"undefined":wn(t))||"function"==typeof t)&&void 0!==t.name&&void 0!==t.message?t.toString():P(t)},null)}([]);"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(H=function(e){console.warn(e)},D.isNode&&process.stderr.isTTY?H=function(e,t){var a=t?"\x1B[33m":"\x1B[31m";console.warn(a+e+"\x1B[0m\n")}:!D.isNode&&"string"==typeof new Error().stack&&(H=function(e,t){console.warn("%c"+e,t?"color: darkorange":"color: red")}));var te={warnings:U,longStackTraces:!1,cancellation:!1,monitoring:!1};return N&&t.longStackTraces(),{longStackTraces:function(){return te.longStackTraces},warnings:function(){return te.warnings},cancellation:function(){return te.cancellation},monitoring:function(){return te.monitoring},propagateFromFunction:function(){return Z},boundValueFunction:function(){return d},checkForgottenReturns:function(e,t,a,r,o){if(void 0===e&&null!==t&&q){if(void 0!==o&&o._returnedNonUndefined())return;if(0==(65535&r._bitField))return;a&&(a+=" ");var n="",l="";if(t._trace){for(var s=t._trace.stack.split("\n"),u=y(s),p=u.length-1,i;0<=p;--p)if(i=u[p],!R.test(i)){var d=i.match(O);d&&(n="at "+d[1]+":"+d[2]+":"+d[3]+" ");break}if(0<u.length)for(var c=u[0],p=0;p<s.length;++p)if(s[p]===c){0<p&&(l="\n"+s[p-1]);break}}var g="a promise was created in a "+a+"handler "+n+"but was not returned from it, see http://goo.gl/rRqMUw"+l;r._warn(g,!0,t)}},setBounds:function(e,t){if(w()){for(var a=e.stack.split("\n"),r=t.stack.split("\n"),o=-1,n=-1,l=0,i,s,u;l<a.length;++l)if(u=k(a[l]),u){i=u.fileName,o=u.line;break}for(var l=0,u;l<r.length;++l)if(u=k(r[l]),u){s=u.fileName,n=u.line;break}0>o||0>n||!i||!s||i!==s||o>=n||(Q=function(e){if(A.test(e))return!0;var t=k(e);return t&&t.fileName===i&&o<=t.line&&t.line<=n})}},warn:h,deprecated:function(e,t){var a=e+" is deprecated and will be removed in a future version.";return t&&(a+=" Use "+t+" instead."),h(a)},CapturedTrace:C,fireDomEvent:X,fireGlobalEvent:Y}}},{"./errors":12,"./util":36}],10:[function(e,t){t.exports=function(e){function t(){return this.value}function a(){throw this.reason}e.prototype["return"]=e.prototype.thenReturn=function(a){return a instanceof e&&a.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:a},void 0)},e.prototype["throw"]=e.prototype.thenThrow=function(e){return this._then(a,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(1>=arguments.length)return this._then(void 0,a,void 0,{reason:e},void 0);var t=arguments[1];return this.caught(e,function(){throw t})},e.prototype.catchReturn=function(a){if(1>=arguments.length)return a instanceof e&&a.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:a},void 0);var r=arguments[1];r instanceof e&&r.suppressUnhandledRejections();return this.caught(a,function(){return r})}}},{}],11:[function(e,t){t.exports=function(e,t){function a(){return o(this)}var r=e.reduce,o=e.all;e.prototype.each=function(e){return r(this,e,t,0)._then(a,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(e){return r(this,e,t,t)},e.each=function(e,o){return r(e,o,t,0)._then(a,void 0,void 0,e,void 0)},e.mapSeries=function(e,a){return r(e,a,t,t)}}},{}],12:[function(e,t){function a(e,t){function a(r){return this instanceof a?void(u(this,"message","string"==typeof r?r:t),u(this,"name",e),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)):new a(r)}return s(a,Error),a}function r(e){return this instanceof r?void(u(this,"name","OperationalError"),u(this,"message",e),this.cause=e,this.isOperational=!0,e instanceof Error?(u(this,"message",e.message),u(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)):new r(e)}var o=e("./es5"),n=o.freeze,l=e("./util"),s=l.inherits,u=l.notEnumerableProp,p=a("Warning","warning"),d=a("CancellationError","cancellation error"),c=a("TimeoutError","timeout error"),g=a("AggregateError","aggregate error"),h,f;try{h=TypeError,f=RangeError}catch(t){h=a("TypeError","type error"),f=a("RangeError","range error")}for(var m="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),_=0;_<m.length;++_)"function"==typeof Array.prototype[m[_]]&&(g.prototype[m[_]]=Array.prototype[m[_]]);o.defineProperty(g.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),g.prototype.isOperational=!0;var y=0;g.prototype.toString=function(){var e=Array(4*y+1).join(" "),t="\n"+e+"AggregateError of:\n";y++,e=Array(4*y+1).join(" ");for(var a=0;a<this.length;++a){for(var r=this[a]===this?"[Circular AggregateError]":this[a]+"",o=r.split("\n"),n=0;n<o.length;++n)o[n]=e+o[n];r=o.join("\n"),t+=r+"\n"}return y--,t},s(r,Error);var i=Error.__BluebirdErrorTypes__;i||(i=n({CancellationError:d,TimeoutError:c,OperationalError:r,RejectionError:r,AggregateError:g}),o.defineProperty(Error,"__BluebirdErrorTypes__",{value:i,writable:!1,enumerable:!1,configurable:!1})),t.exports={Error:Error,TypeError:h,RangeError:f,CancellationError:i.CancellationError,OperationalError:i.OperationalError,TimeoutError:i.TimeoutError,AggregateError:i.AggregateError,Warning:p}},{"./es5":13,"./util":36}],13:[function(e,t){var a=function(){return this===void 0}();if(a)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:a,propertyIsWritable:function(e,t){var a=Object.getOwnPropertyDescriptor(e,t);return!!(!a||a.writable||a.set)}};else{var r={}.hasOwnProperty,o={}.toString,n={}.constructor.prototype,i=function(e){var t=[];for(var a in e)r.call(e,a)&&t.push(a);return t},l=function(e,t){return{value:e[t]}},s=function(e,t,a){return e[t]=a.value,e},u=function(e){return e},p=function(e){try{return Object(e).constructor.prototype}catch(t){return n}},d=function(e){try{return"[object Array]"===o.call(e)}catch(t){return!1}};t.exports={isArray:d,keys:i,names:i,defineProperty:s,getDescriptor:l,freeze:u,getPrototypeOf:p,isES5:a,propertyIsWritable:function(){return!0}}}},{}],14:[function(e,t){t.exports=function(e,t){var a=e.map;e.prototype.filter=function(e,r){return a(this,e,r,t)},e.filter=function(e,r,o){return a(e,r,o,t)}}},{}],15:[function(e,t){t.exports=function(t,a,r){function o(e,t,a){this.promise=e,this.type=t,this.handler=a,this.called=!1,this.cancelPromise=null}function n(e){this.finallyHandler=e}function i(e,t){return null!=e.cancelPromise&&(1<arguments.length?e.cancelPromise._reject(t):e.cancelPromise._cancel(),e.cancelPromise=null,!0)}function l(){return u.call(this,this.promise._target()._settledValue())}function s(e){if(!i(this,e))return c.e=e,c}function u(e){var o=this.promise,u=this.handler;if(!this.called){this.called=!0;var p=this.isFinallyHandler()?u.call(o._boundValue()):u.call(o._boundValue(),e);if(p===r)return p;if(void 0!==p){o._setReturnedNonUndefined();var g=a(p,o);if(g instanceof t){if(null!=this.cancelPromise){if(g._isCancelled()){var h=new d("late cancellation observer");return o._attachExtraTrace(h),c.e=h,c}g.isPending()&&g._attachCancellationCallback(new n(this))}return g._then(l,s,void 0,this,void 0)}}}return o.isRejected()?(i(this),c.e=e,c):(i(this),e)}var p=e("./util"),d=t.CancellationError,c=p.errorObj,g=e("./catch_filter")(r);return o.prototype.isFinallyHandler=function(){return 0===this.type},n.prototype._resultCancelled=function(){i(this.finallyHandler)},t.prototype._passThrough=function(e,t,a,r){return"function"==typeof e?this._then(a,r,void 0,new o(this,t,e),void 0):this.then()},t.prototype.lastly=t.prototype["finally"]=function(e){return this._passThrough(e,0,u,u)},t.prototype.tap=function(e){return this._passThrough(e,1,u)},t.prototype.tapCatch=function(e){var a=arguments.length;if(1===a)return this._passThrough(e,1,void 0,u);var r=Array(a-1),o=0,n;for(n=0;n<a-1;++n){var i=arguments[n];if(p.isObject(i))r[o++]=i;else return t.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+p.classString(i)))}r.length=o;var l=arguments[n];return this._passThrough(g(r,l,this),1,void 0,u)},o}},{"./catch_filter":7,"./util":36}],16:[function(e,t){t.exports=function(t,a,r,o,n,i){function l(e,a,r){for(var n=0;n<a.length;++n){r._pushContext();var i=g(a[n])(e);if(r._popContext(),i===c){r._pushContext();var l=t.reject(c.e);return r._popContext(),l}var s=o(i,r);if(s instanceof t)return s}return null}function s(e,a,o,n){if(i.cancellation()){var l=new t(r),s=this._finallyPromise=new t(r);this._promise=l.lastly(function(){return s}),l._captureStackTrace(),l._setOnCancel(this)}else{var u=this._promise=new t(r);u._captureStackTrace()}this._stack=n,this._generatorFunction=e,this._receiver=a,this._generator=void 0,this._yieldHandlers="function"==typeof o?[o].concat(h):h,this._yieldedPromise=null,this._cancellationPhase=!1}var u=e("./errors"),p=u.TypeError,d=e("./util"),c=d.errorObj,g=d.tryCatch,h=[];d.inherits(s,n),s.prototype._isResolved=function(){return null===this._promise},s.prototype._cleanup=function(){this._promise=this._generator=null,i.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},s.prototype._promiseCancelled=function(){if(!this._isResolved()){var e="undefined"!=typeof this._generator["return"],a;if(!e){var r=new t.CancellationError("generator .return() sentinel");t.coroutine.returnSentinel=r,this._promise._attachExtraTrace(r),this._promise._pushContext(),a=g(this._generator["throw"]).call(this._generator,r),this._promise._popContext()}else this._promise._pushContext(),a=g(this._generator["return"]).call(this._generator,void 0),this._promise._popContext();this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(a)}},s.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var t=g(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},s.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var t=g(this._generator["throw"]).call(this._generator,e);this._promise._popContext(),this._continue(t)},s.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof t){var e=this._yieldedPromise;this._yieldedPromise=null,e.cancel()}},s.prototype.promise=function(){return this._promise},s.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},s.prototype._continue=function(e){var a=this._promise;if(e===c)return this._cleanup(),this._cancellationPhase?a.cancel():a._rejectCallback(e.e,!1);var r=e.value;if(!0===e.done)return this._cleanup(),this._cancellationPhase?a.cancel():a._resolveCallback(r);var n=o(r,this._promise);if(!(n instanceof t)&&(n=l(n,this._yieldHandlers,this._promise),null===n))return void this._promiseRejected(new p("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",r+"")+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));n=n._target();var i=n._bitField;0==(50397184&i)?(this._yieldedPromise=n,n._proxy(this,null)):0==(33554432&i)?0==(16777216&i)?this._promiseCancelled():t._async.invoke(this._promiseRejected,this,n._reason()):t._async.invoke(this._promiseFulfilled,this,n._value())},t.coroutine=function(e,t){if("function"!=typeof e)throw new p("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var a=Object(t).yieldHandler,r=new Error().stack;return function(){var t=e.apply(this,arguments),o=new s(void 0,void 0,a,r),n=o.promise();return o._generator=t,o._promiseFulfilled(void 0),n}},t.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new p("expecting a function but got "+d.classString(e));h.push(e)},t.spawn=function(e){if(i.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof e)return a("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=new s(e,this),o=r.promise();return r._run(t.spawn),o}}},{"./errors":12,"./util":36}],17:[function(e,t){t.exports=function(t,a){var r=e("./util"),o=r.canEvaluate,n=r.tryCatch,i=r.errorObj;t.join=function(){var e=arguments.length-1,t;if(0<e&&"function"==typeof arguments[e]){t=arguments[e];var r}var o=[].slice.call(arguments);t&&o.pop();var r=new a(o).promise();return t===void 0?r:r.spread(t)}}},{"./util":36}],18:[function(e,t){t.exports=function(t,a,r,o,n,i){function l(e,t,a,r){this.constructor$(e),this._promise._captureStackTrace();var o=u();this._callback=null===o?t:p.domainBind(o,t),this._preservedValues=r===n?Array(this.length()):null,this._limit=a,this._inFlight=0,this._queue=[],g.invoke(this._asyncInit,this,void 0)}function s(e,a,o,n){if("function"!=typeof a)return r("expecting a function but got "+p.classString(a));var i=0;if(void 0!==o)if("object"===("undefined"==typeof o?"undefined":wn(o))&&null!==o){if("number"!=typeof o.concurrency)return t.reject(new TypeError("'concurrency' must be a number but it is "+p.classString(o.concurrency)));i=o.concurrency}else return t.reject(new TypeError("options argument must be an object but it is "+p.classString(o)));return i="number"==typeof i&&isFinite(i)&&1<=i?i:0,new l(e,a,i,n).promise()}var u=t._getDomain,p=e("./util"),d=p.tryCatch,c=p.errorObj,g=t._async;p.inherits(l,a),l.prototype._asyncInit=function(){this._init$(void 0,-2)},l.prototype._init=function(){},l.prototype._promiseFulfilled=function(e,a){var r=this._values,n=this.length(),l=this._preservedValues,s=this._limit;if(!(0>a)){if(1<=s&&this._inFlight>=s)return r[a]=e,this._queue.push(a),!1;null!==l&&(l[a]=e);var u=this._promise,p=this._callback,g=u._boundValue();u._pushContext();var h=d(p).call(g,e,a,n),f=u._popContext();if(i.checkForgottenReturns(h,f,null===l?"Promise.map":"Promise.filter",u),h===c)return this._reject(h.e),!0;var m=o(h,this._promise);if(m instanceof t){m=m._target();var _=m._bitField;if(0==(50397184&_))return 1<=s&&this._inFlight++,r[a]=m,m._proxy(this,-1*(a+1)),!1;if(0!=(33554432&_))h=m._value();else return 0==(16777216&_)?(this._cancel(),!0):(this._reject(m._reason()),!0)}r[a]=h}else if(a=-1*a-1,r[a]=e,1<=s&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0;var y=++this._totalResolved;return!!(y>=n)&&(null===l?this._resolve(r):this._filter(r,l),!0)},l.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,a=this._values;0<e.length&&this._inFlight<t;){if(this._isResolved())return;var r=e.pop();this._promiseFulfilled(a[r],r)}},l.prototype._filter=function(e,t){for(var a=t.length,r=Array(a),o=0,n=0;n<a;++n)e[n]&&(r[o++]=t[n]);r.length=o,this._resolve(r)},l.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(e,t){return s(this,e,t,null)},t.map=function(e,t,a,r){return s(e,t,a,r)}}},{"./util":36}],19:[function(e,t){t.exports=function(t,a,r,o,n){var i=e("./util"),l=i.tryCatch;t.method=function(e){if("function"!=typeof e)throw new t.TypeError("expecting a function but got "+i.classString(e));return function(){var r=new t(a);r._captureStackTrace(),r._pushContext();var o=l(e).apply(this,arguments),i=r._popContext();return n.checkForgottenReturns(o,i,"Promise.method",r),r._resolveFromSyncValue(o),r}},t.attempt=t["try"]=function(e){if("function"!=typeof e)return o("expecting a function but got "+i.classString(e));var r=new t(a);r._captureStackTrace(),r._pushContext();var s;if(1<arguments.length){n.deprecated("calling Promise.try with more than 1 argument");var u=arguments[1],p=arguments[2];s=i.isArray(u)?l(e).apply(p,u):l(e).call(p,u)}else s=l(e)();var d=r._popContext();return n.checkForgottenReturns(s,d,"Promise.try",r),r._resolveFromSyncValue(s),r},t.prototype._resolveFromSyncValue=function(e){e===i.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}},{"./util":36}],20:[function(e,t){function a(e){return e instanceof Error&&s.getPrototypeOf(e)===Error.prototype}function r(e){var t;if(a(e)){t=new l(e),t.name=e.name,t.message=e.message,t.stack=e.stack;for(var r=s.keys(e),n=0,i;n<r.length;++n)i=r[n],u.test(i)||(t[i]=e[i]);return t}return o.markAsOriginatingFromRejection(e),e}var o=e("./util"),n=o.maybeWrapAsError,i=e("./errors"),l=i.OperationalError,s=e("./es5"),u=/^(?:name|message|stack|cause)$/;t.exports=function(e,t){return function(a,o){if(null!==e){if(a){var i=r(n(a));e._attachExtraTrace(i),e._reject(i)}else if(!t)e._fulfill(o);else{var l=[].slice.call(arguments,1);e._fulfill(l)}e=null}}}},{"./errors":12,"./es5":13,"./util":36}],21:[function(e,t){t.exports=function(t){function a(e,t){var a=this;if(!n.isArray(e))return r.call(a,e,t);var o=l(t).apply(a._boundValue(),[null].concat(e));o===s&&i.throwLater(o.e)}function r(e,t){var a=this,r=a._boundValue(),o=e===void 0?l(t).call(r,null):l(t).call(r,null,e);o===s&&i.throwLater(o.e)}function o(e,t){var a=this;if(!e){var r=new Error(e+"");r.cause=e,e=r}var o=l(t).call(a._boundValue(),e);o===s&&i.throwLater(o.e)}var n=e("./util"),i=t._async,l=n.tryCatch,s=n.errorObj;t.prototype.asCallback=t.prototype.nodeify=function(e,t){if("function"==typeof e){var n=r;t!==void 0&&Object(t).spread&&(n=a),this._then(n,o,void 0,this,e)}return this}}},{"./util":36}],22:[function(e,t){t.exports=function(){function a(){}function r(e,t){if(null==e||e.constructor!==o)throw new y("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof t)throw new y("expecting a function but got "+c.classString(t))}function o(e){e!==v&&r(this,e),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(e),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function n(e){this.promise._resolveCallback(e)}function i(e){this.promise._rejectCallback(e,!1)}function l(e){var t=new o(v);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}var s=function(){return new y("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},u=function(){return new o.PromiseInspection(this._target())},p=function(e){return o.reject(new y(e))},d={},c=e("./util"),g;g=c.isNode?function(){var e=process.domain;return void 0===e&&(e=null),e}:function(){return null},c.notEnumerableProp(o,"_getDomain",g);var h=e("./es5"),f=e("./async"),m=new f;h.defineProperty(o,"_async",{value:m});var _=e("./errors"),y=o.TypeError=_.TypeError;o.RangeError=_.RangeError;var x=o.CancellationError=_.CancellationError;o.TimeoutError=_.TimeoutError,o.OperationalError=_.OperationalError,o.RejectionError=_.OperationalError,o.AggregateError=_.AggregateError;var v=function(){},b={},S={},P=e("./thenables")(o,v),T=e("./promise_array")(o,v,P,p,a),w=e("./context")(o),k=w.create,C=e("./debuggability")(o,w),F=C.CapturedTrace,M=e("./finally")(o,P,S),E=e("./catch_filter")(S),D=e("./nodeback"),I=c.errorObj,A=c.tryCatch;return o.prototype.toString=function(){return"[object Promise]"},o.prototype.caught=o.prototype["catch"]=function(e){var t=arguments.length;if(1<t){var a=Array(t-1),r=0,o;for(o=0;o<t-1;++o){var n=arguments[o];if(c.isObject(n))a[r++]=n;else return p("Catch statement predicate: expecting an object but got "+c.classString(n))}return a.length=r,e=arguments[o],this.then(void 0,E(a,e,this))}return this.then(void 0,e)},o.prototype.reflect=function(){return this._then(u,u,void 0,this,void 0)},o.prototype.then=function(e,t){if(C.warnings()&&0<arguments.length&&"function"!=typeof e&&"function"!=typeof t){var a=".then() only accepts functions but was passed: "+c.classString(e);1<arguments.length&&(a+=", "+c.classString(t)),this._warn(a)}return this._then(e,t,void 0,void 0,void 0)},o.prototype.done=function(e,t){var a=this._then(e,t,void 0,void 0,void 0);a._setIsFinal()},o.prototype.spread=function(e){return"function"==typeof e?this.all()._then(e,void 0,void 0,b,void 0):p("expecting a function but got "+c.classString(e))},o.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},o.prototype.all=function(){return 0<arguments.length&&this._warn(".all() was passed arguments but it does not take any"),new T(this).promise()},o.prototype.error=function(e){return this.caught(c.originatesFromRejection,e)},o.getNewLibraryCopy=t.exports,o.is=function(e){return e instanceof o},o.fromNode=o.fromCallback=function(e){var t=new o(v);t._captureStackTrace();var a=!!(1<arguments.length)&&!!Object(arguments[1]).multiArgs,r=A(e)(D(t,a));return r===I&&t._rejectCallback(r.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},o.all=function(e){return new T(e).promise()},o.cast=function(e){var t=P(e);return t instanceof o||(t=new o(v),t._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},o.resolve=o.fulfilled=o.cast,o.reject=o.rejected=function(e){var t=new o(v);return t._captureStackTrace(),t._rejectCallback(e,!0),t},o.setScheduler=function(e){if("function"!=typeof e)throw new y("expecting a function but got "+c.classString(e));return m.setScheduler(e)},o.prototype._then=function(e,t,a,r,n){var i=void 0!==n,l=i?n:new o(v),s=this._target(),u=s._bitField;i||(l._propagateFrom(this,3),l._captureStackTrace(),void 0===r&&0!=(2097152&this._bitField)&&(0==(50397184&u)?r=s===this?void 0:this._boundTo:r=this._boundValue()),this._fireEvent("promiseChained",this,l));var p=g();if(0!=(50397184&u)){var d=s._settlePromiseCtx,h,f;0==(33554432&u)?0==(16777216&u)?(d=s._settlePromiseLateCancellationObserver,f=new x("late cancellation observer"),s._attachExtraTrace(f),h=t):(f=s._fulfillmentHandler0,h=t,s._unsetRejectionIsUnhandled()):(f=s._rejectionHandler0,h=e),m.invoke(d,s,{handler:null===p?h:"function"==typeof h&&c.domainBind(p,h),promise:l,receiver:r,value:f})}else s._addCallbacks(e,t,l,r,p);return l},o.prototype._length=function(){return 65535&this._bitField},o.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},o.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},o.prototype._setLength=function(e){this._bitField=-65536&this._bitField|65535&e},o.prototype._setFulfilled=function(){this._bitField|=33554432,this._fireEvent("promiseFulfilled",this)},o.prototype._setRejected=function(){this._bitField|=16777216,this._fireEvent("promiseRejected",this)},o.prototype._setFollowing=function(){this._bitField|=67108864,this._fireEvent("promiseResolved",this)},o.prototype._setIsFinal=function(){this._bitField|=4194304},o.prototype._isFinal=function(){return 0<(4194304&this._bitField)},o.prototype._unsetCancelled=function(){this._bitField&=-65537},o.prototype._setCancelled=function(){this._bitField|=65536,this._fireEvent("promiseCancelled",this)},o.prototype._setWillBeCancelled=function(){this._bitField|=8388608},o.prototype._setAsyncGuaranteed=function(){m.hasCustomScheduler()||(this._bitField|=134217728)},o.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];if(t!==d)return void 0===t&&this._isBound()?this._boundValue():t},o.prototype._promiseAt=function(e){return this[4*e-4+2]},o.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},o.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},o.prototype._boundValue=function(){},o.prototype._migrateCallback0=function(e){var t=e._bitField,a=e._fulfillmentHandler0,r=e._rejectionHandler0,o=e._promise0,n=e._receiverAt(0);void 0===n&&(n=d),this._addCallbacks(a,r,o,n,null)},o.prototype._migrateCallbackAt=function(e,t){var a=e._fulfillmentHandlerAt(t),r=e._rejectionHandlerAt(t),o=e._promiseAt(t),n=e._receiverAt(t);void 0===n&&(n=d),this._addCallbacks(a,r,o,n,null)},o.prototype._addCallbacks=function(e,t,a,r,o){var n=this._length();if(65531<=n&&(n=0,this._setLength(0)),0===n)this._promise0=a,this._receiver0=r,"function"==typeof e&&(this._fulfillmentHandler0=null===o?e:c.domainBind(o,e)),"function"==typeof t&&(this._rejectionHandler0=null===o?t:c.domainBind(o,t));else{var i=4*n-4;this[i+2]=a,this[i+3]=r,"function"==typeof e&&(this[i+0]=null===o?e:c.domainBind(o,e)),"function"==typeof t&&(this[i+1]=null===o?t:c.domainBind(o,t))}return this._setLength(n+1),n},o.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},o.prototype._resolveCallback=function(e,t){if(0==(117506048&this._bitField)){if(e===this)return this._rejectCallback(s(),!1);var a=P(e,this);if(!(a instanceof o))return this._fulfill(e);t&&this._propagateFrom(a,2);var r=a._target();if(r===this)return void this._reject(s());var n=r._bitField;if(0==(50397184&n)){var l=this._length();0<l&&r._migrateCallback0(this);for(var u=1;u<l;++u)r._migrateCallbackAt(this,u);this._setFollowing(),this._setLength(0),this._setFollowee(r)}else if(0!=(33554432&n))this._fulfill(r._value());else if(0!=(16777216&n))this._reject(r._reason());else{var i=new x("late cancellation observer");r._attachExtraTrace(i),this._reject(i)}}},o.prototype._rejectCallback=function(e,t,a){var r=c.ensureErrorObject(e),o=r===e;if(!o&&!a&&C.warnings()){var n="a promise was rejected with a non-error: "+c.classString(e);this._warn(n,!0)}this._attachExtraTrace(r,!!t&&o),this._reject(e)},o.prototype._resolveFromExecutor=function(e){if(e!==v){var t=this;this._captureStackTrace(),this._pushContext();var a=!0,o=this._execute(e,function(e){t._resolveCallback(e)},function(e){t._rejectCallback(e,a)});a=!1,this._popContext(),void 0!==o&&t._rejectCallback(o,!0)}},o.prototype._settlePromiseFromHandler=function(e,t,a,r){var o=r._bitField;if(0==(65536&o)){r._pushContext();var n;t===b?a&&"number"==typeof a.length?n=A(e).apply(this._boundValue(),a):(n=I,n.e=new y("cannot .spread() a non-array: "+c.classString(a))):n=A(e).call(t,a);var i=r._popContext();o=r._bitField,0!=(65536&o)||(n===S?r._reject(a):n===I?r._rejectCallback(n.e,!1):(C.checkForgottenReturns(n,i,"",r,this),r._resolveCallback(n)))}},o.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},o.prototype._followee=function(){return this._rejectionHandler0},o.prototype._setFollowee=function(e){this._rejectionHandler0=e},o.prototype._settlePromise=function(e,t,r,n){var i=e instanceof o,l=this._bitField,s=0!=(134217728&l);0==(65536&l)?"function"==typeof t?i?(s&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,r,n,e)):t.call(r,n,e):r instanceof a?!r._isResolved()&&(0==(33554432&l)?r._promiseRejected(n,e):r._promiseFulfilled(n,e)):i&&(s&&e._setAsyncGuaranteed(),0==(33554432&l)?e._reject(n):e._fulfill(n)):(i&&e._invokeInternalOnCancel(),r instanceof M&&r.isFinallyHandler()?(r.cancelPromise=e,A(t).call(r,n)===I&&e._reject(I.e)):t===u?e._fulfill(u.call(r)):r instanceof a?r._promiseCancelled(e):i||e instanceof T?e._cancel():r.cancel())},o.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,a=e.promise,r=e.receiver,n=e.value;"function"==typeof t?a instanceof o?this._settlePromiseFromHandler(t,r,n,a):t.call(r,n,a):a instanceof o&&a._reject(n)},o.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},o.prototype._settlePromise0=function(e,t){var a=this._promise0,r=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(a,e,r,t)},o.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},o.prototype._fulfill=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(e===this){var a=s();return this._attachExtraTrace(a),this._reject(a)}this._setFulfilled(),this._rejectionHandler0=e,0<(65535&t)&&(0==(134217728&t)?m.settlePromises(this):this._settlePromises())}},o.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16))return this._setRejected(),this._fulfillmentHandler0=e,this._isFinal()?m.fatalError(e,c.isNode):void(0<(65535&t)?m.settlePromises(this):this._ensurePossibleRejectionHandled())},o.prototype._fulfillPromises=function(e,t){for(var a=1;a<e;a++){var r=this._fulfillmentHandlerAt(a),o=this._promiseAt(a),n=this._receiverAt(a);this._clearCallbackDataAtIndex(a),this._settlePromise(o,r,n,t)}},o.prototype._rejectPromises=function(e,t){for(var a=1;a<e;a++){var r=this._rejectionHandlerAt(a),o=this._promiseAt(a),n=this._receiverAt(a);this._clearCallbackDataAtIndex(a),this._settlePromise(o,r,n,t)}},o.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(0<t){if(0!=(16842752&e)){var a=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,a,e),this._rejectPromises(t,a)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,e),this._fulfillPromises(t,r)}this._setLength(0)}this._clearCancellationData()},o.prototype._settledValue=function(){var e=this._bitField;return 0==(33554432&e)?0==(16777216&e)?void 0:this._fulfillmentHandler0:this._rejectionHandler0},o.defer=o.pending=function(){C.deprecated("Promise.defer","new Promise");var e=new o(v);return{promise:e,resolve:n,reject:i}},c.notEnumerableProp(o,"_makeSelfResolutionError",s),e("./method")(o,v,P,p,C),e("./bind")(o,v,P,C),e("./cancel")(o,T,p,C),e("./direct_resolve")(o),e("./synchronous_inspection")(o),e("./join")(o,T,P,v,m,g),o.Promise=o,o.version="3.5.1",e("./map.js")(o,T,p,P,v,C),e("./call_get.js")(o),e("./using.js")(o,p,P,k,v,C),e("./timers.js")(o,v,C),e("./generators.js")(o,p,v,P,a,C),e("./nodeify.js")(o),e("./promisify.js")(o,v),e("./props.js")(o,T,P,p),e("./race.js")(o,v,P,p),e("./reduce.js")(o,T,p,P,v,C),e("./settle.js")(o,T,C),e("./some.js")(o,T,p),e("./filter.js")(o,v),e("./each.js")(o,v),e("./any.js")(o),c.toFastProperties(o),c.toFastProperties(o.prototype),l({a:1}),l({b:2}),l({c:3}),l(1),l(function(){}),l(void 0),l(!1),l(new o(v)),C.setBounds(f.firstLineError,c.lastLineError),o}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36}],23:[function(e,t){t.exports=function(t,a,r,o,n){function i(e){return-2===e?[]:-3===e?{}:-6===e?new Map:void 0}function l(e){var r=this._promise=new t(a);e instanceof t&&r._propagateFrom(e,3),r._setOnCancel(this),this._values=e,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var s=e("./util"),u=s.isArray;return s.inherits(l,n),l.prototype.length=function(){return this._length},l.prototype.promise=function(){return this._promise},l.prototype._init=function e(a,n){var l=r(this._values,this._promise);if(l instanceof t){l=l._target();var u=l._bitField;if(this._values=l,0==(50397184&u))return this._promise._setAsyncGuaranteed(),l._then(e,this._reject,void 0,this,n);if(0!=(33554432&u))l=l._value();else return 0==(16777216&u)?this._cancel():this._reject(l._reason())}if(l=s.asArray(l),null===l){var p=o("expecting an array or an iterable object but got "+s.classString(l)).reason();return void this._promise._rejectCallback(p,!1)}return 0===l.length?void(-5===n?this._resolveEmptyArray():this._resolve(i(n))):void this._iterate(l)},l.prototype._iterate=function(e){var a=this.getActualLength(e.length);this._length=a,this._values=this.shouldCopyValues()?Array(a):this._values;for(var o=this._promise,n=!1,l=null,s=0,i;s<a;++s)i=r(e[s],o),i instanceof t?(i=i._target(),l=i._bitField):l=null,n?null!==l&&i.suppressUnhandledRejections():null===l?n=this._promiseFulfilled(i,s):0==(50397184&l)?(i._proxy(this,s),this._values[s]=i):0==(33554432&l)?0==(16777216&l)?n=this._promiseCancelled(s):n=this._promiseRejected(i._reason(),s):n=this._promiseFulfilled(i._value(),s);n||o._setAsyncGuaranteed()},l.prototype._isResolved=function(){return null===this._values},l.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},l.prototype._cancel=function(){this._isResolved()||!this._promise._isCancellable()||(this._values=null,this._promise._cancel())},l.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},l.prototype._promiseFulfilled=function(e,t){this._values[t]=e;var a=++this._totalResolved;return!!(a>=this._length)&&(this._resolve(this._values),!0)},l.prototype._promiseCancelled=function(){return this._cancel(),!0},l.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},l.prototype._resultCancelled=function(){if(!this._isResolved()){var e=this._values;if(this._cancel(),e instanceof t)e.cancel();else for(var a=0;a<e.length;++a)e[a]instanceof t&&e[a].cancel()}},l.prototype.shouldCopyValues=function(){return!0},l.prototype.getActualLength=function(e){return e},l}},{"./util":36}],24:[function(e,t){t.exports=function(t,a){function r(e){return!y.test(e)}function o(e){try{return!0===e.__isPromisified__}catch(t){return!1}}function n(e,t,a){var r=d.getDataPropertyOrDefault(e,t+a,_);return!!r&&o(r)}function l(e,t,a){for(var r=0,o;r<e.length;r+=2)if(o=e[r],a.test(o))for(var n=o.replace(a,""),i=0;i<e.length;i+=2)if(e[i]===n)throw new m("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",t))}function s(e,t,a,r){for(var s=d.inheritedDataKeys(e),u=[],p=0;p<s.length;++p){var i=s[p],c=e[i],g=r===x||x(i,c,e);"function"!=typeof c||o(c)||n(e,i,t)||!r(i,c,e,g)||u.push(i,c)}return l(u,t,a),u}function u(e,t,a,r,o){for(var n=new RegExp(v(t)+"$"),l=s(e,t,n,a),u=0,i=l.length;u<i;u+=2){var c=l[u],g=l[u+1],h=c+t;if(r===b)e[h]=b(c,p,c,g,t,o);else{var f=r(g,function(){return b(c,p,c,g,t,o)});d.notEnumerableProp(f,"__isPromisified__",!0),e[h]=f}}return d.toFastProperties(e),e}function i(e,t,a){return b(e,t,void 0,e,null,a)}var p={},d=e("./util"),c=e("./nodeback"),g=d.withAppended,h=d.maybeWrapAsError,f=d.canEvaluate,m=e("./errors").TypeError,_={__isPromisified__:!0},y=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),x=function(e){return d.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e},v=function(e){return e.replace(/([$])/,"\\$")},b=f?S:function(e,r,o,n,i,l){function s(){var o=r;r===p&&(o=this);var n=new t(a);n._captureStackTrace();var i="string"==typeof f&&this!==u?this[f]:e,s=c(n,l);try{i.apply(o,g(arguments,s))}catch(t){n._rejectCallback(h(t),!0,!0)}return n._isFateSealed()||n._setAsyncGuaranteed(),n}var u=function(){return this}(),f=e;return"string"==typeof f&&(e=n),d.notEnumerableProp(s,"__isPromisified__",!0),s},S;t.promisify=function(e,t){if("function"!=typeof e)throw new m("expecting a function but got "+d.classString(e));if(o(e))return e;t=Object(t);var a=void 0===t.context?p:t.context,n=!!t.multiArgs,l=i(e,a,n);return d.copyDescriptors(e,l,r),l},t.promisifyAll=function(e,t){if("function"!=typeof e&&"object"!==("undefined"==typeof e?"undefined":wn(e)))throw new m("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");t=Object(t);var a=!!t.multiArgs,r=t.suffix;"string"!=typeof r&&(r="Async");var o=t.filter;"function"!=typeof o&&(o=x);var n=t.promisifier;if("function"!=typeof n&&(n=b),!d.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var l=d.inheritedDataKeys(e),s=0,i;s<l.length;++s)i=e[l[s]],"constructor"!==l[s]&&d.isClass(i)&&(u(i.prototype,r,o,n,a),u(i,r,o,n,a));return u(e,r,o,n,a)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(e,t){t.exports=function(t,a,r,o){function n(e){var t=!1,a;if(p!==void 0&&e instanceof p)a=d(e),t=!0;else{var r=u.keys(e),o=r.length;a=Array(2*o);for(var n=0,i;n<o;++n)i=r[n],a[n]=e[i],a[n+o]=i}this.constructor$(a),this._isMap=t,this._init$(void 0,t?-6:-3)}function i(e){var a=r(e),i;return s(a)?(i=a instanceof t?a._then(t.props,void 0,void 0,void 0,void 0):new n(a).promise(),a instanceof t&&i._propagateFrom(a,2),i):o("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var l=e("./util"),s=l.isObject,u=e("./es5"),p;"function"==typeof Map&&(p=Map);var d=function(){function e(e,r){this[t]=e,this[t+a]=r,t++}var t=0,a=0;return function(r){a=r.size,t=0;var o=Array(2*r.size);return r.forEach(e,o),o}}(),c=function(e){for(var t=new p,a=0|e.length/2,r=0;r<a;++r){var o=e[a+r],n=e[r];t.set(o,n)}return t};l.inherits(n,a),n.prototype._init=function(){},n.prototype._promiseFulfilled=function(e,t){this._values[t]=e;var a=++this._totalResolved;if(a>=this._length){var r;if(this._isMap)r=c(this._values);else{r={};for(var o=this.length(),n=0,i=this.length();n<i;++n)r[this._values[n+o]]=this._values[n]}return this._resolve(r),!0}return!1},n.prototype.shouldCopyValues=function(){return!1},n.prototype.getActualLength=function(e){return e>>1},t.prototype.props=function(){return i(this)},t.props=function(e){return i(e)}}},{"./es5":13,"./util":36}],26:[function(e,t){function a(e,t,a,r,o){for(var n=0;n<o;++n)a[n+r]=e[n+t],e[n+t]=void 0}function r(e){this._capacity=e,this._length=0,this._front=0}r.prototype._willBeOverCapacity=function(e){return this._capacity<e},r.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1);var a=this._front+t&this._capacity-1;this[a]=e,this._length=t+1},r.prototype.push=function(e,t,a){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(e),this._pushOne(t),void this._pushOne(a);var o=this._front+r-3;this._checkCapacity(r);var n=this._capacity-1;this[o+0&n]=e,this[o+1&n]=t,this[o+2&n]=a,this._length=r},r.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},r.prototype.length=function(){return this._length},r.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},r.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var r=this._front,o=this._length;a(this,0,this,t,r+o&t-1)},t.exports=r},{}],27:[function(e,t){t.exports=function(t,a,r,o){function n(e,n){var u=r(e);if(u instanceof t)return s(u);if(e=l.asArray(e),null===e)return o("expecting an array or an iterable object but got "+l.classString(e));var p=new t(a);n!==void 0&&p._propagateFrom(n,3);for(var d=p._fulfill,c=p._reject,g=0,i=e.length,h;g<i;++g)(h=e[g],void 0!==h||g in e)&&t.cast(h)._then(d,c,void 0,p,null);return p}var l=e("./util"),s=function(e){return e.then(function(t){return n(t,e)})};t.race=function(e){return n(e,void 0)},t.prototype.race=function(){return n(this,void 0)}}},{"./util":36}],28:[function(e,t){t.exports=function(t,a,r,o,n,i){function l(e,a,r,o){this.constructor$(e);var i=c();this._fn=null===i?a:g.domainBind(i,a),r!==void 0&&(r=t.resolve(r),r._attachCancellationCallback(this)),this._initialValue=r,this._currentCancellable=null,this._eachValues=o===n?Array(this._length):0===o?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function s(e,t){this.isFulfilled()?t._resolve(e):t._reject(e)}function u(e,t,a,o){if("function"!=typeof t)return r("expecting a function but got "+g.classString(t));var n=new l(e,t,a,o);return n.promise()}function p(e){this.accum=e,this.array._gotAccum(e);var a=o(this.value,this.array._promise);return a instanceof t?(this.array._currentCancellable=a,a._then(d,void 0,void 0,this,void 0)):d.call(this,a)}function d(e){var a=this.array,r=a._promise,o=h(a._fn);r._pushContext();var n;n=void 0===a._eachValues?o.call(r._boundValue(),this.accum,e,this.index,this.length):o.call(r._boundValue(),e,this.index,this.length),n instanceof t&&(a._currentCancellable=n);var l=r._popContext();return i.checkForgottenReturns(n,l,void 0===a._eachValues?"Promise.reduce":"Promise.each",r),n}var c=t._getDomain,g=e("./util"),h=g.tryCatch;g.inherits(l,a),l.prototype._gotAccum=function(e){this._eachValues!==void 0&&null!==this._eachValues&&e!==n&&this._eachValues.push(e)},l.prototype._eachComplete=function(e){return null!==this._eachValues&&this._eachValues.push(e),this._eachValues},l.prototype._init=function(){},l.prototype._resolveEmptyArray=function(){this._resolve(this._eachValues===void 0?this._initialValue:this._eachValues)},l.prototype.shouldCopyValues=function(){return!1},l.prototype._resolve=function(e){this._promise._resolveCallback(e),this._values=null},l.prototype._resultCancelled=function(e){return e===this._initialValue?this._cancel():void(this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof t&&this._currentCancellable.cancel(),this._initialValue instanceof t&&this._initialValue.cancel()))},l.prototype._iterate=function(e){this._values=e;var a=e.length,r,o;if(void 0===this._initialValue?(r=t.resolve(e[0]),o=1):(r=this._initialValue,o=0),this._currentCancellable=r,!r.isRejected())for(;o<a;++o){var n={accum:null,value:e[o],index:o,length:a,array:this};r=r._then(p,void 0,void 0,n,void 0)}void 0!==this._eachValues&&(r=r._then(this._eachComplete,void 0,void 0,this,void 0)),r._then(s,s,void 0,r,this)},t.prototype.reduce=function(e,t){return u(this,e,t,null)},t.reduce=function(e,t,a,r){return u(e,t,a,r)}}},{"./util":36}],29:[function(e,t){var a=e("./util"),r=a.getNativePromise(),o;if(a.isNode&&"undefined"==typeof MutationObserver){var n=_l.setImmediate,i=process.nextTick;o=a.isRecentNode?function(e){n.call(_l,e)}:function(e){i.call(process,e)}}else if("function"==typeof r&&"function"==typeof r.resolve){var l=r.resolve();o=function(e){l.then(e)}}else o="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?"undefined"==typeof setImmediate?"undefined"==typeof setTimeout?function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:function(e){setTimeout(e,0)}:function(e){setImmediate(e)}:function(){var e=document.createElement("div"),t={attributes:!0},a=!1,r=document.createElement("div"),o=new MutationObserver(function(){e.classList.toggle("foo"),a=!1});o.observe(r,t);var n=function(){a||(a=!0,r.classList.toggle("foo"))};return function(a){var r=new MutationObserver(function(){r.disconnect(),a()});r.observe(e,t),n()}}();t.exports=o},{"./util":36}],30:[function(e,t){t.exports=function(t,a,r){function o(e){this.constructor$(e)}var n=t.PromiseInspection,i=e("./util");i.inherits(o,a),o.prototype._promiseResolved=function(e,t){this._values[e]=t;var a=++this._totalResolved;return!!(a>=this._length)&&(this._resolve(this._values),!0)},o.prototype._promiseFulfilled=function(e,t){var a=new n;return a._bitField=33554432,a._settledValueField=e,this._promiseResolved(t,a)},o.prototype._promiseRejected=function(e,t){var a=new n;return a._bitField=16777216,a._settledValueField=e,this._promiseResolved(t,a)},t.settle=function(e){return r.deprecated(".settle()",".reflect()"),new o(e).promise()},t.prototype.settle=function(){return t.settle(this)}}},{"./util":36}],31:[function(e,t){t.exports=function(t,a,r){function o(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function n(e,t){if((0|t)!==t||0>t)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var a=new o(e),n=a.promise();return a.setHowMany(t),a.init(),n}var i=e("./util"),l=e("./errors").RangeError,s=e("./errors").AggregateError,u=i.isArray,p={};i.inherits(o,a),o.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var e=u(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},o.prototype.init=function(){this._initialized=!0,this._init()},o.prototype.setUnwrap=function(){this._unwrap=!0},o.prototype.howMany=function(){return this._howMany},o.prototype.setHowMany=function(e){this._howMany=e},o.prototype._promiseFulfilled=function(e){return this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},o.prototype._promiseRejected=function(e){return this._addRejected(e),this._checkOutcome()},o.prototype._promiseCancelled=function(){return this._values instanceof t||null==this._values?this._cancel():(this._addRejected(p),this._checkOutcome())},o.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new s,e=this.length();e<this._values.length;++e)this._values[e]!==p&&t.push(this._values[e]);return 0<t.length?this._reject(t):this._cancel(),!0}return!1},o.prototype._fulfilled=function(){return this._totalResolved},o.prototype._rejected=function(){return this._values.length-this.length()},o.prototype._addRejected=function(e){this._values.push(e)},o.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},o.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},o.prototype._getRangeError=function(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new l(t)},o.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(e,t){return n(e,t)},t.prototype.some=function(e){return n(this,e)},t._SomePromiseArray=o}},{"./errors":12,"./util":36}],32:[function(e,t){t.exports=function(e){function t(e){e===void 0?(this._bitField=0,this._settledValueField=void 0):(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0)}t.prototype._settledValue=function(){return this._settledValueField};var a=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},o=t.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},n=t.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},i=t.prototype.isPending=function(){return 0==(50397184&this._bitField)},l=t.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};t.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},e.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},e.prototype.isPending=function(){return i.call(this._target())},e.prototype.isRejected=function(){return n.call(this._target())},e.prototype.isFulfilled=function(){return o.call(this._target())},e.prototype.isResolved=function(){return l.call(this._target())},e.prototype.value=function(){return a.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),r.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}},{}],33:[function(e,t){t.exports=function(t,a){function r(e){return e.then}function o(e){try{return r(e)}catch(t){return s.e=t,s}}function n(e){try{return p.call(e,"_promise0")}catch(t){return!1}}function i(e,r,o){var n=new t(a),i=n;o&&o._pushContext(),n._captureStackTrace(),o&&o._popContext();var u=!0,p=l.tryCatch(r).call(e,function(e){n&&(n._resolveCallback(e),n=null)},function(e){n&&(n._rejectCallback(e,u,!0),n=null)});return u=!1,n&&p===s&&(n._rejectCallback(p.e,!0,!0),n=null),i}var l=e("./util"),s=l.errorObj,u=l.isObject,p={}.hasOwnProperty;return function(e,r){if(u(e)){if(e instanceof t)return e;var l=o(e);if(l===s){r&&r._pushContext();var p=t.reject(l.e);return r&&r._popContext(),p}if("function"==typeof l){if(n(e)){var p=new t(a);return e._then(p._fulfill,p._reject,void 0,p,null),p}return i(e,l,r)}}return e}}},{"./util":36}],34:[function(e,t){t.exports=function(t,a,r){function o(e){this.handle=e}function n(e){return clearTimeout(this.handle),e}function i(e){throw clearTimeout(this.handle),e}var l=e("./util"),s=t.TimeoutError;o.prototype._resultCancelled=function(){clearTimeout(this.handle)};var u=function(e){return p(+this).thenReturn(e)},p=t.delay=function(e,n){var i,l;return void 0===n?(i=new t(a),l=setTimeout(function(){i._fulfill()},+e),r.cancellation()&&i._setOnCancel(new o(l)),i._captureStackTrace()):(i=t.resolve(n)._then(u,null,null,e,void 0),r.cancellation()&&n instanceof t&&i._setOnCancel(n)),i._setAsyncGuaranteed(),i};t.prototype.delay=function(e){return p(e,this)};var d=function(e,t,a){var r;r="string"==typeof t?new s(t):t instanceof Error?t:new s("operation timed out"),l.markAsOriginatingFromRejection(r),e._attachExtraTrace(r),e._reject(r),null!=a&&a.cancel()};t.prototype.timeout=function(e,t){e=+e;var a=new o(setTimeout(function(){l.isPending()&&d(l,t,s)},e)),l,s;return r.cancellation()?(s=this.then(),l=s._then(n,i,void 0,a,void 0),l._setOnCancel(a)):l=this._then(n,i,void 0,a,void 0),l}}},{"./util":36}],35:[function(e,t){t.exports=function(t,a,r,o,n,l){function i(t){setTimeout(function(){throw t},0)}function s(e){var t=r(e);return t!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}function u(e,a){function o(){if(l>=u)return p._fulfill();var n=s(e[l++]);if(n instanceof t&&n._isDisposable()){try{n=r(n._getDisposer().tryDispose(a),e.promise)}catch(t){return i(t)}if(n instanceof t)return n._then(o,i,null,null,null)}o()}var l=0,u=e.length,p=new t(n);return o(),p}function p(e,t,a){this._data=e,this._promise=t,this._context=a}function d(e,t,a){this.constructor$(e,t,a)}function c(e){return p.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}function g(e){this.length=e,this.promise=null,this[e-1]=null}var h=e("./util"),f=e("./errors").TypeError,m=e("./util").inherits,_=h.errorObj,y=h.tryCatch,x={};p.prototype.data=function(){return this._data},p.prototype.promise=function(){return this._promise},p.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():x},p.prototype.tryDispose=function(e){var t=this.resource(),a=this._context;void 0!==a&&a._pushContext();var r=t===x?null:this.doDispose(t,e);return void 0!==a&&a._popContext(),this._promise._unsetDisposable(),this._data=null,r},p.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},m(d,p),d.prototype.doDispose=function(e,t){var a=this.data();return a.call(e,e,t)},g.prototype._resultCancelled=function(){for(var e=this.length,a=0,r;a<e;++a)r=this[a],r instanceof t&&r.cancel()},t.using=function(){var e=arguments.length;if(2>e)return a("you must pass at least 2 arguments to Promise.using");var o=arguments[e-1];if("function"!=typeof o)return a("expecting a function but got "+h.classString(o));var n=!0,s;2===e&&Array.isArray(arguments[0])?(s=arguments[0],e=s.length,n=!1):(s=arguments,e--);for(var d=new g(e),f=0,m;f<e;++f){if(m=s[f],p.isDisposer(m)){var x=m;m=m.promise(),m._setDisposable(x)}else{var v=r(m);v instanceof t&&(m=v._then(c,null,null,{resources:d,index:f},void 0))}d[f]=m}for(var b=Array(d.length),f=0;f<b.length;++f)b[f]=t.resolve(d[f]).reflect();var S=t.all(b).then(function(e){for(var t=0,a;t<e.length;++t){if(a=e[t],a.isRejected())return _.e=a.error(),_;if(!a.isFulfilled())return void S.cancel();e[t]=a.value()}P._pushContext(),o=y(o);var r=n?o.apply(void 0,e):o(e),i=P._popContext();return l.checkForgottenReturns(r,i,"Promise.using",P),r}),P=S.lastly(function(){var e=new t.PromiseInspection(S);return u(d,e)});return d.promise=P,P._setOnCancel(d),P},t.prototype._setDisposable=function(e){this._bitField|=131072,this._disposer=e},t.prototype._isDisposable=function(){return 0<(131072&this._bitField)},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField&=-131073,this._disposer=void 0},t.prototype.disposer=function(e){if("function"==typeof e)return new d(e,this,o());throw new f}}},{"./errors":12,"./util":36}],36:[function(e,t,a){function r(){try{var e=L;return L=null,e.apply(this,arguments)}catch(t){return F.e=t,F}}function o(e){return L=e,r}function n(e){return null==e||!0===e||!1===e||"string"==typeof e||"number"==typeof e}function i(e){return"function"==typeof e||"object"===("undefined"==typeof e?"undefined":wn(e))&&null!==e}function l(e){return n(e)?new Error(m(e)):e}function s(e,t){var a=e.length,r=Array(a+1),o;for(o=0;o<a;++o)r[o]=e[o];return r[o]=t,r}function u(e,t,a){if(k.isES5){var r=Object.getOwnPropertyDescriptor(e,t);if(null!=r)return null==r.get&&null==r.set?r.value:a}else return{}.hasOwnProperty.call(e,t)?e[t]:void 0}function p(e,t,a){if(n(e))return e;return k.defineProperty(e,t,{value:a,configurable:!0,enumerable:!1,writable:!0}),e}function d(e){throw e}function c(e){try{if("function"==typeof e){var t=k.names(e.prototype),a=k.isES5&&1<t.length,r=0<t.length&&(1!==t.length||"constructor"!==t[0]),o=I.test(e+"")&&0<k.names(e).length;if(a||r||o)return!0}return!1}catch(t){return!1}}function g(e){function t(){}t.prototype=e;for(var a=8;a--;)new t;return e}function h(e){return A.test(e)}function f(e,t,a){for(var r=Array(e),o=0;o<e;++o)r[o]=t+o+a;return r}function m(e){try{return e+""}catch(t){return"[no string representation]"}}function _(e){return e instanceof Error||null!==e&&"object"===("undefined"==typeof e?"undefined":wn(e))&&"string"==typeof e.message&&"string"==typeof e.name}function y(t){try{p(t,"isOperational",!0)}catch(e){}}function x(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===t.isOperational)}function v(e){return _(e)&&k.propertyIsWritable(e,"stack")}function b(e){return{}.toString.call(e)}function S(e,t,a){for(var r=k.names(e),o=0,n;o<r.length;++o)if(n=r[o],a(n))try{k.defineProperty(t,n,k.getDescriptor(e,n))}catch(e){}}function P(e){return G?process.env[e]:void 0}function T(){if("function"==typeof Promise)try{var e=new Promise(function(){});if("[object Promise]"==={}.toString.call(e))return Promise}catch(t){}}function w(e,t){return e.bind(t)}var k=e("./es5"),C="undefined"==typeof navigator,F={e:{}},M="undefined"==typeof self?"undefined"==typeof window?"undefined"==typeof _l?this===void 0?null:this:_l:window:self,E=function(e,t){function a(){for(var a in this.constructor=e,this.constructor$=t,t.prototype)r.call(t.prototype,a)&&"$"!==a.charAt(a.length-1)&&(this[a+"$"]=t.prototype[a])}var r={}.hasOwnProperty;return a.prototype=t.prototype,e.prototype=new a,e.prototype},D=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var a=0;a<e.length;++a)if(e[a]===t)return!0;return!1};if(k.isES5){var a=Object.getOwnPropertyNames;return function(e){for(var r=[],o=Object.create(null);null!=e&&!t(e);){var n;try{n=a(e)}catch(t){return r}for(var l=0,i;l<n.length;++l)if(i=n[l],!o[i]){o[i]=!0;var s=Object.getOwnPropertyDescriptor(e,i);null!=s&&null==s.get&&null==s.set&&r.push(i)}e=k.getPrototypeOf(e)}return r}}var r={}.hasOwnProperty;return function(a){if(t(a))return[];var o=[];enumeration:for(var n in a)if(r.call(a,n))o.push(n);else{for(var l=0;l<e.length;++l)if(r.call(e[l],n))continue enumeration;o.push(n)}return o}}(),I=/this\s*\.\s*\S+\s*=/,A=/^[a-z$_][a-z$_0-9]*$/i,R=function(){return"stack"in new Error?function(e){return v(e)?e:new Error(m(e))}:function(e){if(v(e))return e;try{throw new Error(m(e))}catch(e){return e}}}(),O=function(e){return k.isArray(e)?e:null},L;if("undefined"!=typeof Symbol&&Symbol.iterator){var j="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t=[],a=e[Symbol.iterator](),r;!(r=a.next()).done;)t.push(r.value);return t};O=function(e){if(k.isArray(e))return e;return null!=e&&"function"==typeof e[Symbol.iterator]?j(e):null}}var z="undefined"!=typeof process&&"[object process]"===b(process).toLowerCase(),G="undefined"!=typeof process&&"undefined"!=typeof process.env,U={isClass:c,isIdentifier:h,inheritedDataKeys:D,getDataPropertyOrDefault:u,thrower:d,isArray:k.isArray,asArray:O,notEnumerableProp:p,isPrimitive:n,isObject:i,isError:_,canEvaluate:C,errorObj:F,tryCatch:o,inherits:E,withAppended:s,maybeWrapAsError:l,toFastProperties:g,filledRange:f,toString:m,canAttachTrace:v,ensureErrorObject:R,originatesFromRejection:x,markAsOriginatingFromRejection:y,classString:b,copyDescriptors:S,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:z,hasEnvVariables:G,env:P,global:M,getNativePromise:T,domainBind:w};U.isRecentNode=U.isNode&&function(){var e=process.versions.node.split(".").map(Number);return 0===e[0]&&10<e[1]||0<e[0]}(),U.isNode&&U.toFastProperties(process);try{throw new Error}catch(t){U.lastLineError=t}t.exports=U},{"./es5":13}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}),dS=function(e,t){return function(){for(var a=Array(arguments.length),r=0;r<a.length;r++)a[r]=arguments[r];return e.apply(t,a)}},cS=function(e){return null!=e&&(Ca(e)||Fa(e)||!!e._isBuffer)},gS=Object.prototype.toString,hS={isArray:Ma,isArrayBuffer:Ea,isBuffer:cS,isFormData:Da,isArrayBufferView:Ia,isString:Aa,isNumber:Ra,isObject:La,isUndefined:Oa,isDate:ja,isFile:za,isBlob:Ga,isFunction:Ua,isStream:Na,isURLSearchParams:qa,isStandardBrowserEnv:Va,forEach:Ha,merge:Wa,extend:Xa,trim:Ba},fS=function(e,t){hS.forEach(e,function(a,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=a,delete e[r])})},mS=function(e,t,a,r,o){return e.config=t,a&&(e.code=a),e.request=r,e.response=o,e},_S=function(e,t,a,r,o){var n=new Error(e);return mS(n,t,a,r,o)},yS=function(e,t,a){var r=a.config.validateStatus;a.status&&r&&!r(a.status)?t(_S("Request failed with status code "+a.status,a.config,null,a.request,a)):e(a)},xS=function(e,t,a){if(!t)return e;var r;if(a)r=a(t);else if(hS.isURLSearchParams(t))r=t.toString();else{var o=[];hS.forEach(t,function(e,t){null===e||"undefined"==typeof e||(hS.isArray(e)&&(t+="[]"),!hS.isArray(e)&&(e=[e]),hS.forEach(e,function(e){hS.isDate(e)?e=e.toISOString():hS.isObject(e)&&(e=JSON.stringify(e)),o.push(Ya(t)+"="+Ya(e))}))}),r=o.join("&")}return r&&(e+=(-1===e.indexOf("?")?"?":"&")+r),e},vS=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],bS=function(e){var t={},a,r,o;return e?(hS.forEach(e.split("\n"),function(e){if(o=e.indexOf(":"),a=hS.trim(e.substr(0,o)).toLowerCase(),r=hS.trim(e.substr(o+1)),a){if(t[a]&&0<=vS.indexOf(a))return;t[a]="set-cookie"===a?(t[a]?t[a]:[]).concat([r]):t[a]?t[a]+", "+r:r}}),t):t},SS=hS.isStandardBrowserEnv()?function(){function e(e){var r=e;return t&&(a.setAttribute("href",r),r=a.href),a.setAttribute("href",r),{href:a.href,protocol:a.protocol?a.protocol.replace(/:$/,""):"",host:a.host,search:a.search?a.search.replace(/^\?/,""):"",hash:a.hash?a.hash.replace(/^#/,""):"",hostname:a.hostname,port:a.port,pathname:"/"===a.pathname.charAt(0)?a.pathname:"/"+a.pathname}}var t=/(msie|trident)/i.test(navigator.userAgent),a=document.createElement("a"),r;return r=e(window.location.href),function(t){var a=hS.isString(t)?e(t):t;return a.protocol===r.protocol&&a.host===r.host}}():function(){return function(){return!0}}(),PS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";$a.prototype=new Error,$a.prototype.code=5,$a.prototype.name="InvalidCharacterError";var TS=E,wS=hS.isStandardBrowserEnv()?function(){return{write:function(e,t,a,r,o,n){var i=[];i.push(e+"="+encodeURIComponent(t)),hS.isNumber(a)&&i.push("expires="+new Date(a).toGMTString()),hS.isString(r)&&i.push("path="+r),hS.isString(o)&&i.push("domain="+o),!0===n&&i.push("secure"),document.cookie=i.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-8.64e7)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),kS="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||TS,CS=function(t){return new Promise(function(e,a){var r=t.data,o=t.headers;hS.isFormData(r)&&delete o["Content-Type"];var n=new XMLHttpRequest,i="onreadystatechange",l=!1;if("test"===process.env.NODE_ENV||"undefined"==typeof window||!window.XDomainRequest||"withCredentials"in n||SS(t.url)||(n=new window.XDomainRequest,i="onload",l=!0,n.onprogress=function(){},n.ontimeout=function(){}),t.auth){var s=t.auth.username||"",u=t.auth.password||"";o.Authorization="Basic "+kS(s+":"+u)}if(n.open(t.method.toUpperCase(),xS(t.url,t.params,t.paramsSerializer),!0),n.timeout=t.timeout,n[i]=function(){if(n&&(4===n.readyState||l)&&(0!==n.status||n.responseURL&&0===n.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in n?bS(n.getAllResponseHeaders()):null,o=t.responseType&&"text"!==t.responseType?n.response:n.responseText,i={data:o,status:1223===n.status?204:n.status,statusText:1223===n.status?"No Content":n.statusText,headers:r,config:t,request:n};yS(e,a,i),n=null}},n.onerror=function(){a(_S("Network Error",t,null,n)),n=null},n.ontimeout=function(){a(_S("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",n)),n=null},hS.isStandardBrowserEnv()){var p=(t.withCredentials||SS(t.url))&&t.xsrfCookieName?wS.read(t.xsrfCookieName):void 0;p&&(o[t.xsrfHeaderName]=p)}if("setRequestHeader"in n&&hS.forEach(o,function(e,t){"undefined"==typeof r&&"content-type"===t.toLowerCase()?delete o[t]:n.setRequestHeader(t,e)}),t.withCredentials&&(n.withCredentials=!0),t.responseType)try{n.responseType=t.responseType}catch(a){if("json"!==t.responseType)throw a}"function"==typeof t.onDownloadProgress&&n.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&n.upload&&n.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(e){n&&(n.abort(),a(e),n=null)}),void 0===r&&(r=null),n.send(r)})},FS={"Content-Type":"application/x-www-form-urlencoded"},MS={adapter:Za(),transformRequest:[function(e,t){return fS(t,"Content-Type"),hS.isFormData(e)||hS.isArrayBuffer(e)||hS.isBuffer(e)||hS.isStream(e)||hS.isFile(e)||hS.isBlob(e)?e:hS.isArrayBufferView(e)?e.buffer:hS.isURLSearchParams(e)?(Ka(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):hS.isObject(e)?(Ka(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(t){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return 200<=e&&300>e}};MS.headers={common:{Accept:"application/json, text/plain, */*"}},hS.forEach(["delete","get","head"],function(e){MS.headers[e]={}}),hS.forEach(["post","put","patch"],function(e){MS.headers[e]=hS.merge(FS)});var ES=MS;Qa.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},Qa.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},Qa.prototype.forEach=function(e){hS.forEach(this.handlers,function(t){null!==t&&e(t)})};var DS=Qa,IS=function(e,t,a){return hS.forEach(a,function(a){e=a(e,t)}),e},AS=function(e){return!!(e&&e.__CANCEL__)},RS=function(e){return /^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)},OS=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e},LS=function(e){Ja(e),e.baseURL&&!RS(e.url)&&(e.url=OS(e.baseURL,e.url)),e.headers=e.headers||{},e.data=IS(e.data,e.headers,e.transformRequest),e.headers=hS.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),hS.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]});var t=e.adapter||ES.adapter;return t(e).then(function(t){return Ja(e),t.data=IS(t.data,t.headers,e.transformResponse),t},function(t){return AS(t)||(Ja(e),t&&t.response&&(t.response.data=IS(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})};er.prototype.request=function(e){"string"==typeof e&&(e=hS.merge({url:arguments[0]},arguments[1])),e=hS.merge(ES,this.defaults,{method:"get"},e),e.method=e.method.toLowerCase();var t=[LS,void 0],a=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)a=a.then(t.shift(),t.shift());return a},hS.forEach(["delete","get","head","options"],function(e){er.prototype[e]=function(t,a){return this.request(hS.merge(a||{},{method:e,url:t}))}}),hS.forEach(["post","put","patch"],function(e){er.prototype[e]=function(t,a,r){return this.request(hS.merge(r||{},{method:e,url:t,data:a}))}});var jS=er;tr.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},tr.prototype.__CANCEL__=!0;var zS=tr;ar.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},ar.source=function(){var e=new ar(function(e){t=e}),t;return{token:e,cancel:t}};var GS=ar,US=function(e){return function(t){return e.apply(null,t)}},NS=rr(ES);NS.Axios=jS,NS.create=function(e){return rr(hS.merge(ES,e))},NS.Cancel=zS,NS.CancelToken=GS,NS.isCancel=AS,NS.all=function(e){return Promise.all(e)},NS.spread=US;var qS=NS,BS=NS;qS.default=BS;var VS=qS,HS=se(function(e){(function(){var t,a,r,o,n,i;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(e.exports=function(){return(t()-n)/1e6},a=process.hrtime,t=function(){var e;return e=a(),1e9*e[0]+e[1]},o=t(),i=1e9*process.uptime(),n=o-i):Date.now?(e.exports=function(){return Date.now()-r},r=Date.now()):(e.exports=function(){return new Date().getTime()-r},r=new Date().getTime())}).call(_l)}),WS=se(function(e){function t(){}function a(e,t,a){this.fn=e,this.context=t,this.once=a||!1}function r(e,t,r,o,n){if("function"!=typeof r)throw new TypeError("The listener must be a function");var i=new a(r,o||e,n),l=s?s+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],i]:e._events[l].push(i):(e._events[l]=i,e._eventsCount++),e}function o(e,a){0==--e._eventsCount?e._events=new t:delete e._events[a]}function n(){this._events=new t,this._eventsCount=0}var i=Object.prototype.hasOwnProperty,s="~";Object.create&&(t.prototype=Object.create(null),!new t().__proto__&&(s=!1)),n.prototype.eventNames=function(){var e=[],t,a;if(0===this._eventsCount)return e;for(a in t=this._events)i.call(t,a)&&e.push(s?a.slice(1):a);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e},n.prototype.listeners=function(e){var t=s?s+e:e,a=this._events[t];if(!a)return[];if(a.fn)return[a.fn];for(var r=0,o=a.length,n=Array(o);r<o;r++)n[r]=a[r].fn;return n},n.prototype.listenerCount=function(e){var t=s?s+e:e,a=this._events[t];return a?a.fn?1:a.length:0},n.prototype.emit=function(e,t,a,r,o,n){var l=s?s+e:e;if(!this._events[l])return!1;var u=this._events[l],p=arguments.length,d,c;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),p){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,a),!0;case 4:return u.fn.call(u.context,t,a,r),!0;case 5:return u.fn.call(u.context,t,a,r,o),!0;case 6:return u.fn.call(u.context,t,a,r,o,n),!0;}for(c=1,d=Array(p-1);c<p;c++)d[c-1]=arguments[c];u.fn.apply(u.context,d)}else{var i=u.length,g;for(c=0;c<i;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),p){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,a);break;case 4:u[c].fn.call(u[c].context,t,a,r);break;default:if(!d)for(g=1,d=Array(p-1);g<p;g++)d[g-1]=arguments[g];u[c].fn.apply(u[c].context,d);}}return!0},n.prototype.on=function(e,t,a){return r(this,e,t,a,!1)},n.prototype.once=function(e,t,a){return r(this,e,t,a,!0)},n.prototype.removeListener=function(e,t,a,r){var n=s?s+e:e;if(!this._events[n])return this;if(!t)return o(this,n),this;var l=this._events[n];if(l.fn)l.fn!==t||r&&!l.once||a&&l.context!==a||o(this,n);else{for(var u=0,i=[],p=l.length;u<p;u++)(l[u].fn!==t||r&&!l[u].once||a&&l[u].context!==a)&&i.push(l[u]);i.length?this._events[n]=1===i.length?i[0]:i:o(this,n)}return this},n.prototype.removeAllListeners=function(e){var a;return e?(a=s?s+e:e,this._events[a]&&o(this,a)):(this._events=new t,this._eventsCount=0),this},n.prototype.off=n.prototype.removeListener,n.prototype.addListener=n.prototype.on,n.prefixed=s,n.EventEmitter=n,e.exports=n}),XS=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_TEXTURE_IMAGE_UNITS=t.MAX_TEXTURE_SIZE=t.webgl2=void 0;var a=function(){function e(){if(kn(this,e),this.isSupported=!1,this.vertexShader=null,"undefined"!=typeof window){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("webgl2");var t=this.context;t?(this.isSupported=!0,t.getExtension("EXT_color_buffer_float"),this.MAX_TEXTURE_SIZE=t.getParameter(t.MAX_TEXTURE_SIZE),this.MAX_TEXTURE_IMAGE_UNITS=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),this.init()):console.log("Unable to initialize WebGL2 -- your browser may not support it.")}this._refs={textures:[],buffers:[]}}return Cn(e,[{key:"init",value:function(){this.createCommonVertexShader()}},{key:"createCommonVertexShader",value:function(){var e=this.context,t=e.createShader(e.VERTEX_SHADER);e.shaderSource(t,"#version 300 es\nprecision highp float;\n\nin vec3 position;\nin vec2 texcoord;\nout vec2 outTex;\n\nvoid main () {\n  gl_Position = vec4(position, 1.0);\n\toutTex = texcoord;\n}\n"),e.compileShader(t);var a=e.getShaderParameter(t,e.COMPILE_STATUS);a||(console.error(e.getShaderInfoLog(t)),e.deleteShader(t),this.isSupported=!1),this.vertexShader=t}},{key:"compileProgram",value:function(e){var t=this.context,a=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(a,e),t.compileShader(a);var r=t.getShaderParameter(a,t.COMPILE_STATUS);r||(console.error(t.getShaderInfoLog(a)),t.deleteShader(a),this.isSupported=!1);var o=t.createProgram();return t.attachShader(o,this.vertexShader),t.attachShader(o,a),t.linkProgram(o),r=t.getProgramParameter(o,t.LINK_STATUS),r||(console.error(t.getProgramInfoLog(o)),this.isSupported=!1),this.setupVertices(o),o}},{key:"setupVertices",value:function(e){var t=this.context,a=t.getAttribLocation(e,"position"),r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),this.storeRef("buffer",r),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0]),t.STATIC_DRAW),t.vertexAttribPointer(a,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(a);var o=t.getAttribLocation(e,"texcoord"),n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),t.STATIC_DRAW),t.vertexAttribPointer(o,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(o),this.storeRef("buffer",n);var i=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),t.STATIC_DRAW),this.storeRef("buffer",i)}},{key:"selectProgram",value:function(e){var t=this.context;t.useProgram(e)}},{key:"bindUniforms",value:function(e,t){var a=this.context;t.forEach(function(t){var r=t.value,o=t.type,n=t.name,i=a.getUniformLocation(e,n);"float"===o?a.uniform1f(i,r):("int"===o||"bool"===o)&&a.uniform1i(i,r)})}},{key:"bindInputTextures",value:function(e,t,a){var r=this,o=this.context;t.forEach(function(t,n){var i=t.input,l=t.name;if(o.activeTexture(o.TEXTURE0+n),!i.glTextureFragments){var s=r.getWebGLTextureOptions(i.glTextureType,i.glTextureFormat),u=s.textureTarget;o.bindTexture(u,i.glTexture)}else if(i.glTextureFragmentsAsColStack){var p=r.getWebGLTextureOptions(i.glTextureType,i.glTextureFormat),d=p.textureTarget;o.bindTexture(d,i.glTextureFragmentsAsColStack)}else{var c=r.getWebGLTextureOptions(i.glTextureType,i.glTextureFormat),g=c.textureTarget;o.bindTexture(g,i.glTextureFragments[a])}o.uniform1i(o.getUniformLocation(e,l),n)})}},{key:"bindOutputTexture",value:function(e,t){var a=this.context;a.viewport(0,0,t[1],t[0]),this.framebuffer=this.framebuffer||a.createFramebuffer(),a.bindFramebuffer(a.FRAMEBUFFER,this.framebuffer),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e,0)}},{key:"runProgram",value:function(e){var t=e.program,a=e.output,r=e.inputs,o=e.uniforms,n=e.supportsTextureFragments;if(!t)throw new Error("[WebGL2] missing program");if(!a)throw new Error("[WebGL2] missing output");if(!r)throw new Error("[WebGL2] missing inputs");var i=this.context;if(this.selectProgram(t),o&&Array.isArray(o)&&this.bindUniforms(t,o),a.glTextureFragments){if(!(void 0!==n&&n))throw new Error("[WebGL2] program does not support texture fragments");var l=r.filter(function(e){return e.input.glTextureFragments&&!e.input.glTextureFragmentsAsColStack}),s=a.glTextureFragments.length;if(l.some(function(e){return e.input.glTextureFragments.length!==s}))throw new Error("[WebGL2] number of texture fragments in inputs and output do not match");for(var u=0;u<s;u++)this.bindOutputTexture(a.glTextureFragments[u],a.glTextureFragmentShape),this.bindInputTextures(t,r,u),i.drawElements(i.TRIANGLES,6,i.UNSIGNED_SHORT,0)}else this.bindOutputTexture(a.glTexture,a.glTextureShape),this.bindInputTextures(t,r),i.drawElements(i.TRIANGLES,6,i.UNSIGNED_SHORT,0)}},{key:"readData",value:function(e){var t=this.context,a=new ArrayBuffer(4*(4*(e[0]*e[1]))),r=new Float32Array(a);t.readPixels(0,0,e[1],e[0],t.RGBA,t.FLOAT,r);for(var o=[],n=0;n<r.length;n+=4)o.push(r[n]);return new Float32Array(o)}},{key:"getWebGLTextureOptions",value:function(e,t){var a=this.context,r={"2d":a.TEXTURE_2D,"2d_array":a.TEXTURE_2D_ARRAY,"3d":a.TEXTURE_3D},o={float:a.R32F,int:a.R32I},n={float:a.RED,int:a.RED_INTEGER},i={float:a.FLOAT,int:a.INT},l=r[e],s=o[t],u=n[t],p=i[t];return{textureTarget:l,textureInternalFormat:s,textureFormat:u,textureType:p}}},{key:"storeRef",value:function(e,t){"texture"===e?this._refs.textures.push(t):"buffer"===e&&this._refs.buffers.push(t)}},{key:"clearRefs",value:function(){var e=this.context;this._refs.textures.forEach(function(t){return e.deleteTexture(t)}),this._refs.buffers.forEach(function(t){return e.deleteBuffer(t)}),this._refs={textures:[],buffers:[]}}}]),e}(),r=new a;t.webgl2=r;var o=r.MAX_TEXTURE_SIZE;t.MAX_TEXTURE_SIZE=o;var n=r.MAX_TEXTURE_IMAGE_UNITS;t.MAX_TEXTURE_IMAGE_UNITS=n});le(XS);var YS=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,e),this.layerClass="Layer",this.name=t.name,this.description="",this.gpu=XS.webgl2.isSupported&&t.gpu,this.params=[],this.weights={},this.inbound=[],this.outbound=[]}return Cn(e,[{key:"throwError",value:function(e){throw new Error("["+this.layerClass+" layer: "+(this.name||"")+"] "+e)}},{key:"toggleGPU",value:function(e){var t="undefined"==typeof e?!this.gpu:e;this.gpu=XS.webgl2.isSupported&&t}},{key:"setWeights",value:function(e){var t=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0;this.params.forEach(function(r,o){t.weights[r]=e[o],t.gpu&&a&&t.weights[r].createGLTexture({type:"2d",format:"float"})})}},{key:"call",value:function(e){return this.output=e,this.output}}]),e}();t.default=a});le(YS);var $S=yn,KS=bn,ZS=or,QS=nr,JS=QS(),eP=JS,tP=ir,aP="undefined"!=typeof Float64Array,rP={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]},oP=dr,nP=hr,iP=vr,lP=br,sP=Pr,uP=se(function(e,t){function a(e){if(!e)return n;for(var t=0,r;t<e.args.length;++t)r=e.args[t],e.args[t]=0===t?{name:r,lvalue:!0,rvalue:!!e.rvalue,count:e.count||1}:{name:r,lvalue:!1,rvalue:!0,count:1};return e.thisVars||(e.thisVars=[]),e.localVars||(e.localVars=[]),e}function r(e){return sP({args:e.args,pre:a(e.pre),body:a(e.body),post:a(e.proc),funcName:e.funcName})}function o(e){for(var t=[],a=0;a<e.args.length;++a)t.push("a"+a);var o=new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""));return o(r(e))}var n={body:"",args:[],thisVars:[],localVars:[]},i={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var e in i){var a=i[e];t[e]=o({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+a+"c"},funcName:e}),t[e+"eq"]=o({args:["array","array"],body:{args:["a","b"],body:"a"+a+"=b"},rvalue:!0,funcName:e+"eq"}),t[e+"s"]=o({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+a+"s"},funcName:e+"s"}),t[e+"seq"]=o({args:["array","scalar"],body:{args:["a","s"],body:"a"+a+"=s"},rvalue:!0,funcName:e+"seq"})}})();var l={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var e in l){var a=l[e];t[e]=o({args:["array","array"],body:{args:["a","b"],body:"a="+a+"b"},funcName:e}),t[e+"eq"]=o({args:["array"],body:{args:["a"],body:"a="+a+"a"},rvalue:!0,count:2,funcName:e+"eq"})}})();var s={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var e in s){var a=s[e];t[e]=o({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+a+"c"},funcName:e}),t[e+"s"]=o({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+a+"s"},funcName:e+"s"}),t[e+"eq"]=o({args:["array","array"],body:{args:["a","b"],body:"a=a"+a+"b"},rvalue:!0,count:2,funcName:e+"eq"}),t[e+"seq"]=o({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+a+"s"},rvalue:!0,count:2,funcName:e+"seq"})}})();var u=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];(function(){for(var e=0,a;e<u.length;++e)a=u[e],t[a]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+a,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:a}),t[a+"eq"]=o({args:["array"],pre:{args:[],body:"this_f=Math."+a,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:a+"eq"})})();var p=["max","min","atan2","pow"];(function(){for(var e=0,a;e<p.length;++e)a=p[e],t[a]=o({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+a,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:a}),t[a+"s"]=o({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+a,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:a+"s"}),t[a+"eq"]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+a,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:a+"eq"}),t[a+"seq"]=o({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+a,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:a+"seq"})})();var d=["atan2","pow"];(function(){for(var e=0,a;e<d.length;++e)a=d[e],t[a+"op"]=o({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+a,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:a+"op"}),t[a+"ops"]=o({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+a,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:a+"ops"}),t[a+"opeq"]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+a,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:a+"opeq"}),t[a+"opseq"]=o({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+a,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:a+"opseq"})})(),t.any=sP({args:["array"],pre:n,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),t.all=sP({args:["array"],pre:n,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),t.sum=sP({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),t.prod=sP({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),t.norm2squared=sP({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),t.norm2=sP({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),t.norminf=sP({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),t.norm1=sP({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),t.sup=sP({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.inf=sP({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.argmin=sP({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.argmax=sP({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.random=o({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),t.assign=o({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),t.assigns=o({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),t.equals=sP({args:["array","array"],pre:n,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})}),pP=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.checkShape=function(e,t){if(e.length&&t.length&&e.length!==t.reduce(function(e,t){return e*t},1))throw new Error("[Tensor] specified shape incompatible with data.")},t.data3DLayoutForGL=function(e,t,a){for(var r=new e(t.data.length),n=(0,o.default)(new e(a[0]*a[1]),[a[0],a[1]]),s=0,u=0;u<a[2];u++)l.default.assign(n,t.pick(null,null,u)),r.set(n.data,s),s+=a[0]*a[1];return r},t.createIndicesFor2DReshaped=function(e){var t=1<arguments.length&&arguments[1]!==void 0&&arguments[1],a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:-1,s=e.reduce(function(e,t){return e*t},1),u=(0,o.default)(new Int32Array(s),e);if(t){for(var p=yn(Pn(s)),d=(0,o.default)(new Int32Array(p**2),[p,p]),c=(0,o.default)(new Int32Array(p**2),[p,p]),g=(0,o.default)(new Int32Array(p**2),[p,p]),h=0;h<p;h++)l.default.assigns(d.pick(h,null),h);for(var i=0;i<p;i++)l.default.assigns(c.pick(null,i),i);l.default.muls(g,d,p),l.default.addeq(g,c),u.data.set(g.data.subarray(0,u.size))}else{0>a&&(a=e.length+a);for(var f=e[a],m=(0,o.default)(new Int32Array(s),e),_=(0,o.default)(new Int32Array(s),e),y=[].concat(In(e.slice(0,a)),In(e.slice(a+1))),x=y.reduce(function(e,t){return e*t},1),v=(0,o.default)(new Int32Array((0,r.default)(x)),y),b=Array(e.length).fill(null),S=0;S<f;S++)b[a]=S,l.default.assign(m.pick.apply(m,In(b)),v),l.default.assigns(_.pick.apply(_,In(b)),S);l.default.muls(u,m,f),l.default.addeq(u,_)}return u};var r=a(eP),o=a(oP),l=a(uP)});le(pP);var dP=Tr,cP=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}(pP),o=a(oP),i=a(uP),n=a(dP),l=function(){function e(t,a){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};kn(this,e),this.arrayType=n.type||Float32Array,t&&t.length&&(t instanceof this.arrayType||t instanceof Array)?(r.checkShape(t,a),t instanceof this.arrayType?this.tensor=(0,o.default)(t,a):t instanceof Array&&(this.tensor=(0,o.default)(new this.arrayType(t),a))):!t.length&&a.length?this.tensor=(0,o.default)(new this.arrayType(a.reduce(function(e,t){return e*t},1)),a):this.tensor=(0,o.default)(new this.arrayType([]),[])}return Cn(e,[{key:"createGLTexture",value:function(e){var t=e.type,a=void 0===t?"2d":t,r=e.format,o=void 0===r?"float":r,n=e.supportsTextureFragments,i=[];if(1===this.tensor.shape.length)i=[1,this.tensor.shape[0]],this.is1D=!0;else if(2===this.tensor.shape.length)i=this.tensor.shape;else if(3===this.tensor.shape.length&&("2d_array"===a||"3d"===a))i=this.tensor.shape;else throw new Error("[Tensor] cannot create WebGL2 texture.");if(this.glTextureShape=i,this.glTextureType=a,this.glTextureFormat=o,"2d"===a)this.glTextureShape[0]>XS.MAX_TEXTURE_SIZE&&void 0!==n&&n?this._create2DRowFragmentedGLTexture():this._create2DGLTexture();else if("2d_array"===a||"3d"===a)this._create3DGLTexture();else throw new Error("[Tensor] invalid type "+a+".")}},{key:"_create2DGLTexture",value:function(){var e=XS.webgl2.context,t=XS.webgl2.getWebGLTextureOptions(this.glTextureType,this.glTextureFormat),a=t.textureTarget,r=t.textureInternalFormat,o=t.textureFormat,n=t.textureType;this.glTexture=e.createTexture(),XS.webgl2.storeRef("texture",this.glTexture),e.bindTexture(a,this.glTexture);var i=this.glTextureShape,l=this.tensor.data;e.texImage2D(a,0,r,i[1],i[0],0,o,n,l),e.texParameteri(a,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(a,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(a,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(a,e.TEXTURE_MIN_FILTER,e.NEAREST)}},{key:"_create2DRowFragmentedGLTexture",value:function(){var e=XS.webgl2.context,t=XS.webgl2.getWebGLTextureOptions(this.glTextureType,this.glTextureFormat),a=t.textureTarget,r=t.textureInternalFormat,o=t.textureFormat,n=t.textureType;this.glTextureFragments=[],this.glTextureFragmentShape=[XS.MAX_TEXTURE_SIZE,this.glTextureShape[1]];for(var i=this.glTextureFragmentShape,l=yn(this.glTextureShape[0]/XS.MAX_TEXTURE_SIZE),s=0,u=0,p;u<l;u++){p=e.createTexture(),XS.webgl2.storeRef("texture",p),e.bindTexture(a,p);var d=void 0;u===l-1?(d=new this.arrayType(i[0]*i[1]),d.set(this.tensor.data.slice(s,s+i[0]*i[1]),0)):d=this.tensor.data.slice(s,s+i[0]*i[1]),e.texImage2D(a,0,r,i[1],i[0],0,o,n,d),e.texParameteri(a,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(a,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(a,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(a,e.TEXTURE_MIN_FILTER,e.NEAREST),this.glTextureFragments.push(p),s+=i[0]*i[1]}}},{key:"_create3DGLTexture",value:function(){var e=XS.webgl2.context,t=XS.webgl2.getWebGLTextureOptions(this.glTextureType,this.glTextureFormat),a=t.textureTarget,o=t.textureInternalFormat,n=t.textureFormat,i=t.textureType;this.glTexture=e.createTexture(),XS.webgl2.storeRef("texture",this.glTexture),e.bindTexture(a,this.glTexture);var l=this.glTextureShape,s=r.data3DLayoutForGL(this.arrayType,this.tensor,this.glTextureShape);e.texImage3D(a,0,o,l[1],l[0],l[2],0,n,i,s),e.texParameteri(a,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(a,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(a,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(a,e.TEXTURE_MIN_FILTER,e.NEAREST)}},{key:"convert2DRowFragmentedGLTextureToColStack",value:function(){var e=this;if(!this.glTextureFragments||!this.glTextureFragmentShape)throw new Error("[Tensor] no glTextureFragments available.");var t=XS.webgl2.context,a=XS.webgl2.getWebGLTextureOptions(this.glTextureType,this.glTextureFormat),r=a.textureTarget,o=a.textureInternalFormat,n=a.textureFormat,i=a.textureType;if(!this.glTextureFragmentsAsColStack){this.glTextureFragmentsAsColStack=t.createTexture(),XS.webgl2.storeRef("texture",this.glTextureFragmentsAsColStack),t.bindTexture(r,this.glTextureFragmentsAsColStack);var l=this.glTextureFragments.length;this.glTextureFragmentsAsColStackShape=[this.glTextureFragmentShape[0],this.glTextureFragmentShape[1]*l];var s=this.glTextureFragmentsAsColStackShape,u=new this.arrayType(s.reduce(function(e,t){return e*t},1));t.texImage2D(r,0,o,s[1],s[0],0,n,i,u),t.texParameteri(r,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(r,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(r,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(r,t.TEXTURE_MIN_FILTER,t.NEAREST)}else t.bindTexture(r,this.glTextureFragmentsAsColStack);var p=t.createFramebuffer();t.bindFramebuffer(t.READ_FRAMEBUFFER,p),this.glTextureFragments.forEach(function(a,o){t.framebufferTexture2D(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,a,0),t.copyTexSubImage2D(r,0,o*e.glTextureFragmentShape[1],0,0,0,e.glTextureFragmentShape[1],e.glTextureFragmentShape[0])}),t.deleteFramebuffer(p)}},{key:"removeGLTextureFragmentsAsColStack",value:function(){if(this.glTextureFragmentsAsColStack){var e=XS.webgl2.context;e.deleteTexture(this.glTextureFragmentsAsColStack),delete this.glTextureFragmentsAsColStack,delete this.glTextureFragmentsAsColStackShape}}},{key:"deleteGLTexture",value:function(){var e=XS.webgl2.context;this.glTexture&&(e.deleteTexture(this.glTexture),delete this.glTexture),this.glTextureFragments&&(this.glTextureFragments.forEach(function(t){e.deleteTexture(t)}),delete this.glTextureFragments)}},{key:"replaceTensorData",value:function(e){if(e&&e.length&&e instanceof this.arrayType)this.tensor.data.set(e);else if(e&&e.length&&e instanceof Array)this.tensor.data.set(new this.arrayType(e));else throw new Error("[Tensor] invalid input for replaceTensorData method.");if(this.glTexture){var t=XS.webgl2.context,a=XS.webgl2.getWebGLTextureOptions(this.glTextureType,this.glTextureFormat),o=a.textureTarget,n=a.textureFormat,i=a.textureType;t.bindTexture(o,this.glTexture);var l=this.glTextureShape;if("2d"===this.glTextureType){var s=this.tensor.data;t.texSubImage2D(o,0,0,0,l[1],l[0],n,i,s,0)}else if("2d_array"===this.glTextureType||"3d"===this.glTextureType){var u=r.data3DLayoutForGL(this.arrayType,this.tensor,l);t.texSubImage3D(o,0,0,0,0,l[1],l[0],l[2],n,i,u,0)}}}},{key:"transferFromGLTexture",value:function(){if(this.glTextureFragments){this.tensor=(0,o.default)(new this.arrayType(this.glTextureShape[0]*this.glTextureShape[1]),this.glTextureShape);for(var e=0,t=0;t<this.glTextureFragments.length;t++){XS.webgl2.bindOutputTexture(this.glTextureFragments[t],this.glTextureFragmentShape);var a=XS.webgl2.readData(this.glTextureFragmentShape);if(t===this.glTextureFragments.length-1){var r=this.tensor.data.length-e;this.tensor.data.set(a.subarray(0,r),e)}else this.tensor.data.set(a,e);e+=a.length}}else XS.webgl2.bindOutputTexture(this.glTexture,this.glTextureShape),this.tensor=(0,o.default)(new this.arrayType([]),this.glTextureShape),this.tensor.data=XS.webgl2.readData(this.glTextureShape);this.is1D&&1===this.glTextureShape[0]&&(this.tensor=(0,n.default)(this.tensor,[0]))}},{key:"reshapeTo2D",value:function(){for(var e=this.tensor.shape.length-1,t=this.tensor.shape[e],a=this.tensor.shape.slice(0,e),l=a.reduce(function(e,t){return e*t},1),s=(0,o.default)(new this.arrayType(l*t),[l,t]),u=(0,o.default)(new this.arrayType(l),a),p=(0,o.default)(new this.arrayType(l),[l]),d=Array(this.tensor.shape.length).fill(null),c=0;c<t;c++){var n;d[e]=c,i.default.assign(u,(n=this.tensor).pick.apply(n,In(d))),p.data=u.data,i.default.assign(s.pick(null,c),p)}this.originalShape=this.tensor.shape,this.indicesForReshaped=r.createIndicesFor2DReshaped(this.tensor.shape,!1,e),this.tensor=s,this.is2DReshaped=!0}},{key:"reshapeFrom2D",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;if(!this.is2DReshaped)throw new Error("[Tensor] not in reshaped 2D representation.");if(!this.originalShape)throw new Error("[Tensor] does not contain originalShape.");0>e&&(e=this.originalShape.length+e);for(var t=this.tensor.shape[0],a=this.tensor.shape[1],r=(0,o.default)(new this.arrayType(this.originalShape.reduce(function(e,t){return e*t},1)),this.originalShape),l=(0,o.default)(new this.arrayType(t),[t]),s=[].concat(In(this.originalShape.slice(0,e)),In(this.originalShape.slice(e+1))),u=(0,o.default)(new this.arrayType(s.reduce(function(e,t){return e*t},1)),s),p=Array(this.originalShape.length).fill(null),d=0;d<a;d++)i.default.assign(l,this.tensor.pick(null,d)),u.data=l.data,p[e]=d,i.default.assign(r.pick.apply(r,In(p)),u);this.tensor=r}},{key:"reshapeTo2DSquare",value:function(){var e=yn(Pn(this.tensor.size)),t=(0,o.default)(new this.arrayType(e**2),[e,e]);t.data.set(this.tensor.data),this.originalShape=this.tensor.shape,this.indicesForReshaped=r.createIndicesFor2DReshaped(this.tensor.shape,!0),this.tensor=t,this.is2DSquareReshaped=!0}},{key:"reshapeFrom2DSquare",value:function(){if(!this.is2DSquareReshaped)throw new Error("[Tensor] not in reshaped 2D square representation.");if(!this.originalShape)throw new Error("[Tensor] does not contain originalShape.");var e=this.originalShape.reduce(function(e,t){return e*t},1),t=(0,o.default)(new this.arrayType(e),this.originalShape);t.data.set(this.tensor.data.subarray(0,e)),this.tensor=t}}]),e}();t.default=l});le(cP);var gP=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(mv),o=a(YS),n=a(cP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="InputLayer";var r=e.shape,o=void 0===r?[]:r;return a.shape=e.batch_input_shape&&e.batch_input_shape.length?e.batch_input_shape.slice(1):o,a.description="shape: "+JSON.stringify(a.shape),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){this.inputShape=e.tensor.shape,(0,r.default)(this.inputShape,this.shape)||this.throwError("input tensor shape "+e.tensor.shape+" does not match specified shape "+this.shape+"."),this.output=new n.default(e.tensor.data,e.tensor.shape)}},{key:"_callGPU",value:function(e){this.inputShape=e.glTexture||e.glTextureFragments?e.is2DReshaped||e.is2DSquareReshaped?e.originalShape:e.tensor.shape:e.tensor.shape,(0,r.default)(this.inputShape,this.shape)||this.throwError("input tensor shape "+e.tensor.shape+" does not match specified shape "+this.shape+"."),e.glTexture||(2>=e.tensor.shape.length?e.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}):2<e.tensor.shape.length&&(e.reshapeTo2D(),e.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}))),this.output=e}}]),t}(o.default);t.default=i});le(gP);var hP=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(1===e.tensor.shape.length){var t=a.default.sup(e.tensor);a.default.subseq(e.tensor,t),a.default.expeq(e.tensor);var r=a.default.sum(e.tensor);a.default.divseq(e.tensor,r)}else if(2===e.tensor.shape.length)for(var o=0,n;o<e.tensor.shape[0];o++){n=a.default.sup(e.tensor.pick(o,null)),a.default.subseq(e.tensor.pick(o,null),n),a.default.expeq(e.tensor.pick(o,null));var i=a.default.sum(e.tensor.pick(o,null));a.default.divseq(e.tensor.pick(o,null),i)}else throw new Error("[activations.softmax] tensor shape "+e.tensor.shape+" not supported.")};var a=function(e){return e&&e.__esModule?e:{default:e}}(uP)});le(hP);var fP=se(function(e,t){(function(e,a){a(t)})(_l,function(e){function t(e,t){if(!e)throw new Error("ASSERT: "+t)}function a(e){return 48<=e&&57>=e}function r(e){return 0<="0123456789abcdefABCDEF".indexOf(e)}function o(e){return 0<="01234567".indexOf(e)}function n(e){return 32===e||9===e||11===e||12===e||160===e||5760<=e&&0<=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)}function i(e){return 10===e||13===e||8232===e||8233===e}function l(e){return 36===e||95===e||65<=e&&90>=e||97<=e&&122>=e||92===e||128<=e&&rt.NonAsciiIdentifierStart.test(pn(e))}function s(e){return 36===e||95===e||65<=e&&90>=e||97<=e&&122>=e||48<=e&&57>=e||92===e||128<=e&&rt.NonAsciiIdentifierPart.test(pn(e))}function u(e){return"class"===e||"enum"===e||"export"===e||"extends"===e||"import"===e||"super"===e}function p(e){return"implements"===e||"interface"===e||"package"===e||"private"===e||"protected"===e||"public"===e||"static"===e||"yield"===e||"let"===e}function d(e){return"eval"===e||"arguments"===e}function c(e){if(it&&p(e))return!0;switch(e.length){case 2:return"if"===e||"in"===e||"do"===e;case 3:return"var"===e||"for"===e||"new"===e||"try"===e||"let"===e;case 4:return"this"===e||"else"===e||"case"===e||"void"===e||"with"===e||"enum"===e;case 5:return"while"===e||"break"===e||"catch"===e||"throw"===e||"const"===e||"yield"===e||"class"===e||"super"===e;case 6:return"return"===e||"typeof"===e||"delete"===e||"switch"===e||"export"===e||"import"===e;case 7:return"default"===e||"finally"===e||"extends"===e;case 8:return"function"===e||"continue"===e||"debugger"===e;case 10:return"instanceof"===e;default:return!1;}}function g(e,a,r,o,n){var i;t("number"==typeof r,"Comment must have valid position");gt.lastCommentStart>=r||(gt.lastCommentStart=r,i={type:e,value:a},ht.range&&(i.range=[r,o]),ht.loc&&(i.loc=n),ht.comments.push(i),ht.attachComment&&(ht.leadingComments.push(i),ht.trailingComments.push(i)))}function h(e){var t,a,r,o;for(t=lt-e,a={start:{line:st,column:lt-ut-e}};lt<pt;)if(r=nt.charCodeAt(lt),++lt,i(r))return ht.comments&&(o=nt.slice(t+e,lt-1),a.end={line:st,column:lt-ut-1},g("Line",o,t,lt-1,a)),13===r&&10===nt.charCodeAt(lt)&&++lt,++st,void(ut=lt);ht.comments&&(o=nt.slice(t+e,lt),a.end={line:st,column:lt-ut},g("Line",o,t,lt,a))}function f(){var e,t,a,r;for(ht.comments&&(e=lt-2,t={start:{line:st,column:lt-ut-2}});lt<pt;)if(a=nt.charCodeAt(lt),i(a))13===a&&10===nt.charCodeAt(lt+1)&&++lt,++st,++lt,ut=lt,lt>=pt&&N({},at.UnexpectedToken,"ILLEGAL");else if(42===a){if(47===nt.charCodeAt(lt+1))return++lt,++lt,void(ht.comments&&(r=nt.slice(e+2,lt-2),t.end={line:st,column:lt-ut},g("Block",r,e,lt,t)));++lt}else++lt;N({},at.UnexpectedToken,"ILLEGAL")}function m(){var e,t;for(t=0===lt;lt<pt;)if(e=nt.charCodeAt(lt),n(e))++lt;else if(i(e))++lt,13===e&&10===nt.charCodeAt(lt)&&++lt,++st,ut=lt,t=!0;else if(47===e){if(e=nt.charCodeAt(lt+1),47===e)++lt,++lt,h(2),t=!0;else if(42===e)++lt,++lt,f();else break;}else if(t&&45===e){if(45===nt.charCodeAt(lt+1)&&62===nt.charCodeAt(lt+2))lt+=3,h(3);else break;}else if(60!==e)break;else if("!--"===nt.slice(lt+1,lt+4))++lt,++lt,++lt,++lt,h(4);else break}function _(e){var t=0,a,o,n;for(o="u"===e?4:2,a=0;a<o;++a)if(lt<pt&&r(nt[lt]))n=nt[lt++],t=16*t+"0123456789abcdef".indexOf(n.toLowerCase());else return"";return pn(t)}function y(){var e,t;for(e=nt.charCodeAt(lt++),t=pn(e),92===e&&(117!==nt.charCodeAt(lt)&&N({},at.UnexpectedToken,"ILLEGAL"),++lt,e=_("u"),(!e||"\\"===e||!l(e.charCodeAt(0)))&&N({},at.UnexpectedToken,"ILLEGAL"),t=e);lt<pt&&(e=nt.charCodeAt(lt),!!s(e));)++lt,t+=pn(e),92===e&&(t=t.substr(0,t.length-1),117!==nt.charCodeAt(lt)&&N({},at.UnexpectedToken,"ILLEGAL"),++lt,e=_("u"),(!e||"\\"===e||!s(e.charCodeAt(0)))&&N({},at.UnexpectedToken,"ILLEGAL"),t+=e);return t}function x(){var e,t;for(e=lt++;lt<pt;){if(t=nt.charCodeAt(lt),92===t)return lt=e,y();if(s(t))++lt;else break}return nt.slice(e,lt)}function v(){var e,t,a;return e=lt,t=92===nt.charCodeAt(lt)?y():x(),a=1===t.length?Ze.Identifier:c(t)?Ze.Keyword:"null"===t?Ze.NullLiteral:"true"===t||"false"===t?Ze.BooleanLiteral:Ze.Identifier,{type:a,value:t,lineNumber:st,lineStart:ut,start:e,end:lt}}function b(){var e=lt,t=nt.charCodeAt(lt),a=nt[lt],r,o,n,i;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++lt,ht.tokenize&&(40===t?ht.openParenToken=ht.tokens.length:123===t&&(ht.openCurlyToken=ht.tokens.length)),{type:Ze.Punctuator,value:pn(t),lineNumber:st,lineStart:ut,start:e,end:lt};default:if(r=nt.charCodeAt(lt+1),61===r)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return lt+=2,{type:Ze.Punctuator,value:pn(t)+pn(r),lineNumber:st,lineStart:ut,start:e,end:lt};case 33:case 61:return lt+=2,61===nt.charCodeAt(lt)&&++lt,{type:Ze.Punctuator,value:nt.slice(e,lt),lineNumber:st,lineStart:ut,start:e,end:lt};}}return(i=nt.substr(lt,4),">>>="===i)?(lt+=4,{type:Ze.Punctuator,value:i,lineNumber:st,lineStart:ut,start:e,end:lt}):(n=i.substr(0,3),">>>"===n||"<<="===n||">>="===n)?(lt+=3,{type:Ze.Punctuator,value:n,lineNumber:st,lineStart:ut,start:e,end:lt}):(o=n.substr(0,2),a===o[1]&&0<="+-<>&|".indexOf(a)||"=>"===o?(lt+=2,{type:Ze.Punctuator,value:o,lineNumber:st,lineStart:ut,start:e,end:lt}):0<="<>=!+-*%&|^/".indexOf(a)?(++lt,{type:Ze.Punctuator,value:a,lineNumber:st,lineStart:ut,start:e,end:lt}):void N({},at.UnexpectedToken,"ILLEGAL"))}function S(e){for(var t="";lt<pt&&!!r(nt[lt]);)t+=nt[lt++];return 0===t.length&&N({},at.UnexpectedToken,"ILLEGAL"),l(nt.charCodeAt(lt))&&N({},at.UnexpectedToken,"ILLEGAL"),{type:Ze.NumericLiteral,value:parseInt("0x"+t,16),lineNumber:st,lineStart:ut,start:e,end:lt}}function P(e){for(var t="0"+nt[lt++];lt<pt&&!!o(nt[lt]);)t+=nt[lt++];return(l(nt.charCodeAt(lt))||a(nt.charCodeAt(lt)))&&N({},at.UnexpectedToken,"ILLEGAL"),{type:Ze.NumericLiteral,value:parseInt(t,8),octal:!0,lineNumber:st,lineStart:ut,start:e,end:lt}}function T(){var e,t;for(e=lt+1;e<pt;++e){if(t=nt[e],"8"===t||"9"===t)return!1;if(!o(t))return!0}return!0}function w(){var e,r,n;if(n=nt[lt],t(a(n.charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),r=lt,e="","."!==n){if(e=nt[lt++],n=nt[lt],"0"===e){if("x"===n||"X"===n)return++lt,S(r);if(o(n)&&T())return P(r)}for(;a(nt.charCodeAt(lt));)e+=nt[lt++];n=nt[lt]}if("."===n){for(e+=nt[lt++];a(nt.charCodeAt(lt));)e+=nt[lt++];n=nt[lt]}if("e"===n||"E"===n)if(e+=nt[lt++],n=nt[lt],("+"===n||"-"===n)&&(e+=nt[lt++]),a(nt.charCodeAt(lt)))for(;a(nt.charCodeAt(lt));)e+=nt[lt++];else N({},at.UnexpectedToken,"ILLEGAL");return l(nt.charCodeAt(lt))&&N({},at.UnexpectedToken,"ILLEGAL"),{type:Ze.NumericLiteral,value:parseFloat(e),lineNumber:st,lineStart:ut,start:r,end:lt}}function k(){var e="",a=!1,r,n,l,s,u,p,d,c;for(d=st,c=ut,r=nt[lt],t("'"===r||"\""===r,"String literal must starts with a quote"),n=lt,++lt;lt<pt;)if(l=nt[lt++],l===r){r="";break}else if("\\"===l)l=nt[lt++],l&&i(l.charCodeAt(0))?(++st,"\r"===l&&"\n"===nt[lt]&&++lt,ut=lt):"u"===l||"x"===l?(p=lt,u=_(l),u?e+=u:(lt=p,e+=l)):"n"===l?e+="\n":"r"===l?e+="\r":"t"===l?e+="\t":"b"===l?e+="\b":"f"===l?e+="\f":"v"===l?e+="\x0B":o(l)?(s="01234567".indexOf(l),0!==s&&(a=!0),lt<pt&&o(nt[lt])&&(a=!0,s=8*s+"01234567".indexOf(nt[lt++]),0<="0123".indexOf(l)&&lt<pt&&o(nt[lt])&&(s=8*s+"01234567".indexOf(nt[lt++]))),e+=pn(s)):e+=l;else if(i(l.charCodeAt(0)))break;else e+=l;return""!==r&&N({},at.UnexpectedToken,"ILLEGAL"),{type:Ze.StringLiteral,value:e,octal:a,startLineNumber:d,startLineStart:c,lineNumber:st,lineStart:ut,start:n,end:lt}}function C(e,t){var a;try{a=new RegExp(e,t)}catch(t){N({},at.InvalidRegExp)}return a}function F(){var e,a,r,o,n;for(e=nt[lt],t("/"===e,"Regular expression literal must start with a slash"),a=nt[lt++],r=!1,o=!1;lt<pt;)if(e=nt[lt++],a+=e,"\\"===e)e=nt[lt++],i(e.charCodeAt(0))&&N({},at.UnterminatedRegExp),a+=e;else if(i(e.charCodeAt(0)))N({},at.UnterminatedRegExp);else if(r)"]"===e&&(r=!1);else if("/"===e){o=!0;break}else"["===e&&(r=!0);return o||N({},at.UnterminatedRegExp),n=a.substr(1,a.length-2),{value:n,literal:a}}function M(){var e,t,a,r;for(t="",a="";lt<pt&&(e=nt[lt],!!s(e.charCodeAt(0)));)if(++lt,!("\\"===e&&lt<pt))a+=e,t+=e;else if(e=nt[lt],"u"===e){if(++lt,r=lt,e=_("u"),e)for(a+=e,t+="\\u";r<lt;++r)t+=nt[r];else lt=r,a+="u",t+="\\u";q({},at.UnexpectedToken,"ILLEGAL")}else t+="\\",q({},at.UnexpectedToken,"ILLEGAL");return{value:a,literal:t}}function E(){var e,t,a,r;return ct=null,m(),e=lt,t=F(),a=M(),r=C(t.value,a.value),ht.tokenize?{type:Ze.RegularExpression,value:r,lineNumber:st,lineStart:ut,start:e,end:lt}:{literal:t.literal+a.literal,value:r,start:e,end:lt}}function D(){var e,t,a,r;return m(),e=lt,t={start:{line:st,column:lt-ut}},a=E(),t.end={line:st,column:lt-ut},ht.tokenize||(0<ht.tokens.length&&(r=ht.tokens[ht.tokens.length-1],r.range[0]===e&&"Punctuator"===r.type&&("/"===r.value||"/="===r.value)&&ht.tokens.pop()),ht.tokens.push({type:"RegularExpression",value:a.literal,range:[e,lt],loc:t})),a}function I(e){return e.type===Ze.Identifier||e.type===Ze.Keyword||e.type===Ze.BooleanLiteral||e.type===Ze.NullLiteral}function A(){var e,t;if(e=ht.tokens[ht.tokens.length-1],!e)return D();if("Punctuator"===e.type){if("]"===e.value)return b();if(")"===e.value)return t=ht.tokens[ht.openParenToken-1],t&&"Keyword"===t.type&&("if"===t.value||"while"===t.value||"for"===t.value||"with"===t.value)?D():b();if("}"===e.value){if(!(ht.tokens[ht.openCurlyToken-3]&&"Keyword"===ht.tokens[ht.openCurlyToken-3].type)){if(!(ht.tokens[ht.openCurlyToken-4]&&"Keyword"===ht.tokens[ht.openCurlyToken-4].type))return b();if(t=ht.tokens[ht.openCurlyToken-5],!t)return D()}else if(t=ht.tokens[ht.openCurlyToken-4],!t)return b();return 0<=Je.indexOf(t.value)?b():D()}return D()}return"Keyword"===e.type&&"this"!==e.value?D():b()}function R(){var e;return(m(),lt>=pt)?{type:Ze.EOF,lineNumber:st,lineStart:ut,start:lt,end:lt}:(e=nt.charCodeAt(lt),l(e)?v():40===e||41===e||59===e?b():39===e||34===e?k():46===e?a(nt.charCodeAt(lt+1))?w():b():a(e)?w():ht.tokenize&&47===e?A():b())}function O(){var e,t,a;return m(),e={start:{line:st,column:lt-ut}},t=R(),e.end={line:st,column:lt-ut},t.type!==Ze.EOF&&(a=nt.slice(t.start,t.end),ht.tokens.push({type:Qe[t.type],value:a,range:[t.start,t.end],loc:e})),t}function L(){var e;return e=ct,lt=e.end,st=e.lineNumber,ut=e.lineStart,ct="undefined"==typeof ht.tokens?R():O(),lt=e.end,st=e.lineNumber,ut=e.lineStart,e}function j(){var e,t,a;e=lt,t=st,a=ut,ct="undefined"==typeof ht.tokens?R():O(),lt=e,st=t,ut=a}function z(e,t){this.line=e,this.column=t}function G(e,t,a,r){this.start=new z(e,t),this.end=new z(a,r)}function U(){var e,t,a,r;return e=lt,t=st,a=ut,m(),r=st!==t,lt=e,st=t,ut=a,r}function N(e,a){var r=Array.prototype.slice.call(arguments,2),o=a.replace(/%(\d)/g,function(e,a){return t(a<r.length,"Message reference must be in range"),r[a]}),n;throw"number"==typeof e.lineNumber?(n=new Error("Line "+e.lineNumber+": "+o),n.index=e.start,n.lineNumber=e.lineNumber,n.column=e.start-ut+1):(n=new Error("Line "+st+": "+o),n.index=lt,n.lineNumber=st,n.column=lt-ut+1),n.description=o,n}function q(){try{N.apply(null,arguments)}catch(t){if(ht.errors)ht.errors.push(t);else throw t}}function B(e){if(e.type===Ze.EOF&&N(e,at.UnexpectedEOS),e.type===Ze.NumericLiteral&&N(e,at.UnexpectedNumber),e.type===Ze.StringLiteral&&N(e,at.UnexpectedString),e.type===Ze.Identifier&&N(e,at.UnexpectedIdentifier),e.type===Ze.Keyword){if(u(e.value))N(e,at.UnexpectedReserved);else if(it&&p(e.value))return void q(e,at.StrictReservedWord);N(e,at.UnexpectedToken,e.value)}N(e,at.UnexpectedToken,e.value)}function V(e){var t=L();(t.type!==Ze.Punctuator||t.value!==e)&&B(t)}function H(e){var t=L();(t.type!==Ze.Keyword||t.value!==e)&&B(t)}function W(e){return ct.type===Ze.Punctuator&&ct.value===e}function X(e){return ct.type===Ze.Keyword&&ct.value===e}function Y(){var e;return!(ct.type!==Ze.Punctuator)&&(e=ct.value,"="===e||"*="===e||"/="===e||"%="===e||"+="===e||"-="===e||"<<="===e||">>="===e||">>>="===e||"&="===e||"^="===e||"|="===e)}function $(){var e=lt,t=st,a=ut,r=ct,o;return 59===nt.charCodeAt(lt)||W(";")?void L():(o=st,m(),st===o?void(ct.type!==Ze.EOF&&!W("}")&&B(ct)):(lt=e,st=t,ut=a,void(ct=r)))}function K(e){return e.type===et.Identifier||e.type===et.MemberExpression}function Z(){var e=[],t;for(t=ct,V("[");!W("]");)W(",")?(L(),e.push(null)):(e.push(me()),W("]")||V(","));return L(),dt.markEnd(dt.createArrayExpression(e),t)}function Q(e,t){var a,r,o;return a=it,o=ct,r=Be(),t&&it&&d(e[0].name)&&q(t,at.StrictParamName),it=a,dt.markEnd(dt.createFunctionExpression(null,e,[],r),o)}function J(){var e,t;return t=ct,e=L(),e.type===Ze.StringLiteral||e.type===Ze.NumericLiteral?(it&&e.octal&&q(e,at.StrictOctalLiteral),dt.markEnd(dt.createLiteral(e),t)):dt.markEnd(dt.createIdentifier(e.value),t)}function ee(){var e,t,a,r,o,n;return(e=ct,n=ct,e.type===Ze.Identifier)?(a=J(),"get"===e.value&&!W(":"))?(t=J(),V("("),V(")"),r=Q([]),dt.markEnd(dt.createProperty("get",t,r),n)):"set"!==e.value||W(":")?(V(":"),r=me(),dt.markEnd(dt.createProperty("init",a,r),n)):(t=J(),V("("),e=ct,e.type===Ze.Identifier?(o=[ve()],V(")"),r=Q(o,e)):(V(")"),q(e,at.UnexpectedToken,e.value),r=Q([])),dt.markEnd(dt.createProperty("set",t,r),n)):e.type===Ze.EOF||e.type===Ze.Punctuator?void B(e):(t=J(),V(":"),r=me(),dt.markEnd(dt.createProperty("init",t,r),n))}function te(){var e=[],t={},a=String,r,o,n,i,l;for(l=ct,V("{");!W("}");)r=ee(),o=r.key.type===et.Identifier?r.key.name:a(r.key.value),i="init"===r.kind?tt.Data:"get"===r.kind?tt.Get:tt.Set,n="$"+o,Object.prototype.hasOwnProperty.call(t,n)?(t[n]===tt.Data?it&&i===tt.Data?q({},at.StrictDuplicateProperty):i!==tt.Data&&q({},at.AccessorDataProperty):i===tt.Data?q({},at.AccessorDataProperty):t[n]&i&&q({},at.AccessorGetSet),t[n]|=i):t[n]=i,e.push(r),W("}")||V(",");return V("}"),dt.markEnd(dt.createObjectExpression(e),l)}function ae(){var e;return V("("),e=_e(),V(")"),e}function re(){var e,t,a,r;if(W("("))return ae();if(W("["))return Z();if(W("{"))return te();if(e=ct.type,r=ct,e===Ze.Identifier)a=dt.createIdentifier(L().value);else if(e===Ze.StringLiteral||e===Ze.NumericLiteral)it&&ct.octal&&q(ct,at.StrictOctalLiteral),a=dt.createLiteral(L());else if(e===Ze.Keyword){if(X("function"))return We();X("this")?(L(),a=dt.createThisExpression()):B(L())}else e===Ze.BooleanLiteral?(t=L(),t.value="true"===t.value,a=dt.createLiteral(t)):e===Ze.NullLiteral?(t=L(),t.value=null,a=dt.createLiteral(t)):W("/")||W("/=")?(a="undefined"==typeof ht.tokens?dt.createLiteral(E()):dt.createLiteral(D()),j()):B(L());return dt.markEnd(a,r)}function oe(){var e=[];if(V("("),!W(")"))for(;lt<pt&&(e.push(me()),!W(")"));)V(",");return V(")"),e}function ne(){var e,t;return t=ct,e=L(),I(e)||B(e),dt.markEnd(dt.createIdentifier(e.value),t)}function ie(){return V("."),ne()}function le(){var e;return V("["),e=_e(),V("]"),e}function se(){var e,t,a;return a=ct,H("new"),e=pe(),t=W("(")?oe():[],dt.markEnd(dt.createNewExpression(e,t),a)}function ue(){var e=gt.allowIn,t,a,r,o;for(o=ct,gt.allowIn=!0,t=X("new")?se():re();;){if(W("."))r=ie(),t=dt.createMemberExpression(".",t,r);else if(W("("))a=oe(),t=dt.createCallExpression(t,a);else if(W("["))r=le(),t=dt.createMemberExpression("[",t,r);else break;dt.markEnd(t,o)}return gt.allowIn=e,t}function pe(){var e,a,r;for(t(gt.allowIn,"callee of new expression always allow in keyword."),r=ct,e=X("new")?se():re();W(".")||W("[");)W("[")?(a=le(),e=dt.createMemberExpression("[",e,a)):(a=ie(),e=dt.createMemberExpression(".",e,a)),dt.markEnd(e,r);return e}function de(){var e=ct,t,a;return t=ue(),ct.type===Ze.Punctuator&&(W("++")||W("--"))&&!U()&&(it&&t.type===et.Identifier&&d(t.name)&&q({},at.StrictLHSPostfix),!K(t)&&q({},at.InvalidLHSInAssignment),a=L(),t=dt.markEnd(dt.createPostfixExpression(a.value,t),e)),t}function ce(){var e,t,a;return ct.type!==Ze.Punctuator&&ct.type!==Ze.Keyword?t=de():W("++")||W("--")?(a=ct,e=L(),t=ce(),it&&t.type===et.Identifier&&d(t.name)&&q({},at.StrictLHSPrefix),!K(t)&&q({},at.InvalidLHSInAssignment),t=dt.createUnaryExpression(e.value,t),t=dt.markEnd(t,a)):W("+")||W("-")||W("~")||W("!")?(a=ct,e=L(),t=ce(),t=dt.createUnaryExpression(e.value,t),t=dt.markEnd(t,a)):X("delete")||X("void")||X("typeof")?(a=ct,e=L(),t=ce(),t=dt.createUnaryExpression(e.value,t),t=dt.markEnd(t,a),it&&"delete"===t.operator&&t.argument.type===et.Identifier&&q({},at.StrictDelete)):t=de(),t}function ge(e,t){var a=0;if(e.type!==Ze.Punctuator&&e.type!==Ze.Keyword)return 0;switch(e.value){case"||":a=1;break;case"&&":a=2;break;case"|":a=3;break;case"^":a=4;break;case"&":a=5;break;case"==":case"!=":case"===":case"!==":a=6;break;case"<":case">":case"<=":case">=":case"instanceof":a=7;break;case"in":a=t?7:0;break;case"<<":case">>":case">>>":a=8;break;case"+":case"-":a=9;break;case"*":case"/":case"%":a=11;break;default:}return a}function he(){var e,t,a,r,o,n,l,s,u,p;if(e=ct,u=ce(),r=ct,o=ge(r,gt.allowIn),0===o)return u;for(r.prec=o,L(),t=[e,ct],l=ce(),n=[u,r,l];0<(o=ge(ct,gt.allowIn));){for(;2<n.length&&o<=n[n.length-2].prec;)l=n.pop(),s=n.pop().value,u=n.pop(),a=dt.createBinaryExpression(s,u,l),t.pop(),e=t[t.length-1],dt.markEnd(a,e),n.push(a);r=L(),r.prec=o,n.push(r),t.push(ct),a=ce(),n.push(a)}for(p=n.length-1,a=n[p],t.pop();1<p;)a=dt.createBinaryExpression(n[p-1].value,n[p-2],a),p-=2,e=t.pop(),dt.markEnd(a,e);return a}function fe(){var e,t,a,r,o;return o=ct,e=he(),W("?")&&(L(),t=gt.allowIn,gt.allowIn=!0,a=me(),gt.allowIn=t,V(":"),r=me(),e=dt.createConditionalExpression(e,a,r),dt.markEnd(e,o)),e}function me(){var e,t,a,r,o;return e=ct,o=ct,r=t=fe(),Y()&&(!K(t)&&q({},at.InvalidLHSInAssignment),it&&t.type===et.Identifier&&d(t.name)&&q(e,at.StrictLHSAssignment),e=L(),a=me(),r=dt.markEnd(dt.createAssignmentExpression(e.value,t,a),o)),r}function _e(){var e=ct,t;if(t=me(),W(",")){for(t=dt.createSequenceExpression([t]);lt<pt&&!!W(",");)L(),t.expressions.push(me());dt.markEnd(t,e)}return t}function ye(){for(var e=[],t;lt<pt&&!W("}")&&!(t=Xe(),"undefined"==typeof t);)e.push(t);return e}function xe(){var e,t;return t=ct,V("{"),e=ye(),V("}"),dt.markEnd(dt.createBlockStatement(e),t)}function ve(){var e,t;return t=ct,e=L(),e.type!==Ze.Identifier&&B(e),dt.markEnd(dt.createIdentifier(e.value),t)}function be(e){var t=null,a,r;return r=ct,a=ve(),it&&d(a.name)&&q({},at.StrictVarName),"const"===e?(V("="),t=me()):W("=")&&(L(),t=me()),dt.markEnd(dt.createVariableDeclarator(a,t),r)}function Se(e){var t=[];do{if(t.push(be(e)),!W(","))break;L()}while(lt<pt);return t}function Pe(){var e;return H("var"),e=Se(),$(),dt.createVariableDeclaration(e,"var")}function Te(e){var t,a;return a=ct,H(e),t=Se(e),$(),dt.markEnd(dt.createVariableDeclaration(t,e),a)}function we(){return V(";"),dt.createEmptyStatement()}function ke(){var e=_e();return $(),dt.createExpressionStatement(e)}function Ce(){var e,t,a;return H("if"),V("("),e=_e(),V(")"),t=qe(),X("else")?(L(),a=qe()):a=null,dt.createIfStatement(e,t,a)}function Fe(){var e,t,a;return H("do"),a=gt.inIteration,gt.inIteration=!0,e=qe(),gt.inIteration=a,H("while"),V("("),t=_e(),V(")"),W(";")&&L(),dt.createDoWhileStatement(e,t)}function Me(){var e,t,a;return H("while"),V("("),e=_e(),V(")"),a=gt.inIteration,gt.inIteration=!0,t=qe(),gt.inIteration=a,dt.createWhileStatement(e,t)}function Ee(){var e,t,a;return a=ct,e=L(),t=Se(),dt.markEnd(dt.createVariableDeclaration(t,e.value),a)}function De(){var e=gt.allowIn,t,a,r,o,n,i,l;return t=a=r=null,H("for"),V("("),W(";")?L():(X("var")||X("let")?(gt.allowIn=!1,t=Ee(),gt.allowIn=e,1===t.declarations.length&&X("in")&&(L(),o=t,n=_e(),t=null)):(gt.allowIn=!1,t=_e(),gt.allowIn=e,X("in")&&(!K(t)&&q({},at.InvalidLHSInForIn),L(),o=t,n=_e(),t=null)),"undefined"==typeof o&&V(";")),"undefined"==typeof o&&(!W(";")&&(a=_e()),V(";"),!W(")")&&(r=_e())),V(")"),l=gt.inIteration,gt.inIteration=!0,i=qe(),gt.inIteration=l,"undefined"==typeof o?dt.createForStatement(t,a,r,i):dt.createForInStatement(o,n,i)}function Ie(){var e=null,t;return(H("continue"),59===nt.charCodeAt(lt))?(L(),gt.inIteration||N({},at.IllegalContinue),dt.createContinueStatement(null)):U()?(gt.inIteration||N({},at.IllegalContinue),dt.createContinueStatement(null)):(ct.type===Ze.Identifier&&(e=ve(),t="$"+e.name,!Object.prototype.hasOwnProperty.call(gt.labelSet,t)&&N({},at.UnknownLabel,e.name)),$(),null!==e||gt.inIteration||N({},at.IllegalContinue),dt.createContinueStatement(e))}function Ae(){var e=null,t;return(H("break"),59===nt.charCodeAt(lt))?(L(),gt.inIteration||gt.inSwitch||N({},at.IllegalBreak),dt.createBreakStatement(null)):U()?(gt.inIteration||gt.inSwitch||N({},at.IllegalBreak),dt.createBreakStatement(null)):(ct.type===Ze.Identifier&&(e=ve(),t="$"+e.name,!Object.prototype.hasOwnProperty.call(gt.labelSet,t)&&N({},at.UnknownLabel,e.name)),$(),null!==e||gt.inIteration||gt.inSwitch||N({},at.IllegalBreak),dt.createBreakStatement(e))}function Re(){var e=null;return(H("return"),gt.inFunctionBody||q({},at.IllegalReturn),32===nt.charCodeAt(lt)&&l(nt.charCodeAt(lt+1)))?(e=_e(),$(),dt.createReturnStatement(e)):U()?dt.createReturnStatement(null):(W(";")||W("}")||ct.type===Ze.EOF||(e=_e()),$(),dt.createReturnStatement(e))}function Oe(){var e,t;return it&&(m(),q({},at.StrictModeWith)),H("with"),V("("),e=_e(),V(")"),t=qe(),dt.createWithStatement(e,t)}function Le(){var e=[],t,a,r;for(r=ct,X("default")?(L(),t=null):(H("case"),t=_e()),V(":");lt<pt&&!(W("}")||X("default")||X("case"));)a=qe(),e.push(a);return dt.markEnd(dt.createSwitchCase(t,e),r)}function je(){var e,t,a,r,o;if(H("switch"),V("("),e=_e(),V(")"),V("{"),t=[],W("}"))return L(),dt.createSwitchStatement(e,t);for(r=gt.inSwitch,gt.inSwitch=!0,o=!1;lt<pt&&!W("}");)a=Le(),null===a.test&&(o&&N({},at.MultipleDefaultsInSwitch),o=!0),t.push(a);return gt.inSwitch=r,V("}"),dt.createSwitchStatement(e,t)}function ze(){var e;return H("throw"),U()&&N({},at.NewlineAfterThrow),e=_e(),$(),dt.createThrowStatement(e)}function Ge(){var e,t,a;return a=ct,H("catch"),V("("),W(")")&&B(ct),e=ve(),it&&d(e.name)&&q({},at.StrictCatchVariable),V(")"),t=xe(),dt.markEnd(dt.createCatchClause(e,t),a)}function Ue(){var e=[],t=null,a;return H("try"),a=xe(),X("catch")&&e.push(Ge()),X("finally")&&(L(),t=xe()),0!==e.length||t||N({},at.NoCatchOrFinally),dt.createTryStatement(a,[],e,t)}function Ne(){return H("debugger"),$(),dt.createDebuggerStatement()}function qe(){var e=ct.type,t,a,r,o;if(e===Ze.EOF&&B(ct),e===Ze.Punctuator&&"{"===ct.value)return xe();if(o=ct,e===Ze.Punctuator)switch(ct.value){case";":return dt.markEnd(we(),o);case"(":return dt.markEnd(ke(),o);default:}if(e===Ze.Keyword)switch(ct.value){case"break":return dt.markEnd(Ae(),o);case"continue":return dt.markEnd(Ie(),o);case"debugger":return dt.markEnd(Ne(),o);case"do":return dt.markEnd(Fe(),o);case"for":return dt.markEnd(De(),o);case"function":return dt.markEnd(He(),o);case"if":return dt.markEnd(Ce(),o);case"return":return dt.markEnd(Re(),o);case"switch":return dt.markEnd(je(),o);case"throw":return dt.markEnd(ze(),o);case"try":return dt.markEnd(Ue(),o);case"var":return dt.markEnd(Pe(),o);case"while":return dt.markEnd(Me(),o);case"with":return dt.markEnd(Oe(),o);default:}return(t=_e(),t.type===et.Identifier&&W(":"))?(L(),r="$"+t.name,Object.prototype.hasOwnProperty.call(gt.labelSet,r)&&N({},at.Redeclaration,"Label",t.name),gt.labelSet[r]=!0,a=qe(),delete gt.labelSet[r],dt.markEnd(dt.createLabeledStatement(t,a),o)):($(),dt.markEnd(dt.createExpressionStatement(t),o))}function Be(){var e=[],t,a,r,o,n,i,l,s,u;for(u=ct,V("{");lt<pt&&ct.type===Ze.StringLiteral&&(a=ct,t=Xe(),e.push(t),t.expression.type===et.Literal);)r=nt.slice(a.start+1,a.end-1),"use strict"===r?(it=!0,o&&q(o,at.StrictOctalLiteral)):!o&&a.octal&&(o=a);for(n=gt.labelSet,i=gt.inIteration,l=gt.inSwitch,s=gt.inFunctionBody,gt.labelSet={},gt.inIteration=!1,gt.inSwitch=!1,gt.inFunctionBody=!0;lt<pt&&!W("}")&&(t=Xe(),"undefined"!=typeof t);)e.push(t);return V("}"),gt.labelSet=n,gt.inIteration=i,gt.inSwitch=l,gt.inFunctionBody=s,dt.markEnd(dt.createBlockStatement(e),u)}function Ve(e){var t=[],a,r,o,n,i,l;if(V("("),!W(")"))for(n={};lt<pt&&(r=ct,a=ve(),i="$"+r.value,it?(d(r.value)&&(o=r,l=at.StrictParamName),Object.prototype.hasOwnProperty.call(n,i)&&(o=r,l=at.StrictParamDupe)):!e&&(d(r.value)?(e=r,l=at.StrictParamName):p(r.value)?(e=r,l=at.StrictReservedWord):Object.prototype.hasOwnProperty.call(n,i)&&(e=r,l=at.StrictParamDupe)),t.push(a),n[i]=!0,!W(")"));)V(",");return V(")"),{params:t,stricted:o,firstRestricted:e,message:l}}function He(){var e=[],t,a,r,o,n,i,l,s,u;return u=ct,H("function"),r=ct,t=ve(),it?d(r.value)&&q(r,at.StrictFunctionName):d(r.value)?(i=r,l=at.StrictFunctionName):p(r.value)&&(i=r,l=at.StrictReservedWord),n=Ve(i),e=n.params,o=n.stricted,i=n.firstRestricted,n.message&&(l=n.message),s=it,a=Be(),it&&i&&N(i,l),it&&o&&q(o,l),it=s,dt.markEnd(dt.createFunctionDeclaration(t,e,[],a),u)}function We(){var e=null,t=[],a,r,o,n,i,l,s,u;return u=ct,H("function"),W("(")||(a=ct,e=ve(),it?d(a.value)&&q(a,at.StrictFunctionName):d(a.value)?(o=a,n=at.StrictFunctionName):p(a.value)&&(o=a,n=at.StrictReservedWord)),i=Ve(o),t=i.params,r=i.stricted,o=i.firstRestricted,i.message&&(n=i.message),s=it,l=Be(),it&&o&&N(o,n),it&&r&&q(r,n),it=s,dt.markEnd(dt.createFunctionExpression(e,t,[],l),u)}function Xe(){if(ct.type===Ze.Keyword)switch(ct.value){case"const":case"let":return Te(ct.value);case"function":return He();default:return qe();}return ct.type===Ze.EOF?void 0:qe()}function Ye(){for(var e=[],t,a,r,o;lt<pt&&(a=ct,a.type===Ze.StringLiteral)&&!(t=Xe(),e.push(t),t.expression.type!==et.Literal);)r=nt.slice(a.start+1,a.end-1),"use strict"===r?(it=!0,o&&q(o,at.StrictOctalLiteral)):!o&&a.octal&&(o=a);for(;lt<pt&&(t=Xe(),"undefined"!=typeof t);)e.push(t);return e}function $e(){var e,t;return m(),j(),t=ct,it=!1,e=Ye(),dt.markEnd(dt.createProgram(e),t)}function Ke(){var e=[],t,a,r;for(t=0;t<ht.tokens.length;++t)a=ht.tokens[t],r={type:a.type,value:a.value},ht.range&&(r.range=a.range),ht.loc&&(r.loc=a.loc),e.push(r);ht.tokens=e}var Ze,Qe,Je,et,tt,at,rt,ot,nt,it,lt,st,ut,pt,dt,ct,gt,ht;Ze={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9},Qe={},Qe[Ze.BooleanLiteral]="Boolean",Qe[Ze.EOF]="<end>",Qe[Ze.Identifier]="Identifier",Qe[Ze.Keyword]="Keyword",Qe[Ze.NullLiteral]="Null",Qe[Ze.NumericLiteral]="Numeric",Qe[Ze.Punctuator]="Punctuator",Qe[Ze.StringLiteral]="String",Qe[Ze.RegularExpression]="RegularExpression",Je=["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="],et={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement"},tt={Data:1,Get:2,Set:4},at={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"},rt={NonAsciiIdentifierStart:/[------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]/,NonAsciiIdentifierPart:/[------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]/},ot={name:"SyntaxTree",processComment:function(e){var t,a;if(!(e.type===et.Program&&0<e.body.length)){for(0<ht.trailingComments.length?ht.trailingComments[0].range[0]>=e.range[1]?(a=ht.trailingComments,ht.trailingComments=[]):ht.trailingComments.length=0:0<ht.bottomRightStack.length&&ht.bottomRightStack[ht.bottomRightStack.length-1].trailingComments&&ht.bottomRightStack[ht.bottomRightStack.length-1].trailingComments[0].range[0]>=e.range[1]&&(a=ht.bottomRightStack[ht.bottomRightStack.length-1].trailingComments,delete ht.bottomRightStack[ht.bottomRightStack.length-1].trailingComments);0<ht.bottomRightStack.length&&ht.bottomRightStack[ht.bottomRightStack.length-1].range[0]>=e.range[0];)t=ht.bottomRightStack.pop();t?t.leadingComments&&t.leadingComments[t.leadingComments.length-1].range[1]<=e.range[0]&&(e.leadingComments=t.leadingComments,delete t.leadingComments):0<ht.leadingComments.length&&ht.leadingComments[ht.leadingComments.length-1].range[1]<=e.range[0]&&(e.leadingComments=ht.leadingComments,ht.leadingComments=[]),a&&(e.trailingComments=a),ht.bottomRightStack.push(e)}},markEnd:function(e,t){return ht.range&&(e.range=[t.start,lt]),ht.loc&&(e.loc=new G(void 0===t.startLineNumber?t.lineNumber:t.startLineNumber,t.start-(void 0===t.startLineStart?t.lineStart:t.startLineStart),st,lt-ut),this.postProcess(e)),ht.attachComment&&this.processComment(e),e},postProcess:function(e){return ht.source&&(e.loc.source=ht.source),e},createArrayExpression:function(e){return{type:et.ArrayExpression,elements:e}},createAssignmentExpression:function(e,t,a){return{type:et.AssignmentExpression,operator:e,left:t,right:a}},createBinaryExpression:function(e,t,a){var r="||"===e||"&&"===e?et.LogicalExpression:et.BinaryExpression;return{type:r,operator:e,left:t,right:a}},createBlockStatement:function(e){return{type:et.BlockStatement,body:e}},createBreakStatement:function(e){return{type:et.BreakStatement,label:e}},createCallExpression:function(e,t){return{type:et.CallExpression,callee:e,arguments:t}},createCatchClause:function(e,t){return{type:et.CatchClause,param:e,body:t}},createConditionalExpression:function(e,t,a){return{type:et.ConditionalExpression,test:e,consequent:t,alternate:a}},createContinueStatement:function(e){return{type:et.ContinueStatement,label:e}},createDebuggerStatement:function(){return{type:et.DebuggerStatement}},createDoWhileStatement:function(e,t){return{type:et.DoWhileStatement,body:e,test:t}},createEmptyStatement:function(){return{type:et.EmptyStatement}},createExpressionStatement:function(e){return{type:et.ExpressionStatement,expression:e}},createForStatement:function(e,t,a,r){return{type:et.ForStatement,init:e,test:t,update:a,body:r}},createForInStatement:function(e,t,a){return{type:et.ForInStatement,left:e,right:t,body:a,each:!1}},createFunctionDeclaration:function(e,t,a,r){return{type:et.FunctionDeclaration,id:e,params:t,defaults:a,body:r,rest:null,generator:!1,expression:!1}},createFunctionExpression:function(e,t,a,r){return{type:et.FunctionExpression,id:e,params:t,defaults:a,body:r,rest:null,generator:!1,expression:!1}},createIdentifier:function(e){return{type:et.Identifier,name:e}},createIfStatement:function(e,t,a){return{type:et.IfStatement,test:e,consequent:t,alternate:a}},createLabeledStatement:function(e,t){return{type:et.LabeledStatement,label:e,body:t}},createLiteral:function(e){return{type:et.Literal,value:e.value,raw:nt.slice(e.start,e.end)}},createMemberExpression:function(e,t,a){return{type:et.MemberExpression,computed:"["===e,object:t,property:a}},createNewExpression:function(e,t){return{type:et.NewExpression,callee:e,arguments:t}},createObjectExpression:function(e){return{type:et.ObjectExpression,properties:e}},createPostfixExpression:function(e,t){return{type:et.UpdateExpression,operator:e,argument:t,prefix:!1}},createProgram:function(e){return{type:et.Program,body:e}},createProperty:function(e,t,a){return{type:et.Property,key:t,value:a,kind:e}},createReturnStatement:function(e){return{type:et.ReturnStatement,argument:e}},createSequenceExpression:function(e){return{type:et.SequenceExpression,expressions:e}},createSwitchCase:function(e,t){return{type:et.SwitchCase,test:e,consequent:t}},createSwitchStatement:function(e,t){return{type:et.SwitchStatement,discriminant:e,cases:t}},createThisExpression:function(){return{type:et.ThisExpression}},createThrowStatement:function(e){return{type:et.ThrowStatement,argument:e}},createTryStatement:function(e,t,a,r){return{type:et.TryStatement,block:e,guardedHandlers:t,handlers:a,finalizer:r}},createUnaryExpression:function(e,t){return"++"===e||"--"===e?{type:et.UpdateExpression,operator:e,argument:t,prefix:!0}:{type:et.UnaryExpression,operator:e,argument:t,prefix:!0}},createVariableDeclaration:function(e,t){return{type:et.VariableDeclaration,declarations:e,kind:t}},createVariableDeclarator:function(e,t){return{type:et.VariableDeclarator,id:e,init:t}},createWhileStatement:function(e,t){return{type:et.WhileStatement,test:e,body:t}},createWithStatement:function(e,t){return{type:et.WithStatement,object:e,body:t}}},e.version="1.2.5",e.tokenize=function(e,t){var a,r,o;a=String,"string"==typeof e||e instanceof String||(e=a(e)),dt=ot,nt=e,lt=0,st=0<nt.length?1:0,ut=0,pt=nt.length,ct=null,gt={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},ht={},t=t||{},t.tokens=!0,ht.tokens=[],ht.tokenize=!0,ht.openParenToken=-1,ht.openCurlyToken=-1,ht.range="boolean"==typeof t.range&&t.range,ht.loc="boolean"==typeof t.loc&&t.loc,"boolean"==typeof t.comment&&t.comment&&(ht.comments=[]),"boolean"==typeof t.tolerant&&t.tolerant&&(ht.errors=[]);try{if(j(),ct.type===Ze.EOF)return ht.tokens;for(r=L();ct.type!==Ze.EOF;)try{r=L()}catch(e){if(r=ct,ht.errors){ht.errors.push(e);break}else throw e}Ke(),o=ht.tokens,"undefined"!=typeof ht.comments&&(o.comments=ht.comments),"undefined"!=typeof ht.errors&&(o.errors=ht.errors)}catch(t){throw t}finally{ht={}}return o},e.parse=function(e,t){var a,r;r=String,"string"==typeof e||e instanceof String||(e=r(e)),dt=ot,nt=e,lt=0,st=0<nt.length?1:0,ut=0,pt=nt.length,ct=null,gt={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},ht={},"undefined"!=typeof t&&(ht.range="boolean"==typeof t.range&&t.range,ht.loc="boolean"==typeof t.loc&&t.loc,ht.attachComment="boolean"==typeof t.attachComment&&t.attachComment,ht.loc&&null!==t.source&&t.source!==void 0&&(ht.source=r(t.source)),"boolean"==typeof t.tokens&&t.tokens&&(ht.tokens=[]),"boolean"==typeof t.comment&&t.comment&&(ht.comments=[]),"boolean"==typeof t.tolerant&&t.tolerant&&(ht.errors=[]),ht.attachComment&&(ht.range=!0,ht.comments=[],ht.bottomRightStack=[],ht.trailingComments=[],ht.leadingComments=[]));try{a=$e(),"undefined"!=typeof ht.comments&&(a.comments=ht.comments),"undefined"!=typeof ht.tokens&&(Ke(),a.tokens=ht.tokens),"undefined"!=typeof ht.errors&&(a.errors=ht.errors)}catch(t){throw t}finally{ht={}}return a},e.Syntax=function(){var e={},t;for(t in"function"==typeof Object.create&&(e=Object.create(null)),et)et.hasOwnProperty(t)&&(e[t]=et[t]);return"function"==typeof Object.freeze&&Object.freeze(e),e}()})}),mP=0,_P=Mr,yP=["args","body"],xP=["pre","post","printCode","funcName","blockSize"],vP=Er,bP=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},a=t.alpha,o=a===void 0?1:a;r(e.tensor,o)};var a=function(e){return e&&e.__esModule?e:{default:e}}(vP),r=(0,a.default)({args:["array","scalar"],body:function(e,t){e=bn(e,0)+t*(cn(vn(e,0))-1)}})});le(bP);var SP=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){r(e.tensor)};var a=function(e){return e&&e.__esModule?e:{default:e}}(vP),r=(0,a.default)({args:["array","scalar"],body:function(e){e=1.0507009873554805*(bn(e,0)+1.6732632423543772*(cn(vn(e,0))-1))}})});le(SP);var PP=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){r(e.tensor)};var a=function(e){return e&&e.__esModule?e:{default:e}}(vP),r=(0,a.default)({args:["array"],body:function(e){e=fn(cn(e)+1)}})});le(PP);var TP=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){r(e.tensor)};var a=function(e){return e&&e.__esModule?e:{default:e}}(vP),r=(0,a.default)({args:["array"],body:function(e){e/=1+Sn(e)}})});le(TP);var wP=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},a=t.alpha,n=a===void 0?0:a,i=t.maxValue,l=i===void 0?null:i,s;0!==n&&(s=new o.default([],e.tensor.shape),r.default.mins(s.tensor,e.tensor,0),r.default.mulseq(s.tensor,n)),r.default.maxseq(e.tensor,0),l&&r.default.minseq(e.tensor,l),s&&r.default.addeq(e.tensor,s.tensor)};var r=a(uP),o=a(cP)});le(wP);var kP=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){r(e.tensor)};var a=function(e){return e&&e.__esModule?e:{default:e}}(vP),r=(0,a.default)({args:["array"],body:function(e){e=Math.tanh(e)}})});le(kP);var CP=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){r(e.tensor)};var a=function(e){return e&&e.__esModule?e:{default:e}}(vP),r=(0,a.default)({args:["array"],body:function(e){e=1/(1+cn(-e))}})});le(CP);var FP=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){r(e.tensor)};var a=function(e){return e&&e.__esModule?e:{default:e}}(vP),r=(0,a.default)({args:["array"],body:function(e){e=0.2*e+0.5,0>=e?e=0:1<=e&&(e=1)}})});le(FP);var MP=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e}});le(MP);var EP=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"softmax",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"elu",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"selu",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"softplus",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"softsign",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"relu",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"tanh",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"sigmoid",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"hard_sigmoid",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"linear",{enumerable:!0,get:function(){return c.default}});var r=a(hP),o=a(bP),n=a(SP),i=a(PP),l=a(TP),s=a(wP),u=a(kP),p=a(CP),d=a(FP),c=a(MP)});le(EP);var DP=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="LeakyReLU";var r=e.alpha,o=void 0===r?0.3:r;return a.description="alpha: "+o,a.alpha=o,a.gpu&&(a.program=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform float alpha;\nout vec4 outColor;\n\nvoid main() {\n  vec4 v = texture(x, vec2(outTex.x, outTex.y));\n  outColor = max(v, 0.0) + alpha * min(v, 0.0);\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){this.output=e,(0,EP.relu)(this.output,{alpha:this.alpha})}},{key:"_callGPU",value:function(e){e.glTexture||e.glTextureFragments||e.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),this.output||(this.output=new o.default([],e.glTextureShape),this.output.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),e.is1D?this.output.is1D=e.is1D:(e.is2DReshaped||e.is2DSquareReshaped)&&(e.is2DReshaped?this.output.is2DReshaped=e.is2DReshaped:e.is2DSquareReshaped&&(this.output.is2DSquareReshaped=e.is2DSquareReshaped),this.output.originalShape=e.originalShape,this.output.indicesForReshaped=e.indicesForReshaped)),XS.webgl2.runProgram({program:this.program,output:this.output,inputs:[{input:e,name:"x"}],uniforms:[{value:this.alpha,type:"float",name:"alpha"}],supportsTextureFragments:!0}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.is2DReshaped?this.output.reshapeFrom2D():this.output.is2DSquareReshaped&&this.output.reshapeFrom2DSquare())}}]),t}(r.default);t.default=n});le(DP);var IP=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(vP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(a,"_compute",{configurable:!0,enumerable:!0,writable:!0,value:(0,n.default)({args:["array","array"],body:function(e,t){e=bn(e,0)+t*vn(e,0)}})}),a.layerClass="PReLU",a.params=["alpha"],a.gpu&&(a.program=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform sampler2D alpha;\nout vec4 outColor;\n\nvoid main() {\n  vec4 v = texture(x, vec2(outTex.x, outTex.y));\n  vec4 a = texture(alpha, vec2(outTex.x, outTex.y));\n  outColor = max(v, 0.0) + a * min(v, 0.0);\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){this.output=e,this._compute(this.output.tensor,this.weights.alpha.tensor)}},{key:"_callGPU",value:function(e){e.glTexture||e.glTextureFragments||e.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),this.output||(this.output=new o.default([],e.glTextureShape),this.output.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),e.is1D?this.output.is1D=e.is1D:(e.is2DReshaped||e.is2DSquareReshaped)&&(e.is2DReshaped?this.output.is2DReshaped=e.is2DReshaped:e.is2DSquareReshaped&&(this.output.is2DSquareReshaped=e.is2DSquareReshaped),this.output.originalShape=e.originalShape,this.output.indicesForReshaped=e.indicesForReshaped)),XS.webgl2.runProgram({program:this.program,output:this.output,inputs:[{input:e,name:"x"},{input:this.weights.alpha,name:"alpha"}],supportsTextureFragments:!0}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.is2DReshaped?this.output.reshapeFrom2D():this.output.is2DSquareReshaped&&this.output.reshapeFrom2DSquare())}}]),t}(r.default);t.default=i});le(IP);var AP=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(vP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));l.call(a),a.layerClass="ELU";var r=e.alpha,o=void 0===r?1:r;return a.description="alpha: "+o,a.alpha=o,a.gpu&&(a.program=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform float alpha;\nout vec4 outColor;\n\nvoid main() {\n  vec4 v = texture(x, vec2(outTex.x, outTex.y));\n  outColor = max(v, 0.0) + alpha * (exp(min(v, 0.0)) - 1.0);\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){this.output=e,this._compute(this.output.tensor,this.alpha)}},{key:"_callGPU",value:function(e){e.glTexture||e.glTextureFragments||e.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),this.output||(this.output=new o.default([],e.glTextureShape),this.output.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),e.is1D?this.output.is1D=e.is1D:(e.is2DReshaped||e.is2DSquareReshaped)&&(e.is2DReshaped?this.output.is2DReshaped=e.is2DReshaped:e.is2DSquareReshaped&&(this.output.is2DSquareReshaped=e.is2DSquareReshaped),this.output.originalShape=e.originalShape,this.output.indicesForReshaped=e.indicesForReshaped)),XS.webgl2.runProgram({program:this.program,output:this.output,inputs:[{input:e,name:"x"}],uniforms:[{value:this.alpha,type:"float",name:"alpha"}],supportsTextureFragments:!0}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.is2DReshaped?this.output.reshapeFrom2D():this.output.is2DSquareReshaped&&this.output.reshapeFrom2DSquare())}}]),t}(r.default);t.default=i;var l=function(){Object.defineProperty(this,"_compute",{configurable:!0,enumerable:!0,writable:!0,value:(0,n.default)({args:["array","scalar"],body:function(e,t){e=bn(e,0)+t*(cn(vn(e,0))-1)}})})}});le(AP);var RP=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(vP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));l.call(a),a.layerClass="ThresholdedReLU";var r=e.theta,o=void 0===r?1:r;return a.description="theta: "+o,a.theta=o,a.gpu&&(a.program=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform float theta;\nout vec4 outColor;\n\nvoid main() {\n  vec4 v = texture(x, vec2(outTex.x, outTex.y));\n  outColor = v * float(greaterThan(v, vec4(theta)));\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){this.output=e,this._compute(this.output.tensor,this.theta)}},{key:"_callGPU",value:function(e){e.glTexture||e.glTextureFragments||e.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),this.output||(this.output=new o.default([],e.glTextureShape),this.output.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),e.is1D?this.output.is1D=e.is1D:(e.is2DReshaped||e.is2DSquareReshaped)&&(e.is2DReshaped?this.output.is2DReshaped=e.is2DReshaped:e.is2DSquareReshaped&&(this.output.is2DSquareReshaped=e.is2DSquareReshaped),this.output.originalShape=e.originalShape,this.output.indicesForReshaped=e.indicesForReshaped)),XS.webgl2.runProgram({program:this.program,output:this.output,inputs:[{input:e,name:"x"}],uniforms:[{value:this.theta,type:"float",name:"theta"}],supportsTextureFragments:!0}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.is2DReshaped?this.output.reshapeFrom2D():this.output.is2DSquareReshaped&&this.output.reshapeFrom2DSquare())}}]),t}(r.default);t.default=i;var l=function(){Object.defineProperty(this,"_compute",{configurable:!0,enumerable:!0,writable:!0,value:(0,n.default)({args:["array","scalar"],body:function(e,t){e*=+(e>t)}})})}});le(RP);var OP=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"LeakyReLU",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"PReLU",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"ELU",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"ThresholdedReLU",{enumerable:!0,get:function(){return i.default}});var r=a(DP),o=a(IP),n=a(AP),i=a(RP)});le(OP);var LP=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r="#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D inputs["+e+"];\nout vec4 outColor;\n\nvoid main() {\n  int out_y = int(float("+t[0]+") * outTex.y);\n  int out_x = int(float("+t[1]+") * outTex.x);\n  \n  outColor = vec4("+(0,a.default)(e).map(function(e){return"texelFetch(inputs["+e+"], ivec2(out_x, out_y), 0).r"}).join(" + ")+");\n}\n";return r};var a=function(e){return e&&e.__esModule?e:{default:e}}(eP)});le(LP);var jP=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r="#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D inputs["+e+"];\nout vec4 outColor;\n\nvoid main() {\n  int out_y = int(float("+t[0]+") * outTex.y);\n  int out_x = int(float("+t[1]+") * outTex.x);\n  \n  outColor = vec4(("+(0,a.default)(e).map(function(e){return"texelFetch(inputs["+e+"], ivec2(out_x, out_y), 0).r"}).join(" + ")+") / float("+e+"));\n}\n";return r};var a=function(e){return e&&e.__esModule?e:{default:e}}(eP)});le(jP);var zP=Dr,GP=Ir,UP=Ar,NP=Rr,qP=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,l){var s=t.map(function(e){return e[l]}),u=(0,n.default)(e+1).map(function(e){return(0,o.default)((0,r.default)(s,e))}),p=0===l?"out_y":"out_x",i="\n  int n = 0;\n  int offset = 0;\n  if ("+p+" >= "+u[1]+" && "+p+" < "+u[2]+") {\n    n = 1;\n    offset = "+u[1]+";\n  }";2<e&&(i+=(0,n.default)(2,e).map(function(e){return" else if ("+p+" >= "+u[e]+" && "+p+" < "+u[e+1]+") {\n    n = "+e+";\n    offset = "+u[e]+";\n  }"}).join("")+"\n");var d="outColor = vec4(0.0);";if(0===l||1===l){var c=function(e){return"out_x"+(1===l?" - "+u[e]:"")},g=function(e){return"out_y"+(0===l?" - "+u[e]:"")};d="\n  if (n == 0) {\n    outColor = vec4(texelFetch(inputs[0], ivec2(out_x, out_y), 0).r);\n  }"+(0,n.default)(1,e).map(function(e){return" else if (n == "+e+") {\n    outColor = vec4(texelFetch(inputs["+e+"], ivec2("+c(e)+", "+g(e)+"), 0).r);\n  }"}).join("")+"\n"}var h="#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D inputs["+e+"];\nout vec4 outColor;\n\nvoid main() {\n  int out_y = int(float("+a[0]+") * outTex.y);\n  int out_x = int(float("+a[1]+") * outTex.x);\n"+i+"\n"+d+"\n}\n";return h};var r=a(GP),o=a(NP),n=a(eP)});le(qP);var BP=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a="#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D inputs["+e+"];\nout vec4 outColor;\n\nvoid main() {\n  int out_y = int(float("+t[0]+") * outTex.y);\n  int out_x = int(float("+t[1]+") * outTex.x);\n\n  float val = texelFetch(inputs[0], ivec2(out_x, out_y), 0).r;\n  for (int i = 1; i < "+e+"; i++) {\n    val = max(val, texelFetch(inputs[i], ivec2(out_x, out_y), 0).r);\n  }\n\n  outColor = vec4(val);\n}\n";return a}});le(BP);var VP=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a="#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D inputs["+e+"];\nout vec4 outColor;\n\nvoid main() {\n  int out_y = int(float("+t[0]+") * outTex.y);\n  int out_x = int(float("+t[1]+") * outTex.x);\n\n  float val = texelFetch(inputs[0], ivec2(out_x, out_y), 0).r;\n  for (int i = 1; i < "+e+"; i++) {\n    val = min(val, texelFetch(inputs[i], ivec2(out_x, out_y), 0).r);\n  }\n\n  outColor = vec4(val);\n}\n";return a}});le(VP);var HP=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r="#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D inputs["+e+"];\nout vec4 outColor;\n\nvoid main() {\n  int out_y = int(float("+t[0]+") * outTex.y);\n  int out_x = int(float("+t[1]+") * outTex.x);\n\n  outColor = vec4("+(0,a.default)(e).map(function(e){return"texelFetch(inputs["+e+"], ivec2(out_x, out_y), 0).r"}).join(" * ")+");\n}\n";return r};var a=function(e){return e&&e.__esModule?e:{default:e}}(eP)});le(HP);var WP=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a="#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D inputs[2];\nout vec4 outColor;\n\nvoid main() {\n  int out_y = int(float("+t[0]+") * outTex.y);\n  int out_x = int(float("+t[1]+") * outTex.x);\n  \n  outColor = vec4(texelFetch(inputs[0], ivec2(out_x, out_y), 0).r - texelFetch(inputs[1], ivec2(out_x, out_y), 0).r);\n}\n";return a}});le(WP);var XP=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,r,o){var n=r?"sum += texelFetch(bias, ivec2(out_x, 0), 0).r;":"",i=o?"int fragmentIndex = int(floor(float(rowIndex) / float("+t[0]+")));\n      rowIndex = int(mod(float(rowIndex), float("+t[0]+")));\n      colIndex += fragmentIndex * "+t[1]+";":"",l="#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D indexMap;\nuniform sampler2D kernel;\nuniform sampler2D bias;\nout vec4 outColor;\n\nvoid main() {\n  int out_y = int(float("+e[0]+") * outTex.y);\n  int out_x = int(float("+e[1]+") * outTex.x);\n\n  float sum = 0.;\n  for (int i = 0; i < "+a[1]+"; ++i) {\n    int index = texelFetch(indexMap, ivec2(i, out_y), 0).r;    \n    if (index != -1) {\n      int rowIndex = int(floor(float(index) / float("+t[1]+")));\n      int colIndex = int(mod(float(index), float("+t[1]+")));\n      "+i+"\n      sum += texelFetch(x, ivec2(colIndex, rowIndex), 0).r * texelFetch(kernel, ivec2(out_x, i), 0).r;\n    }\n  }\n\n  "+n+"\n  outColor = vec4(sum);\n}   \n";return l}});le(XP);var YP=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,r,o){var n=r?"sum += texelFetch(bias, ivec2(out_x, 0), 0).r;":"",i=o?"int fragmentIndex = int(floor(float(rowIndex) / float("+t[0]+")));\n      rowIndex = int(mod(float(rowIndex), float("+t[0]+")));\n      colIndex += fragmentIndex * "+t[1]+";":"",l="#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D matMulResult;\nuniform isampler2D indexMap;\nuniform sampler2D bias;\nout vec4 outColor;\n\nvoid main() {\n  int out_y = int(float("+e[0]+") * outTex.y);\n  int out_x = int(float("+e[1]+") * outTex.x);\n\n  float sum = 0.;\n  for (int n = 0; n < "+a[1]+"; ++n) {\n    int index = texelFetch(indexMap, ivec2(n, out_y), 0).r;\n    if (index != -1) {\n      int rowIndex = int(floor(float(index) / float("+t[1]+")));\n      int colIndex = int(mod(float(index), float("+t[1]+")));\n      "+i+"\n      sum += texelFetch(matMulResult, ivec2(colIndex + out_x, rowIndex), 0).r;\n    }\n  }\n\n  "+n+"\n  outColor = vec4(sum);\n}  \n";return l}});le(YP);var $P=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){var r;return r=a?"#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D featureMaps;\nuniform sampler2D weights;\nout vec4 outColor;\n\nvoid main() {\n  int out_y = int(float("+e[0]+") * outTex.y);\n  int out_x = int(float("+e[1]+") * outTex.x);\n\n  int featureMapsRow = out_x + "+e[0]+" * out_y;\n\n  float sum = 0.;\n  for (int k = 0; k < "+t+"; ++k) {\n    float f = texelFetch(featureMaps, ivec2(k, featureMapsRow), 0).r;\n    float w = texelFetch(weights, ivec2(k, 0), 0).r;\n    sum += f * w;\n  }\n\n  outColor = vec4(max(sum, 0.0));\n}  \n":"#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D featureMaps;\nuniform sampler2D weights;\nout vec4 outColor;\n\nvoid main() {\n  int out_y = int(float("+e[0]+") * outTex.y);\n  int out_x = int(float("+e[1]+") * outTex.x);\n\n  float sum = 0.;\n  for (int k = 0; k < "+t+"; ++k) {\n    float f = texelFetch(featureMaps, ivec2(k, out_y), 0).r;\n    float w = texelFetch(weights, ivec2(out_x, k), 0).r;\n    sum += f * w;\n  }\n\n  outColor = vec4(max(sum, 0.0));\n}  \n",r}});le($P);var KP=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=arguments.length,a=Array(1<t?t-1:0),g=1;g<t;g++)a[g-1]=arguments[g];switch(e){case"add":return(0,r.default).apply(void 0,a);case"average":return(0,o.default).apply(void 0,a);case"concatenate":return(0,n.default).apply(void 0,a);case"maximum":return(0,i.default).apply(void 0,a);case"minimum":return(0,l.default).apply(void 0,a);case"multiply":return(0,s.default).apply(void 0,a);case"subtract":return(0,u.default).apply(void 0,a);case"conv2d":return(0,p.default).apply(void 0,a);case"conv2dTranspose":return(0,d.default).apply(void 0,a);case"cam":return(0,c.default).apply(void 0,a);default:throw new Error("GLSL program not found");}};var r=a(LP),o=a(jP),n=a(qP),i=a(BP),l=a(VP),s=a(HP),u=a(WP),p=a(XP),d=a(YP),c=a($P)});le(KP);var ZP=Br,QP=32,JP=Xr,eT={},tT=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.linear=t.hard_sigmoid=t.sigmoid=t.tanh=t.relu=t.softsign=t.softplus=t.selu=t.elu=t.softmax=void 0;t.softmax="#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(x, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  float maxval = 0.0;\n  for (int i = 0; i < int(size[0]); ++i) {\n    float val = texelFetch(x, ivec2(i, out_y), 0).r;\n    if (i == 0 || val > maxval) {\n      maxval = val;\n    }\n  }\n\n  float sum = 0.0;\n  for (int i = 0; i < int(size[0]); ++i) {\n    float val = texelFetch(x, ivec2(i, out_y), 0).r;\n    sum += exp(val - maxval);\n  }\n\n  outColor = exp(texture(x, vec2(outTex.x, outTex.y)) - maxval) / sum;\n}\n";t.elu="#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nout vec4 outColor;\n\nvoid main() {\n  float alpha = 1.0;\n  vec4 v = texture(x, vec2(outTex.x, outTex.y));\n  outColor = max(v, 0.0) + alpha * (exp(min(v, 0.0)) - 1.0);\n}\n";t.selu="#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nout vec4 outColor;\n\nvoid main() {\n  float alpha = 1.6732632423543772848170429916717;\n  float scale = 1.0507009873554804934193349852946;\n  vec4 v = texture(x, vec2(outTex.x, outTex.y));\n  outColor = scale * (max(v, 0.0) + alpha * (exp(min(v, 0.0)) - 1.0));\n}\n";t.softplus="#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nout vec4 outColor;\n\nvoid main() {\n  outColor = log(1.0 + exp(texture(x, vec2(outTex.x, outTex.y))));\n}\n";t.softsign="#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nout vec4 outColor;\n\nvoid main() {\n  vec4 v = texture(x, vec2(outTex.x, outTex.y));\n  v /= 1.0 + abs(v);\n  outColor = v;\n}\n";t.relu="#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nout vec4 outColor;\n\nvoid main() {\n  vec4 v = texture(x, vec2(outTex.x, outTex.y));\n  outColor = max(v, 0.0);\n}\n";t.tanh="#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nout vec4 outColor;\n\nvoid main() {\n  vec4 v = texture(x, vec2(outTex.x, outTex.y));\n  outColor = tanh(v);\n}\n";t.sigmoid="#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nout vec4 outColor;\n\nvoid main() {\n  outColor = 1.0 / (1.0 + exp(-1.0 * texture(x, vec2(outTex.x, outTex.y))));\n}\n";t.hard_sigmoid="#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nout vec4 outColor;\n\nvoid main() {\n  vec4 v = texture(x, vec2(outTex.x, outTex.y));\n  v = v * 0.2 + 0.5;\n  v = max(v, 0.0);\n  v = min(v, 1.0);\n  outColor = v;\n}\n";t.linear="#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nout vec4 outColor;\n\nvoid main() {\n  outColor = texture(x, vec2(outTex.x, outTex.y));\n}\n"});le(tT);var aT=se(function(e,t){function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(YS),l=r(cP),n=a(EP),i=r(KP),s=a(pP),u=r(uP),p=r(JP),d=a(tT),c=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="Conv2D";var r=e.filters,o=void 0===r?1:r,i=e.kernel_size,l=void 0===i?[3,3]:i,s=e.strides,u=void 0===s?[1,1]:s,p=e.padding,c=void 0===p?"valid":p,g=e.data_format,h=void 0===g?"channels_last":g,f=e.dilation_rate,m=void 0===f?[1,1]:f,_=e.activation,y=void 0===_?"linear":_,x=e.use_bias;return a.kernelShape=Array.isArray(l)?[o].concat(In(l)):[o,l,l],a.strides=Array.isArray(u)?u:[u,u],"valid"===c||"same"===c?a.padding=c:a.throwError("Invalid padding."),"channels_last"===h||"channels_first"===h?a.dataFormat=h:a.throwError("Only channels_last and channels_first data formats are allowed."),a.dilationRate=Array.isArray(m)?m:[m,m],(1!==a.dilationRate[0]||1!==a.dilationRate[1])&&(1!==a.strides[0]||1!==a.strides[1])&&a.throwError("Incompatible combination of dilation_rate with strides."),a.activation=y,a.activationFunc=n[y],a.useBias=void 0===x||x,a.params=a.useBias?["kernel","bias"]:["kernel"],a.description=a.kernelShape[0]+" "+a.kernelShape.slice(1).join("x")+" filters",a.description+=a.strides.some(function(e){return 1<e})?", "+a.strides.join("x")+" striding":"",a.description+="valid"===a.padding?", no border padding":", pad to same borders",a.description+=a.dilationRate.some(function(e){return 1<e})?", "+a.dilationRate.join("x")+" dilation":"",a.description+="linear"===a.activation?"":", "+a.activation+" activation",a.gpu&&(a.mapInputProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D indexMap;\nuniform int inputCols;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(indexMap, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  int index = texelFetch(indexMap, ivec2(out_x, out_y), 0).r;\n\n  if (index != -1) {\n    int rowIndex = int(floor(float(index) / float(inputCols)));\n    int colIndex = int(mod(float(index), float(inputCols)));\n    float val = texelFetch(x, ivec2(colIndex, rowIndex), 0).r;\n    outColor = vec4(val);\n  } else {\n    outColor = vec4(0.0);\n  }\n}\n"),a.mapInputFragmentsProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D indexMap;\nuniform int inputCols;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 inputSize = textureSize(x, 0);\n  ivec2 outputSize = textureSize(indexMap, 0);\n  int out_x = int(float(outputSize[0]) * outTex.x);\n  int out_y = int(float(outputSize[1]) * outTex.y);\n\n  int index = texelFetch(indexMap, ivec2(out_x, out_y), 0).r;\n\n  if (index != -1) {\n    int rowIndex = int(floor(float(index) / float(inputCols)));\n    int colIndex = int(mod(float(index), float(inputCols)));\n    int fragmentIndex = int(floor(float(rowIndex) / float(inputSize[1])));\n    rowIndex = int(mod(float(rowIndex), float(inputSize[1])));\n    colIndex = fragmentIndex * inputCols + colIndex;\n    float val = texelFetch(x, ivec2(colIndex, rowIndex), 0).r;\n    outColor = vec4(val);\n  } else {\n    outColor = vec4(0.0);\n  }\n}\n"),a.matMulProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D A;\nuniform sampler2D B;\nuniform sampler2D C;\nuniform bool addC;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 A_size = textureSize(A, 0);\n  ivec2 B_size = textureSize(B, 0);\n  int out_x = int(float(B_size[0]) * outTex.x);\n  int out_y = int(float(A_size[1]) * outTex.y);\n  int commonDim = A_size[0];\n\n  float sum = 0.;\n  for (int i = 0; i < commonDim; ++i) {\n    float a = texelFetch(A, ivec2(i, out_y), 0).r;\n    float b = texelFetch(B, ivec2(out_x, i), 0).r;\n    sum += a * b;\n  }\n\n  if (addC) {\n    sum += texelFetch(C, ivec2(out_x, 0), 0).r;\n  }\n\n  outColor = vec4(sum);\n}\n"),a.activationProgram=XS.webgl2.compileProgram(d[a.activation])),a}return Mn(t,e),Cn(t,[{key:"setWeights",value:function(e){"channels_first"===this.dataFormat&&(e[0].tensor=e[0].tensor.transpose(2,3,1,0)),Fn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setWeights",this).call(this,e,!1),this._w2row(),this.gpu&&(this.weights.kernel=this.wRowsMat,this.weights.kernel.createGLTexture({type:"2d",format:"float"}),this.useBias&&this.weights.bias.createGLTexture({type:"2d",format:"float"}))}},{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_calcOutputShape",value:function(e){if(!(this.outputShape&&this.inputPadding)){var t=e[0],a=e[1],r=Dn(this.kernelShape,3),o=r[0],n=r[1],i=r[2],l=n+(n-1)*(this.dilationRate[0]-1),s=i+(i-1)*(this.dilationRate[1]-1),u="same"===this.padding?_n((t+this.strides[0]-1)/this.strides[0]):_n((t-l+this.strides[0])/this.strides[0]),p="same"===this.padding?_n((a+this.strides[1]-1)/this.strides[1]):_n((a-s+this.strides[1])/this.strides[1]),d="same"===this.padding?bn(0,_n((u-1)*this.strides[0]+l-t)):0,c="same"===this.padding?bn(0,_n((p-1)*this.strides[1]+s-a)):0,g=_n(d/2),h=_n(c/2);this.outputShape=[u,p,o],this.inputPadding=[g,d-g,h,c-h]}}},{key:"_padInput",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if("same"===this.padding){var a=Dn(e.tensor.shape,3),r=a[0],o=a[1],n=a[2],i=Dn(this.inputPadding,4),s=i[0],p=i[1],d=i[2],c=i[3],g=new l.default([],[r+s+p,o+d+c,n]);return 0!==t&&u.default.assigns(g.tensor,t),u.default.assign(g.tensor.hi(r+s,o+d,n).lo(s,d,0),e.tensor),g}return e}},{key:"_im2col",value:function(e){var t=Dn(e.tensor.shape,3),a=t[0],r=t[1],o=t[2],n=this.kernelShape[1],s=this.kernelShape[2],p=this.outputShape[0],d=this.outputShape[1],c=n*s*o,g=n+(n-1)*(this.dilationRate[0]-1),h=s+(s-1)*(this.dilationRate[1]-1);if(this.imColsMat||(this.imColsMat=new l.default([],[p*d,c])),1===g&&1===h&&1===this.strides[0]&&1===this.strides[1])return this.imColsMat.replaceTensorData(e.tensor.data),this.imColsMat;for(var f=new l.default([],[n,s,o]),m=0,_=0;_<=a-g;_+=this.strides[0])for(var i=0;i<=r-h;i+=this.strides[1])u.default.assign(f.tensor,e.tensor.hi(_+g,i+h,o).lo(_,i,0).step(this.dilationRate[0],this.dilationRate[1],1)),this.imColsMat.tensor.data.set(f.tensor.data,m),m+=c;return this.imColsMat}},{key:"_w2row",value:function(){var e=this.weights.kernel.tensor.shape[2],t=Dn(this.kernelShape,3),a=t[0],r=t[1],o=t[2],i=r*o*e;this.wRowsMat=new l.default([],[i,a]);for(var s=new l.default([],[r,o,e]),p=new l.default([],[i]),d=0;d<a;d++)u.default.assign(s.tensor,this.weights.kernel.tensor.pick(null,null,null,d)),p.replaceTensorData(s.tensor.data),u.default.assign(this.wRowsMat.tensor.pick(null,d),p.tensor);return this.wRowsMat}},{key:"_callCPU",value:function(e){this.inputShape=e.tensor.shape,this._calcOutputShape(this.inputShape),e=this._padInput(e),this._im2col(e);var t=this.kernelShape[0],a=this.outputShape[0],r=this.outputShape[1],o=new l.default([],[a*r,t]);if(this.useBias)for(var i=0;i<t;i++)u.default.assigns(o.tensor.pick(null,i),this.weights.bias.tensor.get(i));(0,p.default)(o.tensor,this.imColsMat.tensor,this.wRowsMat.tensor,1,1),this.output=new l.default([],this.outputShape);for(var n=new l.default([],[a*r]),s=new l.default([],[a,r]),d=0;d<t;d++)u.default.assign(n.tensor,o.tensor.pick(null,d)),s.replaceTensorData(n.tensor.data),u.default.assign(this.output.tensor.pick(null,null,d),s.tensor);this.activationFunc(this.output),"channels_first"===this.dataFormat&&(this.output.tensor=this.output.tensor.transpose(2,0,1))}},{key:"_createIndexMap",value:function(e){if(!this.indexMap){var t=Dn(this.inputShape,3),a=t[0],r=t[1],o=t[2],n=new l.default(e.data,e.shape,{type:Int32Array});if("same"===this.padding){var s=Dn(this.inputPadding,4),p=s[0],d=s[1],c=s[2],g=s[3];a=a+p+d,r=r+c+g;n=this._padInput(n,-1)}var h=this.kernelShape[1],f=this.kernelShape[2],m=this.outputShape[0],_=this.outputShape[1],y=h*f*o,x=h+(h-1)*(this.dilationRate[0]-1),v=f+(f-1)*(this.dilationRate[1]-1);this.indexMap=new l.default([],[m*_,y],{type:Int32Array});for(var b=new l.default([],[h,f,o]),S=0,P=0,i=a-x;P<=i;P+=this.strides[0])for(var T=0,w=r-v;T<=w;T+=this.strides[1])u.default.assign(b.tensor,n.tensor.hi(P+x,T+v,o).lo(P,T,0).step(this.dilationRate[0],this.dilationRate[1],1)),this.indexMap.tensor.data.set(b.tensor.data,S),S+=y;this.indexMap.createGLTexture({type:"2d",format:"int",supportsTextureFragments:!0})}}},{key:"_callGPU",value:function(e){var t;if(e.is2DReshaped||e.is2DSquareReshaped?(this.inputShape=e.originalShape,this._calcOutputShape(this.inputShape),this._createIndexMap(e.indicesForReshaped),t=[this.indexMap.glTextureShape[0],this.weights.kernel.glTextureShape[1]]):(this.inputShape=e.tensor.shape,this._calcOutputShape(this.inputShape),e=this._padInput(e),this._im2col(e),this.imColsMat.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),t=[this.imColsMat.glTextureShape[0],this.weights.kernel.glTextureShape[1]]),"linear"===this.activation||this.outputPreactiv||(this.outputPreactiv=new l.default([],t),this.outputPreactiv.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),this.outputPreactiv.is2DReshaped=!0,this.outputPreactiv.originalShape=this.outputShape,this.outputPreactiv.indicesForReshaped=s.createIndicesFor2DReshaped(this.outputShape,!1,-1)),this.output||(this.output=new l.default([],t),this.output.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),this.output.is2DReshaped=!0,this.output.originalShape=this.outputShape,this.output.indicesForReshaped=s.createIndicesFor2DReshaped(this.outputShape,!1,-1)),e.is2DReshaped||e.is2DSquareReshaped){var a=!!e.glTextureFragments;if(a&&e.convert2DRowFragmentedGLTextureToColStack(),!this.convProgram){var r=(0,i.default)("conv2d",this.output.glTextureFragmentShape?this.output.glTextureFragmentShape:this.output.glTextureShape,e.glTextureFragmentShape?e.glTextureFragmentShape:e.glTextureShape,this.indexMap.glTextureFragmentShape?this.indexMap.glTextureFragmentShape:this.indexMap.glTextureShape,this.useBias,a);this.convProgram=XS.webgl2.compileProgram(r)}XS.webgl2.runProgram({program:this.convProgram,output:"linear"===this.activation?this.output:this.outputPreactiv,inputs:[{input:e,name:"x"},{input:this.indexMap,name:"indexMap"},{input:this.weights.kernel,name:"kernel"}].concat(In(this.useBias?[{input:this.weights.bias,name:"bias"}]:[])),supportsTextureFragments:!0}),a&&e.removeGLTextureFragmentsAsColStack()}else{var o=[{input:this.imColsMat,name:"A"},{input:this.weights.kernel,name:"B"}];this.useBias&&o.push({input:this.weights.bias,name:"C"}),XS.webgl2.runProgram({program:this.matMulProgram,output:"linear"===this.activation?this.output:this.outputPreactiv,inputs:o,uniforms:[{value:this.useBias?1:0,type:"bool",name:"addC"}],supportsTextureFragments:!0})}"linear"!==this.activation&&XS.webgl2.runProgram({program:this.activationProgram,output:this.output,inputs:[{input:this.outputPreactiv,name:"x"}],supportsTextureFragments:!0}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.reshapeFrom2D(),"channels_first"===this.dataFormat&&(this.output.tensor=this.output.tensor.transpose(2,0,1)))}}]),t}(o.default);t.default=c});le(aT);var rT=Yr,oT=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(aT),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}(pP),l=a(uP),s=a(dP),u=a(rT),p=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="Conv1D";var r=e.filters,o=void 0===r?1:r,i=e.kernel_size,l=void 0===i?1:i,s=e.strides,u=void 0===s?1:s,p=e.padding,d=void 0===p?"valid":p,c=e.dilation_rate,g=void 0===c?1:c,h=e.activation,f=void 0===h?"linear":h,m=e.use_bias,_=void 0===m||m;a.description=o+" filters of size "+l+", striding "+u,a.description+="valid"===d?", no border padding":", pad to same borders",a.description+=1<g?", dilation rate "+g:"",a.description+="linear"===f?"":", "+f+" activation","valid"!==d&&"same"!==d&&a.throwError("Invalid padding."),1!==g&&1!==u&&a.throwError("Incompatible combination of dilation_rate with strides."),a.use_bias=_,a.params=a.use_bias?["kernel","bias"]:["kernel"];var y={filters:o,kernel_size:[l,1],strides:[u,1],padding:d,data_format:"channels_first",dilation_rate:g,activation:f,use_bias:_};return a._conv2dAttrs=y,a._conv2d=new n.default(Object.assign(y,{gpu:e.gpu})),a}return Mn(t,e),Cn(t,[{key:"setWeights",value:function(e){e[0].tensor=(0,u.default)(e[0].tensor).transpose(2,1,0,3),this._conv2d.setWeights(e)}},{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){var t=this,a=new o.default(e.tensor.data,e.tensor.shape);a.tensor=(0,u.default)(a.tensor).transpose(0,2,1);var r=this._conv2d.call(a);this.outputShape=[0,2].map(function(e){return t._conv2d.outputShape[e]}),this.output=new o.default([],this.outputShape),l.default.assign(this.output.tensor,(0,s.default)(r.tensor).transpose(1,0,2))}},{key:"_callGPU",value:function(e){e.glTexture||e.createGLTexture({type:"2d",format:"float"});var t=e.tensor.shape,a=new o.default([],t);Object.assign(a,e),a.glTextureShape=t,a.is2DReshaped=!0,a.originalShape=[t[0],1,t[1]],a.indicesForReshaped=i.createIndicesFor2DReshaped(a.originalShape,!1,-1),this.output=this._conv2d.call(a),0===this.outbound.length&&this.output.transferFromGLTexture()}}]),t}(r.default);t.default=p});le(oT);var nT=se(function(e,t){function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(YS),l=r(cP),n=a(EP),i=a(pP),s=r(uP),u=r(JP),p=r(aT),d=a(tT),c=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return Mn(t,e),Cn(t,[{key:"_calcOutputShape",value:function(e){Fn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_calcOutputShape",this).call(this,e);var a=this.kernelShape[0],r=e[2];this.outputShape[2]=a*r}},{key:"_im2col",value:function(e){var t=Dn(e.tensor.shape,3),a=t[0],r=t[1],o=t[2],n=this.kernelShape[1],u=this.kernelShape[2],p=this.outputShape[0],d=this.outputShape[1],g=n*u;this.imColsMat||(this.imColsMat=new l.default([],[p*d*o,g]));for(var h=new l.default([],[n,u,1]),f=0,m=0;m<o;m++)for(var c=0;c<=a-n;c+=this.strides[0])for(var i=0;i<=r-u;i+=this.strides[1])s.default.assign(h.tensor,e.tensor.hi(c+n,i+u,m+1).lo(c,i,m)),this.imColsMat.tensor.data.set(h.tensor.data,f),f+=g;return this.imColsMat}},{key:"_w2row",value:function(){var e=this.weights.kernel.tensor.shape[2],t=Dn(this.kernelShape,3),a=t[0],r=t[1],o=t[2],i=r*o;this.wRowsMat=new l.default([],[i,a*e]);for(var u=new l.default([],[r,o]),d=new l.default([],[i]),g=0,p=0;p<e;p++)for(var c=0;c<a;c++)s.default.assign(u.tensor,this.weights.kernel.tensor.pick(null,null,p,c)),d.replaceTensorData(u.tensor.data),s.default.assign(this.wRowsMat.tensor.pick(null,g),d.tensor),g+=1;return this.wRowsMat}},{key:"_callCPU",value:function(e){this.inputShape=e.tensor.shape,this._calcOutputShape(this.inputShape),e=this._padInput(e),this._im2col(e);var t=this.kernelShape[0],a=this.outputShape[0],r=this.outputShape[1],o=this.inputShape[2],i=new l.default([],[a*r*o,t*o]);(0,u.default)(i.tensor,this.imColsMat.tensor,this.wRowsMat.tensor,1,1),this.output=new l.default([],this.outputShape);for(var s=a*r*t*o,p=new Float32Array(s),d=0;d<o;d++)for(var c=d*s+d*t;c<(d+1)*s;c+=t*o)for(var n=0;n<t;n++)p[c+n-d*s]=i.tensor.data[c+n];this.output.replaceTensorData(p)}},{key:"_createIndexMap",value:function(e){if(!this.indexMap){var t=Dn(this.inputShape,3),a=t[0],r=t[1],o=t[2],n=new l.default(e.data,e.shape,{type:Int32Array});if("same"===this.padding){var u=Dn(this.inputPadding,4),p=u[0],d=u[1],g=u[2],h=u[3];a=a+p+d,r=r+g+h;n=this._padInput(n,-1)}var f=this.kernelShape[1],m=this.kernelShape[2],_=this.outputShape[0],y=this.outputShape[1],x=f*m;this.indexMap=new l.default([],[_*y*o,x],{type:Int32Array});for(var v=new l.default([],[f,m,1]),b=0,S=0;S<o;S++)for(var c=0,i=a-f;c<=i;c+=this.strides[0])for(var P=0,T=r-m;P<=T;P+=this.strides[1])s.default.assign(v.tensor,n.tensor.hi(c+f,P+m,S+1).lo(c,P,S)),this.indexMap.tensor.data.set(v.tensor.data,b),b+=x;this.indexMap.createGLTexture({type:"2d",format:"int",supportsTextureFragments:!0})}}},{key:"_createOutputReshapeIndexMap",value:function(){if(!this.reshapeIndexMap){var e=this.kernelShape[0],t=[this.outputShape[0]*this.outputShape[1],this.outputShape[2]],a=new l.default([],t,{type:Int32Array}),r=new l.default([],t,{type:Int32Array});this.reshapeIndexMap=new l.default([],t,{type:Int32Array});for(var o=0;o<t[1];o++)for(var n=0;n<t[0];n++)s.default.assigns(a.tensor.pick(n,o),n+_n(o/e)*t[0]);for(var i=0;i<t[1];i++)s.default.assigns(r.tensor.pick(null,i),i);s.default.muls(this.reshapeIndexMap.tensor,a.tensor,t[1]),s.default.addeq(this.reshapeIndexMap.tensor,r.tensor),this.reshapeIndexMap.createGLTexture({type:"2d",format:"int",supportsTextureFragments:!0})}}},{key:"_callGPU",value:function(e){if(Fn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_callGPU",this).call(this,e),this._createOutputReshapeIndexMap(),!this.outputReshaped){var a=[this.outputShape[0]*this.outputShape[1],this.outputShape[2]];this.outputReshaped=new l.default([],a),this.outputReshaped.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),this.outputReshaped.is2DReshaped=!0,this.outputReshaped.originalShape=this.outputShape,this.outputReshaped.indicesForReshaped=i.createIndicesFor2DReshaped(this.outputShape,!1,-1)}this.output.glTextureFragments&&this.output.convert2DRowFragmentedGLTextureToColStack(),XS.webgl2.runProgram({program:this.output.glTextureFragments?this.mapInputFragmentsProgram:this.mapInputProgram,output:this.outputReshaped,inputs:[{input:this.output,name:"x"},{input:this.reshapeIndexMap,name:"indexMap"}],uniforms:[{value:this.output.glTextureShape[1],type:"int",name:"inputCols"}],supportsTextureFragments:!0}),this.output.glTextureFragments&&this.output.removeGLTextureFragmentsAsColStack()}}]),t}(p.default),g=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="SeparableConv2D";var r=e.filters,o=void 0===r?1:r,i=e.kernel_size,l=void 0===i?[1,1]:i,s=e.strides,u=void 0===s?[1,1]:s,p=e.padding,c=void 0===p?"valid":p,g=e.data_format,h=void 0===g?"channels_last":g,f=e.depth_multiplier,m=void 0===f?1:f,_=e.activation,y=void 0===_?"linear":_,x=e.use_bias,v=void 0===x||x;return a.kernelShape=Array.isArray(l)?[o].concat(In(l)):[o,l,l],a.strides=Array.isArray(u)?u:[u,u],"valid"===c||"same"===c?a.padding=c:a.throwError("Invalid padding."),"channels_last"===h||"channels_first"===h?a.dataFormat=h:a.throwError("Only channels_last and channels_first data formats are allowed."),a.activation=y,a.activationFunc=n[y],"valid"===c||"same"===c?a.padding=c:a.throwError("Invalid padding."),a.useBias=v,a.params=a.useBias?["depthwise_kernel","pointwise_kernel","bias"]:["depthwise_kernel","pointwise_kernel"],a.depthwiseConvAttrs={filters:m,kernel_size:[a.kernelShape[1],a.kernelShape[2]],strides:a.strides,padding:c,data_format:h,activation:"linear",use_bias:!1,gpu:e.gpu},a.pointwiseConvAttrs={filters:o,kernel_size:[1,1],strides:[1,1],padding:c,data_format:h,activation:"linear",use_bias:v,gpu:e.gpu},a.description=a.kernelShape[0]+" "+a.kernelShape.slice(1).join("x")+" filters",a.description+=a.strides.some(function(e){return 1<e})?", "+a.strides.join("x")+" striding":"",a.description+="valid"===a.padding?", no border padding":", pad to same borders",a.description+=1<m?", depth multiplier: "+m:"",a.description+="linear"===a.activation?"":", "+a.activation+" activation",a.gpu&&(a.activationProgram=XS.webgl2.compileProgram(d[a.activation])),a}return Mn(t,e),Cn(t,[{key:"setWeights",value:function(e){this._depthwiseConv=new c(this.depthwiseConvAttrs),this._depthwiseConv.setWeights(e.slice(0,1)),this._pointwiseConv=new p.default(this.pointwiseConvAttrs),this._pointwiseConv.setWeights(e.slice(1,3))}},{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){this._depthwiseConv._callCPU(e),this._pointwiseConv._callCPU(this._depthwiseConv.output),this.output=this._pointwiseConv.output,this.activationFunc(this.output)}},{key:"_callGPU",value:function(e){this._depthwiseConv.outbound=[null],this._pointwiseConv.outbound=[null],this._depthwiseConv._callGPU(e),this._pointwiseConv._callGPU(this._depthwiseConv.outputReshaped),"linear"===this.activation?this.output=this._pointwiseConv.output:(!this.output&&(this.output=new l.default([],this._pointwiseConv.output.glTextureShape),this.output.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),this.output.is2DReshaped=!0,this.output.originalShape=this._pointwiseConv.output.originalShape,this.output.indicesForReshaped=i.createIndicesFor2DReshaped(this._pointwiseConv.output.originalShape,!1,-1)),this.outputPreactiv=this._pointwiseConv.output,XS.webgl2.runProgram({program:this.activationProgram,output:this.output,inputs:[{input:this.outputPreactiv,name:"x"}],supportsTextureFragments:!0})),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.reshapeFrom2D(),"channels_first"===this.dataFormat&&(this.output.tensor=this.output.tensor.transpose(2,0,1)))}}]),t}(o.default);t.default=g});le(nT);var iT=se(function(e,t){function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(YS),l=r(cP),n=a(EP),i=r(KP),s=a(pP),u=r(vP),p=r(uP),d=r(JP),c=a(tT),g=(0,u.default)({args:[{blockIndices:-1},"scalar","scalar"],body:function(e,t,a){for(var r=0;r<a;r++)if(-1===e[r]){e[r]=t;break}}}),h=(0,u.default)({args:[{blockIndices:-1},"array","scalar"],body:function(e,t,a){for(var r=0;r<a;r++)if(-1===e[r]){e[r]=t;break}}}),f=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="Conv2DTranspose";var r=e.filters,o=void 0===r?1:r,i=e.kernel_size,l=void 0===i?[3,3]:i,s=e.strides,u=void 0===s?[1,1]:s,p=e.padding,d=void 0===p?"valid":p,g=e.data_format,h=void 0===g?"channels_last":g,f=e.activation,m=void 0===f?"linear":f,_=e.use_bias;return a.kernelShape=Array.isArray(l)?[o].concat(In(l)):[o,l,l],a.strides=Array.isArray(u)?u:[u,u],"valid"===d||"same"===d?a.padding=d:a.throwError("Invalid padding."),"channels_last"===h||"channels_first"===h?a.dataFormat=h:a.throwError("Only channels_last and channels_first data formats are allowed."),a.activation=m,a.activationFunc=n[m],a.useBias=void 0===_||_,a.params=a.useBias?["kernel","bias"]:["kernel"],a.description=a.kernelShape[0]+" "+a.kernelShape.slice(1).join("x")+" filters",a.description+=a.strides.some(function(e){return 1<e})?", "+a.strides.join("x")+" striding":"",a.description+="valid"===a.padding?", no border padding":", pad to same borders",a.description+="linear"===a.activation?"":", "+a.activation+" activation",a.gpu&&(a.matMulProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D A;\nuniform sampler2D B;\nuniform sampler2D C;\nuniform bool addC;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 A_size = textureSize(A, 0);\n  ivec2 B_size = textureSize(B, 0);\n  int out_x = int(float(B_size[0]) * outTex.x);\n  int out_y = int(float(A_size[1]) * outTex.y);\n  int commonDim = A_size[0];\n\n  float sum = 0.;\n  for (int i = 0; i < commonDim; ++i) {\n    float a = texelFetch(A, ivec2(i, out_y), 0).r;\n    float b = texelFetch(B, ivec2(out_x, i), 0).r;\n    sum += a * b;\n  }\n\n  if (addC) {\n    sum += texelFetch(C, ivec2(out_x, 0), 0).r;\n  }\n\n  outColor = vec4(sum);\n}\n"),a.activationProgram=XS.webgl2.compileProgram(c[a.activation])),a}return Mn(t,e),Cn(t,[{key:"setWeights",value:function(e){"channels_first"===this.dataFormat&&(e[0].tensor=e[0].tensor.transpose(2,3,1,0)),Fn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setWeights",this).call(this,e,!1),this._w2row(),this.gpu&&(this.weights.kernel=this.wRowsMat,this.weights.kernel.createGLTexture({type:"2d",format:"float"}),this.useBias&&this.weights.bias.createGLTexture({type:"2d",format:"float"}))}},{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_calcOutputShape",value:function(e){if(!(this.outputShape&&this.outputPadding)){var t=e[0],a=e[1],r=Dn(this.kernelShape,3),o=r[0],n=r[1],i=r[2],l="same"===this.padding?t*this.strides[0]:t*this.strides[0]+bn(n-this.strides[0],0),s="same"===this.padding?a*this.strides[1]:a*this.strides[1]+bn(i-this.strides[1],0),u="same"===this.padding?bn(0,_n((t-1)*this.strides[0]+n-l)):0,p="same"===this.padding?bn(0,_n((a-1)*this.strides[1]+i-s)):0,d=_n(u/2),c=_n(p/2);this.outputShape=[l,s,o],this.outputPadding=[d,u-d,c,p-c]}}},{key:"_im2col",value:function(e){var t=Dn(e.tensor.shape,3),a=t[0],r=t[1],o=t[2];this.imColsMat||(this.imColsMat=new l.default([],[a*r,o]));for(var n=new l.default([],[a*r]),i=new l.default([],[a,r]),s=0;s<o;s++)p.default.assign(i.tensor,e.tensor.pick(null,null,s)),n.replaceTensorData(i.tensor.data),p.default.assign(this.imColsMat.tensor.pick(null,s),n.tensor);return this.imColsMat}},{key:"_w2row",value:function(){var e=Dn(this.weights.kernel.tensor.shape,4),t=e[0],a=e[1],r=e[2],o=e[3];this.wRowsMat=new l.default([],[o,t*a*r]);for(var n=new l.default([],[t*a*r]),i=new l.default([],[t,a,r]),s=0;s<o;s++)p.default.assign(i.tensor,this.weights.kernel.tensor.pick(null,null,null,s)),n.replaceTensorData(i.tensor.data),p.default.assign(this.wRowsMat.tensor.pick(s,null),n.tensor);return this.wRowsMat}},{key:"_callCPU",value:function(e){this.inputShape=e.tensor.shape,this._calcOutputShape(this.inputShape),this._im2col(e);var t=e.tensor.shape[0],a=e.tensor.shape[1],r=Dn(this.kernelShape,3),o=r[0],s=r[1],u=r[2],c=new l.default([],[t*a,s*u*o]);(0,d.default)(c.tensor,this.imColsMat.tensor,this.wRowsMat.tensor,1,1);var g=Dn(this.outputPadding,4),h=g[0],f=g[1],m=g[2],_=g[3];this.output=new l.default([],this.outputShape);for(var y=new l.default([],[this.outputShape[0]+h+f,this.outputShape[1]+m+_,this.outputShape[2]]),x=[s,u,o],v=new l.default([],x),b=new l.default([],[s*u*o]),S=0,P=0;P<t;P++)for(var i=0;i<a;i++){p.default.assign(b.tensor,c.tensor.pick(S,null)),v.replaceTensorData(b.tensor.data);var T=P*this.strides[0],w=i*this.strides[1];p.default.addeq(y.tensor.hi(T+s,w+u,this.outputShape[2]).lo(T,w,0),v.tensor),S+=1}if(p.default.assign(this.output.tensor,y.tensor.hi(this.outputShape[0]+h,this.outputShape[1]+m,this.outputShape[2]).lo(h,m,0)),this.useBias)for(var k=0;k<o;k++)p.default.addseq(this.output.tensor.pick(null,null,k),this.weights.bias.tensor.get(k));this.activationFunc(this.output),"channels_first"===this.dataFormat&&(this.output.tensor=this.output.tensor.transpose(2,0,1))}},{key:"_createIndexMap",value:function(){if(!this.indexMap){var e=this.inputShape[0],t=this.inputShape[1],a=Dn(this.kernelShape,3),r=a[0],o=a[1],n=a[2],s=Dn(this.outputPadding,4),u=s[0],d=s[1],c=s[2],f=s[3],m=(o-this.strides[0]+1)*(n-this.strides[1]+1),_=[this.outputShape[0],this.outputShape[1],m],y=[this.outputShape[0]+u+d,this.outputShape[1]+c+f,m],x=new l.default([],_,{type:Int32Array}),v=new l.default([],_,{type:Int32Array}),b=new l.default([],y,{type:Int32Array}),S=new l.default([],y,{type:Int32Array});p.default.assigns(x.tensor,-1),p.default.assigns(v.tensor,-1),p.default.assigns(b.tensor,-1),p.default.assigns(S.tensor,-1);for(var P=new l.default([],[o,n,r],{type:Int32Array}),T=0;T<o*n*r;T++)P.tensor.data[T]=T;for(var i=0;i<e;i++)for(var w=0;w<t;w++){var C=i*t+w,F=i*this.strides[0],M=w*this.strides[1];g(b.tensor.hi(F+o,M+n,m).lo(F,M,0),C,m),h(S.tensor.hi(F+o,M+n,m).lo(F,M,0),P.tensor.pick(null,null,0),m)}p.default.assign(x.tensor,b.tensor.hi(this.outputShape[0]+u,this.outputShape[1]+c,m).lo(u,c,0)),p.default.assign(v.tensor,S.tensor.hi(this.outputShape[0]+u,this.outputShape[1]+c,m).lo(u,c,0));var E=[this.outputShape[0]*this.outputShape[1],m];this.indexMap=new l.default([],E,{type:Int32Array});for(var D=new l.default([],[m],{type:Int32Array}),I=0;I<this.outputShape[0];I++)for(var A=0;A<this.outputShape[1];A++){for(var R=0;R<m;R++){var k=x.tensor.get(I,A,R),O=v.tensor.get(I,A,R);-1!==k&&-1!==O?D.tensor.set(R,k*this.weights.kernel.glTextureShape[1]+O):D.tensor.set(R,-1)}p.default.assign(this.indexMap.tensor.pick(I*this.outputShape[1]+A,null),D.tensor)}this.indexMap.createGLTexture({type:"2d",format:"int",supportsTextureFragments:!0})}}},{key:"_callGPU",value:function(e){e.is2DReshaped||e.is2DSquareReshaped?(this.inputShape=e.originalShape,this._calcOutputShape(this.inputShape)):(this.inputShape=e.tensor.shape,this._calcOutputShape(this.inputShape),this._im2col(e),this.imColsMat.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}));var t=e.is2DReshaped||e.is2DSquareReshaped?e:this.imColsMat;if(!this.matMulResult){var a=[t.glTextureShape[0],this.weights.kernel.glTextureShape[1]];this.matMulResult=new l.default([],a),this.matMulResult.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0})}if("linear"!==this.activation&&!this.outputPreactiv){var r=[this.outputShape[0]*this.outputShape[1],this.outputShape[2]];this.outputPreactiv=new l.default([],r),this.outputPreactiv.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),this.outputPreactiv.is2DReshaped=!0,this.outputPreactiv.originalShape=this.outputShape,this.outputPreactiv.indicesForReshaped=s.createIndicesFor2DReshaped(this.outputShape,!1,-1)}if(!this.output){var o=[this.outputShape[0]*this.outputShape[1],this.outputShape[2]];this.output=new l.default([],o),this.output.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),this.output.is2DReshaped=!0,this.output.originalShape=this.outputShape,this.output.indicesForReshaped=s.createIndicesFor2DReshaped(this.outputShape,!1,-1)}XS.webgl2.runProgram({program:this.matMulProgram,output:this.matMulResult,inputs:[{input:t,name:"A"},{input:this.weights.kernel,name:"B"}],uniforms:[{value:0,type:"bool",name:"addC"}],supportsTextureFragments:!0}),this._createIndexMap();var n=!!this.matMulResult.glTextureFragments;if(n&&this.matMulResult.convert2DRowFragmentedGLTextureToColStack(),!this.convTransposeProgram){var u=(0,i.default)("conv2dTranspose",this.output.glTextureFragmentShape?this.output.glTextureFragmentShape:this.output.glTextureShape,this.matMulResult.glTextureFragmentShape?this.matMulResult.glTextureFragmentShape:this.matMulResult.glTextureShape,this.indexMap.glTextureFragmentShape?this.indexMap.glTextureFragmentShape:this.indexMap.glTextureShape,this.useBias,n);this.convTransposeProgram=XS.webgl2.compileProgram(u)}XS.webgl2.runProgram({program:this.convTransposeProgram,output:"linear"===this.activation?this.output:this.outputPreactiv,inputs:[{input:this.matMulResult,name:"matMulResult"},{input:this.indexMap,name:"indexMap"}].concat(In(this.useBias?[{input:this.weights.bias,name:"bias"}]:[])),supportsTextureFragments:!0}),n&&this.matMulResult.removeGLTextureFragmentsAsColStack(),"linear"!==this.activation&&XS.webgl2.runProgram({program:this.activationProgram,output:this.output,inputs:[{input:this.outputPreactiv,name:"x"}],supportsTextureFragments:!0}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.reshapeFrom2D(),"channels_first"===this.dataFormat&&(this.output.tensor=this.output.tensor.transpose(2,0,1)))}}]),t}(o.default);t.default=f});le(iT);var lT=se(function(e,t){function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(YS),l=r(cP),n=a(EP),i=r(KP),s=a(pP),u=r(uP),p=r(JP),d=a(tT),c=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="Conv3D";var r=e.filters,o=void 0===r?1:r,i=e.kernel_size,l=void 0===i?[1,1,1]:i,s=e.strides,u=void 0===s?[1,1,1]:s,p=e.padding,c=void 0===p?"valid":p,g=e.data_format,h=void 0===g?"channels_last":g,f=e.dilation_rate,m=void 0===f?[1,1,1]:f,_=e.activation,y=void 0===_?"linear":_,x=e.use_bias;return a.kernelShape=Array.isArray(l)?[o].concat(In(l)):[o,l,l,l],a.strides=Array.isArray(u)?u:[u,u,u],"valid"===c||"same"===c?a.padding=c:a.throwError("Invalid padding."),"channels_last"===h||"channels_first"===h?a.dataFormat=h:a.throwError("Only channels_last and channels_first data formats are allowed."),a.dilationRate=Array.isArray(m)?m:[m,m,m],(1!==a.dilationRate[0]||1!==a.dilationRate[1]||1!==a.dilationRate[2])&&(1!==a.strides[0]||1!==a.strides[1]||1!==a.strides[2])&&a.throwError("Incompatible combination of dilation_rate with strides."),a.activation=y,a.activationFunc=n[y],a.useBias=void 0===x||x,a.params=a.useBias?["kernel","bias"]:["kernel"],a.description=a.kernelShape[0]+" "+a.kernelShape.slice(1).join("x")+" filters",a.description+=a.strides.some(function(e){return 1<e})?", "+a.strides.join("x")+" striding":"",a.description+="valid"===a.padding?", no border padding":", pad to same borders",a.description+=a.dilationRate.some(function(e){return 1<e})?", "+a.dilationRate.join("x")+" dilation":"",a.description+="linear"===a.activation?"":", "+a.activation+" activation",a.gpu&&(a.mapInputProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D indexMap;\nuniform int inputCols;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(indexMap, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  int index = texelFetch(indexMap, ivec2(out_x, out_y), 0).r;\n\n  if (index != -1) {\n    int rowIndex = int(floor(float(index) / float(inputCols)));\n    int colIndex = int(mod(float(index), float(inputCols)));\n    float val = texelFetch(x, ivec2(colIndex, rowIndex), 0).r;\n    outColor = vec4(val);\n  } else {\n    outColor = vec4(0.0);\n  }\n}\n"),a.mapInputFragmentsProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D indexMap;\nuniform int inputCols;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 inputSize = textureSize(x, 0);\n  ivec2 outputSize = textureSize(indexMap, 0);\n  int out_x = int(float(outputSize[0]) * outTex.x);\n  int out_y = int(float(outputSize[1]) * outTex.y);\n\n  int index = texelFetch(indexMap, ivec2(out_x, out_y), 0).r;\n\n  if (index != -1) {\n    int rowIndex = int(floor(float(index) / float(inputCols)));\n    int colIndex = int(mod(float(index), float(inputCols)));\n    int fragmentIndex = int(floor(float(rowIndex) / float(inputSize[1])));\n    rowIndex = int(mod(float(rowIndex), float(inputSize[1])));\n    colIndex = fragmentIndex * inputCols + colIndex;\n    float val = texelFetch(x, ivec2(colIndex, rowIndex), 0).r;\n    outColor = vec4(val);\n  } else {\n    outColor = vec4(0.0);\n  }\n}\n"),a.matMulProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D A;\nuniform sampler2D B;\nuniform sampler2D C;\nuniform bool addC;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 A_size = textureSize(A, 0);\n  ivec2 B_size = textureSize(B, 0);\n  int out_x = int(float(B_size[0]) * outTex.x);\n  int out_y = int(float(A_size[1]) * outTex.y);\n  int commonDim = A_size[0];\n\n  float sum = 0.;\n  for (int i = 0; i < commonDim; ++i) {\n    float a = texelFetch(A, ivec2(i, out_y), 0).r;\n    float b = texelFetch(B, ivec2(out_x, i), 0).r;\n    sum += a * b;\n  }\n\n  if (addC) {\n    sum += texelFetch(C, ivec2(out_x, 0), 0).r;\n  }\n\n  outColor = vec4(sum);\n}\n"),a.activationProgram=XS.webgl2.compileProgram(d[a.activation])),a}return Mn(t,e),Cn(t,[{key:"setWeights",value:function(e){"channels_first"===this.dataFormat&&(e[0].tensor=e[0].tensor.transpose(2,3,4,1,0)),Fn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setWeights",this).call(this,e,!1),this._w2row(),this.gpu&&(this.weights.kernel=this.wRowsMat,this.weights.kernel.createGLTexture({type:"2d",format:"float"}),this.useBias&&this.weights.bias.createGLTexture({type:"2d",format:"float"}))}},{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_calcOutputShape",value:function(e){if(!(this.outputShape&&this.inputPadding)){var t=e[0],a=e[1],r=e[2],o=Dn(this.kernelShape,4),n=o[0],i=o[1],l=o[2],s=o[3],u=i+(i-1)*(this.dilationRate[0]-1),p=l+(l-1)*(this.dilationRate[1]-1),d=s+(s-1)*(this.dilationRate[2]-1),c="same"===this.padding?_n((t+this.strides[0]-1)/this.strides[0]):_n((t-u+this.strides[0])/this.strides[0]),g="same"===this.padding?_n((a+this.strides[1]-1)/this.strides[1]):_n((a-p+this.strides[1])/this.strides[1]),h="same"===this.padding?_n((r+this.strides[2]-1)/this.strides[2]):_n((r-d+this.strides[2])/this.strides[2]),f="same"===this.padding?bn(0,_n((c-1)*this.strides[0]+u-t)):0,m="same"===this.padding?bn(0,_n((g-1)*this.strides[1]+p-a)):0,_="same"===this.padding?bn(0,_n((h-1)*this.strides[2]+d-r)):0,y=_n(f/2),x=_n(m/2),v=_n(_/2);this.outputShape=[c,g,h,n],this.inputPadding=[y,f-y,x,m-x,v,_-v]}}},{key:"_padInput",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if("same"===this.padding){var a=Dn(e.tensor.shape,4),r=a[0],o=a[1],n=a[2],i=a[3],s=Dn(this.inputPadding,6),p=s[0],d=s[1],c=s[2],g=s[3],h=s[4],f=s[5],m=new l.default([],[r+p+d,o+c+g,n+h+f,i]);return 0!==t&&u.default.assigns(m.tensor,t),u.default.assign(m.tensor.hi(r+p,o+c,n+h,i).lo(p,c,h,0),e.tensor),m}return e}},{key:"_vol2col",value:function(e){var t=Dn(e.tensor.shape,4),a=t[0],r=t[1],o=t[2],n=t[3],s=this.kernelShape[1],p=this.kernelShape[2],d=this.kernelShape[3],c=this.outputShape[0],g=this.outputShape[1],h=this.outputShape[2],f=s*p*d*n,m=s+(s-1)*(this.dilationRate[0]-1),_=p+(p-1)*(this.dilationRate[1]-1),y=d+(d-1)*(this.dilationRate[2]-1);if(this.volColsMat||(this.volColsMat=new l.default([],[c*g*h,f])),1===m&&1===_&&1===y&&1===this.strides[0]&&1===this.strides[1]&&1===this.strides[2])return this.volColsMat.replaceTensorData(e.tensor.data),this.volColsMat;for(var x=new l.default([],[s,p,d,n]),v=0,b=0;b<=a-m;b+=this.strides[0])for(var i=0;i<=r-_;i+=this.strides[1])for(var S=0;S<=o-y;S+=this.strides[2])u.default.assign(x.tensor,e.tensor.hi(b+m,i+_,S+y,n).lo(b,i,S,0).step(this.dilationRate[0],this.dilationRate[1],this.dilationRate[2],1)),this.volColsMat.tensor.data.set(x.tensor.data,v),v+=f;return this.volColsMat}},{key:"_w2row",value:function(){var e=this.weights.kernel.tensor.shape[3],t=Dn(this.kernelShape,4),a=t[0],r=t[1],o=t[2],i=t[3],s=r*o*i*e;this.wRowsMat=new l.default([],[s,a]);for(var p=new l.default([],[r,o,i,e]),d=new l.default([],[s]),c=0;c<a;c++)u.default.assign(p.tensor,this.weights.kernel.tensor.pick(null,null,null,null,c)),d.replaceTensorData(p.tensor.data),u.default.assign(this.wRowsMat.tensor.pick(null,c),d.tensor);return this.wRowsMat}},{key:"_callCPU",value:function(e){this.inputShape=e.tensor.shape,this._calcOutputShape(this.inputShape),e=this._padInput(e),this._vol2col(e);var t=this.kernelShape[0],a=this.outputShape[0],r=this.outputShape[1],o=this.outputShape[2],i=new l.default([],[a*r*o,t]);if(this.useBias)for(var s=0;s<t;s++)u.default.assigns(i.tensor.pick(null,s),this.weights.bias.tensor.get(s));(0,p.default)(i.tensor,this.volColsMat.tensor,this.wRowsMat.tensor,1,1),this.output=new l.default([],this.outputShape);for(var n=new l.default([],[a*r*o]),d=new l.default([],[a,r,o]),c=0;c<t;c++)u.default.assign(n.tensor,i.tensor.pick(null,c)),d.replaceTensorData(n.tensor.data),u.default.assign(this.output.tensor.pick(null,null,null,c),d.tensor);this.activationFunc(this.output),"channels_first"===this.dataFormat&&(this.output.tensor=this.output.tensor.transpose(3,0,1,2))}},{key:"_createIndexMap",value:function(e){if(!this.indexMap){var t=Dn(this.inputShape,4),a=t[0],r=t[1],o=t[2],n=t[3],s=new l.default(e.data,e.shape,{type:Int32Array});if("same"===this.padding){var p=Dn(this.inputPadding,6),d=p[0],c=p[1],g=p[2],h=p[3],f=p[4],m=p[5];a=a+d+c,r=r+g+h,o=o+f+m;s=this._padInput(s,-1)}var _=this.kernelShape[1],y=this.kernelShape[2],x=this.kernelShape[3],v=this.outputShape[0],b=this.outputShape[1],S=this.outputShape[2],P=_*y*x*n,T=_+(_-1)*(this.dilationRate[0]-1),w=y+(y-1)*(this.dilationRate[1]-1),C=x+(x-1)*(this.dilationRate[2]-1);this.indexMap=new l.default([],[v*b*S,P],{type:Int32Array});for(var F=new l.default([],[_,y,x,n]),M=0,E=0,i=a-T;E<=i;E+=this.strides[0])for(var D=0,I=r-w;D<=I;D+=this.strides[1])for(var A=0,k=o-C;A<=k;A+=this.strides[2])u.default.assign(F.tensor,s.tensor.hi(E+T,D+w,A+C,n).lo(E,D,A,0).step(this.dilationRate[0],this.dilationRate[1],this.dilationRate[2],1)),this.indexMap.tensor.data.set(F.tensor.data,M),M+=P;this.indexMap.createGLTexture({type:"2d",format:"int",supportsTextureFragments:!0})}}},{key:"_callGPU",value:function(e){var t;if(e.is2DReshaped||e.is2DSquareReshaped?(this.inputShape=e.originalShape,this._calcOutputShape(this.inputShape),this._createIndexMap(e.indicesForReshaped),t=[this.indexMap.glTextureShape[0],this.weights.kernel.glTextureShape[1]]):(this.inputShape=e.tensor.shape,this._calcOutputShape(this.inputShape),e=this._padInput(e),this._vol2col(e),this.volColsMat.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),t=[this.volColsMat.glTextureShape[0],this.weights.kernel.glTextureShape[1]]),"linear"===this.activation||this.outputPreactiv||(this.outputPreactiv=new l.default([],t),this.outputPreactiv.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),this.outputPreactiv.is2DReshaped=!0,this.outputPreactiv.originalShape=this.outputShape,this.outputPreactiv.indicesForReshaped=s.createIndicesFor2DReshaped(this.outputShape,!1,-1)),this.output||(this.output=new l.default([],t),this.output.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),this.output.is2DReshaped=!0,this.output.originalShape=this.outputShape,this.output.indicesForReshaped=s.createIndicesFor2DReshaped(this.outputShape,!1,-1)),e.is2DReshaped||e.is2DSquareReshaped){var a=!!e.glTextureFragments;if(a&&e.convert2DRowFragmentedGLTextureToColStack(),!this.convProgram){var r=(0,i.default)("conv2d",this.output.glTextureFragmentShape?this.output.glTextureFragmentShape:this.output.glTextureShape,e.glTextureFragmentShape?e.glTextureFragmentShape:e.glTextureShape,this.indexMap.glTextureFragmentShape?this.indexMap.glTextureFragmentShape:this.indexMap.glTextureShape,this.useBias,a);this.convProgram=XS.webgl2.compileProgram(r)}XS.webgl2.runProgram({program:this.convProgram,output:"linear"===this.activation?this.output:this.outputPreactiv,inputs:[{input:e,name:"x"},{input:this.indexMap,name:"indexMap"},{input:this.weights.kernel,name:"kernel"}].concat(In(this.useBias?[{input:this.weights.bias,name:"bias"}]:[])),supportsTextureFragments:!0}),a&&e.removeGLTextureFragmentsAsColStack()}else{var o=[{input:this.volColsMat,name:"A"},{input:this.weights.kernel,name:"B"}];this.useBias&&o.push({input:this.weights.bias,name:"C"}),XS.webgl2.runProgram({program:this.matMulProgram,output:"linear"===this.activation?this.output:this.outputPreactiv,inputs:o,uniforms:[{value:this.useBias?1:0,type:"bool",name:"addC"}],supportsTextureFragments:!0})}"linear"!==this.activation&&XS.webgl2.runProgram({program:this.activationProgram,output:this.output,inputs:[{input:this.outputPreactiv,name:"x"}],supportsTextureFragments:!0}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.reshapeFrom2D(),"channels_first"===this.dataFormat&&(this.output.tensor=this.output.tensor.transpose(3,0,1,2)))}}]),t}(o.default);t.default=c});le(lT);var sT=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="Cropping1D";var r=e.cropping,o=void 0===r?[0,0]:r;return a.cropping=Array.isArray(o)?o:[o,o],a.description=""+JSON.stringify(a.cropping),a.gpu&&(a.mapInputProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D indexMap;\nuniform int inputCols;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(indexMap, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  int index = texelFetch(indexMap, ivec2(out_x, out_y), 0).r;\n\n  if (index != -1) {\n    int rowIndex = int(floor(float(index) / float(inputCols)));\n    int colIndex = int(mod(float(index), float(inputCols)));\n    float val = texelFetch(x, ivec2(colIndex, rowIndex), 0).r;\n    outColor = vec4(val);\n  } else {\n    outColor = vec4(0.0);\n  }\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){this.inputShape=e.tensor.shape,this.outputShape=[this.inputShape[0]-this.cropping[0]-this.cropping[1],this.inputShape[1]],this.output=new o.default([],this.outputShape),n.default.assign(this.output.tensor,e.tensor.hi(this.inputShape[0]-this.cropping[1],this.inputShape[2]).lo(this.cropping[0],0))}},{key:"_createIndexMap",value:function(){var e,t;if(!this.indexMap){for(var a=new o.default([],this.inputShape,{type:Int32Array}),r=new o.default([],this.inputShape,{type:Int32Array}),l=new o.default([],this.inputShape,{type:Int32Array}),s=0;s<this.inputShape[0];s++)n.default.assigns(r.tensor.pick(s,null),s);for(var i=0;i<this.inputShape[1];i++)n.default.assigns(l.tensor.pick(null,i),i);n.default.muls(a.tensor,r.tensor,this.inputShape[1]),n.default.addeq(a.tensor,l.tensor),this.indexMap=new o.default([],this.outputShape,{type:Int32Array});var u=[this.cropping[0],0],p=[this.inputShape[0]-this.cropping[1],this.inputShape[2]];n.default.assign(this.indexMap.tensor,(e=(t=a.tensor).hi.apply(t,p)).lo.apply(e,u)),this.indexMap.createGLTexture({type:"2d",format:"int"})}}},{key:"_callGPU",value:function(e){e.glTexture||e.createGLTexture({type:"2d",format:"float"}),this.inputShape=e.tensor.shape,this.outputShape=[this.inputShape[0]-this.cropping[0]-this.cropping[1],this.inputShape[1]],this._createIndexMap(),this.output||(this.output=new o.default([],this.outputShape),this.output.createGLTexture({type:"2d",format:"float"})),XS.webgl2.runProgram({program:this.mapInputProgram,output:this.output,inputs:[{input:e,name:"x"},{input:this.indexMap,name:"indexMap"}],uniforms:[{value:e.glTextureShape[1],type:"int",name:"inputCols"}]}),0===this.outbound.length&&this.output.transferFromGLTexture()}}]),t}(r.default);t.default=i});le(sT);var uT=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="Cropping2D";var r=e.cropping,o=void 0===r?[[0,0],[0,0]]:r,n=e.data_format,i=void 0===n?"channels_last":n;return a.cropping=Array.isArray(o)?Array.isArray(o[0])?o:[[o[0],o[0]],[o[1],o[1]]]:[[o,o],[o,o]],a.dataFormat=i,a.description=""+JSON.stringify(a.cropping),a.gpu&&(a.mapInputProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D indexMap;\nuniform int inputCols;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(indexMap, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  int index = texelFetch(indexMap, ivec2(out_x, out_y), 0).r;\n\n  if (index != -1) {\n    int rowIndex = int(floor(float(index) / float(inputCols)));\n    int colIndex = int(mod(float(index), float(inputCols)));\n    float val = texelFetch(x, ivec2(colIndex, rowIndex), 0).r;\n    outColor = vec4(val);\n  } else {\n    outColor = vec4(0.0);\n  }\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){"channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(1,2,0)),this.inputShape=e.tensor.shape,this.outputShape=[this.inputShape[0]-this.cropping[0][0]-this.cropping[0][1],this.inputShape[1]-this.cropping[1][0]-this.cropping[1][1],this.inputShape[2]],this.output=new o.default([],this.outputShape),n.default.assign(this.output.tensor,e.tensor.hi(this.inputShape[0]-this.cropping[0][1],this.inputShape[1]-this.cropping[1][1],this.inputShape[2]).lo(this.cropping[0][0],this.cropping[1][0],0)),"channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(2,0,1),this.output.tensor=this.output.tensor.transpose(2,0,1))}},{key:"_createIndexMap",value:function(e,t){var a,r;if(!this.indexMap){var i=new o.default(e.data,e.shape,{type:Int32Array});this.indexMap=new o.default([],this.outputShape,{type:Int32Array});var l="channels_first"===this.dataFormat?[0,this.cropping[0][0],this.cropping[1][0]]:[this.cropping[0][0],this.cropping[1][0],0],s="channels_first"===this.dataFormat?[this.inputShape[0],this.inputShape[1]-this.cropping[0][1],this.inputShape[2]-this.cropping[1][1]]:[this.inputShape[0]-this.cropping[0][1],this.inputShape[1]-this.cropping[1][1],this.inputShape[2]];n.default.assign(this.indexMap.tensor,(a=(r=i.tensor).hi.apply(r,s)).lo.apply(a,l)),t?this.indexMap.reshapeTo2D():this.indexMap.reshapeTo2DSquare(),this.indexMap.createGLTexture({type:"2d",format:"int"})}}},{key:"_callGPU",value:function(e){e.glTexture||(e.reshapeTo2DSquare(),e.createGLTexture({type:"2d",format:"float"})),this.inputShape=e.originalShape,this.outputShape="channels_first"===this.dataFormat?[this.inputShape[0],this.inputShape[1]-this.cropping[0][0]-this.cropping[0][1],this.inputShape[2]-this.cropping[1][0]-this.cropping[1][1]]:[this.inputShape[0]-this.cropping[0][0]-this.cropping[0][1],this.inputShape[1]-this.cropping[1][0]-this.cropping[1][1],this.inputShape[2]],this._createIndexMap(e.indicesForReshaped,e.is2DReshaped),this.output||(this.output=new o.default([],this.outputShape),e.is2DReshaped?this.output.reshapeTo2D():this.output.reshapeTo2DSquare(),this.output.createGLTexture({type:"2d",format:"float"})),XS.webgl2.runProgram({program:this.mapInputProgram,output:this.output,inputs:[{input:e,name:"x"},{input:this.indexMap,name:"indexMap"}],uniforms:[{value:e.glTextureShape[1],type:"int",name:"inputCols"}]}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.is2DReshaped?this.output.reshapeFrom2D():this.output.reshapeFrom2DSquare())}}]),t}(r.default);t.default=i});le(uT);var pT=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="Cropping3D";var r=e.cropping,o=void 0===r?[[0,0],[0,0],[0,0]]:r,n=e.data_format,i=void 0===n?"channels_last":n;return a.cropping=Array.isArray(o)?Array.isArray(o[0])?o:[[o[0],o[0]],[o[1],o[1]],[o[2],o[2]]]:[[o,o],[o,o],[o,o]],a.dataFormat=i,a.description=""+JSON.stringify(a.cropping),a.gpu&&(a.mapInputProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D indexMap;\nuniform int inputCols;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(indexMap, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  int index = texelFetch(indexMap, ivec2(out_x, out_y), 0).r;\n\n  if (index != -1) {\n    int rowIndex = int(floor(float(index) / float(inputCols)));\n    int colIndex = int(mod(float(index), float(inputCols)));\n    float val = texelFetch(x, ivec2(colIndex, rowIndex), 0).r;\n    outColor = vec4(val);\n  } else {\n    outColor = vec4(0.0);\n  }\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){"channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(1,2,3,0)),this.inputShape=e.tensor.shape,this.outputShape=[this.inputShape[0]-this.cropping[0][0]-this.cropping[0][1],this.inputShape[1]-this.cropping[1][0]-this.cropping[1][1],this.inputShape[2]-this.cropping[2][0]-this.cropping[2][1],this.inputShape[3]],this.output=new o.default([],this.outputShape),n.default.assign(this.output.tensor,e.tensor.hi(this.inputShape[0]-this.cropping[0][1],this.inputShape[1]-this.cropping[1][1],this.inputShape[2]-this.cropping[2][1],this.inputShape[3]).lo(this.cropping[0][0],this.cropping[1][0],this.cropping[2][0],0)),"channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(3,0,1,2),this.output.tensor=this.output.tensor.transpose(3,0,1,2))}},{key:"_createIndexMap",value:function(e,t){var a,r;if(!this.indexMap){var i=new o.default(e.data,e.shape,{type:Int32Array});this.indexMap=new o.default([],this.outputShape,{type:Int32Array});var l="channels_first"===this.dataFormat?[0,this.cropping[0][0],this.cropping[1][0],this.cropping[2][0]]:[this.cropping[0][0],this.cropping[1][0],this.cropping[2][0],0],s="channels_first"===this.dataFormat?[this.inputShape[0],this.inputShape[1]-this.cropping[0][1],this.inputShape[2]-this.cropping[1][1],this.inputShape[3]-this.cropping[2][1]]:[this.inputShape[0]-this.cropping[0][1],this.inputShape[1]-this.cropping[1][1],this.inputShape[2]-this.cropping[2][1],this.inputShape[3]];n.default.assign(this.indexMap.tensor,(a=(r=i.tensor).hi.apply(r,s)).lo.apply(a,l)),t?this.indexMap.reshapeTo2D():this.indexMap.reshapeTo2DSquare(),this.indexMap.createGLTexture({type:"2d",format:"int"})}}},{key:"_callGPU",value:function(e){e.glTexture||(e.reshapeTo2DSquare(),e.createGLTexture({type:"2d",format:"float"})),this.inputShape=e.originalShape,this.outputShape="channels_first"===this.dataFormat?[this.inputShape[0],this.inputShape[1]-this.cropping[0][0]-this.cropping[0][1],this.inputShape[2]-this.cropping[1][0]-this.cropping[1][1],this.inputShape[3]-this.cropping[2][0]-this.cropping[2][1]]:[this.inputShape[0]-this.cropping[0][0]-this.cropping[0][1],this.inputShape[1]-this.cropping[1][0]-this.cropping[1][1],this.inputShape[2]-this.cropping[2][0]-this.cropping[2][1],this.inputShape[3]],this._createIndexMap(e.indicesForReshaped,e.is2DReshaped),this.output||(this.output=new o.default([],this.outputShape),e.is2DReshaped?this.output.reshapeTo2D():this.output.reshapeTo2DSquare(),this.output.createGLTexture({type:"2d",format:"float"})),XS.webgl2.runProgram({program:this.mapInputProgram,output:this.output,inputs:[{input:e,name:"x"},{input:this.indexMap,name:"indexMap"}],uniforms:[{value:e.glTextureShape[1],type:"int",name:"inputCols"}]}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.is2DReshaped?this.output.reshapeFrom2D():this.output.reshapeFrom2DSquare())}}]),t}(r.default);t.default=i});le(pT);var dT=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="UpSampling1D";var r=e.size,o=void 0===r?2:r;return a.size=o,a.description="size "+o,a.gpu&&(a.mapInputProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D indexMap;\nuniform int inputCols;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(indexMap, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  int index = texelFetch(indexMap, ivec2(out_x, out_y), 0).r;\n\n  if (index != -1) {\n    int rowIndex = int(floor(float(index) / float(inputCols)));\n    int colIndex = int(mod(float(index), float(inputCols)));\n    float val = texelFetch(x, ivec2(colIndex, rowIndex), 0).r;\n    outColor = vec4(val);\n  } else {\n    outColor = vec4(0.0);\n  }\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){this.inputShape=e.tensor.shape,this.outputShape=[this.inputShape[0]*this.size,this.inputShape[1]],this.output=new o.default([],this.outputShape);for(var t=0;t<this.size;t++)n.default.assign(this.output.tensor.lo(t,0).step(this.size,1),e.tensor)}},{key:"_createIndexMap",value:function(){if(!this.indexMap){for(var e=new o.default([],this.inputShape,{type:Int32Array}),t=new o.default([],this.inputShape,{type:Int32Array}),a=new o.default([],this.inputShape,{type:Int32Array}),r=0;r<this.inputShape[0];r++)n.default.assigns(t.tensor.pick(r,null),r);for(var i=0;i<this.inputShape[1];i++)n.default.assigns(a.tensor.pick(null,i),i);n.default.muls(e.tensor,t.tensor,this.inputShape[1]),n.default.addeq(e.tensor,a.tensor),this.indexMap=new o.default([],this.outputShape,{type:Int32Array});for(var l=0;l<this.size;l++)n.default.assign(this.indexMap.tensor.lo(l,0).step(this.size,1),e.tensor);this.indexMap.createGLTexture({type:"2d",format:"int"})}}},{key:"_callGPU",value:function(e){e.glTexture||e.createGLTexture({type:"2d",format:"float"}),this.inputShape=e.tensor.shape,this.outputShape=[this.inputShape[0]*this.size,this.inputShape[1]],this._createIndexMap(),this.output||(this.output=new o.default([],this.outputShape),this.output.createGLTexture({type:"2d",format:"float"})),XS.webgl2.runProgram({program:this.mapInputProgram,output:this.output,inputs:[{input:e,name:"x"},{input:this.indexMap,name:"indexMap"}],uniforms:[{value:e.glTextureShape[1],type:"int",name:"inputCols"}]}),0===this.outbound.length&&this.output.transferFromGLTexture()}}]),t}(r.default);t.default=i});le(dT);var cT=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="UpSampling2D";var r=e.size,o=void 0===r?[2,2]:r,n=e.data_format,i=void 0===n?"channels_last":n;return a.size=Array.isArray(o)?o:[o,o],a.dataFormat=i,a.description="size "+a.size.join("x"),a.gpu&&(a.mapInputProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D indexMap;\nuniform int inputCols;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(indexMap, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  int index = texelFetch(indexMap, ivec2(out_x, out_y), 0).r;\n\n  if (index != -1) {\n    int rowIndex = int(floor(float(index) / float(inputCols)));\n    int colIndex = int(mod(float(index), float(inputCols)));\n    float val = texelFetch(x, ivec2(colIndex, rowIndex), 0).r;\n    outColor = vec4(val);\n  } else {\n    outColor = vec4(0.0);\n  }\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){"channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(1,2,0)),this.inputShape=e.tensor.shape,this.outputShape=[this.inputShape[0]*this.size[0],this.inputShape[1]*this.size[1],this.inputShape[2]],this.output=new o.default([],this.outputShape);for(var t=0;t<this.size[0];t++)for(var a=0;a<this.size[1];a++)n.default.assign(this.output.tensor.lo(t,a,0).step(this.size[0],this.size[1],1),e.tensor);"channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(2,0,1),this.output.tensor=this.output.tensor.transpose(2,0,1))}},{key:"_createIndexMap",value:function(e,t){if(!this.indexMap){var a=new o.default(e.data,e.shape,{type:Int32Array});this.indexMap=new o.default([],this.outputShape,{type:Int32Array});for(var r=0;r<this.size[0];r++)for(var i=0;i<this.size[1];i++){var l="channels_first"===this.dataFormat?[0,r,i]:[r,i,0],s="channels_first"===this.dataFormat?[1,this.size[0],this.size[1]]:[this.size[0],this.size[1],1],u,p;n.default.assign((u=(p=this.indexMap.tensor).lo.apply(p,l)).step.apply(u,s),a.tensor)}t?this.indexMap.reshapeTo2D():this.indexMap.reshapeTo2DSquare(),this.indexMap.createGLTexture({type:"2d",format:"int"})}}},{key:"_callGPU",value:function(e){e.glTexture||(e.reshapeTo2DSquare(),e.createGLTexture({type:"2d",format:"float"})),this.inputShape=e.originalShape,this.outputShape="channels_first"===this.dataFormat?[this.inputShape[0],this.inputShape[1]*this.size[0],this.inputShape[2]*this.size[1]]:[this.inputShape[0]*this.size[0],this.inputShape[1]*this.size[1],this.inputShape[2]],this._createIndexMap(e.indicesForReshaped,e.is2DReshaped),this.output||(this.output=new o.default([],this.outputShape),e.is2DReshaped?this.output.reshapeTo2D():this.output.reshapeTo2DSquare(),this.output.createGLTexture({type:"2d",format:"float"})),XS.webgl2.runProgram({program:this.mapInputProgram,output:this.output,inputs:[{input:e,name:"x"},{input:this.indexMap,name:"indexMap"}],uniforms:[{value:e.glTextureShape[1],type:"int",name:"inputCols"}]}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.is2DReshaped?this.output.reshapeFrom2D():this.output.reshapeFrom2DSquare())}}]),t}(r.default);t.default=i});le(cT);var gT=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="UpSampling3D";var r=e.size,o=void 0===r?[2,2,2]:r,n=e.data_format,i=void 0===n?"channels_last":n;return a.size=Array.isArray(o)?o:[o,o,o],a.dataFormat=i,a.description="size "+a.size.join("x"),a.gpu&&(a.mapInputProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D indexMap;\nuniform int inputCols;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(indexMap, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  int index = texelFetch(indexMap, ivec2(out_x, out_y), 0).r;\n\n  if (index != -1) {\n    int rowIndex = int(floor(float(index) / float(inputCols)));\n    int colIndex = int(mod(float(index), float(inputCols)));\n    float val = texelFetch(x, ivec2(colIndex, rowIndex), 0).r;\n    outColor = vec4(val);\n  } else {\n    outColor = vec4(0.0);\n  }\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){"channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(1,2,3,0)),this.inputShape=e.tensor.shape,this.outputShape=[this.inputShape[0]*this.size[0],this.inputShape[1]*this.size[1],this.inputShape[2]*this.size[2],this.inputShape[3]],this.output=new o.default([],this.outputShape);for(var t=0;t<this.size[0];t++)for(var a=0;a<this.size[1];a++)for(var r=0;r<this.size[2];r++)n.default.assign(this.output.tensor.lo(t,a,r,0).step(this.size[0],this.size[1],this.size[2],1),e.tensor);"channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(3,0,1,2),this.output.tensor=this.output.tensor.transpose(3,0,1,2))}},{key:"_createIndexMap",value:function(e,t){if(!this.indexMap){var a=new o.default(e.data,e.shape,{type:Int32Array});this.indexMap=new o.default([],this.outputShape,{type:Int32Array});for(var r=0;r<this.size[0];r++)for(var i=0;i<this.size[1];i++)for(var l=0;l<this.size[2];l++){var s="channels_first"===this.dataFormat?[0,r,i,l]:[r,i,l,0],u="channels_first"===this.dataFormat?[1,this.size[0],this.size[1],this.size[2]]:[this.size[0],this.size[1],this.size[2],1],p,d;n.default.assign((p=(d=this.indexMap.tensor).lo.apply(d,s)).step.apply(p,u),a.tensor)}t?this.indexMap.reshapeTo2D():this.indexMap.reshapeTo2DSquare(),this.indexMap.createGLTexture({type:"2d",format:"int"})}}},{key:"_callGPU",value:function(e){e.glTexture||(e.reshapeTo2DSquare(),e.createGLTexture({type:"2d",format:"float"})),this.inputShape=e.originalShape,this.outputShape="channels_first"===this.dataFormat?[this.inputShape[0],this.inputShape[1]*this.size[0],this.inputShape[2]*this.size[1],this.inputShape[3]*this.size[2]]:[this.inputShape[0]*this.size[0],this.inputShape[1]*this.size[1],this.inputShape[2]*this.size[2],this.inputShape[3]],this._createIndexMap(e.indicesForReshaped,e.is2DReshaped),this.output||(this.output=new o.default([],this.outputShape),e.is2DReshaped?this.output.reshapeTo2D():this.output.reshapeTo2DSquare(),this.output.createGLTexture({type:"2d",format:"float"})),XS.webgl2.runProgram({program:this.mapInputProgram,output:this.output,inputs:[{input:e,name:"x"},{input:this.indexMap,name:"indexMap"}],uniforms:[{value:e.glTextureShape[1],type:"int",name:"inputCols"}]}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.is2DReshaped?this.output.reshapeFrom2D():this.output.reshapeFrom2DSquare())}}]),t}(r.default);t.default=i});le(gT);var hT=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="ZeroPadding1D";var r=e.padding,o=void 0===r?[1,1]:r;return a.padding=Array.isArray(o)?o:[o,o],a.description=""+JSON.stringify(a.padding),a.gpu&&(a.mapInputProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D indexMap;\nuniform int inputCols;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(indexMap, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  int index = texelFetch(indexMap, ivec2(out_x, out_y), 0).r;\n\n  if (index != -1) {\n    int rowIndex = int(floor(float(index) / float(inputCols)));\n    int colIndex = int(mod(float(index), float(inputCols)));\n    float val = texelFetch(x, ivec2(colIndex, rowIndex), 0).r;\n    outColor = vec4(val);\n  } else {\n    outColor = vec4(0.0);\n  }\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){this.inputShape=e.tensor.shape,this.outputShape=[this.inputShape[0]+this.padding[0]+this.padding[1],this.inputShape[1]],this.output=new o.default([],this.outputShape),n.default.assign(this.output.tensor.hi(this.inputShape[0]+this.padding[0],this.inputShape[1]).lo(this.padding[0],0),e.tensor)}},{key:"_createIndexMap",value:function(){var e,t;if(!this.indexMap){for(var a=new o.default([],this.inputShape,{type:Int32Array}),r=new o.default([],this.inputShape,{type:Int32Array}),l=new o.default([],this.inputShape,{type:Int32Array}),s=0;s<this.inputShape[0];s++)n.default.assigns(r.tensor.pick(s,null),s);for(var i=0;i<this.inputShape[1];i++)n.default.assigns(l.tensor.pick(null,i),i);n.default.muls(a.tensor,r.tensor,this.inputShape[1]),n.default.addeq(a.tensor,l.tensor),this.indexMap=new o.default([],this.outputShape,{type:Int32Array});var u=[this.padding[0],0],p=[this.inputShape[0]+this.padding[0],this.inputShape[1]];n.default.assigns(this.indexMap.tensor,-1),n.default.assign((e=(t=this.indexMap.tensor).hi.apply(t,p)).lo.apply(e,u),a.tensor),this.indexMap.createGLTexture({type:"2d",format:"int"})}}},{key:"_callGPU",value:function(e){e.glTexture||e.createGLTexture({type:"2d",format:"float"}),this.inputShape=e.tensor.shape,this.outputShape=[this.inputShape[0]+this.padding[0]+this.padding[1],this.inputShape[1]],this._createIndexMap(),this.output||(this.output=new o.default([],this.outputShape),this.output.createGLTexture({type:"2d",format:"float"})),XS.webgl2.runProgram({program:this.mapInputProgram,output:this.output,inputs:[{input:e,name:"x"},{input:this.indexMap,name:"indexMap"}],uniforms:[{value:e.glTextureShape[1],type:"int",name:"inputCols"}]}),0===this.outbound.length&&this.output.transferFromGLTexture()}}]),t}(r.default);t.default=i});le(hT);var fT=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="ZeroPadding2D";var r=e.padding,o=void 0===r?[[1,1],[1,1]]:r,n=e.data_format,i=void 0===n?"channels_last":n;return a.padding=Array.isArray(o)?Array.isArray(o[0])?o:[[o[0],o[0]],[o[1],o[1]]]:[[o,o],[o,o]],a.dataFormat=i,a.description=""+JSON.stringify(a.padding),a.gpu&&(a.mapInputProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D indexMap;\nuniform int inputCols;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(indexMap, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  int index = texelFetch(indexMap, ivec2(out_x, out_y), 0).r;\n\n  if (index != -1) {\n    int rowIndex = int(floor(float(index) / float(inputCols)));\n    int colIndex = int(mod(float(index), float(inputCols)));\n    float val = texelFetch(x, ivec2(colIndex, rowIndex), 0).r;\n    outColor = vec4(val);\n  } else {\n    outColor = vec4(0.0);\n  }\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){"channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(1,2,0)),this.inputShape=e.tensor.shape,this.outputShape=[this.inputShape[0]+this.padding[0][0]+this.padding[0][1],this.inputShape[1]+this.padding[1][0]+this.padding[1][1],this.inputShape[2]],this.output=new o.default([],this.outputShape),n.default.assign(this.output.tensor.hi(this.inputShape[0]+this.padding[0][0],this.inputShape[1]+this.padding[1][0],this.inputShape[2]).lo(this.padding[0][0],this.padding[1][0],0),e.tensor),"channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(2,0,1),this.output.tensor=this.output.tensor.transpose(2,0,1))}},{key:"_createIndexMap",value:function(e,t){var a,r;if(!this.indexMap){var i=new o.default(e.data,e.shape,{type:Int32Array});this.indexMap=new o.default([],this.outputShape,{type:Int32Array});var l="channels_first"===this.dataFormat?[0,this.padding[0][0],this.padding[1][0]]:[this.padding[0][0],this.padding[1][0],0],s="channels_first"===this.dataFormat?[this.inputShape[0],this.inputShape[1]+this.padding[0][0],this.inputShape[2]+this.padding[1][0]]:[this.inputShape[0]+this.padding[0][0],this.inputShape[1]+this.padding[1][0],this.inputShape[2]];n.default.assigns(this.indexMap.tensor,-1),n.default.assign((a=(r=this.indexMap.tensor).hi.apply(r,s)).lo.apply(a,l),i.tensor),t?this.indexMap.reshapeTo2D():this.indexMap.reshapeTo2DSquare(),this.indexMap.createGLTexture({type:"2d",format:"int"})}}},{key:"_callGPU",value:function(e){e.glTexture||(e.reshapeTo2DSquare(),e.createGLTexture({type:"2d",format:"float"})),this.inputShape=e.originalShape,this.outputShape="channels_first"===this.dataFormat?[this.inputShape[0],this.inputShape[1]+this.padding[0][0]+this.padding[0][1],this.inputShape[2]+this.padding[1][0]+this.padding[1][1]]:[this.inputShape[0]+this.padding[0][0]+this.padding[0][1],this.inputShape[1]+this.padding[1][0]+this.padding[1][1],this.inputShape[2]],this._createIndexMap(e.indicesForReshaped,e.is2DReshaped),this.output||(this.output=new o.default([],this.outputShape),e.is2DReshaped?this.output.reshapeTo2D():this.output.reshapeTo2DSquare(),this.output.createGLTexture({type:"2d",format:"float"})),XS.webgl2.runProgram({program:this.mapInputProgram,output:this.output,inputs:[{input:e,name:"x"},{input:this.indexMap,name:"indexMap"}],uniforms:[{value:e.glTextureShape[1],type:"int",name:"inputCols"}]}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.is2DReshaped?this.output.reshapeFrom2D():this.output.reshapeFrom2DSquare())}}]),t}(r.default);t.default=i});le(fT);var mT=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="ZeroPadding3D";var r=e.padding,o=void 0===r?[[1,1],[1,1],[1,1]]:r,n=e.data_format,i=void 0===n?"channels_last":n;return a.padding=Array.isArray(o)?Array.isArray(o[0])?o:[[o[0],o[0]],[o[1],o[1]],[o[2],o[2]]]:[[o,o],[o,o],[o,o]],a.dataFormat=i,a.description=""+JSON.stringify(a.padding),a.gpu&&(a.mapInputProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D indexMap;\nuniform int inputCols;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(indexMap, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  int index = texelFetch(indexMap, ivec2(out_x, out_y), 0).r;\n\n  if (index != -1) {\n    int rowIndex = int(floor(float(index) / float(inputCols)));\n    int colIndex = int(mod(float(index), float(inputCols)));\n    float val = texelFetch(x, ivec2(colIndex, rowIndex), 0).r;\n    outColor = vec4(val);\n  } else {\n    outColor = vec4(0.0);\n  }\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){"channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(1,2,3,0)),this.inputShape=e.tensor.shape,this.outputShape=[this.inputShape[0]+this.padding[0][0]+this.padding[0][1],this.inputShape[1]+this.padding[1][0]+this.padding[1][1],this.inputShape[2]+this.padding[2][0]+this.padding[2][1],this.inputShape[3]],this.output=new o.default([],this.outputShape),n.default.assign(this.output.tensor.hi(this.inputShape[0]+this.padding[0][0],this.inputShape[1]+this.padding[1][0],this.inputShape[2]+this.padding[2][0],this.inputShape[3]).lo(this.padding[0][0],this.padding[1][0],this.padding[2][0],0),e.tensor),"channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(3,0,1,2),this.output.tensor=this.output.tensor.transpose(3,0,1,2))}},{key:"_createIndexMap",value:function(e,t){var a,r;if(!this.indexMap){var i=new o.default(e.data,e.shape,{type:Int32Array});this.indexMap=new o.default([],this.outputShape,{type:Int32Array});var l="channels_first"===this.dataFormat?[0,this.padding[0][0],this.padding[1][0],this.padding[2][0]]:[this.padding[0][0],this.padding[1][0],this.padding[2][0],0],s="channels_first"===this.dataFormat?[this.inputShape[0],this.inputShape[1]+this.padding[0][0],this.inputShape[2]+this.padding[1][0],this.inputShape[3]+this.padding[2][0]]:[this.inputShape[0]+this.padding[0][0],this.inputShape[1]+this.padding[1][0],this.inputShape[2]+this.padding[2][0],this.inputShape[3]];n.default.assigns(this.indexMap.tensor,-1),n.default.assign((a=(r=this.indexMap.tensor).hi.apply(r,s)).lo.apply(a,l),i.tensor),t?this.indexMap.reshapeTo2D():this.indexMap.reshapeTo2DSquare(),this.indexMap.createGLTexture({type:"2d",format:"int"})}}},{key:"_callGPU",value:function(e){e.glTexture||(e.reshapeTo2DSquare(),e.createGLTexture({type:"2d",format:"float"})),this.inputShape=e.originalShape,this.outputShape="channels_first"===this.dataFormat?[this.inputShape[0],this.inputShape[1]+this.padding[0][0]+this.padding[0][1],this.inputShape[2]+this.padding[1][0]+this.padding[1][1],this.inputShape[3]+this.padding[2][0]+this.padding[2][1]]:[this.inputShape[0]+this.padding[0][0]+this.padding[0][1],this.inputShape[1]+this.padding[1][0]+this.padding[1][1],this.inputShape[2]+this.padding[2][0]+this.padding[2][1],this.inputShape[3]],this._createIndexMap(e.indicesForReshaped,e.is2DReshaped),this.output||(this.output=new o.default([],this.outputShape),e.is2DReshaped?this.output.reshapeTo2D():this.output.reshapeTo2DSquare(),this.output.createGLTexture({type:"2d",format:"float"})),XS.webgl2.runProgram({program:this.mapInputProgram,output:this.output,inputs:[{input:e,name:"x"},{input:this.indexMap,name:"indexMap"}],uniforms:[{value:e.glTextureShape[1],type:"int",name:"inputCols"}]}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.is2DReshaped?this.output.reshapeFrom2D():this.output.reshapeFrom2DSquare())}}]),t}(r.default);t.default=i});le(mT);var _T=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Conv1D",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"Conv2D",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"SeparableConv2D",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"Conv2DTranspose",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"Conv3D",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"Cropping1D",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"Cropping2D",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"Cropping3D",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"UpSampling1D",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"UpSampling2D",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"UpSampling3D",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(t,"ZeroPadding1D",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"ZeroPadding2D",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"ZeroPadding3D",{enumerable:!0,get:function(){return m.default}});var r=a(oT),o=a(aT),n=a(nT),i=a(iT),l=a(lT),s=a(sT),u=a(uT),p=a(pT),d=a(dT),c=a(cT),g=a(gT),h=a(hT),f=a(fT),m=a(mT)});le(_T);var yT=function(e,t){var a=e.data,r=t.data,o=e.stride[0],n=t.stride[0],l=e.offset,s=t.offset,u,i;for(u=e.shape[0]-1;0<=u;u--,l+=o,s+=n)i=a[l],a[l]=r[s],r[s]=i},xT=function(e,t){var a=t.data,r=t.stride[0],o=t.offset,n;for(n=t.shape[0]-1;0<=n;n--,o+=r)a[o]*=e},vT=function(e,t){var a=e.data,r=t.data,o=e.stride[0],n=t.stride[0],l=e.offset,s=t.offset,u;for(u=e.shape[0]-1;0<=u;u--,l+=o,s+=n)r[s]=a[l]},bT=function(e,t,a){var r=t.data,o=a.data,n=t.stride[0],l=a.stride[0],s=t.offset,u=a.offset,p;for(p=t.shape[0]-1;0<=p;p--,s+=n,u+=l)o[u]+=e*r[s]},ST=function(e,t){var a=e.data,r=e.stride[0],o=e.offset,n=0,l,i;if(e===t)for(l=e.shape[0]-1;0<=l;l--,o+=r)i=a[o],n+=i*i;else{var s=t.data,u=t.stride[0],p=t.offset;for(l=e.shape[0]-1;0<=l;l--,o+=r,p+=u)n+=s[p]*a[o]}return n},PT=function(e,t,a){var r=t.data,o=a.data,n=t.stride[0],l=a.stride[0],s=t.offset,u=a.offset,p;for(p=t.shape[0]-1;0<=p;p--,s+=n,u+=l)o[u]=e*r[s]},TT=function(e,a){if(0===e&&0===a)return 0;var r=Sn(e),o=Sn(a),n=vn(r,o),t=bn(r,o);return n/=t,t*Pn(1+n*n)},wT=function(e){var t=e.data,a=e.stride[0],r=e.offset,o=0,n,i;for(n=e.shape[0]-1;0<=n;n--,r+=a)i=t[r],o=TT(o,i);return o},kT=function(e){var t=e.data,a=e.stride[0],r=e.offset,o=0,n;for(n=e.shape[0]-1;0<=n;n--,r+=a)o+=Sn(t[r]);return o},CT=function(e){var t=-Infinity,a=e.data,r=e.stride[0],o=e.offset,n=e.shape[0],l,i,s;for(l=0;l<n;l++,o+=r)i=Sn(a[o]),i>t&&(t=i,s=l);return s};gn=gn||function(e){return e=+e,0===e||isNaN(e)?e:0<e?1:-1};var FT=function(e,a,o){var n=0,i=0,l=0,r=0,t=0;return 0===a?(n=gn(e),i=0,l=Sn(e)):0===e?(n=0,i=gn(a),l=Sn(a)):Sn(e)>Sn(a)?(r=a/e,t=gn(e)*Pn(1+r*r),n=1/t,i=r*n,l=e*t):(r=e/a,t=gn(e)*Pn(1+r*r),i=1/t,n=r*i,l=a*t),void 0!==o&&2<o.length?void(o[0]=n,o[1]=i,o[2]=l):[n,i,l]},MT=yT,ET=xT,DT=vT,IT=bT,AT=ST,RT=PT,OT=wT,LT=kT,jT=CT,zT=FT,GT={swap:MT,scal:ET,copy:DT,axpy:IT,dot:AT,cpsc:RT,nrm2:OT,asum:LT,iamax:jT,rotg:zT},UT=$r,NT=Kr,qT=Zr,BT=Qr,VT=se(function(e){e.exporst=function(){console.error("SPMV (symmetric packed matrix vector multiply) not yet implemented")}}),HT=Jr,WT=eo,XT=to,YT=se(function(e){e.exporst=function(){console.error("TBSV (triangular banded matrix solver) not yet implemented")}}),$T=ao,KT=ro,ZT=oo,QT=no,JT=io,ew=lo,tw=se(function(e){e.exports.gemv=UT,e.exports.gbmv=NT,e.exports.symv=qT,e.exports.sbmv=BT,e.exports.spmv=VT,e.exports.trmv=HT,e.exports.tbmv=WT,e.exports.trsv=XT,e.exports.tbsv=YT,e.exports.tpsv=$T,e.exports.ger=KT,e.exports.syr=ZT,e.exports.spr=QT,e.exports.syr2=JT,e.exports.spr2=ew,e.exports.trmv_lower=function(t,a){return console.warn("trmv_lower is deprecated. Please use the 'isLower' flag with trmv."),e.exports.trmv(t,a,!0)},e.exports.trsv_lower=function(t,a){return console.warn("trsv_lower is deprecated. Please use the 'isLower' flag with trsv."),e.exports.trsv(t,a,!0)}}),aw=se(function(e,t){function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(YS),n=r(cP),i=a(EP),l=r(uP),s=a(tT),u=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="Dense";var r=e.units,o=void 0===r?1:r,n=e.activation,l=void 0===n?"linear":n,u=e.input_dim,p=void 0===u?null:u,d=e.use_bias;return a.description=l+" activation, output dimensions: "+o,a.activation=l,a.activationFunc=i[a.activation],a.units=o,a.input_dim=p,a.use_bias=void 0===d||d,a.params=a.use_bias?["kernel","bias"]:["kernel"],a.input_dim&&(a.inputShape=[a.input_dim]),a.gpu&&(a.matMulProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D A;\nuniform sampler2D B;\nuniform sampler2D C;\nuniform bool addC;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 A_size = textureSize(A, 0);\n  ivec2 B_size = textureSize(B, 0);\n  int out_x = int(float(B_size[0]) * outTex.x);\n  int out_y = int(float(A_size[1]) * outTex.y);\n  int commonDim = A_size[0];\n\n  float sum = 0.;\n  for (int i = 0; i < commonDim; ++i) {\n    float a = texelFetch(A, ivec2(i, out_y), 0).r;\n    float b = texelFetch(B, ivec2(out_x, i), 0).r;\n    sum += a * b;\n  }\n\n  if (addC) {\n    sum += texelFetch(C, ivec2(out_x, 0), 0).r;\n  }\n\n  outColor = vec4(sum);\n}\n"),a.activationProgram=XS.webgl2.compileProgram(s[a.activation])),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){this.output=new n.default([],[this.units]),this.use_bias&&l.default.assign(this.output.tensor,this.weights.bias.tensor),(0,tw.gemv)(1,this.weights.kernel.tensor.transpose(1,0),e.tensor,1,this.output.tensor),this.activationFunc(this.output)}},{key:"_callGPU",value:function(e){e.glTexture||e.createGLTexture({type:"2d",format:"float"}),"linear"===this.activation||this.outputPreactiv||(this.outputPreactiv=new n.default([],[this.units]),this.outputPreactiv.createGLTexture({type:"2d",format:"float"})),this.output||(this.output=new n.default([],[this.units]),this.output.createGLTexture({type:"2d",format:"float"}));var t=[{input:e,name:"A"},{input:this.weights.kernel,name:"B"}];this.use_bias&&t.push({input:this.weights.bias,name:"C"}),XS.webgl2.runProgram({program:this.matMulProgram,output:"linear"===this.activation?this.output:this.outputPreactiv,inputs:t,uniforms:[{value:this.use_bias?1:0,type:"bool",name:"addC"}]}),"linear"!==this.activation&&XS.webgl2.runProgram({program:this.activationProgram,output:this.output,inputs:[{input:this.outputPreactiv,name:"x"}]}),0===this.outbound.length&&this.output.transferFromGLTexture()}}]),t}(o.default);t.default=u});le(aw);var rw=se(function(e,t){function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(YS),n=r(cP),i=a(EP),l=a(tT),s=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="Activation";var r=e.activation,o=void 0===r?"linear":r;return a.activation=o,a.activationFunc=i[o],a.description=""+a.activation,a.gpu&&(a.program=XS.webgl2.compileProgram(l[a.activation])),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return"linear"===this.activation?(this.output=e,this.output):(this.gpu?this._callGPU(e):this._callCPU(e),this.output)}},{key:"_callCPU",value:function(e){this.output=new n.default(new e.arrayType(e.tensor.data),e.tensor.shape),this.activationFunc(this.output)}},{key:"_callGPU",value:function(e){e.glTexture||e.glTextureFragments||e.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),this.output||(this.output=new n.default([],e.glTextureShape),this.output.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),e.is1D?this.output.is1D=e.is1D:(e.is2DReshaped||e.is2DSquareReshaped)&&(e.is2DReshaped?this.output.is2DReshaped=e.is2DReshaped:e.is2DSquareReshaped&&(this.output.is2DSquareReshaped=e.is2DSquareReshaped),this.output.originalShape=e.originalShape,this.output.indicesForReshaped=e.indicesForReshaped)),XS.webgl2.runProgram({program:this.program,output:this.output,inputs:[{input:e,name:"x"}],supportsTextureFragments:!0}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.is2DReshaped?this.output.reshapeFrom2D():this.output.is2DSquareReshaped&&this.output.reshapeFrom2DSquare())}}]),t}(o.default);t.default=s});le(rw);var ow=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(YS),r=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="Dropout";var r=e.rate,o=void 0===r?0.5:r;return a.description=""+o,a.rate=vn(bn(0,o),1),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.output=e,this.output}}]),t}(a.default);t.default=r});le(ow);var nw=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(YS),r=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="SpatialDropout1D";var r=e.p,o=void 0===r?0.5:r;return a.description=""+o,a.p=vn(bn(0,o),1),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.output=e,this.output}}]),t}(a.default);t.default=r});le(nw);var iw=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(YS),r=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="SpatialDropout2D";var r=e.rate,o=void 0===r?0.5:r,n=e.data_format,i=void 0===n?"channels_last":n;return a.description=""+o,a.rate=vn(bn(0,o),1),a.dataFormat=i,a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.output=e,this.output}}]),t}(a.default);t.default=r});le(iw);var lw=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(YS),r=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="SpatialDropout3D";var r=e.rate,o=void 0===r?0.5:r,n=e.data_format,i=void 0===n?"channels_last":n;return a.description=""+o,a.rate=vn(bn(0,o),1),a.dataFormat=i,a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.output=e,this.output}}]),t}(a.default);t.default=r});le(lw);var sw=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="Flatten",a.gpu&&(a.flattenProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform int outputSize;\nuniform int inputCols;\nout vec4 outColor;\n\nvoid main() {\n  int out_x = int(float(outputSize) * outTex.x);\n  int out_y = 0;\n\n  int i = int(floor(float(out_x) / float(inputCols)));\n  int j = int(mod(float(out_x), float(inputCols)));\n  outColor = vec4(texelFetch(x, ivec2(j, i), 0).r);\n}\n"),a.flattenFragmentsProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform int outputSize;\nuniform int inputRows;\nuniform int inputCols;\nout vec4 outColor;\n\nvoid main() {\n  int out_x = int(float(outputSize) * outTex.x);\n  int out_y = 0;\n\n  int rowIndex = int(mod(floor(float(out_x) / float(inputCols)), float(inputRows)));\n  int colIndex = int(mod(float(out_x), float(inputCols)));\n  int fragmentIndex = int(floor(float(out_x) / (float(inputRows) * float(inputCols))));\n  colIndex += fragmentIndex * inputCols;\n  outColor = vec4(texelFetch(x, ivec2(colIndex, rowIndex), 0).r);\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){1>=e.tensor.shape.length?this.output=e:(this.output=new o.default([],[e.tensor.shape.reduce(function(e,t){return e*t},1)]),this.output.replaceTensorData(e.tensor.data))}},{key:"_callGPU",value:function(e){e.glTexture||e.glTextureFragments||(2>=e.tensor.shape.length?e.createGLTexture({type:"2d",format:"float"}):2<e.tensor.shape.length&&!e.is2DReshaped&&(e.reshapeTo2D(),e.createGLTexture({type:"2d",format:"float"}))),this.output||(this.output=new o.default([],[e.glTextureShape.reduce(function(e,t){return e*t},1)]),this.output.createGLTexture({type:"2d",format:"float"})),e.glTextureFragments?(e.convert2DRowFragmentedGLTextureToColStack(),XS.webgl2.runProgram({program:this.flattenFragmentsProgram,output:this.output,inputs:[{input:e,name:"x"}],uniforms:[{value:this.output.glTextureShape[1],type:"int",name:"outputSize"},{value:e.glTextureShape[0],type:"int",name:"inputRows"},{value:e.glTextureShape[1],type:"int",name:"inputCols"}],supportsTextureFragments:!0}),e.removeGLTextureFragmentsAsColStack()):XS.webgl2.runProgram({program:this.flattenProgram,output:this.output,inputs:[{input:e,name:"x"}],uniforms:[{value:this.output.glTextureShape[1],type:"int",name:"outputSize"},{value:e.glTextureShape[1],type:"int",name:"inputCols"}],supportsTextureFragments:!0}),0===this.outbound.length&&this.output.transferFromGLTexture()}}]),t}(r.default);t.default=n});le(sw);var uw=so,pw=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(uw),o=a(YS),n=a(cP),l=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="Reshape";var r=e.target_shape,o=void 0===r?[]:r;return a.targetShape=o,a.description="target shape: "+JSON.stringify(a.targetShape),a.gpu&&(a.mapInputProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D indexMap;\nuniform int inputCols;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(indexMap, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  int index = texelFetch(indexMap, ivec2(out_x, out_y), 0).r;\n\n  if (index != -1) {\n    int rowIndex = int(floor(float(index) / float(inputCols)));\n    int colIndex = int(mod(float(index), float(inputCols)));\n    float val = texelFetch(x, ivec2(colIndex, rowIndex), 0).r;\n    outColor = vec4(val);\n  } else {\n    outColor = vec4(0.0);\n  }\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){this.targetShape.reduce(function(e,t){return e*t},1)!==e.tensor.size&&this.throwError("The total size of new array must be unchanged in reshape layer."),this.output=new n.default([],this.targetShape),this.output.replaceTensorData(e.tensor.data)}},{key:"_createIndexMap",value:function(){if(!this.indexMap){var e=new n.default([],this.inputShape,{type:Int32Array}),t=new n.default([],this.inputShape,{type:Int32Array}),a=new n.default([],this.inputShape,{type:Int32Array});if(2===this.inputShape.length)for(var o=0;o<this.inputShape[0];o++)l.default.assigns(t.tensor.pick(o,null),o);else if(3===this.inputShape.length)for(var i=0;i<this.inputShape[0];i++)for(var s=0;s<this.inputShape[1];s++)l.default.assigns(t.tensor.pick(i,s,null),i*this.inputShape[1]+s);else if(4===this.inputShape.length)for(var u=0;u<this.inputShape[0];u++)for(var p=0;p<this.inputShape[1];p++)for(var d=0;d<this.inputShape[2];d++)l.default.assigns(t.tensor.pick(u,p,d,null),u*this.inputShape[1]*this.inputShape[2]+p*this.inputShape[2]+d);for(var g=0;g<(0,r.default)(this.inputShape);g++){var c;l.default.assigns((c=a.tensor).pick.apply(c,In(Array(this.inputShape.length-1).fill(null)).concat([g])),g)}l.default.muls(e.tensor,t.tensor,(0,r.default)(this.inputShape)),l.default.addeq(e.tensor,a.tensor),this.indexMap=new n.default([],this.targetShape,{type:Int32Array}),this.indexMap.replaceTensorData(new Int32Array(e.tensor.data)),2<this.targetShape.length&&this.indexMap.reshapeTo2D(),this.indexMap.createGLTexture({type:"2d",format:"int"})}}},{key:"_callGPU",value:function(e){e.glTexture?e.is2DReshaped||e.is2DSquareReshaped?this.inputShape=e.originalShape:this.inputShape=e.tensor.shape:(this.inputShape=e.tensor.shape,2>=e.tensor.shape.length?e.createGLTexture({type:"2d",format:"float"}):2<e.tensor.shape.length&&!e.is2DReshaped&&(e.reshapeTo2D(),e.createGLTexture({type:"2d",format:"float"}))),this._createIndexMap(),this.output||(this.output=new n.default([],this.targetShape),2<this.targetShape.length&&this.output.reshapeTo2D(),this.output.createGLTexture({type:"2d",format:"float"})),XS.webgl2.runProgram({program:this.mapInputProgram,output:this.output,inputs:[{input:e,name:"x"},{input:this.indexMap,name:"indexMap"}],uniforms:[{value:e.glTextureShape[1],type:"int",name:"inputCols"}]}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.is2DReshaped?this.output.reshapeFrom2D():this.output.is2DSquareReshaped&&this.output.reshapeFrom2DSquare())}}]),t}(o.default);t.default=i});le(pw);var dw=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(uw),o=a(eP),n=a(mv),i=a(YS),l=a(cP),s=a(uP),u=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="Permute";var r=e.dims,o=void 0===r?[]:r;return a.description=""+JSON.stringify(o),a.dims=o.map(function(e){return e-1}),a.gpu&&(a.mapInputProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D indexMap;\nuniform int inputCols;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(indexMap, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  int index = texelFetch(indexMap, ivec2(out_x, out_y), 0).r;\n\n  if (index != -1) {\n    int rowIndex = int(floor(float(index) / float(inputCols)));\n    int colIndex = int(mod(float(index), float(inputCols)));\n    float val = texelFetch(x, ivec2(colIndex, rowIndex), 0).r;\n    outColor = vec4(val);\n  } else {\n    outColor = vec4(0.0);\n  }\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return 1>=e.tensor.shape.length||(0,n.default)((0,o.default)(e.tensor.shape.length),this.dims)?(this.output=e,this.output):(this.gpu?this._callGPU(e):this._callCPU(e),this.output)}},{key:"_callCPU",value:function(e){var t;this.dims.length!==e.tensor.shape.length&&this.throwError("The specified dims permutation must match the number of dimensions.");var a=this.dims.map(function(t){return e.tensor.shape[t]});this.output=new l.default([],a),s.default.assign(this.output.tensor,(t=e.tensor).transpose.apply(t,In(this.dims)))}},{key:"_createIndexMap",value:function(){var e=this,t;if(!this.indexMap){var a=new l.default([],this.inputShape,{type:Int32Array}),o=new l.default([],this.inputShape,{type:Int32Array}),n=new l.default([],this.inputShape,{type:Int32Array});if(2===this.inputShape.length)for(var u=0;u<this.inputShape[0];u++)s.default.assigns(o.tensor.pick(u,null),u);else if(3===this.inputShape.length)for(var i=0;i<this.inputShape[0];i++)for(var p=0;p<this.inputShape[1];p++)s.default.assigns(o.tensor.pick(i,p,null),i*this.inputShape[1]+p);else if(4===this.inputShape.length)for(var d=0;d<this.inputShape[0];d++)for(var g=0;g<this.inputShape[1];g++)for(var h=0;h<this.inputShape[2];h++)s.default.assigns(o.tensor.pick(d,g,h,null),d*this.inputShape[1]*this.inputShape[2]+g*this.inputShape[2]+h);for(var f=0;f<(0,r.default)(this.inputShape);f++){var c;s.default.assigns((c=n.tensor).pick.apply(c,In(Array(this.inputShape.length-1).fill(null)).concat([f])),f)}s.default.muls(a.tensor,o.tensor,(0,r.default)(this.inputShape)),s.default.addeq(a.tensor,n.tensor);var m=this.dims.map(function(t){return e.inputShape[t]});this.indexMap=new l.default([],m,{type:Int32Array}),s.default.assign(this.indexMap.tensor,(t=a.tensor).transpose.apply(t,In(this.dims))),2<m.length&&this.indexMap.reshapeTo2D(),this.indexMap.createGLTexture({type:"2d",format:"int"})}}},{key:"_callGPU",value:function(e){var t=this;if(e.glTexture?e.is2DReshaped||e.is2DSquareReshaped?this.inputShape=e.originalShape:this.inputShape=e.tensor.shape:(this.inputShape=e.tensor.shape,2>=e.tensor.shape.length?e.createGLTexture({type:"2d",format:"float"}):2<e.tensor.shape.length&&!e.is2DReshaped&&(e.reshapeTo2D(),e.createGLTexture({type:"2d",format:"float"}))),this._createIndexMap(),!this.output){var a=this.dims.map(function(e){return t.inputShape[e]});this.output=new l.default([],a),2<a.length&&this.output.reshapeTo2D(),this.output.createGLTexture({type:"2d",format:"float"})}XS.webgl2.runProgram({program:this.mapInputProgram,output:this.output,inputs:[{input:e,name:"x"},{input:this.indexMap,name:"indexMap"}],uniforms:[{value:e.glTextureShape[1],type:"int",name:"inputCols"}]}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.is2DReshaped?this.output.reshapeFrom2D():this.output.is2DSquareReshaped&&this.output.reshapeFrom2DSquare())}}]),t}(i.default);t.default=u});le(dw);var cw=32,gw=cw,hw=2147483647,fw=-1<<cw-1,mw=function(e){return(0<e)-(0>e)},_w=function(e){var t=e>>cw-1;return(e^t)-t},yw=function(e,t){return t^(e^t)&-(e<t)},xw=function(e,t){return e^(e^t)&-(e<t)},vw=function(e){return!(e&e-1)&&!!e},bw=function(e){var t,a;return t=(65535<e)<<4,e>>>=t,a=(255<e)<<3,e>>>=a,t|=a,a=(15<e)<<2,e>>>=a,t|=a,a=(3<e)<<1,e>>>=a,t|=a,t|e>>1},Sw=function(e){return 1e9<=e?9:1e8<=e?8:1e7<=e?7:1e6<=e?6:1e5<=e?5:1e4<=e?4:1e3<=e?3:100<=e?2:10<=e?1:0},Pw=function(e){return e-=1431655765&e>>>1,e=(858993459&e)+(858993459&e>>>2),16843009*(252645135&e+(e>>>4))>>>24},Tw=uo,ww=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1},kw=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e-(e>>>1)},Cw=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,e&=15,1&27030>>>e},Fw=Array(256);(function(e){for(var t=0;256>t;++t){var a=t,o=t,r=7;for(a>>>=1;a;a>>>=1)o<<=1,o|=1&a,--r;e[t]=255&o<<r}})(Fw);var Mw=function(e){return Fw[255&e]<<24|Fw[255&e>>>8]<<16|Fw[255&e>>>16]<<8|Fw[255&e>>>24]},Ew=function(e,t){return e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1},Dw=function(e,t){return e=1431655765&e>>>t,e=858993459&(e|e>>>1),e=252645135&(e|e>>>2),e=16711935&(e|e>>>4),e=65535&(e|e>>>16),e<<16>>16},Iw=function(e,t,a){return e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e|=t<<1,a&=1023,a=4278190335&(a|a<<16),a=251719695&(a|a<<8),a=3272356035&(a|a<<4),a=1227133513&(a|a<<2),e|a<<2},Aw=function(e,t){return e=1227133513&e>>>t,e=3272356035&(e|e>>>2),e=251719695&(e|e>>>4),e=4278190335&(e|e>>>8),e=1023&(e|e>>>16),e<<22>>22},Rw=function(e){var a=e|e-1;return a+1|(~a&-~a)-1>>>uo(e)+1},Ow={INT_BITS:gw,INT_MAX:hw,INT_MIN:fw,sign:mw,abs:_w,min:yw,max:xw,isPow2:vw,log2:bw,log10:Sw,popCount:Pw,countTrailingZeros:Tw,nextPow2:ww,prevPow2:kw,parity:Cw,reverse:Mw,interleave2:Ew,deinterleave2:Dw,interleave3:Iw,deinterleave3:Aw,nextCombination:Rw},Lw=go,jw=se(function(e,t){function a(e){if(e){var t=e.length||e.byteLength,a=Ow.log2(t);_[a].push(e)}}function r(e){var e=Ow.nextPow2(e),t=Ow.log2(e),a=_[t];return 0<a.length?a.pop():new ArrayBuffer(e)}function o(e){return new Uint8Array(r(e),0,e)}function i(e){return new Uint16Array(r(2*e),0,e)}function l(e){return new Uint32Array(r(4*e),0,e)}function s(e){return new Int8Array(r(e),0,e)}function u(e){return new Int16Array(r(2*e),0,e)}function p(e){return new Int32Array(r(4*e),0,e)}function d(e){return new Float32Array(r(4*e),0,e)}function c(e){return new Float64Array(r(8*e),0,e)}function g(e){return m?new Uint8ClampedArray(r(e),0,e):o(e)}function h(e){return new DataView(r(e),0,e)}function f(e){e=Ow.nextPow2(e);var t=Ow.log2(e),a=y[t];return 0<a.length?a.pop():new Buffer(e)}_l.__TYPEDARRAY_POOL||(_l.__TYPEDARRAY_POOL={UINT8:Lw([32,0]),UINT16:Lw([32,0]),UINT32:Lw([32,0]),INT8:Lw([32,0]),INT16:Lw([32,0]),INT32:Lw([32,0]),FLOAT:Lw([32,0]),DOUBLE:Lw([32,0]),DATA:Lw([32,0]),UINT8C:Lw([32,0]),BUFFER:Lw([32,0])});var m="undefined"!=typeof Uint8ClampedArray,n=_l.__TYPEDARRAY_POOL;n.UINT8C||(n.UINT8C=Lw([32,0])),n.BUFFER||(n.BUFFER=Lw([32,0]));var _=n.DATA,y=n.BUFFER;t.free=function(e){if(Buffer.isBuffer(e))y[Ow.log2(e.length)].push(e);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(e)&&(e=e.buffer),!e)return;var t=e.length||e.byteLength,a=0|Ow.log2(t);_[a].push(e)}},t.freeUint8=t.freeUint16=t.freeUint32=t.freeInt8=t.freeInt16=t.freeInt32=t.freeFloat32=t.freeFloat=t.freeFloat64=t.freeDouble=t.freeUint8Clamped=t.freeDataView=function(e){a(e.buffer)},t.freeArrayBuffer=a,t.freeBuffer=function(e){y[Ow.log2(e.length)].push(e)},t.malloc=function(e,t){return void 0===t||"arraybuffer"===t?r(e):"uint8"===t?o(e):"uint16"===t?i(e):"uint32"===t?l(e):"int8"===t?s(e):"int16"===t?u(e):"int32"===t?p(e):"float"===t||"float32"===t?d(e):"double"===t||"float64"===t?c(e):"uint8_clamped"===t?g(e):"buffer"===t?f(e):"data"===t||"dataview"===t?h(e):null},t.mallocArrayBuffer=r,t.mallocUint8=o,t.mallocUint16=i,t.mallocUint32=l,t.mallocInt8=s,t.mallocInt16=u,t.mallocInt32=p,t.mallocFloat32=t.mallocFloat=d,t.mallocFloat64=t.mallocDouble=c,t.mallocUint8Clamped=g,t.mallocDataView=h,t.mallocBuffer=f,t.clearCache=function(){for(var e=0;32>e;++e)n.UINT8[e].length=0,n.UINT16[e].length=0,n.UINT32[e].length=0,n.INT8[e].length=0,n.INT16[e].length=0,n.INT32[e].length=0,n.FLOAT[e].length=0,n.DOUBLE[e].length=0,n.UINT8C[e].length=0,_[e].length=0,y[e].length=0}}),zw=ho,Gw=fo,Uw=mo,Nw=_o,qw=yo,Bw=xo,Vw={clone:zw,malloc:Gw,free:Uw,zeros:Nw,ones:qw,eye:Bw},Hw=vo,Ww=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(rT),i=a(Hw),l=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="RepeatVector";var r=e.n,o=void 0===r?1:r;return a.n=o,a.description="n = "+o,a.gpu&&(a.program=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nout vec4 outColor;\n\nvoid main() {\n  outColor = texture(x, vec2(outTex.x, 0));\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){1!==e.tensor.shape.length&&this.throwError("Only 1D tensor inputs allowed."),this.output=new o.default([],[this.n,e.tensor.shape[1]]),this.output.tensor=(0,i.default)((0,n.default)(e.tensor,0),[this.n,1])}},{key:"_callGPU",value:function(e){e.glTexture||e.createGLTexture({type:"2d",format:"float"}),this.output||(this.output=new o.default([],[this.n,e.glTextureShape[1]]),this.output.createGLTexture({type:"2d",format:"float"})),XS.webgl2.runProgram({program:this.program,output:this.output,inputs:[{input:e,name:"x"}]}),0===this.outbound.length&&this.output.transferFromGLTexture()}}]),t}(r.default);t.default=l});le(Ww);var Xw=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Dense",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"Activation",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"Dropout",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"SpatialDropout1D",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"SpatialDropout2D",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"SpatialDropout3D",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"Flatten",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"Reshape",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"Permute",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"RepeatVector",{enumerable:!0,get:function(){return c.default}});var r=a(aw),o=a(rw),n=a(ow),i=a(nw),l=a(iw),s=a(lw),u=a(sw),p=a(pw),d=a(dw),c=a(Ww)});le(Xw);var Yw=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="Embedding";var r=e.input_dim,o=void 0===r?1:r,n=e.output_dim,i=void 0===n?1:n,l=e.input_length,s=void 0===l?0:l,u=e.mask_zero;return a.description="output dimensions: "+i,a.inputDim=o,a.outputDim=i,a.inputLength=s,a.maskZero=void 0!==u&&u,a.params=["embeddings"],a.gpu&&(a.program=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform sampler2D embeddings;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 x_size = textureSize(x, 0);\n  ivec2 embeddings_size = textureSize(embeddings, 0);\n  int out_x = int(float(embeddings_size[0]) * outTex.x);\n  int out_y = int(float(x_size[0]) * outTex.y);\n\n  int index = int(texelFetch(x, ivec2(out_y, 0), 0).r);\n  outColor = texelFetch(embeddings, ivec2(out_x, index), 0);\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){this.output=new o.default([],[e.tensor.shape[0],this.weights.embeddings.tensor.shape[1]]);for(var t=0,a=e.tensor.shape[0];t<a;t++)n.default.assign(this.output.tensor.pick(t,null),this.weights.embeddings.tensor.pick(e.tensor.get(t),null))}},{key:"_callGPU",value:function(e){e.glTexture||e.createGLTexture({type:"2d",format:"float"}),this.output||(this.output=new o.default([],[e.glTextureShape[1],this.weights.embeddings.glTextureShape[1]]),this.output.createGLTexture({type:"2d",format:"float"})),XS.webgl2.runProgram({program:this.program,output:this.output,inputs:[{input:e,name:"x"},{input:this.weights.embeddings,name:"embeddings"}]}),0===this.outbound.length&&this.output.transferFromGLTexture()}}]),t}(r.default);t.default=i});le(Yw);var $w=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Embedding",{enumerable:!0,get:function(){return a.default}});var a=function(e){return e&&e.__esModule?e:{default:e}}(Yw)});le($w);var Kw=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(eP),o=a(mv),n=a(YS),i=a(cP),l=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="_Merge",a.isMergeLayer=!0,a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){if(this.gpu)this._callGPU(e);else{var t=this._validateInputs(e);t||this.throwError("Invalid inputs to call method."),this._callCPU(e)}return this.output}},{key:"_validateInputs",value:function(e){var t=e.map(function(e){return e.tensor.shape.slice()});if(-1<["sum","diff","mul","ave","max","min"].indexOf(this.mode)&&!t.every(function(e){return(0,o.default)(e,t[0])})&&this.throwError("All input shapes must be the same for mode "+this.mode+"."),"dot"===this.mode)2!==e.length&&this.throwError("Exactly 2 inputs required for mode "+this.mode+"."),0>this.dotAxes[0]&&(this.dotAxes[0]=t[0].length+this.dotAxes[0]),0>this.dotAxes[1]&&(this.dotAxes[1]=t[1].length+this.dotAxes[1]),t[0][this.dotAxes[0]]!==t[1][this.dotAxes[1]]&&this.throwError("Dimensions incompatibility using dot mode.");else if("concat"===this.mode){var a=t.slice(),n=0>this.concatAxis?a[0].length+this.concatAxis:this.concatAxis;0===this.concatAxis&&(n=0),(0,r.default)(a.length).forEach(function(e){a[e].splice(n,1)}),a.every(function(e){return(0,o.default)(e,a[0])})||this.throwError("In concat mode, all shapes must be the same except along the concat axis.")}return!0}},{key:"_callCPU",value:function(){}},{key:"_callGPU",value:function(e){e.forEach(function(e){e.glTexture||e.glTextureFragments||e.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0})}),this.output||(this.output=new i.default([],e[0].glTextureShape),this.output.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),e[0].is1D?this.output.is1D=e[0].is1D:(e[0].is2DReshaped||e[0].is2DSquareReshaped)&&(e[0].is2DReshaped?this.output.is2DReshaped=e[0].is2DReshaped:e[0].is2DSquareReshaped&&(this.output.is2DSquareReshaped=e[0].is2DSquareReshaped),this.output.originalShape=e[0].originalShape.slice(),this.output.indicesForReshaped=e[0].indicesForReshaped)),XS.webgl2.runProgram({program:this.mergeProgram,output:this.output,inputs:e.map(function(e,t){return{input:e,name:"inputs["+t+"]"}}),supportsTextureFragments:!0}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.is2DReshaped?this.output.reshapeFrom2D():this.output.is2DSquareReshaped&&this.output.reshapeFrom2DSquare())}}]),t}(n.default);t.default=l});le(Kw);var Zw=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(Kw),o=a(cP),n=a(KP),l=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="Add",a.mode="sum",a}return Mn(t,e),Cn(t,[{key:"_callCPU",value:function(e){var t=e[0].tensor.shape.slice();this.output=new o.default([],t);for(var a=0;a<e.length;a++)l.default.addeq(this.output.tensor,e[a].tensor)}},{key:"_callGPU",value:function(e){if(!this.mergeProgram){var a=e[0].glTextureFragments?e[0].glTextureFragmentShape:e[0].glTextureShape,r=(0,n.default)("add",e.length,a);this.mergeProgram=XS.webgl2.compileProgram(r)}Fn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_callGPU",this).call(this,e)}}]),t}(r.default);t.default=i});le(Zw);var Qw=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(Kw),o=a(cP),n=a(KP),i=a(uP),l=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="Subtract",a.mode="diff",a}return Mn(t,e),Cn(t,[{key:"_callCPU",value:function(e){2!==e.length&&this.throwError("Inputs should be an array of 2 Tensors.");var t=e[0].tensor.shape.slice();this.output=new o.default([],t),i.default.sub(this.output.tensor,e[0].tensor,e[1].tensor)}},{key:"_callGPU",value:function(e){if(!this.mergeProgram){var a=e[0].glTextureFragments?e[0].glTextureFragmentShape:e[0].glTextureShape,r=(0,n.default)("subtract",e.length,a);this.mergeProgram=XS.webgl2.compileProgram(r)}Fn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_callGPU",this).call(this,e)}}]),t}(r.default);t.default=l});le(Qw);var Jw=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(Kw),o=a(cP),n=a(KP),l=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="Multiply",a.mode="mul",a}return Mn(t,e),Cn(t,[{key:"_callCPU",value:function(e){var t=e[0].tensor.shape.slice();this.output=new o.default([],t),l.default.assigns(this.output.tensor,1);for(var a=0;a<e.length;a++)l.default.muleq(this.output.tensor,e[a].tensor)}},{key:"_callGPU",value:function(e){if(!this.mergeProgram){var a=e[0].glTextureFragments?e[0].glTextureFragmentShape:e[0].glTextureShape,r=(0,n.default)("multiply",e.length,a);this.mergeProgram=XS.webgl2.compileProgram(r)}Fn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_callGPU",this).call(this,e)}}]),t}(r.default);t.default=i});le(Jw);var ek=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(Kw),o=a(cP),n=a(KP),l=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="Average",a.mode="ave",a}return Mn(t,e),Cn(t,[{key:"_callCPU",value:function(e){var t=e[0].tensor.shape.slice();this.output=new o.default([],t);for(var a=0;a<e.length;a++)l.default.addeq(this.output.tensor,e[a].tensor);l.default.divseq(this.output.tensor,e.length)}},{key:"_callGPU",value:function(e){if(!this.mergeProgram){var a=e[0].glTextureFragments?e[0].glTextureFragmentShape:e[0].glTextureShape,r=(0,n.default)("average",e.length,a);this.mergeProgram=XS.webgl2.compileProgram(r)}Fn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_callGPU",this).call(this,e)}}]),t}(r.default);t.default=i});le(ek);var tk=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(Kw),o=a(cP),n=a(KP),l=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="Maximum",a.mode="max",a}return Mn(t,e),Cn(t,[{key:"_callCPU",value:function(e){var t=e[0].tensor.shape.slice();this.output=new o.default([],t),l.default.assign(this.output.tensor,e[0].tensor);for(var a=1;a<e.length;a++)l.default.maxeq(this.output.tensor,e[a].tensor)}},{key:"_callGPU",value:function(e){if(!this.mergeProgram){var a=e[0].glTextureFragments?e[0].glTextureFragmentShape:e[0].glTextureShape,r=(0,n.default)("maximum",e.length,a);this.mergeProgram=XS.webgl2.compileProgram(r)}Fn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_callGPU",this).call(this,e)}}]),t}(r.default);t.default=i});le(tk);var ak=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(Kw),o=a(cP),n=a(KP),l=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="Minimum",a.mode="min",a}return Mn(t,e),Cn(t,[{key:"_callCPU",value:function(e){var t=e[0].tensor.shape.slice();this.output=new o.default([],t),l.default.assign(this.output.tensor,e[0].tensor);for(var a=1;a<e.length;a++)l.default.mineq(this.output.tensor,e[a].tensor)}},{key:"_callGPU",value:function(e){if(!this.mergeProgram){var a=e[0].glTextureFragments?e[0].glTextureFragmentShape:e[0].glTextureShape,r=(0,n.default)("minimum",e.length,a);this.mergeProgram=XS.webgl2.compileProgram(r)}Fn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_callGPU",this).call(this,e)}}]),t}(r.default);t.default=i});le(ak);var rk=bo,ok=So,nk={dtype:"double"},ik=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(NP),o=a(Kw),n=a(cP),i=a(KP),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}(pP),s=a(ok),u=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="Concatenate",a.mode="concat";var r=e.axis,o=void 0===r?-1:r;return a.concatAxis=0>=o?o:o-1,a}return Mn(t,e),Cn(t,[{key:"_callCPU",value:function(e){var t=e[0].tensor.shape.slice(),a=0>this.concatAxis?t.length+this.concatAxis:this.concatAxis;if(e.slice(1,e.length).forEach(function(e){var r=e.tensor.shape.slice()[a];t[a]+=r}),this.output=new n.default([],t),0===a)(0,s.default)(this.output.tensor,e.map(function(e){return e.tensor}));else{for(var r=[a],o=0,i;o<e[0].tensor.shape.length;o++)o!==a&&r.push(o);(0,s.default)((i=this.output.tensor).transpose.apply(i,r),e.map(function(e){var t;return(t=e.tensor).transpose.apply(t,r)}))}}},{key:"_callGPU",value:function(e){e.forEach(function(e){e.glTexture||e.glTextureFragments||e.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0})});var t=e[0].glTextureShape.slice(),a=1;if(e[0].is2DReshaped?-1===this.concatAxis||this.concatAxis===e[0].originalShape.length-1?a=1:this.throwError("specified axis not supported for now."):-1===this.concatAxis||1===this.concatAxis?a=1:-2===this.concatAxis||0===this.concatAxis?a=0:this.throwError("specified axis not supported for now."),t[a]=(0,r.default)(e.map(function(e){return e.glTextureShape[a]})),!this.output)if(this.output=new n.default([],t),this.output.createGLTexture({type:"2d",format:"float",supportsTextureFragments:1==a}),e[0].is1D)this.output.is1D=e[0].is1D;else if(e[0].is2DReshaped){this.output.is2DReshaped=e[0].is2DReshaped,this.output.originalShape=e[0].originalShape.slice();var o=0>this.concatAxis?this.output.originalShape.length+this.concatAxis:this.concatAxis;this.output.originalShape[o]=(0,r.default)(e.map(function(e){return e.originalShape[o]})),this.output.indicesForReshaped=l.createIndicesFor2DReshaped(this.output.originalShape,!1,o)}if(!this.mergeProgram){var s=this.output.glTextureFragments?this.output.glTextureFragmentShape:this.output.glTextureShape,u=(0,i.default)("concatenate",e.length,e.map(function(e){return e.glTextureShape}),s,a);this.mergeProgram=XS.webgl2.compileProgram(u)}XS.webgl2.runProgram({program:this.mergeProgram,output:this.output,inputs:e.map(function(e,t){return{input:e,name:"inputs["+t+"]"}}),supportsTextureFragments:!0}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.is2DReshaped?this.output.reshapeFrom2D():this.output.is2DSquareReshaped&&this.output.reshapeFrom2DSquare())}}]),t}(o.default);t.default=u});le(ik);var lk=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(Kw),o=a(cP),n=a(JP),l=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="Dot",a.mode="dot";var r=e.axes,o=void 0===r?-1:r,n=e.normalize;return a.dotAxes=Array.isArray(o)?[0>=o[0]?o[0]:o[0]-1,0>=o[1]?o[1]:o[1]-1]:[0>=o?o:o-1,0>=o?o:o-1],a.normalize=void 0!==n&&n,a.gpu&&(a.mergeProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D input1;\nuniform sampler2D input2;\nuniform int rows;\nuniform int cols;\nuniform int dotAxis1;\nuniform int dotAxis2;\nuniform int commonDim;\nuniform bool normalize;\nout vec4 outColor;\n\nvoid main() {\n  int out_x = int(float(cols) * outTex.x);\n  int out_y = int(float(rows) * outTex.y);\n\n  float sum = 0.;\n  float a = 0.;\n  float b = 0.;\n  float norm1 = 0.;\n  float norm2 = 0.;\n\n  for (int i = 0; i < commonDim; ++i) {\n    if (dotAxis1 == 0 && dotAxis2 == 0) {\n      a = texelFetch(input1, ivec2(out_y, i), 0).r;\n      b = texelFetch(input2, ivec2(out_x, i), 0).r;\n    } else if (dotAxis1 == 1 && dotAxis2 == 1) {\n      a = texelFetch(input1, ivec2(i, out_y), 0).r;\n      b = texelFetch(input2, ivec2(i, out_x), 0).r;\n    }\n\n    sum += a * b;\n\n    if (normalize) {\n      norm1 += a * a;\n      norm2 += b * b;\n    }\n  }\n\n  if (normalize) {\n    sum /= sqrt(norm1) * sqrt(norm2);\n  }\n\n  outColor = vec4(sum);\n}\n")),a}return Mn(t,e),Cn(t,[{key:"_calcOutputShape",value:function(e){var t=e[0].slice(),a=e[1].slice();t.splice(this.dotAxes[0],1),a.splice(this.dotAxes[1],1),this.outputShape=t.concat(a),1===this.outputShape.length&&this.outputShape.push(1)}},{key:"_callCPU",value:function(e){if(this._calcOutputShape([e[0].tensor.shape,e[1].tensor.shape]),this.output=new o.default([],this.outputShape),2!==e[0].tensor.shape.length||2!==e[1].tensor.shape.length)this.throwError("dot mode for 3+ dim tensors not yet implemented.");else if(0===this.dotAxes[0]&&0===this.dotAxes[1]){if(this.normalize){for(var t=0;t<e[0].tensor.shape[1];t++)l.default.divseq(e[0].tensor.pick(null,t),l.default.norm2(e[0].tensor.pick(null,t)));for(var a=0;a<e[1].tensor.shape[1];a++)l.default.divseq(e[1].tensor.pick(null,a),l.default.norm2(e[1].tensor.pick(null,a)))}(0,n.default)(this.output.tensor,e[0].tensor.transpose(1,0),e[1].tensor)}else if(1===this.dotAxes[0]&&1===this.dotAxes[1]){if(this.normalize){for(var r=0;r<e[0].tensor.shape[0];r++)l.default.divseq(e[0].tensor.pick(r,null),l.default.norm2(e[0].tensor.pick(r,null)));for(var i=0;i<e[1].tensor.shape[0];i++)l.default.divseq(e[1].tensor.pick(i,null),l.default.norm2(e[1].tensor.pick(i,null)))}(0,n.default)(this.output.tensor,e[0].tensor,e[1].tensor.transpose(1,0))}}},{key:"_callGPU",value:function(e){e.forEach(function(e){e.glTexture||e.glTextureFragments||e.createGLTexture({type:"2d",format:"float"})}),this._calcOutputShape([e[0].glTextureShape,e[1].glTextureShape]),this.output||(this.output=new o.default([],this.outputShape),this.output.createGLTexture({type:"2d",format:"float"}));var t=e[0].glTextureShape[this.dotAxes[0]];XS.webgl2.runProgram({program:this.mergeProgram,output:this.output,inputs:[{input:e[0],name:"input1"},{input:e[1],name:"input2"}],uniforms:[{value:this.output.glTextureShape[0],type:"int",name:"rows"},{value:this.output.glTextureShape[1],type:"int",name:"cols"},{value:this.dotAxes[0],type:"int",name:"dotAxis1"},{value:this.dotAxes[1],type:"int",name:"dotAxis2"},{value:t,type:"int",name:"commonDim"},{value:+this.normalize,type:"bool",name:"normalize"}]}),0===this.outbound.length&&this.output.transferFromGLTexture()}}]),t}(r.default);t.default=i});le(lk);var sk=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Add",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"Subtract",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"Multiply",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"Average",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"Maximum",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"Minimum",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"Concatenate",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"Dot",{enumerable:!0,get:function(){return p.default}});var r=a(Zw),o=a(Qw),n=a(Jw),i=a(ek),l=a(tk),s=a(ak),u=a(ik),p=a(lk)});le(sk);var uk=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(YS),r=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="GaussianDropout";var r=e.rate,o=void 0===r?0.5:r;return a.rate=vn(bn(0,o),1),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.output=e,this.output}}]),t}(a.default);t.default=r});le(uk);var pk=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(YS),r=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="GaussianNoise";var r=e.stddev,o=void 0===r?0:r;return a.stddev=o,a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.output=e,this.output}}]),t}(a.default);t.default=r});le(pk);var dk=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"GaussianDropout",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"GaussianNoise",{enumerable:!0,get:function(){return o.default}});var r=a(uk),o=a(pk)});le(dk);var ck=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="BatchNormalization";var r=e.epsilon,o=void 0===r?1e-3:r,n=e.axis,i=void 0===n?-1:n,l=e.center,s=e.scale;return a.epsilon=o,a.center=void 0===l||l,a.scale=void 0===s||s,a.axis=i,a.axisNormalized=!1,a.params=[],a.scale&&a.params.push("gamma"),a.center&&a.params.push("beta"),a.params=a.params.concat(["moving_mean","moving_variance"]),a.gpu&&(a.program=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D X;\nuniform isampler2D normAxisIndexMap;\nuniform sampler2D gamma;\nuniform sampler2D beta;\nuniform sampler2D mean;\nuniform sampler2D std;\nuniform float epsilon;\nuniform bool scale;\nuniform bool center;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(X, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\nint normAxisIndex = texelFetch(normAxisIndexMap, ivec2(out_x, out_y), 0).r;\n\n  float _x = texelFetch(X, ivec2(out_x, out_y), 0).r;\n  float _mean = texelFetch(mean, ivec2(normAxisIndex, 0), 0).r;\n  float _std = texelFetch(std, ivec2(normAxisIndex, 0), 0).r;\n\n  float _gamma = 1.0;\n  if (scale) {\n    _gamma = texelFetch(gamma, ivec2(normAxisIndex, 0), 0).r;\n  }\n\n  float _beta = 0.0;\n  if (center) {\n    _beta = texelFetch(beta, ivec2(normAxisIndex, 0), 0).r;\n  }\n\n  float sum = _beta + _gamma * (_x - _mean) / sqrt(_std + epsilon);\n\n  outColor = vec4(sum);\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){this.axisNormalized||(this.axis=0>this.axis?e.tensor.shape.length+this.axis:this.axis-1,this.axisNormalized=!0);for(var t=[],a=0;a<e.tensor.shape.length;a++)a===this.axis?t.push(1):t.push(null);for(var r=new o.default([],e.tensor.shape),l=new o.default([],e.tensor.shape),s=0;s<e.tensor.shape[this.axis];s++){if(t[this.axis]=s,this.scale){var i;n.default.assigns((i=r.tensor).pick.apply(i,t),this.weights.gamma.tensor.get(s))}if(this.center){var u;n.default.assigns((u=l.tensor).pick.apply(u,t),this.weights.beta.tensor.get(s))}}for(var p=new o.default([],e.tensor.shape),d=new o.default([],e.tensor.shape),c=0;c<e.tensor.shape[this.axis];c++){var g,h;t[this.axis]=c,n.default.assigns((g=p.tensor).pick.apply(g,t),this.weights.moving_mean.tensor.get(c)),n.default.assigns((h=d.tensor).pick.apply(h,t),this.weights.moving_variance.tensor.get(c)+this.epsilon)}n.default.sqrteq(d.tensor),this.output=new o.default(e.tensor.data,e.tensor.shape),n.default.subeq(this.output.tensor,p.tensor),n.default.diveq(this.output.tensor,d.tensor),this.scale&&n.default.muleq(this.output.tensor,r.tensor),this.center&&n.default.addeq(this.output.tensor,l.tensor)}},{key:"_createIndexMap",value:function(e,t){if(!this.normAxisIndexMap){var a=new o.default([],this.inputShape,{type:Int32Array});this.normAxisIndexMap=new o.default([],e,{type:Int32Array});for(var r=Array(this.inputShape.length).fill(null),l=0;l<this.inputShape[this.axis];l++){var i;r[this.axis]=l,n.default.assigns((i=a.tensor).pick.apply(i,In(r)),l)}if(t)for(var s=0;s<t.data.length;s++)this.normAxisIndexMap.tensor.data[t.data[s]]=a.tensor.data[s];else this.normAxisIndexMap=a;this.normAxisIndexMap.createGLTexture({type:"2d",format:"int",supportsTextureFragments:!0})}}},{key:"_callGPU",value:function(e){this.axisNormalized||(this.inputShape=e.is2DReshaped||e.is2DSquareReshaped?e.originalShape:e.tensor.shape,this.axis=0>this.axis?this.inputShape.length+this.axis:this.axis-1,this.axisNormalized=!0),e.glTexture||e.glTextureFragments||(2>=e.tensor.shape.length?e.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}):2<e.tensor.shape.length&&!e.is2DReshaped&&(e.reshapeTo2DSquare(),e.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}))),this._createIndexMap(e.glTextureShape,e.indicesForReshaped),this.output||(this.output=new o.default([],e.glTextureShape),this.output.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),e.is1D?this.output.is1D=e.is1D:(e.is2DReshaped||e.is2DSquareReshaped)&&(e.is2DReshaped?this.output.is2DReshaped=e.is2DReshaped:e.is2DSquareReshaped&&(this.output.is2DSquareReshaped=e.is2DSquareReshaped),this.output.originalShape=e.originalShape,this.output.indicesForReshaped=e.indicesForReshaped));var t=[{input:e,name:"X"},{input:this.normAxisIndexMap,name:"normAxisIndexMap"}];this.scale&&t.push({input:this.weights.gamma,name:"gamma"}),this.center&&t.push({input:this.weights.beta,name:"beta"}),t.push({input:this.weights.moving_mean,name:"mean"}),t.push({input:this.weights.moving_variance,name:"std"});var a=[{value:this.epsilon,type:"float",name:"epsilon"},{value:+this.scale,type:"bool",name:"scale"},{value:+this.center,type:"bool",name:"center"}];XS.webgl2.runProgram({program:this.program,output:this.output,inputs:t,uniforms:a,supportsTextureFragments:!0}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.is2DReshaped?this.output.reshapeFrom2D():this.output.is2DSquareReshaped&&this.output.reshapeFrom2DSquare())}}]),t}(r.default);t.default=i});le(ck);var gk=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BatchNormalization",{enumerable:!0,get:function(){return a.default}});var a=function(e){return e&&e.__esModule?e:{default:e}}(ck)});le(gk);var hk=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="_Pooling1D";var r=e.pool_size,o=void 0===r?2:r,n=e.strides,i=void 0===n?null:n,l=e.padding,s=void 0===l?"valid":l;return a.poolSize=o,a.strides=null===i?a.poolSize:i,a.padding=s,a.poolingFunc="max",a.description="pool size "+a.poolSize,a.description+=1<a.strides?", striding "+a.strides+" striding":"",a.description+="valid"===a.padding?", no border padding":", pad to same borders",a.gpu&&(a.poolingProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D poolIndexMap;\nuniform int channels;\nuniform int poolSize;\nuniform bool isMaxPooling;\nout vec4 outColor;\n\nvoid main() {\n  int out_x = int(float(channels) * outTex.x);\n  int out_y = int(float(textureSize(poolIndexMap, 0)[1]) * outTex.y);\n\n  float val = 0.;\n  int count = 0;\n  for (int i = 0; i < poolSize; ++i) {\n    int poolIndex = texelFetch(poolIndexMap, ivec2(i, out_y), 0).r;\n    if (poolIndex != -1) {\n      float val2 = texelFetch(x, ivec2(out_x, poolIndex), 0).r;\n      if (isMaxPooling) {\n        if (count == 0 || val2 > val) {\n          val = val2;\n        }\n      } else {\n        val += val2;\n      }\n      count += 1;\n    }\n  }\n\n  if (!isMaxPooling) {\n    val /= float(count);\n  }\n\n  outColor = vec4(val);\n}\n"),a.poolingFragmentsProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D poolIndexMap;\nuniform int channels;\nuniform int poolSize;\nuniform bool isMaxPooling;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 inputSize = textureSize(x, 0);\n  ivec2 outputSize = textureSize(poolIndexMap, 0);\n  int out_x = int(float(channels) * outTex.x);\n  int out_y = int(float(outputSize[1]) * outTex.y);\n\n  float val = 0.;\n  int count = 0;\n  for (int i = 0; i < poolSize; ++i) {\n    int poolIndex = texelFetch(poolIndexMap, ivec2(i, out_y), 0).r;\n    int fragmentIndex = int(floor(float(poolIndex) / float(inputSize[1])));\n    if (poolIndex != -1) {\n      poolIndex = int(mod(float(poolIndex), float(inputSize[1])));\n      float val2 = texelFetch(x, ivec2(fragmentIndex * channels + out_x, poolIndex), 0).r;\n      if (isMaxPooling) {\n        if (count == 0 || val2 > val) {\n          val = val2;\n        }\n      } else {\n        val += val2;\n      }\n      count += 1;\n    }\n  }\n\n  if (!isMaxPooling) {\n    val /= float(count);\n  }\n\n  outColor = vec4(val);\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){var t="valid"===this.padding?_n((e.tensor.shape[0]-this.poolSize+this.strides)/this.strides):_n((e.tensor.shape[0]+this.strides-1)/this.strides);this.output=new o.default([],[t,e.tensor.shape[1]]);for(var a=new o.default([],[e.tensor.shape[1]]),r="valid"===this.padding?0:vn(0,yn((e.tensor.shape[0]-(t-1)*this.strides-this.poolSize)/2)),l=0;l<t;l++){var i=bn(0,r),s=this.poolSize+vn(0,r);n.default.assign(a.tensor,e.tensor.pick(i,null));for(var u=1,p=1;p<s&&!(i+p>e.tensor.shape[0]-1);p++)"max"===this.poolingFunc?n.default.maxeq(a.tensor,e.tensor.pick(i+p,null)):"average"===this.poolingFunc&&n.default.addeq(a.tensor,e.tensor.pick(i+p,null)),u+=1;"average"===this.poolingFunc&&n.default.divseq(a.tensor,u),n.default.assign(this.output.tensor.pick(l,null),a.tensor),r+=this.strides}}},{key:"_createIndexMap",value:function(){if(!this.poolIndexMap){var e="valid"===this.padding?_n((this.inputShape[0]-this.poolSize+this.strides)/this.strides):_n((this.inputShape[0]+this.strides-1)/this.strides);this.outputShape=[e,this.inputShape[1]],this.poolIndexMap=new o.default([],[e,this.poolSize],{type:Int32Array}),n.default.assigns(this.poolIndexMap.tensor,-1);for(var t="valid"===this.padding?0:vn(0,yn((this.inputShape[0]-(e-1)*this.strides-this.poolSize)/2)),a=0;a<e;a++){var r=bn(0,t),i=this.poolSize+vn(0,t),l=r;this.poolIndexMap.tensor.set(a,0,l);for(var s=1;s<i&&(l=r+s,l<=this.inputShape[0]-1);s++)this.poolIndexMap.tensor.set(a,s,l);t+=this.strides}this.poolIndexMap.createGLTexture({type:"2d",format:"int",supportsTextureFragments:!0})}}},{key:"_callGPU",value:function(e){e.glTexture||e.glTextureFragments||e.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),this.inputShape=e.tensor.shape,this._createIndexMap(),this.output||(this.output=new o.default([],this.outputShape),this.output.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}));var t="max"===this.poolingFunc,a=[{value:this.output.glTextureShape[1],type:"int",name:"channels"},{value:this.poolSize,type:"int",name:"poolSize"},{value:+t,type:"bool",name:"isMaxPooling"}];e.glTextureFragments?(e.convert2DRowFragmentedGLTextureToColStack(),XS.webgl2.runProgram({program:this.poolingFragmentsProgram,output:this.output,inputs:[{input:e,name:"x"},{input:this.poolIndexMap,name:"poolIndexMap"}],uniforms:a,supportsTextureFragments:!0}),e.removeGLTextureFragmentsAsColStack()):XS.webgl2.runProgram({program:this.poolingProgram,output:this.output,inputs:[{input:e,name:"x"},{input:this.poolIndexMap,name:"poolIndexMap"}],uniforms:a,supportsTextureFragments:!0}),0===this.outbound.length&&this.output.transferFromGLTexture()}}]),t}(r.default);t.default=i});le(hk);var fk=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(hk),r=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="MaxPooling1D",a.poolingFunc="max",a}return Mn(t,e),t}(a.default);t.default=r});le(fk);var mk=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}(pP),l=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="_Pooling2D";var r=e.pool_size,o=void 0===r?[2,2]:r,n=e.strides,i=void 0===n?null:n,l=e.padding,s=void 0===l?"valid":l,u=e.data_format,p=void 0===u?"channels_last":u;return a.poolSize=Array.isArray(o)?o:[o,o],a.strides=Array.isArray(i)?i:null===i?a.poolSize:[i,i],a.padding=s,a.dataFormat=p,a.poolingFunc="max",a.description="pool size "+a.poolSize.join("x"),a.description+=a.strides.some(function(e){return 1<e})?", "+a.strides.join("x")+" striding":"",a.description+="valid"===a.padding?", no border padding":", pad to same borders",a.gpu&&(a.poolingProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D poolIndexMap;\nuniform int channels;\nuniform int poolSize;\nuniform bool isMaxPooling;\nout vec4 outColor;\n\nvoid main() {\n  int out_x = int(float(channels) * outTex.x);\n  int out_y = int(float(textureSize(poolIndexMap, 0)[1]) * outTex.y);\n\n  float val = 0.;\n  int count = 0;\n  for (int i = 0; i < poolSize; ++i) {\n    int poolIndex = texelFetch(poolIndexMap, ivec2(i, out_y), 0).r;\n    if (poolIndex != -1) {\n      float val2 = texelFetch(x, ivec2(out_x, poolIndex), 0).r;\n      if (isMaxPooling) {\n        if (count == 0 || val2 > val) {\n          val = val2;\n        }\n      } else {\n        val += val2;\n      }\n      count += 1;\n    }\n  }\n\n  if (!isMaxPooling) {\n    val /= float(count);\n  }\n\n  outColor = vec4(val);\n}\n"),a.poolingFragmentsProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D poolIndexMap;\nuniform int channels;\nuniform int poolSize;\nuniform bool isMaxPooling;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 inputSize = textureSize(x, 0);\n  ivec2 outputSize = textureSize(poolIndexMap, 0);\n  int out_x = int(float(channels) * outTex.x);\n  int out_y = int(float(outputSize[1]) * outTex.y);\n\n  float val = 0.;\n  int count = 0;\n  for (int i = 0; i < poolSize; ++i) {\n    int poolIndex = texelFetch(poolIndexMap, ivec2(i, out_y), 0).r;\n    int fragmentIndex = int(floor(float(poolIndex) / float(inputSize[1])));\n    if (poolIndex != -1) {\n      poolIndex = int(mod(float(poolIndex), float(inputSize[1])));\n      float val2 = texelFetch(x, ivec2(fragmentIndex * channels + out_x, poolIndex), 0).r;\n      if (isMaxPooling) {\n        if (count == 0 || val2 > val) {\n          val = val2;\n        }\n      } else {\n        val += val2;\n      }\n      count += 1;\n    }\n  }\n\n  if (!isMaxPooling) {\n    val /= float(count);\n  }\n\n  outColor = vec4(val);\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_calcOutputShape",value:function(e){if(!(this.outputShape&&this.inputPadding)){var t=Dn(e,3),a=t[0],r=t[1],o=t[2],n=Dn(this.poolSize,2),i=n[0],l=n[1],s="same"===this.padding?_n((a+this.strides[0]-1)/this.strides[0]):_n((a-i+this.strides[0])/this.strides[0]),u="same"===this.padding?_n((r+this.strides[1]-1)/this.strides[1]):_n((r-l+this.strides[1])/this.strides[1]),p="same"===this.padding?bn(0,_n((s-1)*this.strides[0]+i-a)):0,d="same"===this.padding?bn(0,_n((u-1)*this.strides[1]+l-r)):0,c=_n(p/2),g=_n(d/2);this.outputShape=[s,u,o],this.inputPadding=[c,p-c,g,d-g]}}},{key:"_padInput",value:function(e){if("same"===this.padding){var t=Dn(e.tensor.shape,3),a=t[0],r=t[1],n=t[2],i=Dn(this.inputPadding,4),s=i[0],u=i[1],p=i[2],d=i[3],c=new o.default([],[a+s+u,r+p+d,n]);return"max"===this.poolingFunc&&l.default.assigns(c.tensor,Number.NEGATIVE_INFINITY),l.default.assign(c.tensor.hi(a+s,r+p,n).lo(s,p,0),e.tensor),c}return e}},{key:"_callCPU",value:function(e){"channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(1,2,0)),this._calcOutputShape(e.tensor.shape),e=this._padInput(e);var t=Dn(e.tensor.shape,3),a=t[0],r=t[1],n=t[2],s=Dn(this.poolSize,2),u=s[0],p=s[1];this.output=new o.default([],this.outputShape);for(var d=new o.default([],[u,p,n]),g=Dn(this.inputPadding,4),h=g[0],f=g[1],m=g[2],_=g[3],y=0,i=0,x;y<=a-u;y+=this.strides[0],i++){x=0,y<h?x=h-y:y+u>a-f&&(x=y+u-(a-f));for(var v=0,b=0,S;v<=r-p;v+=this.strides[1],b++){S=0,v<m?S=m-v:v+p>r-_&&(S=v+p-(r-_));var P=(u-x)*(p-S);l.default.assign(d.tensor,e.tensor.hi(y+u,v+p,n).lo(y,v,0));for(var T=0;T<n;T++)"max"===this.poolingFunc?this.output.tensor.set(i,b,T,l.default.sup(d.tensor.pick(null,null,T))):"average"===this.poolingFunc&&this.output.tensor.set(i,b,T,l.default.sum(d.tensor.pick(null,null,T))/P)}}"channels_first"===this.dataFormat&&(this.output.tensor=this.output.tensor.transpose(2,0,1))}},{key:"_im2col",value:function(e){var t=Dn(e.tensor.shape,3),a=t[0],r=t[1],n=t[2];this.tiledInput||(this.tiledInput=new o.default([],[a*r,n]));for(var i=new o.default([],[a,r]),s=new o.default([],[a*r]),u=0;u<n;u++)l.default.assign(i.tensor,e.tensor.pick(null,null,u)),s.replaceTensorData(i.tensor.data),l.default.assign(this.tiledInput.tensor.pick(null,u),s.tensor);return this.tiledInput}},{key:"_createIndexMap",value:function(){if(!this.poolIndexMap){for(var e=this.inputShape[0],t=this.inputShape[1],a=new o.default([],[e,t]),r=0,n=0;n<e;n++)for(var i=0;i<t;i++)a.tensor.set(n,i,r),r+=1;if("same"===this.padding){var s=Dn(this.inputPadding,4),u=s[0],p=s[1],d=s[2],c=s[3];e=e+u+p,t=t+d+c;var g=new o.default([],[e,t]);l.default.assigns(g.tensor,-1),l.default.assign(g.tensor.hi(this.inputShape[0]+u,this.inputShape[1]+d).lo(u,d),a.tensor),a.tensor=g.tensor}var h=Dn(this.poolSize,2),f=h[0],m=h[1],_=this.outputShape[0],y=this.outputShape[1];this.poolIndexMap=new o.default([],[_*y,f*m],{type:Int32Array});for(var x=new o.default([],[f,m]),v=0,b=0,S=e-f;b<=S;b+=this.strides[0])for(var P=0,T=t-m;P<=T;P+=this.strides[1])l.default.assign(x.tensor,a.tensor.hi(b+f,P+m).lo(b,P)),this.poolIndexMap.tensor.data.set(x.tensor.data,v),v+=f*m;this.poolIndexMap.createGLTexture({type:"2d",format:"int",supportsTextureFragments:!0})}}},{key:"_callGPU",value:function(e){if(e.is2DReshaped||e.is2DSquareReshaped?this.inputShape=e.originalShape:("channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(1,2,0)),this.inputShape=e.tensor.shape,this._im2col(e),this.tiledInput.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0})),this._calcOutputShape(this.inputShape),this._createIndexMap(),!this.output){var t=Dn(this.outputShape,3),a=t[0],r=t[1],i=t[2];this.output=new o.default([],[a*r,i]),this.output.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),this.output.is2DReshaped=!0,this.output.originalShape=this.outputShape,this.output.indicesForReshaped=n.createIndicesFor2DReshaped(this.outputShape,!1,-1)}var l=e.is2DReshaped||e.is2DSquareReshaped?e:this.tiledInput,s=this.poolSize[0]*this.poolSize[1],u="max"===this.poolingFunc,p=[{value:this.output.glTextureShape[1],type:"int",name:"channels"},{value:s,type:"int",name:"poolSize"},{value:+u,type:"bool",name:"isMaxPooling"}];l.glTextureFragments?(l.convert2DRowFragmentedGLTextureToColStack(),XS.webgl2.runProgram({program:this.poolingFragmentsProgram,output:this.output,inputs:[{input:l,name:"x"},{input:this.poolIndexMap,name:"poolIndexMap"}],uniforms:p,supportsTextureFragments:!0}),l.removeGLTextureFragmentsAsColStack()):XS.webgl2.runProgram({program:this.poolingProgram,output:this.output,inputs:[{input:l,name:"x"},{input:this.poolIndexMap,name:"poolIndexMap"}],uniforms:p,supportsTextureFragments:!0}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.reshapeFrom2D(),"channels_first"===this.dataFormat&&(this.output.tensor=this.output.tensor.transpose(2,0,1)))}}]),t}(r.default);t.default=i});le(mk);var _k=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(mk),r=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="MaxPooling2D",a.poolingFunc="max",a}return Mn(t,e),t}(a.default);t.default=r});le(_k);var yk=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}(pP),l=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="_Pooling3D";var r=e.pool_size,o=void 0===r?[2,2,2]:r,n=e.strides,i=void 0===n?null:n,l=e.padding,s=void 0===l?"valid":l,u=e.data_format,p=void 0===u?"channels_last":u;return a.poolSize=Array.isArray(o)?o:[o,o,o],a.strides=Array.isArray(i)?i:null===i?a.poolSize:[i,i,i],a.padding=s,a.dataFormat=p,a.poolingFunc="max",a.description="pool size "+a.poolSize.join("x"),a.description+=a.strides.some(function(e){return 1<e})?", "+a.strides.join("x")+" striding":"",a.description+="valid"===a.padding?", no border padding":", pad to same borders",a.gpu&&(a.poolingProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D poolIndexMap;\nuniform int channels;\nuniform int poolSize;\nuniform bool isMaxPooling;\nout vec4 outColor;\n\nvoid main() {\n  int out_x = int(float(channels) * outTex.x);\n  int out_y = int(float(textureSize(poolIndexMap, 0)[1]) * outTex.y);\n\n  float val = 0.;\n  int count = 0;\n  for (int i = 0; i < poolSize; ++i) {\n    int poolIndex = texelFetch(poolIndexMap, ivec2(i, out_y), 0).r;\n    if (poolIndex != -1) {\n      float val2 = texelFetch(x, ivec2(out_x, poolIndex), 0).r;\n      if (isMaxPooling) {\n        if (count == 0 || val2 > val) {\n          val = val2;\n        }\n      } else {\n        val += val2;\n      }\n      count += 1;\n    }\n  }\n\n  if (!isMaxPooling) {\n    val /= float(count);\n  }\n\n  outColor = vec4(val);\n}\n"),a.poolingFragmentsProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D poolIndexMap;\nuniform int channels;\nuniform int poolSize;\nuniform bool isMaxPooling;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 inputSize = textureSize(x, 0);\n  ivec2 outputSize = textureSize(poolIndexMap, 0);\n  int out_x = int(float(channels) * outTex.x);\n  int out_y = int(float(outputSize[1]) * outTex.y);\n\n  float val = 0.;\n  int count = 0;\n  for (int i = 0; i < poolSize; ++i) {\n    int poolIndex = texelFetch(poolIndexMap, ivec2(i, out_y), 0).r;\n    int fragmentIndex = int(floor(float(poolIndex) / float(inputSize[1])));\n    if (poolIndex != -1) {\n      poolIndex = int(mod(float(poolIndex), float(inputSize[1])));\n      float val2 = texelFetch(x, ivec2(fragmentIndex * channels + out_x, poolIndex), 0).r;\n      if (isMaxPooling) {\n        if (count == 0 || val2 > val) {\n          val = val2;\n        }\n      } else {\n        val += val2;\n      }\n      count += 1;\n    }\n  }\n\n  if (!isMaxPooling) {\n    val /= float(count);\n  }\n\n  outColor = vec4(val);\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_calcOutputShape",value:function(e){if(!(this.outputShape&&this.inputPadding)){var t=Dn(e,4),a=t[0],r=t[1],o=t[2],n=t[3],i=Dn(this.poolSize,3),l=i[0],s=i[1],u=i[2],p="same"===this.padding?_n((a+this.strides[0]-1)/this.strides[0]):_n((a-l+this.strides[0])/this.strides[0]),d="same"===this.padding?_n((r+this.strides[1]-1)/this.strides[1]):_n((r-s+this.strides[1])/this.strides[1]),c="same"===this.padding?_n((o+this.strides[2]-1)/this.strides[2]):_n((o-u+this.strides[2])/this.strides[2]),g="same"===this.padding?bn(0,_n((p-1)*this.strides[0]+l-a)):0,h="same"===this.padding?bn(0,_n((d-1)*this.strides[1]+s-r)):0,f="same"===this.padding?bn(0,_n((c-1)*this.strides[2]+u-o)):0,m=_n(g/2),_=_n(h/2),y=_n(f/2);this.outputShape=[p,d,c,n],this.inputPadding=[m,g-m,_,h-_,y,f-y]}}},{key:"_padInput",value:function(e){if("same"===this.padding){var t=Dn(e.tensor.shape,4),a=t[0],r=t[1],n=t[2],i=t[3],s=Dn(this.inputPadding,6),u=s[0],p=s[1],d=s[2],c=s[3],g=s[4],h=s[5],f=new o.default([],[a+u+p,r+d+c,n+g+h,i]);return"max"===this.poolingFunc&&l.default.assigns(f.tensor,Number.NEGATIVE_INFINITY),l.default.assign(f.tensor.hi(a+u,r+d,n+g,i).lo(u,d,g,0),e.tensor),f}return e}},{key:"_callCPU",value:function(e){"channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(1,2,3,0)),this._calcOutputShape(e.tensor.shape),e=this._padInput(e);var t=Dn(e.tensor.shape,4),a=t[0],r=t[1],n=t[2],s=t[3],u=Dn(this.poolSize,3),p=u[0],d=u[1],g=u[2];this.output=new o.default([],this.outputShape);for(var h=new o.default([],[p,d,g,s]),f=Dn(this.inputPadding,6),m=f[0],_=f[1],y=f[2],x=f[3],v=f[4],b=f[5],S=0,i=0,P;S<=a-p;S+=this.strides[0],i++){P=0,S<m?P=m-S:S+p>a-_&&(P=S+p-(a-_));for(var T=0,w=0,C;T<=r-d;T+=this.strides[1],w++){C=0,T<y?C=y-T:T+d>r-x&&(C=T+d-(r-x));for(var F=0,k=0,M;F<=n-g;F+=this.strides[2],k++){M=0,F<v?M=v-F:F+g>n-b&&(M=F+g-(n-b));var E=(p-P)*(d-C)*(g-M);l.default.assign(h.tensor,e.tensor.hi(S+p,T+d,F+g,s).lo(S,T,F,0));for(var D=0;D<s;D++)"max"===this.poolingFunc?this.output.tensor.set(i,w,k,D,l.default.sup(h.tensor.pick(null,null,null,D))):"average"===this.poolingFunc&&this.output.tensor.set(i,w,k,D,l.default.sum(h.tensor.pick(null,null,null,D))/E)}}}"channels_first"===this.dataFormat&&(this.output.tensor=this.output.tensor.transpose(3,0,1,2))}},{key:"_vol2col",value:function(e){var t=Dn(e.tensor.shape,4),a=t[0],r=t[1],n=t[2],i=t[3];this.tiledInput||(this.tiledInput=new o.default([],[a*r*n,i]));for(var s=new o.default([],[a,r,n]),u=new o.default([],[a*r*n]),p=0;p<i;p++)l.default.assign(s.tensor,e.tensor.pick(null,null,null,p)),u.replaceTensorData(s.tensor.data),l.default.assign(this.tiledInput.tensor.pick(null,p),u.tensor);return this.tiledInput}},{key:"_createIndexMap",value:function(){if(!this.poolIndexMap){for(var e=this.inputShape[0],t=this.inputShape[1],a=this.inputShape[2],r=new o.default([],[e,t,a]),n=0,s=0;s<e;s++)for(var i=0;i<t;i++)for(var u=0;u<a;u++)r.tensor.set(s,i,u,n),n+=1;if("same"===this.padding){var p=Dn(this.inputPadding,6),d=p[0],c=p[1],g=p[2],h=p[3],f=p[4],m=p[5];e=e+d+c,t=t+g+h,a=a+f+m;var _=new o.default([],[e,t,a]);l.default.assigns(_.tensor,-1),l.default.assign(_.tensor.hi(this.inputShape[0]+d,this.inputShape[1]+g,this.inputShape[2]+f).lo(d,g,f),r.tensor),r.tensor=_.tensor}var y=Dn(this.poolSize,3),x=y[0],v=y[1],b=y[2],S=this.outputShape[0],P=this.outputShape[1],T=this.outputShape[2];this.poolIndexMap=new o.default([],[S*P*T,x*v*b],{type:Int32Array});for(var w=new o.default([],[x,v,b]),k=0,C=0,F=e-x;C<=F;C+=this.strides[0])for(var M=0,E=t-v;M<=E;M+=this.strides[1])for(var D=0,I=a-b;D<=I;D+=this.strides[2])l.default.assign(w.tensor,r.tensor.hi(C+x,M+v,D+b).lo(C,M,D)),this.poolIndexMap.tensor.data.set(w.tensor.data,k),k+=x*v*b;this.poolIndexMap.createGLTexture({type:"2d",format:"int",supportsTextureFragments:!0})}}},{key:"_callGPU",value:function(e){if(e.is2DReshaped||e.is2DSquareReshaped?this.inputShape=e.originalShape:("channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(1,2,3,0)),this.inputShape=e.tensor.shape,this._vol2col(e),this.tiledInput.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0})),this._calcOutputShape(this.inputShape),this._createIndexMap(),!this.output){var t=Dn(this.outputShape,4),a=t[0],r=t[1],i=t[2],l=t[3];this.output=new o.default([],[a*r*i,l]),this.output.createGLTexture({type:"2d",format:"float",supportsTextureFragments:!0}),this.output.is2DReshaped=!0,this.output.originalShape=this.outputShape,this.output.indicesForReshaped=n.createIndicesFor2DReshaped(this.outputShape,!1,-1)}var s=e.is2DReshaped||e.is2DSquareReshaped?e:this.tiledInput,u=this.poolSize[0]*this.poolSize[1]*this.poolSize[2],p="max"===this.poolingFunc,d=[{value:this.output.glTextureShape[1],type:"int",name:"channels"},{value:u,type:"int",name:"poolSize"},{value:+p,type:"bool",name:"isMaxPooling"}];s.glTextureFragments?(s.convert2DRowFragmentedGLTextureToColStack(),XS.webgl2.runProgram({program:this.poolingFragmentsProgram,output:this.output,inputs:[{input:s,name:"x"},{input:this.poolIndexMap,name:"poolIndexMap"}],uniforms:d,supportsTextureFragments:!0}),s.removeGLTextureFragmentsAsColStack()):XS.webgl2.runProgram({program:this.poolingProgram,output:this.output,inputs:[{input:s,name:"x"},{input:this.poolIndexMap,name:"poolIndexMap"}],uniforms:d}),0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.reshapeFrom2D(),"channels_first"===this.dataFormat&&(this.output.tensor=this.output.tensor.transpose(3,0,1,2)))}}]),t}(r.default);t.default=i});le(yk);var xk=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(yk),r=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="MaxPooling3D",a.poolingFunc="max",a}return Mn(t,e),t}(a.default);t.default=r});le(xk);var vk=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(hk),r=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="AveragePooling1D",a.poolingFunc="average",a}return Mn(t,e),t}(a.default);t.default=r});le(vk);var bk=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(mk),r=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="AveragePooling2D",a.poolingFunc="average",a}return Mn(t,e),t}(a.default);t.default=r});le(bk);var Sk=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(yk),r=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="AveragePooling3D",a.poolingFunc="average",a}return Mn(t,e),t}(a.default);t.default=r});le(Sk);var Pk=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="_GlobalPooling1D";var r=e.data_format,o=void 0===r?"channels_last":r;return a.dataFormat=o,a.poolingFunc="max",a.gpu&&(a.poolingProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform int channelDataSize;\nuniform bool isMaxPooling;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(x, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  if (isMaxPooling) {\n    // GlobalMaxPooling\n    float maxval = 0.0;\n    for (int j = 0; j < size[1]; ++j) {\n      float val = texelFetch(x, ivec2(out_x, j), 0).r;\n      if (j == 0 || val > maxval) {\n        maxval = val;\n      }\n    }\n    outColor = vec4(maxval);\n  } else {\n    // GlobalAveragePooling\n    float sum = 0.0;\n    for (int j = 0; j < size[1]; ++j) {\n      float val = texelFetch(x, ivec2(out_x, j), 0).r;\n      sum += val;\n    }\n    outColor = vec4(sum / float(channelDataSize));\n  }\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){var t=Dn(e.tensor.shape,2),a=t[0],r=t[1];this.output=new o.default([],[r]);for(var l=0;l<r;l++)"max"===this.poolingFunc?this.output.tensor.set(l,n.default.sup(e.tensor.pick(null,l))):"average"===this.poolingFunc&&this.output.tensor.set(l,n.default.sum(e.tensor.pick(null,l))/a)}},{key:"_callGPU",value:function(e){e.glTexture||e.createGLTexture({type:"2d",format:"float"}),this.inputShape=e.tensor.shape,this.output||(this.output=new o.default([],[this.inputShape[1]]),this.output.createGLTexture({type:"2d",format:"float"}));var t="max"===this.poolingFunc;XS.webgl2.runProgram({program:this.poolingProgram,output:this.output,inputs:[{input:e,name:"x"}],uniforms:[{value:this.inputShape[0],type:"int",name:"channelDataSize"},{value:+t,type:"bool",name:"isMaxPooling"}]}),0===this.outbound.length&&this.output.transferFromGLTexture()}}]),t}(r.default);t.default=i});le(Pk);var Tk=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(Pk),r=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="GlobalMaxPooling1D",a.poolingFunc="max",a}return Mn(t,e),t}(a.default);t.default=r});le(Tk);var wk=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="_GlobalPooling2D";var r=e.data_format,o=void 0===r?"channels_last":r;return a.dataFormat=o,a.poolingFunc="max",a.gpu&&(a.poolingProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform int channelDataSize;\nuniform bool isMaxPooling;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(x, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  if (isMaxPooling) {\n    // GlobalMaxPooling\n    float maxval = 0.0;\n    for (int j = 0; j < size[1]; ++j) {\n      float val = texelFetch(x, ivec2(out_x, j), 0).r;\n      if (j == 0 || val > maxval) {\n        maxval = val;\n      }\n    }\n    outColor = vec4(maxval);\n  } else {\n    // GlobalAveragePooling\n    float sum = 0.0;\n    for (int j = 0; j < size[1]; ++j) {\n      float val = texelFetch(x, ivec2(out_x, j), 0).r;\n      sum += val;\n    }\n    outColor = vec4(sum / float(channelDataSize));\n  }\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){"channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(1,2,0));var t=Dn(e.tensor.shape,3),a=t[0],r=t[1],l=t[2];this.output=new o.default([],[l]);for(var s=0;s<l;s++)"max"===this.poolingFunc?this.output.tensor.set(s,n.default.sup(e.tensor.pick(null,null,s))):"average"===this.poolingFunc&&this.output.tensor.set(s,n.default.sum(e.tensor.pick(null,null,s))/(a*r))}},{key:"_callGPU",value:function(e){e.is2DReshaped||e.is2DSquareReshaped?this.inputShape=e.originalShape:("channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(1,2,0)),this.inputShape=e.tensor.shape,e.reshapeTo2D(),e.createGLTexture({type:"2d",format:"float"})),this.output||(this.output=new o.default([],[this.inputShape[2]]),this.output.createGLTexture({type:"2d",format:"float"}));var t="max"===this.poolingFunc;XS.webgl2.runProgram({program:this.poolingProgram,output:this.output,inputs:[{input:e,name:"x"}],uniforms:[{value:this.inputShape[0]*this.inputShape[1],type:"int",name:"channelDataSize"},{value:+t,type:"bool",name:"isMaxPooling"}]}),0===this.outbound.length&&this.output.transferFromGLTexture()}}]),t}(r.default);t.default=i});le(wk);var kk=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(wk),r=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="GlobalMaxPooling2D",a.poolingFunc="max",a}return Mn(t,e),t}(a.default);t.default=r});le(kk);var Ck=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(uP),i=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="_GlobalPooling3D";var r=e.data_format,o=void 0===r?"channels_last":r;return a.dataFormat=o,a.poolingFunc="max",a.gpu&&(a.poolingProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform int channelDataSize;\nuniform bool isMaxPooling;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(x, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  if (isMaxPooling) {\n    // GlobalMaxPooling\n    float maxval = 0.0;\n    for (int j = 0; j < size[1]; ++j) {\n      float val = texelFetch(x, ivec2(out_x, j), 0).r;\n      if (j == 0 || val > maxval) {\n        maxval = val;\n      }\n    }\n    outColor = vec4(maxval);\n  } else {\n    // GlobalAveragePooling\n    float sum = 0.0;\n    for (int j = 0; j < size[1]; ++j) {\n      float val = texelFetch(x, ivec2(out_x, j), 0).r;\n      sum += val;\n    }\n    outColor = vec4(sum / float(channelDataSize));\n  }\n}\n")),a}return Mn(t,e),Cn(t,[{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){"channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(1,2,3,0));var t=Dn(e.tensor.shape,4),a=t[0],r=t[1],l=t[2],s=t[3];this.output=new o.default([],[s]);for(var u=0;u<s;u++)"max"===this.poolingFunc?this.output.tensor.set(u,n.default.sup(e.tensor.pick(null,null,null,u))):"average"===this.poolingFunc&&this.output.tensor.set(u,n.default.sum(e.tensor.pick(null,null,null,u))/(a*r*l))}},{key:"_callGPU",value:function(e){e.is2DReshaped||e.is2DSquareReshaped?this.inputShape=e.originalShape:("channels_first"===this.dataFormat&&(e.tensor=e.tensor.transpose(1,2,3,0)),this.inputShape=e.tensor.shape,e.reshapeTo2D(),e.createGLTexture({type:"2d",format:"float"})),this.output||(this.output=new o.default([],[this.inputShape[3]]),this.output.createGLTexture({type:"2d",format:"float"}));var t="max"===this.poolingFunc;XS.webgl2.runProgram({program:this.poolingProgram,output:this.output,inputs:[{input:e,name:"x"}],uniforms:[{value:this.inputShape[0]*this.inputShape[1]*this.inputShape[2],type:"int",name:"channelDataSize"},{value:+t,type:"bool",name:"isMaxPooling"}]}),0===this.outbound.length&&this.output.transferFromGLTexture()}}]),t}(r.default);t.default=i});le(Ck);var Fk=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(Ck),r=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="GlobalMaxPooling3D",a.poolingFunc="max",a}return Mn(t,e),t}(a.default);t.default=r});le(Fk);var Mk=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(Pk),r=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="GlobalAveragePooling1D",a.poolingFunc="average",a}return Mn(t,e),t}(a.default);t.default=r});le(Mk);var Ek=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(wk),r=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="GlobalAveragePooling2D",a.poolingFunc="average",a}return Mn(t,e),t}(a.default);t.default=r});le(Ek);var Dk=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(Ck),r=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.layerClass="GlobalAveragePooling3D",a.poolingFunc="average",a}return Mn(t,e),t}(a.default);t.default=r});le(Dk);var Ik=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"MaxPooling1D",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"MaxPooling2D",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"MaxPooling3D",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"AveragePooling1D",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"AveragePooling2D",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"AveragePooling3D",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"GlobalMaxPooling1D",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"GlobalMaxPooling2D",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"GlobalMaxPooling3D",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"GlobalAveragePooling1D",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"GlobalAveragePooling2D",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(t,"GlobalAveragePooling3D",{enumerable:!0,get:function(){return h.default}});var r=a(fk),o=a(_k),n=a(xk),i=a(vk),l=a(bk),s=a(Sk),u=a(Tk),p=a(kk),d=a(Fk),c=a(Mk),g=a(Ek),h=a(Dk)});le(Ik);var Ak=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(EP),n=a(cP),i=a(YS),l=a(uP),s=a(vP),u=r(tT),p=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));Object.defineProperty(a,"_combine",{configurable:!0,enumerable:!0,writable:!0,value:(0,s.default)({args:["array","array","array","array"],body:function(e,t,a,r){e=t+a+r}})}),a.layerClass="SimpleRNN";var r=e.units,n=void 0===r?1:r,i=e.activation,l=void 0===i?"tanh":i,p=e.use_bias,d=e.return_sequences,c=e.go_backwards,g=e.stateful;return a.units=n,a.activation=l,a.activationFunc=o[l],a.use_bias=void 0===p||p,a.returnSequences=void 0!==d&&d,a.goBackwards=void 0!==c&&c,a.stateful=void 0!==g&&g,a.params=a.use_bias?["kernel","recurrent_kernel","bias"]:["kernel","recurrent_kernel"],a.description="output dimensions: "+a.units,a.description+="linear"===a.activation?"":", "+a.activation+" activation",a.description+=a.returnSequences?", return sequences":"",a.description+=a.goBackwards?", backward direction":"",a.description+=a.stateful?", stateful":"",a.gpu&&(a.copyTextureProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D source;\nout vec4 outColor;\n\nvoid main(void) {\n  outColor = texture(source, vec2(outTex.x, outTex.y));\n}\n"),a.matMulProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D A;\nuniform sampler2D B;\nuniform sampler2D C;\nuniform bool addC;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 A_size = textureSize(A, 0);\n  ivec2 B_size = textureSize(B, 0);\n  int out_x = int(float(B_size[0]) * outTex.x);\n  int out_y = int(float(A_size[1]) * outTex.y);\n  int commonDim = A_size[0];\n\n  float sum = 0.;\n  for (int i = 0; i < commonDim; ++i) {\n    float a = texelFetch(A, ivec2(i, out_y), 0).r;\n    float b = texelFetch(B, ivec2(out_x, i), 0).r;\n    sum += a * b;\n  }\n\n  if (addC) {\n    sum += texelFetch(C, ivec2(out_x, 0), 0).r;\n  }\n\n  outColor = vec4(sum);\n}\n"),a.activationProgram=XS.webgl2.compileProgram(u[a.activation]),a.gateSummationProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D t1;\nuniform sampler2D t2;\nuniform sampler2D bias;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(bias, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  float t1_val = texelFetch(t1, ivec2(out_x, out_y), 0).r;\n  float t2_val = texelFetch(t2, ivec2(out_x, out_y), 0).r;\n  float bias_val = texelFetch(bias, ivec2(out_x, out_y), 0).r;\n\n  outColor = vec4(t1_val + t2_val + bias_val);\n}\n"),a.timestepReadProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform int index;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(x, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n\n  outColor = vec4(texelFetch(x, ivec2(out_x, index), 0).r);\n}\n"),a.timestepWriteProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform sampler2D y;\nuniform int index;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(y, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  if (out_y == index) {\n    outColor = vec4(texelFetch(x, ivec2(out_x, 0), 0).r);\n  } else {\n    outColor = vec4(texelFetch(y, ivec2(out_x, out_y), 0).r);\n  }\n}\n")),a}return Mn(t,e),Cn(t,[{key:"setWeights",value:function(e){Fn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setWeights",this).call(this,e),this.use_bias||(this.weights.bias=new n.default([],[this.units]),this.gpu&&this.weights.bias.createGLTexture({type:"2d",format:"float"}))}},{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){var t=this,a=this.units,r=this.stateful&&this.currentHiddenState?this.currentHiddenState:new n.default([],[a]),o=new n.default([],[a]),s=new n.default([],[a]),u=new n.default([],[a]);this.hiddenStateSequence=new n.default([],[e.tensor.shape[0],a]);for(var p=new n.default([],[e.tensor.shape[1]]),d=function(){l.default.assign(u.tensor,r.tensor),(0,tw.gemv)(1,t.weights.kernel.tensor.transpose(1,0),p.tensor,1,o.tensor),(0,tw.gemv)(1,t.weights.recurrent_kernel.tensor.transpose(1,0),u.tensor,1,s.tensor),t._combine(r.tensor,o.tensor,s.tensor,t.weights.bias.tensor),t.activationFunc(r)},c=0,i=e.tensor.shape[0],g;c<i;c++){g=this.goBackwards?i-c-1:c,l.default.assign(p.tensor,e.tensor.pick(g,null));[o,s].forEach(function(e){return l.default.assigns(e.tensor,0)}),d(),this.returnSequences&&l.default.assign(this.hiddenStateSequence.tensor.pick(c,null),r.tensor)}this.output=this.returnSequences?this.hiddenStateSequence:r,this.stateful&&(this.currentHiddenState=r)}},{key:"_stepGPU",value:function(){XS.webgl2.runProgram({program:this.copyTextureProgram,output:this.previousHiddenState,inputs:[{input:this.currentHiddenState,name:"source"}]}),XS.webgl2.runProgram({program:this.matMulProgram,output:this.tempXH,inputs:[{input:this.currentX,name:"A"},{input:this.weights.kernel,name:"B"}],uniforms:[{value:0,type:"bool",name:"addC"}]}),XS.webgl2.runProgram({program:this.matMulProgram,output:this.tempHH,inputs:[{input:this.previousHiddenState,name:"A"},{input:this.weights.recurrent_kernel,name:"B"}],uniforms:[{value:0,type:"bool",name:"addC"}]}),XS.webgl2.runProgram({program:this.gateSummationProgram,output:this.currentHiddenStatePreactiv,inputs:[{input:this.tempXH,name:"t1"},{input:this.tempHH,name:"t2"},{input:this.weights.bias,name:"bias"}]}),"linear"===this.activation?this.currentHiddenState=this.currentHiddenStatePreactiv:XS.webgl2.runProgram({program:this.activationProgram,output:this.currentHiddenState,inputs:[{input:this.currentHiddenStatePreactiv,name:"x"}]})}},{key:"_callGPU",value:function(e){e.glTexture||e.createGLTexture({type:"2d",format:"float"});var t=this.units;this.currentHiddenState&&this.stateful||(this.currentHiddenState=new n.default([],[t]),this.currentHiddenState.createGLTexture({type:"2d",format:"float"})),this.currentHiddenStatePreactiv||(this.currentHiddenStatePreactiv=new n.default([],[t]),this.currentHiddenStatePreactiv.createGLTexture({type:"2d",format:"float"})),this.tempXH||(this.tempXH=new n.default([],[t]),this.tempXH.createGLTexture({type:"2d",format:"float"})),this.tempHH||(this.tempHH=new n.default([],[t]),this.tempHH.createGLTexture({type:"2d",format:"float"})),this.previousHiddenState||(this.previousHiddenState=new n.default([],[t]),this.previousHiddenState.createGLTexture({type:"2d",format:"float"})),this.hiddenStateSequence||(this.hiddenStateSequence=new n.default([],[e.glTextureShape[0],t]),this.hiddenStateSequence.createGLTexture({type:"2d",format:"float"})),this.hiddenStateSequenceCopy||(this.hiddenStateSequenceCopy=new n.default([],[e.glTextureShape[0],t]),this.hiddenStateSequenceCopy.createGLTexture({type:"2d",format:"float"})),this.currentX||(this.currentX=new n.default([],[e.glTextureShape[1]]),this.currentX.createGLTexture({type:"2d",format:"float"}));for(var a=0,r=e.glTextureShape[0],o;a<r;a++)o=this.goBackwards?r-a-1:a,XS.webgl2.runProgram({program:this.timestepReadProgram,output:this.currentX,inputs:[{input:e,name:"x"}],uniforms:[{value:o,type:"int",name:"index"}]}),this._stepGPU(),this.returnSequences&&(XS.webgl2.runProgram({program:this.copyTextureProgram,output:this.hiddenStateSequenceCopy,inputs:[{input:this.hiddenStateSequence,name:"source"}]}),XS.webgl2.runProgram({program:this.timestepWriteProgram,output:this.hiddenStateSequence,inputs:[{input:this.currentHiddenState,name:"x"},{input:this.hiddenStateSequenceCopy,name:"y"}],uniforms:[{value:a,type:"int",name:"index"}]}));this.output=this.returnSequences?this.hiddenStateSequence:this.currentHiddenState,0===this.outbound.length&&this.output.transferFromGLTexture()}}]),t}(i.default);t.default=p});le(Ak);var Rk=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(EP),n=a(cP),i=a(YS),l=a(uP),s=a(vP),u=r(tT),p=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));Object.defineProperty(a,"_combine",{configurable:!0,enumerable:!0,writable:!0,value:(0,s.default)({args:["array","array","array","array"],body:function(e,t,a,r){e=t+a+r}})}),Object.defineProperty(a,"_update",{configurable:!0,enumerable:!0,writable:!0,value:(0,s.default)({args:["array","array","array","array"],body:function(e,t,a,r){e=e*a+t*r}})}),a.layerClass="LSTM";var r=e.units,n=void 0===r?1:r,i=e.activation,l=void 0===i?"tanh":i,p=e.use_bias,d=e.recurrent_activation,c=void 0===d?"hard_sigmoid":d,g=e.return_sequences,h=e.go_backwards,f=e.stateful;return a.units=n,a.activation=l,a.recurrentActivation=c,a.activationFunc=o[l],a.recurrentActivationFunc=o[c],a.use_bias=void 0===p||p,a.returnSequences=void 0!==g&&g,a.goBackwards=void 0!==h&&h,a.stateful=void 0!==f&&f,a.params=a.use_bias?["kernel","recurrent_kernel","bias"]:["kernel","recurrent_kernel"],a.description="output dimensions: "+a.units,a.description+="linear"===a.activation?"":", "+a.activation+" activation",a.description+="linear"===a.recurrentActivation?"":", "+a.recurrentActivation+" recurrent activation",a.description+=a.returnSequences?", return sequences":"",a.description+=a.goBackwards?", backward direction":"",a.description+=a.stateful?", stateful":"",a.gpu&&(a.copyTextureProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D source;\nout vec4 outColor;\n\nvoid main(void) {\n  outColor = texture(source, vec2(outTex.x, outTex.y));\n}\n"),a.matMulProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D A;\nuniform sampler2D B;\nuniform sampler2D C;\nuniform bool addC;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 A_size = textureSize(A, 0);\n  ivec2 B_size = textureSize(B, 0);\n  int out_x = int(float(B_size[0]) * outTex.x);\n  int out_y = int(float(A_size[1]) * outTex.y);\n  int commonDim = A_size[0];\n\n  float sum = 0.;\n  for (int i = 0; i < commonDim; ++i) {\n    float a = texelFetch(A, ivec2(i, out_y), 0).r;\n    float b = texelFetch(B, ivec2(out_x, i), 0).r;\n    sum += a * b;\n  }\n\n  if (addC) {\n    sum += texelFetch(C, ivec2(out_x, 0), 0).r;\n  }\n\n  outColor = vec4(sum);\n}\n"),a.activationProgram=XS.webgl2.compileProgram(u[a.activation]),a.recurrentActivationProgram=XS.webgl2.compileProgram(u[a.recurrentActivation]),a.gateSummationProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D t1;\nuniform sampler2D t2;\nuniform sampler2D bias;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(bias, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  float t1_val = texelFetch(t1, ivec2(out_x, out_y), 0).r;\n  float t2_val = texelFetch(t2, ivec2(out_x, out_y), 0).r;\n  float bias_val = texelFetch(bias, ivec2(out_x, out_y), 0).r;\n\n  outColor = vec4(t1_val + t2_val + bias_val);\n}\n"),a.gateProductProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D t1;\nuniform sampler2D t2;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(t1, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  float t1_val = texelFetch(t1, ivec2(out_x, out_y), 0).r;\n  float t2_val = texelFetch(t2, ivec2(out_x, out_y), 0).r;\n\n  outColor = vec4(t1_val * t2_val);\n}\n"),a.timestepReadProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform int index;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(x, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n\n  outColor = vec4(texelFetch(x, ivec2(out_x, index), 0).r);\n}\n"),a.timestepWriteProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform sampler2D y;\nuniform int index;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(y, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  if (out_y == index) {\n    outColor = vec4(texelFetch(x, ivec2(out_x, 0), 0).r);\n  } else {\n    outColor = vec4(texelFetch(y, ivec2(out_x, out_y), 0).r);\n  }\n}\n"),a.updateProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D c;\nuniform sampler2D ctm1;\nuniform sampler2D i;\nuniform sampler2D f;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(c, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  float c_val = texelFetch(c, ivec2(out_x, out_y), 0).r;\n  float ctm1_val = texelFetch(ctm1, ivec2(out_x, out_y), 0).r;\n  float i_val = texelFetch(i, ivec2(out_x, out_y), 0).r;\n  float f_val = texelFetch(f, ivec2(out_x, out_y), 0).r;\n\n  outColor = vec4(c_val * i_val + ctm1_val * f_val);\n}\n")),a}return Mn(t,e),Cn(t,[{key:"setWeights",value:function(e){var a=this;Fn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setWeights",this).call(this,e);var r=this.weights.kernel.tensor.shape;this.weights.W_i=new n.default([],[r[0],this.units]),this.weights.W_f=new n.default([],[r[0],this.units]),this.weights.W_c=new n.default([],[r[0],this.units]),this.weights.W_o=new n.default([],[r[0],this.units]),l.default.assign(this.weights.W_i.tensor,this.weights.kernel.tensor.hi(r[0],this.units).lo(0,0)),l.default.assign(this.weights.W_f.tensor,this.weights.kernel.tensor.hi(r[0],2*this.units).lo(0,this.units)),l.default.assign(this.weights.W_c.tensor,this.weights.kernel.tensor.hi(r[0],3*this.units).lo(0,2*this.units)),l.default.assign(this.weights.W_o.tensor,this.weights.kernel.tensor.hi(r[0],4*this.units).lo(0,3*this.units));var o=this.weights.recurrent_kernel.tensor.shape;if(this.weights.U_i=new n.default([],[o[0],this.units]),this.weights.U_f=new n.default([],[o[0],this.units]),this.weights.U_c=new n.default([],[o[0],this.units]),this.weights.U_o=new n.default([],[o[0],this.units]),l.default.assign(this.weights.U_i.tensor,this.weights.recurrent_kernel.tensor.hi(o[0],this.units).lo(0,0)),l.default.assign(this.weights.U_f.tensor,this.weights.recurrent_kernel.tensor.hi(o[0],2*this.units).lo(0,this.units)),l.default.assign(this.weights.U_c.tensor,this.weights.recurrent_kernel.tensor.hi(o[0],3*this.units).lo(0,2*this.units)),l.default.assign(this.weights.U_o.tensor,this.weights.recurrent_kernel.tensor.hi(o[0],4*this.units).lo(0,3*this.units)),this.weights.b_i=new n.default([],[this.units]),this.weights.b_f=new n.default([],[this.units]),this.weights.b_c=new n.default([],[this.units]),this.weights.b_o=new n.default([],[this.units]),this.use_bias&&(l.default.assign(this.weights.b_i.tensor,this.weights.bias.tensor.hi(this.units).lo(0)),l.default.assign(this.weights.b_f.tensor,this.weights.bias.tensor.hi(2*this.units).lo(this.units)),l.default.assign(this.weights.b_c.tensor,this.weights.bias.tensor.hi(3*this.units).lo(2*this.units)),l.default.assign(this.weights.b_o.tensor,this.weights.bias.tensor.hi(4*this.units).lo(3*this.units))),this.gpu){["W_i","W_f","W_c","W_o","U_i","U_f","U_c","U_o","b_i","b_f","b_c","b_o"].forEach(function(e){a.weights[e].createGLTexture({type:"2d",format:"float"})})}}},{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){var t=this,a=this.weights.b_i.tensor.shape[0],r=this.weights.b_c.tensor.shape[0],o=this.weights.b_f.tensor.shape[0],s=this.weights.b_o.tensor.shape[0],u=new n.default([],[a]),p=new n.default([],[a]),d=new n.default([],[a]),c=new n.default([],[o]),g=new n.default([],[o]),h=new n.default([],[o]),f=new n.default([],[s]),m=new n.default([],[s]),_=new n.default([],[s]),y=new n.default([],[r]),x=new n.default([],[r]),v=new n.default([],[r]),b=this.stateful&&this.previousCandidate?this.previousCandidate:new n.default([],[r]),S=this.stateful&&this.currentHiddenState?this.currentHiddenState:new n.default([],[r]),P=new n.default([],[r]);this.hiddenStateSequence=new n.default([],[e.tensor.shape[0],r]);for(var T=new n.default([],[e.tensor.shape[1]]),w=function(){l.default.assign(P.tensor,S.tensor),(0,tw.gemv)(1,t.weights.W_i.tensor.transpose(1,0),T.tensor,1,p.tensor),(0,tw.gemv)(1,t.weights.U_i.tensor.transpose(1,0),P.tensor,1,d.tensor),t._combine(u.tensor,p.tensor,d.tensor,t.weights.b_i.tensor),t.recurrentActivationFunc(u),(0,tw.gemv)(1,t.weights.W_f.tensor.transpose(1,0),T.tensor,1,g.tensor),(0,tw.gemv)(1,t.weights.U_f.tensor.transpose(1,0),P.tensor,1,h.tensor),t._combine(c.tensor,g.tensor,h.tensor,t.weights.b_f.tensor),t.recurrentActivationFunc(c),(0,tw.gemv)(1,t.weights.W_o.tensor.transpose(1,0),T.tensor,1,m.tensor),(0,tw.gemv)(1,t.weights.U_o.tensor.transpose(1,0),P.tensor,1,_.tensor),t._combine(f.tensor,m.tensor,_.tensor,t.weights.b_o.tensor),t.recurrentActivationFunc(f),(0,tw.gemv)(1,t.weights.W_c.tensor.transpose(1,0),T.tensor,1,x.tensor),(0,tw.gemv)(1,t.weights.U_c.tensor.transpose(1,0),P.tensor,1,v.tensor),t._combine(y.tensor,x.tensor,v.tensor,t.weights.b_c.tensor),t.activationFunc(y),t._update(y.tensor,b.tensor,u.tensor,c.tensor),l.default.assign(b.tensor,y.tensor),t.activationFunc(y),l.default.mul(S.tensor,f.tensor,y.tensor)},k=0,i=e.tensor.shape[0],C;k<i;k++){C=this.goBackwards?i-k-1:k,l.default.assign(T.tensor,e.tensor.pick(C,null));[p,d,g,h,m,_,x,v].forEach(function(e){return l.default.assigns(e.tensor,0)}),w(),l.default.assign(this.hiddenStateSequence.tensor.pick(k,null),S.tensor)}this.output=this.returnSequences?this.hiddenStateSequence:S,this.stateful&&(this.previousCandidate=b,this.currentHiddenState=S)}},{key:"_stepGPU",value:function(){XS.webgl2.runProgram({program:this.copyTextureProgram,output:this.previousHiddenState,inputs:[{input:this.currentHiddenState,name:"source"}]}),XS.webgl2.runProgram({program:this.matMulProgram,output:this.tempXI,inputs:[{input:this.currentX,name:"A"},{input:this.weights.W_i,name:"B"}],uniforms:[{value:0,type:"bool",name:"addC"}]}),XS.webgl2.runProgram({program:this.matMulProgram,output:this.tempHI,inputs:[{input:this.previousHiddenState,name:"A"},{input:this.weights.U_i,name:"B"}],uniforms:[{value:0,type:"bool",name:"addC"}]}),XS.webgl2.runProgram({program:this.gateSummationProgram,output:this.currentInputGateStatePreactiv,inputs:[{input:this.tempXI,name:"t1"},{input:this.tempHI,name:"t2"},{input:this.weights.b_i,name:"bias"}]}),"linear"===this.recurrentActivation?this.currentInputGateState=this.currentInputGateStatePreactiv:XS.webgl2.runProgram({program:this.recurrentActivationProgram,output:this.currentInputGateState,inputs:[{input:this.currentInputGateStatePreactiv,name:"x"}]}),XS.webgl2.runProgram({program:this.matMulProgram,output:this.tempXF,inputs:[{input:this.currentX,name:"A"},{input:this.weights.W_f,name:"B"}],uniforms:[{value:0,type:"bool",name:"addC"}]}),XS.webgl2.runProgram({program:this.matMulProgram,output:this.tempHF,inputs:[{input:this.previousHiddenState,name:"A"},{input:this.weights.U_f,name:"B"}],uniforms:[{value:0,type:"bool",name:"addC"}]}),XS.webgl2.runProgram({program:this.gateSummationProgram,output:this.currentForgetGateStatePreactiv,inputs:[{input:this.tempXF,name:"t1"},{input:this.tempHF,name:"t2"},{input:this.weights.b_f,name:"bias"}]}),"linear"===this.recurrentActivation?this.currentForgetGateState=this.currentForgetGateStatePreactiv:XS.webgl2.runProgram({program:this.recurrentActivationProgram,output:this.currentForgetGateState,inputs:[{input:this.currentForgetGateStatePreactiv,name:"x"}]}),XS.webgl2.runProgram({program:this.matMulProgram,output:this.tempXO,inputs:[{input:this.currentX,name:"A"},{input:this.weights.W_o,name:"B"}],uniforms:[{value:0,type:"bool",name:"addC"}]}),XS.webgl2.runProgram({program:this.matMulProgram,output:this.tempHO,inputs:[{input:this.previousHiddenState,name:"A"},{input:this.weights.U_o,name:"B"}],uniforms:[{value:0,type:"bool",name:"addC"}]}),XS.webgl2.runProgram({program:this.gateSummationProgram,output:this.currentOutputGateStatePreactiv,inputs:[{input:this.tempXO,name:"t1"},{input:this.tempHO,name:"t2"},{input:this.weights.b_o,name:"bias"}]}),"linear"===this.recurrentActivation?this.currentOutputGateState=this.currentOutputGateStatePreactiv:XS.webgl2.runProgram({program:this.recurrentActivationProgram,output:this.currentOutputGateState,inputs:[{input:this.currentOutputGateStatePreactiv,name:"x"}]}),XS.webgl2.runProgram({program:this.matMulProgram,output:this.tempXC,inputs:[{input:this.currentX,name:"A"},{input:this.weights.W_c,name:"B"}],uniforms:[{value:0,type:"bool",name:"addC"}]}),XS.webgl2.runProgram({program:this.matMulProgram,output:this.tempHC,inputs:[{input:this.previousHiddenState,name:"A"},{input:this.weights.U_c,name:"B"}],uniforms:[{value:0,type:"bool",name:"addC"}]}),XS.webgl2.runProgram({program:this.gateSummationProgram,output:this.currentCandidatePreactiv,inputs:[{input:this.tempXC,name:"t1"},{input:this.tempHC,name:"t2"},{input:this.weights.b_c,name:"bias"}]}),"linear"===this.activation?this.currentCandidate=this.currentCandidatePreactiv:XS.webgl2.runProgram({program:this.activationProgram,output:this.currentCandidate,inputs:[{input:this.currentCandidatePreactiv,name:"x"}]}),XS.webgl2.runProgram({program:this.copyTextureProgram,output:this.currentCandidateCopy,inputs:[{input:this.currentCandidate,name:"source"}]}),XS.webgl2.runProgram({program:this.updateProgram,output:this.currentCandidate,inputs:[{input:this.currentCandidateCopy,name:"c"},{input:this.previousCandidate,name:"ctm1"},{input:this.currentInputGateState,name:"i"},{input:this.currentForgetGateState,name:"f"}]}),XS.webgl2.runProgram({program:this.copyTextureProgram,output:this.previousCandidate,inputs:[{input:this.currentCandidate,name:"source"}]}),XS.webgl2.runProgram({program:this.copyTextureProgram,output:this.currentCandidatePreactiv,inputs:[{input:this.currentCandidate,name:"source"}]}),"linear"===this.activation?this.currentCandidate=this.currentCandidatePreactiv:XS.webgl2.runProgram({program:this.activationProgram,output:this.currentCandidate,inputs:[{input:this.currentCandidatePreactiv,name:"x"}]}),XS.webgl2.runProgram({program:this.gateProductProgram,output:this.currentHiddenState,inputs:[{input:this.currentOutputGateState,name:"t1"},{input:this.currentCandidate,name:"t2"}]})}},{key:"_callGPU",value:function(e){e.glTexture||e.createGLTexture({type:"2d",format:"float"});var t=this.weights.b_i.glTextureShape[1],a=this.weights.b_c.glTextureShape[1],r=this.weights.b_f.glTextureShape[1],o=this.weights.b_o.glTextureShape[1];this.currentInputGateState||(this.currentInputGateState=new n.default([],[t]),this.currentInputGateState.createGLTexture({type:"2d",format:"float"})),this.currentInputGateStatePreactiv||(this.currentInputGateStatePreactiv=new n.default([],[t]),this.currentInputGateStatePreactiv.createGLTexture({type:"2d",format:"float"})),this.tempXI||(this.tempXI=new n.default([],[t]),this.tempXI.createGLTexture({type:"2d",format:"float"})),this.tempHI||(this.tempHI=new n.default([],[t]),this.tempHI.createGLTexture({type:"2d",format:"float"})),this.currentForgetGateState||(this.currentForgetGateState=new n.default([],[r]),this.currentForgetGateState.createGLTexture({type:"2d",format:"float"})),this.currentForgetGateStatePreactiv||(this.currentForgetGateStatePreactiv=new n.default([],[r]),this.currentForgetGateStatePreactiv.createGLTexture({type:"2d",format:"float"})),this.tempXF||(this.tempXF=new n.default([],[r]),this.tempXF.createGLTexture({type:"2d",format:"float"})),this.tempHF||(this.tempHF=new n.default([],[r]),this.tempHF.createGLTexture({type:"2d",format:"float"})),this.currentOutputGateState||(this.currentOutputGateState=new n.default([],[o]),this.currentOutputGateState.createGLTexture({type:"2d",format:"float"})),this.currentOutputGateStatePreactiv||(this.currentOutputGateStatePreactiv=new n.default([],[o]),this.currentOutputGateStatePreactiv.createGLTexture({type:"2d",format:"float"})),this.tempXO||(this.tempXO=new n.default([],[o]),this.tempXO.createGLTexture({type:"2d",format:"float"})),this.tempHO||(this.tempHO=new n.default([],[o]),this.tempHO.createGLTexture({type:"2d",format:"float"})),this.currentCandidate||(this.currentCandidate=new n.default([],[a]),this.currentCandidate.createGLTexture({type:"2d",format:"float"})),this.currentCandidateCopy||(this.currentCandidateCopy=new n.default([],[a]),this.currentCandidateCopy.createGLTexture({type:"2d",format:"float"})),this.currentCandidatePreactiv||(this.currentCandidatePreactiv=new n.default([],[a]),this.currentCandidatePreactiv.createGLTexture({type:"2d",format:"float"})),this.tempXC||(this.tempXC=new n.default([],[a]),this.tempXC.createGLTexture({type:"2d",format:"float"})),this.tempHC||(this.tempHC=new n.default([],[a]),this.tempHC.createGLTexture({type:"2d",format:"float"})),this.previousCandidate&&this.stateful||(this.previousCandidate=new n.default([],[a]),this.previousCandidate.createGLTexture({type:"2d",format:"float"})),this.currentHiddenState&&this.stateful||(this.currentHiddenState=new n.default([],[a]),this.currentHiddenState.createGLTexture({type:"2d",format:"float"})),this.previousHiddenState||(this.previousHiddenState=new n.default([],[a]),this.previousHiddenState.createGLTexture({type:"2d",format:"float"})),this.hiddenStateSequence||(this.hiddenStateSequence=new n.default([],[e.glTextureShape[0],a]),this.hiddenStateSequence.createGLTexture({type:"2d",format:"float"})),this.hiddenStateSequenceCopy||(this.hiddenStateSequenceCopy=new n.default([],[e.glTextureShape[0],a]),this.hiddenStateSequenceCopy.createGLTexture({type:"2d",format:"float"})),this.currentX||(this.currentX=new n.default([],[e.glTextureShape[1]]),this.currentX.createGLTexture({type:"2d",format:"float"}));for(var l=0,s=e.glTextureShape[0],u;l<s;l++)u=this.goBackwards?s-l-1:l,XS.webgl2.runProgram({program:this.timestepReadProgram,output:this.currentX,inputs:[{input:e,name:"x"}],uniforms:[{value:u,type:"int",name:"index"}]}),this._stepGPU(),this.returnSequences&&(XS.webgl2.runProgram({program:this.copyTextureProgram,output:this.hiddenStateSequenceCopy,inputs:[{input:this.hiddenStateSequence,name:"source"}]}),XS.webgl2.runProgram({program:this.timestepWriteProgram,output:this.hiddenStateSequence,inputs:[{input:this.currentHiddenState,name:"x"},{input:this.hiddenStateSequenceCopy,name:"y"}],uniforms:[{value:l,type:"int",name:"index"}]}));this.output=this.returnSequences?this.hiddenStateSequence:this.currentHiddenState,0===this.outbound.length&&this.output.transferFromGLTexture()}}]),t}(i.default);t.default=p});le(Rk);var Ok=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(EP),n=a(cP),i=a(YS),l=a(uP),s=a(vP),u=r(tT),p=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));Object.defineProperty(a,"_combine",{configurable:!0,enumerable:!0,writable:!0,value:(0,s.default)({args:["array","array","array","array"],body:function(e,t,a,r){e=t+a+r}})}),Object.defineProperty(a,"_update",{configurable:!0,enumerable:!0,writable:!0,value:(0,s.default)({args:["array","array","array"],body:function(e,t,a){e=e*(1-a)+t*a}})}),a.layerClass="GRU";var r=e.units,n=void 0===r?1:r,i=e.activation,l=void 0===i?"tanh":i,p=e.use_bias,d=e.recurrent_activation,c=void 0===d?"hard_sigmoid":d,g=e.return_sequences,h=e.go_backwards,f=e.stateful;return a.units=n,a.activation=l,a.recurrentActivation=c,a.activationFunc=o[l],a.recurrentActivationFunc=o[c],a.use_bias=void 0===p||p,a.returnSequences=void 0!==g&&g,a.goBackwards=void 0!==h&&h,a.stateful=void 0!==f&&f,a.params=a.use_bias?["kernel","recurrent_kernel","bias"]:["kernel","recurrent_kernel"],a.description="output dimensions: "+a.units,a.description+="linear"===a.activation?"":", "+a.activation+" activation",a.description+="linear"===a.recurrentActivation?"":", "+a.recurrentActivation+" recurrent activation",a.description+=a.returnSequences?", return sequences":"",a.description+=a.goBackwards?", backward direction":"",a.description+=a.stateful?", stateful":"",a.gpu&&(a.copyTextureProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D source;\nout vec4 outColor;\n\nvoid main(void) {\n  outColor = texture(source, vec2(outTex.x, outTex.y));\n}\n"),a.matMulProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D A;\nuniform sampler2D B;\nuniform sampler2D C;\nuniform bool addC;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 A_size = textureSize(A, 0);\n  ivec2 B_size = textureSize(B, 0);\n  int out_x = int(float(B_size[0]) * outTex.x);\n  int out_y = int(float(A_size[1]) * outTex.y);\n  int commonDim = A_size[0];\n\n  float sum = 0.;\n  for (int i = 0; i < commonDim; ++i) {\n    float a = texelFetch(A, ivec2(i, out_y), 0).r;\n    float b = texelFetch(B, ivec2(out_x, i), 0).r;\n    sum += a * b;\n  }\n\n  if (addC) {\n    sum += texelFetch(C, ivec2(out_x, 0), 0).r;\n  }\n\n  outColor = vec4(sum);\n}\n"),a.activationProgram=XS.webgl2.compileProgram(u[a.activation]),a.recurrentActivationProgram=XS.webgl2.compileProgram(u[a.recurrentActivation]),a.gateSummationProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D t1;\nuniform sampler2D t2;\nuniform sampler2D bias;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(bias, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  float t1_val = texelFetch(t1, ivec2(out_x, out_y), 0).r;\n  float t2_val = texelFetch(t2, ivec2(out_x, out_y), 0).r;\n  float bias_val = texelFetch(bias, ivec2(out_x, out_y), 0).r;\n\n  outColor = vec4(t1_val + t2_val + bias_val);\n}\n"),a.gateProductProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D t1;\nuniform sampler2D t2;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(t1, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  float t1_val = texelFetch(t1, ivec2(out_x, out_y), 0).r;\n  float t2_val = texelFetch(t2, ivec2(out_x, out_y), 0).r;\n\n  outColor = vec4(t1_val * t2_val);\n}\n"),a.timestepReadProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform int index;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(x, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n\n  outColor = vec4(texelFetch(x, ivec2(out_x, index), 0).r);\n}\n"),a.timestepWriteProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform sampler2D y;\nuniform int index;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(y, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  if (out_y == index) {\n    outColor = vec4(texelFetch(x, ivec2(out_x, 0), 0).r);\n  } else {\n    outColor = vec4(texelFetch(y, ivec2(out_x, out_y), 0).r);\n  }\n}\n"),a.updateProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D h;\nuniform sampler2D htm1;\nuniform sampler2D z;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(h, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  float h_val = texelFetch(h, ivec2(out_x, out_y), 0).r;\n  float htm1_val = texelFetch(htm1, ivec2(out_x, out_y), 0).r;\n  float z_val = texelFetch(z, ivec2(out_x, out_y), 0).r;\n\n  outColor = vec4(h_val * (float(1.0) - z_val) + htm1_val * z_val);\n}\n")),a}return Mn(t,e),Cn(t,[{key:"setWeights",value:function(e){var a=this;Fn(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setWeights",this).call(this,e);var r=this.weights.kernel.tensor.shape;this.weights.W_z=new n.default([],[r[0],this.units]),this.weights.W_r=new n.default([],[r[0],this.units]),this.weights.W_h=new n.default([],[r[0],this.units]),l.default.assign(this.weights.W_z.tensor,this.weights.kernel.tensor.hi(r[0],this.units).lo(0,0)),l.default.assign(this.weights.W_r.tensor,this.weights.kernel.tensor.hi(r[0],2*this.units).lo(0,this.units)),l.default.assign(this.weights.W_h.tensor,this.weights.kernel.tensor.hi(r[0],3*this.units).lo(0,2*this.units));var o=this.weights.recurrent_kernel.tensor.shape;if(this.weights.U_z=new n.default([],[o[0],this.units]),this.weights.U_r=new n.default([],[o[0],this.units]),this.weights.U_h=new n.default([],[o[0],this.units]),l.default.assign(this.weights.U_z.tensor,this.weights.recurrent_kernel.tensor.hi(o[0],this.units).lo(0,0)),l.default.assign(this.weights.U_r.tensor,this.weights.recurrent_kernel.tensor.hi(o[0],2*this.units).lo(0,this.units)),l.default.assign(this.weights.U_h.tensor,this.weights.recurrent_kernel.tensor.hi(o[0],3*this.units).lo(0,2*this.units)),this.weights.b_z=new n.default([],[this.units]),this.weights.b_r=new n.default([],[this.units]),this.weights.b_h=new n.default([],[this.units]),this.use_bias&&(l.default.assign(this.weights.b_z.tensor,this.weights.bias.tensor.hi(this.units).lo(0)),l.default.assign(this.weights.b_r.tensor,this.weights.bias.tensor.hi(2*this.units).lo(this.units)),l.default.assign(this.weights.b_h.tensor,this.weights.bias.tensor.hi(3*this.units).lo(2*this.units))),this.gpu){["W_z","W_r","W_h","U_z","U_r","U_h","b_z","b_r","b_h"].forEach(function(e){a.weights[e].createGLTexture({type:"2d",format:"float"})})}}},{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){var t=this,a=this.weights.b_z.tensor.shape[0],r=this.weights.b_r.tensor.shape[0],o=this.weights.b_h.tensor.shape[0],s=new n.default([],[a]),u=new n.default([],[a]),p=new n.default([],[a]),d=new n.default([],[r]),c=new n.default([],[r]),g=new n.default([],[r]),h=this.stateful&&this.currentHiddenState?this.currentHiddenState:new n.default([],[o]),f=new n.default([],[o]),m=new n.default([],[o]),_=new n.default([],[o]);this.hiddenStateSequence=new n.default([],[e.tensor.shape[0],o]);for(var y=new n.default([],[e.tensor.shape[1]]),x=function(){l.default.assign(_.tensor,h.tensor),(0,tw.gemv)(1,t.weights.W_z.tensor.transpose(1,0),y.tensor,1,u.tensor),(0,tw.gemv)(1,t.weights.U_z.tensor.transpose(1,0),_.tensor,1,p.tensor),t._combine(s.tensor,u.tensor,p.tensor,t.weights.b_z.tensor),t.recurrentActivationFunc(s),(0,tw.gemv)(1,t.weights.W_r.tensor.transpose(1,0),y.tensor,1,c.tensor),(0,tw.gemv)(1,t.weights.U_r.tensor.transpose(1,0),_.tensor,1,g.tensor),t._combine(d.tensor,c.tensor,g.tensor,t.weights.b_r.tensor),t.recurrentActivationFunc(d),l.default.muleq(d.tensor,_.tensor),(0,tw.gemv)(1,t.weights.W_h.tensor.transpose(1,0),y.tensor,1,f.tensor),(0,tw.gemv)(1,t.weights.U_h.tensor.transpose(1,0),d.tensor,1,m.tensor),t._combine(h.tensor,f.tensor,m.tensor,t.weights.b_h.tensor),t.activationFunc(h),t._update(h.tensor,_.tensor,s.tensor)},v=0,i=e.tensor.shape[0],b;v<i;v++){b=this.goBackwards?i-v-1:v,l.default.assign(y.tensor,e.tensor.pick(b,null));[u,p,c,g,f,m].forEach(function(e){return l.default.assigns(e.tensor,0)}),x(),this.returnSequences&&l.default.assign(this.hiddenStateSequence.tensor.pick(v,null),h.tensor)}this.output=this.returnSequences?this.hiddenStateSequence:h,this.stateful&&(this.currentHiddenState=h)}},{key:"_stepGPU",value:function(){XS.webgl2.runProgram({program:this.copyTextureProgram,output:this.previousHiddenState,inputs:[{input:this.currentHiddenState,name:"source"}]}),XS.webgl2.runProgram({program:this.matMulProgram,output:this.tempXZ,inputs:[{input:this.currentX,name:"A"},{input:this.weights.W_z,name:"B"}],uniforms:[{value:0,type:"bool",name:"addC"}]}),XS.webgl2.runProgram({program:this.matMulProgram,output:this.tempHZ,inputs:[{input:this.previousHiddenState,name:"A"},{input:this.weights.U_z,name:"B"}],uniforms:[{value:0,type:"bool",name:"addC"}]}),XS.webgl2.runProgram({program:this.gateSummationProgram,output:this.currentUpdateGateStatePreactiv,inputs:[{input:this.tempXZ,name:"t1"},{input:this.tempHZ,name:"t2"},{input:this.weights.b_z,name:"bias"}]}),"linear"===this.recurrentActivation?this.currentUpdateGateState=this.currentUpdateGateStatePreactiv:XS.webgl2.runProgram({program:this.recurrentActivationProgram,output:this.currentUpdateGateState,inputs:[{input:this.currentUpdateGateStatePreactiv,name:"x"}]}),XS.webgl2.runProgram({program:this.matMulProgram,output:this.tempXR,inputs:[{input:this.currentX,name:"A"},{input:this.weights.W_r,name:"B"}],uniforms:[{value:0,type:"bool",name:"addC"}]}),XS.webgl2.runProgram({program:this.matMulProgram,output:this.tempHR,inputs:[{input:this.previousHiddenState,name:"A"},{input:this.weights.U_r,name:"B"}],uniforms:[{value:0,type:"bool",name:"addC"}]}),XS.webgl2.runProgram({program:this.gateSummationProgram,output:this.currentResetGateStatePreactiv,inputs:[{input:this.tempXR,name:"t1"},{input:this.tempHR,name:"t2"},{input:this.weights.b_r,name:"bias"}]}),"linear"===this.recurrentActivation?this.currentResetGateState=this.currentResetGateStatePreactiv:XS.webgl2.runProgram({program:this.recurrentActivationProgram,output:this.currentResetGateState,inputs:[{input:this.currentResetGateStatePreactiv,name:"x"}]}),XS.webgl2.runProgram({program:this.copyTextureProgram,output:this.currentResetGateStateCopy,inputs:[{input:this.currentResetGateState,name:"source"}]}),XS.webgl2.runProgram({program:this.gateProductProgram,output:this.currentResetGateState,inputs:[{input:this.currentResetGateStateCopy,name:"t1"},{input:this.previousHiddenState,name:"t2"}]}),XS.webgl2.runProgram({program:this.matMulProgram,output:this.tempXH,inputs:[{input:this.currentX,name:"A"},{input:this.weights.W_h,name:"B"}],uniforms:[{value:0,type:"bool",name:"addC"}]}),XS.webgl2.runProgram({program:this.matMulProgram,output:this.tempHH,inputs:[{input:this.currentResetGateState,name:"A"},{input:this.weights.U_h,name:"B"}],uniforms:[{value:0,type:"bool",name:"addC"}]}),XS.webgl2.runProgram({program:this.gateSummationProgram,output:this.currentHiddenStatePreactiv,inputs:[{input:this.tempXH,name:"t1"},{input:this.tempHH,name:"t2"},{input:this.weights.b_h,name:"bias"}]}),"linear"===this.activation?this.currentHiddenState=this.currentHiddenStatePreactiv:XS.webgl2.runProgram({program:this.activationProgram,output:this.currentHiddenState,inputs:[{input:this.currentHiddenStatePreactiv,name:"x"}]}),XS.webgl2.runProgram({program:this.copyTextureProgram,output:this.currentHiddenStateCopy,inputs:[{input:this.currentHiddenState,name:"source"}]}),XS.webgl2.runProgram({program:this.updateProgram,output:this.currentHiddenState,inputs:[{input:this.currentHiddenStateCopy,name:"h"},{input:this.previousHiddenState,name:"htm1"},{input:this.currentUpdateGateState,name:"z"}]})}},{key:"_callGPU",value:function(e){e.glTexture||e.createGLTexture({type:"2d",format:"float"});var t=this.weights.b_z.glTextureShape[1],a=this.weights.b_r.glTextureShape[1],r=this.weights.b_h.glTextureShape[1];this.currentHiddenState&&this.stateful||(this.currentHiddenState=new n.default([],[r]),this.currentHiddenState.createGLTexture({type:"2d",format:"float"})),this.currentHiddenStateCopy||(this.currentHiddenStateCopy=new n.default([],[r]),this.currentHiddenStateCopy.createGLTexture({type:"2d",format:"float"})),this.currentHiddenStatePreactiv||(this.currentHiddenStatePreactiv=new n.default([],[r]),this.currentHiddenStatePreactiv.createGLTexture({type:"2d",format:"float"})),this.currentUpdateGateState||(this.currentUpdateGateState=new n.default([],[t]),this.currentUpdateGateState.createGLTexture({type:"2d",format:"float"})),this.currentUpdateGateStatePreactiv||(this.currentUpdateGateStatePreactiv=new n.default([],[t]),this.currentUpdateGateStatePreactiv.createGLTexture({type:"2d",format:"float"})),this.tempXZ||(this.tempXZ=new n.default([],[t]),this.tempXZ.createGLTexture({type:"2d",format:"float"})),this.tempHZ||(this.tempHZ=new n.default([],[t]),this.tempHZ.createGLTexture({type:"2d",format:"float"})),this.currentResetGateState||(this.currentResetGateState=new n.default([],[a]),this.currentResetGateState.createGLTexture({type:"2d",format:"float"})),this.currentResetGateStateCopy||(this.currentResetGateStateCopy=new n.default([],[a]),this.currentResetGateStateCopy.createGLTexture({type:"2d",format:"float"})),this.currentResetGateStatePreactiv||(this.currentResetGateStatePreactiv=new n.default([],[a]),this.currentResetGateStatePreactiv.createGLTexture({type:"2d",format:"float"})),this.tempXR||(this.tempXR=new n.default([],[a]),this.tempXR.createGLTexture({type:"2d",format:"float"})),this.tempHR||(this.tempHR=new n.default([],[a]),this.tempHR.createGLTexture({type:"2d",format:"float"})),this.tempXH||(this.tempXH=new n.default([],[r]),this.tempXH.createGLTexture({type:"2d",format:"float"})),this.tempHH||(this.tempHH=new n.default([],[r]),this.tempHH.createGLTexture({type:"2d",format:"float"})),this.previousHiddenState||(this.previousHiddenState=new n.default([],[r]),this.previousHiddenState.createGLTexture({type:"2d",format:"float"})),this.hiddenStateSequence||(this.hiddenStateSequence=new n.default([],[e.glTextureShape[0],r]),this.hiddenStateSequence.createGLTexture({type:"2d",format:"float"})),this.hiddenStateSequenceCopy||(this.hiddenStateSequenceCopy=new n.default([],[e.glTextureShape[0],r]),this.hiddenStateSequenceCopy.createGLTexture({type:"2d",format:"float"})),this.currentX||(this.currentX=new n.default([],[e.glTextureShape[1]]),this.currentX.createGLTexture({type:"2d",format:"float"}));for(var o=0,l=e.glTextureShape[0],s;o<l;o++)s=this.goBackwards?l-o-1:o,XS.webgl2.runProgram({program:this.timestepReadProgram,output:this.currentX,inputs:[{input:e,name:"x"}],uniforms:[{value:s,type:"int",name:"index"}]}),this._stepGPU(),this.returnSequences&&(XS.webgl2.runProgram({program:this.copyTextureProgram,output:this.hiddenStateSequenceCopy,inputs:[{input:this.hiddenStateSequence,name:"source"}]}),XS.webgl2.runProgram({program:this.timestepWriteProgram,output:this.hiddenStateSequence,inputs:[{input:this.currentHiddenState,name:"x"},{input:this.hiddenStateSequenceCopy,name:"y"}],uniforms:[{value:o,type:"int",name:"index"}]}));this.output=this.returnSequences?this.hiddenStateSequence:this.currentHiddenState,0===this.outbound.length&&this.output.transferFromGLTexture()}}]),t}(i.default);t.default=p});le(Ok);var Lk=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"SimpleRNN",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"LSTM",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"GRU",{enumerable:!0,get:function(){return n.default}});var r=a(Ak),o=a(Rk),n=a(Ok)});le(Lk);var jk=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(uP),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}(Uk),l=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="TimeDistributed";var r=e.layer;r||a.throwError("wrapped layer is undefined.");var o=Object.assign({},r.config,{gpu:e.gpu});return a.wrappedLayer=new i[r.class_name](o),a.wrappedLayer.outbound=[null],a.gpu&&(a.copyTextureProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D source;\nout vec4 outColor;\n\nvoid main(void) {\n  outColor = texture(source, vec2(outTex.x, outTex.y));\n}\n"),a.mapInputProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform isampler2D indexMap;\nuniform int inputCols;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(indexMap, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  int index = texelFetch(indexMap, ivec2(out_x, out_y), 0).r;\n\n  if (index != -1) {\n    int rowIndex = int(floor(float(index) / float(inputCols)));\n    int colIndex = int(mod(float(index), float(inputCols)));\n    float val = texelFetch(x, ivec2(colIndex, rowIndex), 0).r;\n    outColor = vec4(val);\n  } else {\n    outColor = vec4(0.0);\n  }\n}\n"),a.selectSliceProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D x;\nuniform int t;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(x, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n\n  outColor = vec4(texelFetch(x, ivec2(out_x, t), 0).r);\n}\n"),a.copySliceOutputProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D outputCopy;\nuniform sampler2D sliceOutput;\nuniform int t;\nuniform int timesteps;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(sliceOutput, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(timesteps) * outTex.y);\n\n  if (t == out_y) {\n    outColor = vec4(texelFetch(sliceOutput, ivec2(out_x, 0), 0).r);\n  } else {\n    outColor = texelFetch(outputCopy, ivec2(out_x, out_y), 0);\n  }\n}\n"),a.mapSliceOutputProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\nprecision highp isampler2D;\n\nin vec2 outTex;\nuniform sampler2D outputCopy;\nuniform sampler2D sliceOutput;\nuniform isampler2D indexMap;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(outputCopy, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  int index = texelFetch(indexMap, ivec2(out_x, out_y), 0).r;\n\n  if (index != -1) {\n    int rowIndex = int(floor(float(index) / float(textureSize(sliceOutput, 0)[0])));\n    int colIndex = int(mod(float(index), float(textureSize(sliceOutput, 0)[0])));\n    float val = texelFetch(sliceOutput, ivec2(colIndex, rowIndex), 0).r;\n    outColor = vec4(val);\n  } else {\n    outColor = texelFetch(outputCopy, ivec2(out_x, out_y), 0);\n  }\n}\n")),a}return Mn(t,e),Cn(t,[{key:"setWeights",value:function(e){this.wrappedLayer.setWeights(e)}},{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){var t=[].concat(In(e.tensor.shape.slice(1))),a=new o.default([],t),r,l;n.default.assign(a.tensor,(r=e.tensor).pick.apply(r,[0].concat(In(Array(t.length).fill(null)))));var s=this.wrappedLayer.call(a),u=s.tensor.shape.slice();this.output=new o.default([],[e.tensor.shape[0]].concat(In(u))),n.default.assign((l=this.output.tensor).pick.apply(l,[0].concat(In(Array(u.length).fill(null)))),s.tensor);for(var p=1,i=e.tensor.shape[0];p<i;p++){var d,c;n.default.assign(a.tensor,(d=e.tensor).pick.apply(d,[p].concat(In(Array(t.length).fill(null))))),s=this.wrappedLayer.call(a),n.default.assign((c=this.output.tensor).pick.apply(c,[p].concat(In(Array(u.length).fill(null)))),s.tensor)}}},{key:"_createIndexMap",value:function(e){if(!this.indexMaps){var a=new o.default(e.data,e.shape,{type:Int32Array});this.indexMaps=[];for(var r=this.inputShape[0],i=this.inputShape.slice(1),l=0;l<r;l++){var t=new o.default([],i,{type:Int32Array}),s;n.default.assign(t.tensor,(s=a.tensor).pick.apply(s,[l].concat(In(Array(i.length).fill(null))))),t.reshapeTo2DSquare(),t.createGLTexture({type:"2d",format:"int"}),this.indexMaps.push(t)}}}},{key:"_createOutputIndexMap",value:function(e){if(!this.outputIndexMaps){var a=new o.default(e.data,e.shape,{type:Int32Array});this.outputIndexMaps=[];for(var r=this.outputShape[0],i=this.outputShape.slice(1),l=0;l<r;l++){var t=new o.default([],this.outputShape,{type:Int32Array}),s;n.default.assigns(t.tensor,-1),n.default.assign((s=t.tensor).pick.apply(s,[l].concat(In(Array(i.length).fill(null)))),a.tensor),t.reshapeTo2DSquare(),t.createGLTexture({type:"2d",format:"int"}),this.outputIndexMaps.push(t)}}}},{key:"_callGPU",value:function(e){this.inputShape=e.is2DReshaped||e.is2DSquareReshaped?e.originalShape:e.tensor.shape,e.glTexture||(2>=e.tensor.shape.length?e.createGLTexture({type:"2d",format:"float"}):2<e.tensor.shape.length&&!e.is2DReshaped&&(e.reshapeTo2DSquare(),e.createGLTexture({type:"2d",format:"float"}))),2<this.inputShape.length&&this._createIndexMap(e.indicesForReshaped);var t=this.inputShape[0],a=this.inputShape.slice(1);this.slice||(this.slice=new o.default([],a),2>=a.length?this.slice.createGLTexture({type:"2d",format:"float"}):(this.slice.reshapeTo2DSquare(),this.slice.createGLTexture({type:"2d",format:"float"}))),2>=this.inputShape.length?XS.webgl2.runProgram({program:this.selectSliceProgram,output:this.slice,inputs:[{input:e,name:"x"}],uniforms:[{value:0,type:"int",name:"t"}]}):XS.webgl2.runProgram({program:this.mapInputProgram,output:this.slice,inputs:[{input:e,name:"x"},{input:this.indexMaps[0],name:"indexMap"}],uniforms:[{value:e.glTextureShape[1],type:"int",name:"inputCols"}]}),this.wrappedLayer._callGPU(this.slice),this.sliceOutput=this.wrappedLayer.output,this.output||(2>=this.inputShape.length?(this.outputShape=[t,this.sliceOutput.glTextureShape[1]],this.output=new o.default([],this.outputShape),this.outputCopy=new o.default([],this.outputShape),this.output.createGLTexture({type:"2d",format:"float"}),this.outputCopy.createGLTexture({type:"2d",format:"float"})):(this.outputShape=[t].concat(In(this.sliceOutput.originalShape)),this.output=new o.default([],this.outputShape),this.outputCopy=new o.default([],this.outputShape),this.output.reshapeTo2DSquare(),this.outputCopy.reshapeTo2DSquare(),this.output.createGLTexture({type:"2d",format:"float"}),this.outputCopy.createGLTexture({type:"2d",format:"float"}),this._createOutputIndexMap(this.sliceOutput.indicesForReshaped))),XS.webgl2.runProgram({program:this.copyTextureProgram,output:this.outputCopy,inputs:[{input:this.output,name:"source"}]}),2>=this.inputShape.length?XS.webgl2.runProgram({program:this.copySliceOutputProgram,output:this.output,inputs:[{input:this.outputCopy,name:"outputCopy"},{input:this.sliceOutput,name:"sliceOutput"}],uniforms:[{value:0,type:"int",name:"t"},{value:t,type:"int",name:"timesteps"}]}):XS.webgl2.runProgram({program:this.mapSliceOutputProgram,output:this.output,inputs:[{input:this.outputCopy,name:"outputCopy"},{input:this.sliceOutput,name:"sliceOutput"},{input:this.outputIndexMaps[0],name:"indexMap"}]});for(var r=1;r<t;r++)2>=this.inputShape.length?XS.webgl2.runProgram({program:this.selectSliceProgram,output:this.slice,inputs:[{input:e,name:"x"}],uniforms:[{value:r,type:"int",name:"t"}]}):XS.webgl2.runProgram({program:this.mapInputProgram,output:this.slice,inputs:[{input:e,name:"x"},{input:this.indexMaps[r],name:"indexMap"}],uniforms:[{value:e.glTextureShape[1],type:"int",name:"inputCols"}]}),this.wrappedLayer._callGPU(this.slice),this.sliceOutput=this.wrappedLayer.output,XS.webgl2.runProgram({program:this.copyTextureProgram,output:this.outputCopy,inputs:[{input:this.output,name:"source"}]}),2>=this.inputShape.length?XS.webgl2.runProgram({program:this.copySliceOutputProgram,output:this.output,inputs:[{input:this.outputCopy,name:"outputCopy"},{input:this.sliceOutput,name:"sliceOutput"}],uniforms:[{value:r,type:"int",name:"t"},{value:t,type:"int",name:"timesteps"}]}):XS.webgl2.runProgram({program:this.mapSliceOutputProgram,output:this.output,inputs:[{input:this.outputCopy,name:"outputCopy"},{input:this.sliceOutput,name:"sliceOutput"},{input:this.outputIndexMaps[r],name:"indexMap"}]});0===this.outbound.length&&(this.output.transferFromGLTexture(),this.output.is2DReshaped?this.output.reshapeFrom2D():this.output.is2DSquareReshaped&&this.output.reshapeFrom2DSquare())}}]),t}(r.default);t.default=l});le(jk);var zk=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(YS),o=a(cP),n=a(uP),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}(Lk),l=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.layerClass="Bidirectional";var r=e.layer,o=e.merge_mode,n=void 0===o?"concat":o;r||a.throwError("wrapped layer is undefined."),["SimpleRNN","GRU","LSTM"].includes(r.class_name)||a.throwError("cannot wrap "+r.class_name+" layer."),["concat","sum","mul","ave"].includes(n)||a.throwError("merge_mode "+n+" not supported.");var l=Object.assign({},r.config,{gpu:e.gpu}),s=Object.assign({},r.config,{gpu:e.gpu});return s.go_backwards=!s.go_backwards,a.forwardLayer=new i[r.class_name](l),a.backwardLayer=new i[r.class_name](s),a.forwardLayer.outbound=[null],a.backwardLayer.outbound=[null],a.mergeMode=n,a.returnSequences=r.config.return_sequences,a.gpu&&(a.copyTextureProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D source;\nout vec4 outColor;\n\nvoid main(void) {\n  outColor = texture(source, vec2(outTex.x, outTex.y));\n}\n"),"concat"===a.mergeMode?a.mergeProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D forward;\nuniform sampler2D backward;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(forward, 0);\n  int out_x = int(float(size[0] * 2) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  if (out_x >= 0 && out_x < size[0]) {\n    outColor = vec4(texelFetch(forward, ivec2(out_x, out_y), 0).r);\n  } else {\n    outColor = vec4(texelFetch(backward, ivec2(out_x - size[0], size[1] - out_y - 1), 0).r);\n  }\n}\n"):"sum"===a.mergeMode?a.mergeProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D forward;\nuniform sampler2D backward;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(forward, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  float forward_val = texelFetch(forward, ivec2(out_x, out_y), 0).r;\n  float backward_val = texelFetch(backward, ivec2(out_x, size[1] - out_y - 1), 0).r;\n\n  outColor = vec4(forward_val + backward_val);\n}\n"):"mul"===a.mergeMode?a.mergeProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D forward;\nuniform sampler2D backward;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(forward, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  float forward_val = texelFetch(forward, ivec2(out_x, out_y), 0).r;\n  float backward_val = texelFetch(backward, ivec2(out_x, size[1] - out_y - 1), 0).r;\n\n  outColor = vec4(forward_val * backward_val);\n}\n"):"ave"===a.mergeMode&&(a.mergeProgram=XS.webgl2.compileProgram("#version 300 es\nprecision highp float;\n\nin vec2 outTex;\nuniform sampler2D forward;\nuniform sampler2D backward;\nout vec4 outColor;\n\nvoid main() {\n  ivec2 size = textureSize(forward, 0);\n  int out_x = int(float(size[0]) * outTex.x);\n  int out_y = int(float(size[1]) * outTex.y);\n\n  float forward_val = texelFetch(forward, ivec2(out_x, out_y), 0).r;\n  float backward_val = texelFetch(backward, ivec2(out_x, size[1] - out_y - 1), 0).r;\n\n  outColor = vec4(0.5 * (forward_val + backward_val));\n}\n"))),a}return Mn(t,e),Cn(t,[{key:"setWeights",value:function(e){this.forwardLayer.setWeights(e.slice(0,e.length/2)),this.backwardLayer.setWeights(e.slice(e.length/2))}},{key:"call",value:function(e){return this.gpu?this._callGPU(e):this._callCPU(e),this.output}},{key:"_callCPU",value:function(e){this.forwardLayer._callCPU(new o.default(e.tensor.data,e.tensor.shape)),this.backwardLayer._callCPU(new o.default(e.tensor.data,e.tensor.shape));var t=this.forwardLayer.output,a=this.backwardLayer.output;this.returnSequences&&(a.tensor=a.tensor.step(-1));var r=t.tensor.shape.slice();"concat"===this.mergeMode&&(r[r.length-1]+=a.tensor.shape[r.length-1]),this.output=new o.default([],r),"concat"===this.mergeMode?this.returnSequences?(n.default.assign(this.output.tensor.hi(r[0],t.tensor.shape[1]).lo(0,0),t.tensor),n.default.assign(this.output.tensor.hi(r[0],r[1]).lo(0,t.tensor.shape[1]),a.tensor)):(n.default.assign(this.output.tensor.hi(t.tensor.shape[0]).lo(0),t.tensor),n.default.assign(this.output.tensor.hi(r[0]).lo(t.tensor.shape[0]),a.tensor)):"sum"===this.mergeMode?(n.default.addeq(this.output.tensor,t.tensor),n.default.addeq(this.output.tensor,a.tensor)):"mul"===this.mergeMode?(n.default.assigns(this.output.tensor,1),n.default.muleq(this.output.tensor,t.tensor),n.default.muleq(this.output.tensor,a.tensor)):"ave"===this.mergeMode&&(n.default.addeq(this.output.tensor,t.tensor),n.default.addeq(this.output.tensor,a.tensor),n.default.divseq(this.output.tensor,2))}},{key:"_callGPU",value:function(e){e.glTexture||e.createGLTexture({type:"2d",format:"float"}),this.inputCopy||(this.inputCopy=new o.default([],e.glTextureShape),this.inputCopy.createGLTexture({type:"2d",format:"float"})),XS.webgl2.runProgram({program:this.copyTextureProgram,output:this.inputCopy,inputs:[{input:e,name:"source"}]}),this.forwardLayer._callGPU(e),this.backwardLayer._callGPU(this.inputCopy);var t=this.forwardLayer.output,a=this.backwardLayer.output,r=t.glTextureShape.slice();"concat"===this.mergeMode&&(r[1]+=a.glTextureShape[1]),this.output||(this.output=new o.default([],r),this.output.createGLTexture({type:"2d",format:"float"}),!this.returnSequences&&(this.output.is1D=!0)),XS.webgl2.runProgram({program:this.mergeProgram,output:this.output,inputs:[{input:t,name:"forward"},{input:a,name:"backward"}]}),0===this.outbound.length&&this.output.transferFromGLTexture()}}]),t}(r.default);t.default=l});le(zk);var Gk=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"TimeDistributed",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"Bidirectional",{enumerable:!0,get:function(){return o.default}});var r=a(jk),o=a(zk)});le(Gk);var Uk=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a={InputLayer:!0};Object.defineProperty(t,"InputLayer",{enumerable:!0,get:function(){return r.default}});var r=function(e){return e&&e.__esModule?e:{default:e}}(gP);Object.keys(OP).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(a,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return OP[e]}})}),Object.keys(_T).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(a,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return _T[e]}})}),Object.keys(Xw).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(a,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return Xw[e]}})}),Object.keys($w).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(a,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return $w[e]}})}),Object.keys(sk).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(a,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return sk[e]}})}),Object.keys(dk).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(a,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return dk[e]}})}),Object.keys(gk).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(a,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return gk[e]}})}),Object.keys(Ik).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(a,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return Ik[e]}})}),Object.keys(Lk).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(a,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return Lk[e]}})}),Object.keys(Gk).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(a,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return Gk[e]}})})});le(Uk);var Nk=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(cP),o=a(uP),n=a(JP),i=a(KP),l=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(kn(this,e),this.modelLayersMap=t.modelLayersMap,this.gpu=t.gpu,!this.modelLayersMap)throw new Error("[CAM] modelLayersMap is required")}return Cn(e,[{key:"initialize",value:function(){var e=this;if(this.modelLayersMap.forEach(function(t){"GlobalAveragePooling2D"===t.layerClass&&(e.enabled=!0,e.poolLayer=t)}),this.enabled&&!this.data){this.featureMaps=this.modelLayersMap.get(this.poolLayer.inbound[0]).output;var t=this.poolLayer;for(t.outbound.length||(this.weights=this.poolLayer.output);t.outbound.length;)t=this.modelLayersMap.get(t.outbound[0]),this.weights=t.weights.kernel?t.weights.kernel:this.poolLayer.output;if(this.inputShape=this.featureMaps.is2DReshaped?this.featureMaps.originalShape.slice(0,2):this.featureMaps.tensor.shape.slice(0,2),1===this.weights.tensor.shape.length)this.shape=this.inputShape;else{var a=this.weights.tensor.shape[1];this.shape=[].concat(In(this.inputShape),[a])}this.data=new Float32Array(this.shape.reduce(function(e,t){return e*t},1))}}},{key:"update",value:function(){if(this.enabled){this.featureMaps=this.modelLayersMap.get(this.poolLayer.inbound[0]).output,this.gpu?this._updateGPU():this._updateCPU();var e=o.default.inf(this.output.tensor),t=o.default.sup(this.output.tensor);o.default.divseq(o.default.subseq(this.output.tensor,e),t-e),this.data=this.output.tensor.data}}},{key:"_updateCPU",value:function(){if(this.featureMaps.is2DReshaped||this.featureMaps.reshapeTo2D(),1===this.weights.tensor.shape.length){this.output||(this.output=new r.default([],this.shape));var e=new r.default([],[this.shape[0]*this.shape[1]]);(0,tw.gemv)(1,this.featureMaps.tensor,this.weights.tensor,1,e.tensor),this.output.replaceTensorData(e.tensor.data)}else this.output||(this.output=new r.default([],this.shape)),this.output.reshapeTo2D(),(0,n.default)(this.output.tensor,this.featureMaps.tensor,this.weights.tensor,1,1),this.output.reshapeFrom2D();o.default.maxseq(this.output.tensor,0),this.featureMaps.is2DReshaped&&this.featureMaps.reshapeFrom2D()}},{key:"_updateGPU",value:function(){this.output||(this.output=new r.default([],this.shape));var e=this.weights.is1D;!this.output.glTexture&&e?this.output.createGLTexture({type:"2d",format:"float"}):(this.output.reshapeTo2D(),this.output.createGLTexture({type:"2d",format:"float"}));var t=e?this.weights.glTextureShape[1]:this.weights.glTextureShape[0];if(!this.program){var a=(0,i.default)("cam",this.output.glTextureShape,t,e);this.program=XS.webgl2.compileProgram(a)}XS.webgl2.runProgram({program:this.program,output:this.output,inputs:[{input:this.featureMaps,name:"featureMaps"},{input:this.weights,name:"weights"}]}),this.output.transferFromGLTexture(),this.output.is2DReshaped&&this.output.reshapeFrom2D()}}]),e}();t.default=l});le(Nk);var qk=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"CAM",{enumerable:!0,get:function(){return a.default}});var a=function(e){return e&&e.__esModule?e:{default:e}}(Nk)});le(qk);var Bk=Po,Vk=se(function(e,t){var a=t;a.length=function(e){var t=e.length;if(!t)return 0;for(var a=0;1<--t%4&&"="===e.charAt(t);)++a;return yn(3*e.length)/4-a};for(var r=Array(64),o=Array(123),n=0;64>n;)o[r[n]=26>n?n+65:52>n?n+71:62>n?n-4:43|n-59]=n++;a.encode=function(e,a,o){for(var n=null,l=[],s=0,i=0,u,t;a<o;)t=e[a++],0==i?(l[s++]=r[t>>2],u=(3&t)<<4,i=1):1==i?(l[s++]=r[u|t>>4],u=(15&t)<<2,i=2):2==i?(l[s++]=r[u|t>>6],l[s++]=r[63&t],i=0):void 0,8191<s&&((n||(n=[])).push(pn.apply(String,l)),s=0);return i&&(l[s++]=r[u],l[s++]=61,1==i&&(l[s++]=61)),n?(s&&n.push(pn.apply(String,l.slice(0,s))),n.join("")):pn.apply(String,l.slice(0,s))};var l="invalid encoding";a.decode=function(e,a,r){for(var n=r,s=0,u=0,i,t;u<e.length&&(t=e.charCodeAt(u++),!(61===t&&1<s));){if(void 0===(t=o[t]))throw Error(l);0==s?(i=t,s=1):1==s?(a[r++]=i<<2|(48&t)>>4,i=t,s=2):2==s?(a[r++]=(15&i)<<4|(60&t)>>2,i=t,s=3):3==s?(a[r++]=(3&i)<<6|t,s=0):void 0}if(1==s)throw Error(l);return r-n},a.test=function(e){return /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}}),Hk=To;To.prototype.on=function(e,t,a){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:a||this}),this},To.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var a=this._listeners[e],r=0;r<a.length;)a[r].fn===t?a.splice(r,1):++r;return this},To.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var a=[],r=1;r<arguments.length;)a.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,a)}return this};var Wk=wo(wo),Xk=Eo,Yk=se(function(e,t){var a=t;a.length=function(e){for(var t=0,a=0,r=0;r<e.length;++r)a=e.charCodeAt(r),128>a?t+=1:2048>a?t+=2:55296==(64512&a)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},a.read=function(e,a,r){var o=r-a;if(1>o)return"";for(var n=null,l=[],s=0,i;a<r;)i=e[a++],128>i?l[s++]=i:191<i&&224>i?l[s++]=(31&i)<<6|63&e[a++]:239<i&&365>i?(i=((7&i)<<18|(63&e[a++])<<12|(63&e[a++])<<6|63&e[a++])-65536,l[s++]=55296+(i>>10),l[s++]=56320+(1023&i)):l[s++]=(15&i)<<12|(63&e[a++])<<6|63&e[a++],8191<s&&((n||(n=[])).push(pn.apply(String,l)),s=0);return n?(s&&n.push(pn.apply(String,l.slice(0,s))),n.join("")):pn.apply(String,l.slice(0,s))},a.write=function(e,t,a){for(var r=a,o=0,n,i;o<e.length;++o)n=e.charCodeAt(o),128>n?t[a++]=n:2048>n?(t[a++]=192|n>>6,t[a++]=128|63&n):55296==(64512&n)&&56320==(64512&(i=e.charCodeAt(o+1)))?(n=65536+((1023&n)<<10)+(1023&i),++o,t[a++]=240|n>>18,t[a++]=128|63&n>>12,t[a++]=128|63&n>>6,t[a++]=128|63&n):(t[a++]=224|n>>12,t[a++]=128|63&n>>6,t[a++]=128|63&n);return a-r}}),$k=Do,Kk=Io,Zk=Io.zero=new Io(0,0);Zk.toNumber=function(){return 0},Zk.zzEncode=Zk.zzDecode=function(){return this},Zk.length=function(){return 1};var Qk=Io.zeroHash="\0\0\0\0\0\0\0\0";Io.fromNumber=function(e){if(0===e)return Zk;var t=0>e;t&&(e=-e);var a=e>>>0,r=(e-a)/4294967296>>>0;return t&&(r=~r>>>0,a=~a>>>0,4294967295<++a&&(a=0,4294967295<++r&&(r=0))),new Io(a,r)},Io.from=function(e){if("number"==typeof e)return Io.fromNumber(e);if(eC.isString(e))if(eC.Long)e=eC.Long.fromString(e);else return Io.fromNumber(parseInt(e,10));return e.low||e.high?new Io(e.low>>>0,e.high>>>0):Zk},Io.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,a=~this.hi>>>0;return t||(a=a+1>>>0),-(t+4294967296*a)}return this.lo+4294967296*this.hi},Io.prototype.toLong=function(e){return eC.Long?new eC.Long(0|this.lo,0|this.hi,!!e):{low:0|this.lo,high:0|this.hi,unsigned:!!e}};var Jk=mn.charCodeAt;Io.fromHash=function(e){return e===Qk?Zk:new Io((Jk.call(e,0)|Jk.call(e,1)<<8|Jk.call(e,2)<<16|Jk.call(e,3)<<24)>>>0,(Jk.call(e,4)|Jk.call(e,5)<<8|Jk.call(e,6)<<16|Jk.call(e,7)<<24)>>>0)},Io.prototype.toHash=function(){return pn(255&this.lo,255&this.lo>>>8,255&this.lo>>>16,this.lo>>>24,255&this.hi,255&this.hi>>>8,255&this.hi>>>16,this.hi>>>24)},Io.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},Io.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},Io.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,a=this.hi>>>24;return 0==a?0==t?16384>e?128>e?1:2:2097152>e?3:4:16384>t?128>t?5:6:2097152>t?7:8:128>a?9:10};var eC=se(function(e,t){function a(e,t,a){for(var r=Object.keys(t),o=0;o<r.length;++o)void 0!==e[r[o]]&&a||(e[r[o]]=t[r[o]]);return e}function r(e){function t(e,r){return this instanceof t?void(Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:new Error().stack||""}),r&&a(this,r)):new t(e,r)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}var o=t;o.asPromise=Bk,o.base64=Vk,o.EventEmitter=Hk,o.float=Wk,o.inquire=Xk,o.utf8=Yk,o.pool=$k,o.LongBits=Kk,o.emptyArray=Object.freeze?Object.freeze([]):[],o.emptyObject=Object.freeze?Object.freeze({}):{},o.isNode=!!(_l.process&&_l.process.versions&&_l.process.versions.node),o.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&_n(e)===e},o.isString=function(e){return"string"==typeof e||e instanceof String},o.isObject=function(e){return e&&"object"===("undefined"==typeof e?"undefined":wn(e))},o.isset=o.isSet=function(e,t){var a=e[t];return null!=a&&e.hasOwnProperty(t)&&("object"!==("undefined"==typeof a?"undefined":wn(a))||0<(Array.isArray(a)?a.length:Object.keys(a).length))},o.Buffer=function(){try{var e=o.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(t){return null}}(),o._Buffer_from=null,o._Buffer_allocUnsafe=null,o.newBuffer=function(e){return"number"==typeof e?o.Buffer?o._Buffer_allocUnsafe(e):new o.Array(e):o.Buffer?o._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},o.Array="undefined"==typeof Uint8Array?Array:Uint8Array,o.Long=_l.dcodeIO&&_l.dcodeIO.Long||o.inquire("long"),o.key2Re=/^true|false|0|1$/,o.key32Re=/^-?(?:0|[1-9][0-9]*)$/,o.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,o.longToHash=function(e){return e?o.LongBits.from(e).toHash():o.LongBits.zeroHash},o.longFromHash=function(e,t){var a=o.LongBits.fromHash(e);return o.Long?o.Long.fromBits(a.lo,a.hi,t):a.toNumber(!!t)},o.merge=a,o.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},o.newError=r,o.ProtocolError=r("ProtocolError"),o.oneOfGetter=function(e){for(var t={},a=0;a<e.length;++a)t[e[a]]=1;return function(){for(var e=Object.keys(this),a=e.length-1;-1<a;--a)if(1===t[e[a]]&&this[e[a]]!==void 0&&null!==this[e[a]])return e[a]}},o.oneOfSetter=function(e){return function(t){for(var a=0;a<e.length;++a)e[a]!==t&&delete this[e[a]]}},o.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},o._configure=function(){var e=o.Buffer;return e?void(o._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,a){return new e(t,a)},o._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):void(o._Buffer_from=o._Buffer_allocUnsafe=null)}}),tC=Lo,aC=eC.LongBits,rC=eC.base64,oC=eC.utf8,nC;Lo.create=eC.Buffer?function(){return(Lo.create=function(){return new nC})()}:function(){return new Lo},Lo.alloc=function(e){return new eC.Array(e)},eC.Array!==Array&&(Lo.alloc=eC.pool(Lo.alloc,eC.Array.prototype.subarray)),Lo.prototype._push=function(e,t,a){return this.tail=this.tail.next=new Ao(e,t,a),this.len+=t,this},Go.prototype=Object.create(Ao.prototype),Go.prototype.fn=zo,Lo.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Go(128>(e>>>=0)?1:16384>e?2:2097152>e?3:268435456>e?4:5,e)).len,this},Lo.prototype.int32=function(e){return 0>e?this._push(Uo,10,aC.fromNumber(e)):this.uint32(e)},Lo.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},Lo.prototype.uint64=function(e){var t=aC.from(e);return this._push(Uo,t.length(),t)},Lo.prototype.int64=Lo.prototype.uint64,Lo.prototype.sint64=function(e){var t=aC.from(e).zzEncode();return this._push(Uo,t.length(),t)},Lo.prototype.bool=function(e){return this._push(jo,1,e?1:0)},Lo.prototype.fixed32=function(e){return this._push(No,4,e>>>0)},Lo.prototype.sfixed32=Lo.prototype.fixed32,Lo.prototype.fixed64=function(e){var t=aC.from(e);return this._push(No,4,t.lo)._push(No,4,t.hi)},Lo.prototype.sfixed64=Lo.prototype.fixed64,Lo.prototype.float=function(e){return this._push(eC.float.writeFloatLE,4,e)},Lo.prototype.double=function(e){return this._push(eC.float.writeDoubleLE,8,e)};var iC=eC.Array.prototype.set?function(e,t,a){t.set(e,a)}:function(e,t,a){for(var r=0;r<e.length;++r)t[a+r]=e[r]};Lo.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(jo,1,0);if(eC.isString(e)){var a=Lo.alloc(t=rC.length(e));rC.decode(e,a,0),e=a}return this.uint32(t)._push(iC,t,e)},Lo.prototype.string=function(e){var t=oC.length(e);return t?this.uint32(t)._push(oC.write,t,e):this._push(jo,1,0)},Lo.prototype.fork=function(){return this.states=new Oo(this),this.head=this.tail=new Ao(Ro,0,0),this.len=0,this},Lo.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Ao(Ro,0,0),this.len=0),this},Lo.prototype.ldelim=function(){var e=this.head,t=this.tail,a=this.len;return this.reset().uint32(a),a&&(this.tail.next=e.next,this.tail=t,this.len+=a),this},Lo.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),a=0;e;)e.fn(e.val,t,a),a+=e.len,e=e.next;return t},Lo._configure=function(e){nC=e};var lC=qo;(qo.prototype=Object.create(tC.prototype)).constructor=qo;var sC=eC.Buffer;qo.alloc=function(e){return(qo.alloc=eC._Buffer_allocUnsafe)(e)};var uC=sC&&sC.prototype instanceof Uint8Array&&"set"===sC.prototype.set.name?function(e,t,a){t.set(e,a)}:function(e,t,a){if(e.copy)e.copy(t,a,0,e.length);else for(var r=0;r<e.length;)t[a++]=e[r++]};qo.prototype.bytes=function(e){eC.isString(e)&&(e=eC._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(uC,t,e),this},qo.prototype.string=function(e){var t=sC.byteLength(e);return this.uint32(t),t&&this._push(Bo,t,e),this};var pC=Ho,dC=eC.LongBits,cC=eC.utf8,gC="undefined"==typeof Uint8Array?function(e){if(Array.isArray(e))return new Ho(e);throw Error("illegal buffer")}:function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Ho(e);throw Error("illegal buffer")},hC;Ho.create=eC.Buffer?function(e){return(Ho.create=function(e){return eC.Buffer.isBuffer(e)?new hC(e):gC(e)})(e)}:gC,Ho.prototype._slice=eC.Array.prototype.subarray||eC.Array.prototype.slice,Ho.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,128>this.buf[this.pos++])return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,128>this.buf[this.pos++])return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,128>this.buf[this.pos++])return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,128>this.buf[this.pos++])return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,128>this.buf[this.pos++])return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Vo(this,10);return e}}(),Ho.prototype.int32=function(){return 0|this.uint32()},Ho.prototype.sint32=function(){var e=this.uint32();return 0|e>>>1^-(1&e)},Ho.prototype.bool=function(){return 0!==this.uint32()},Ho.prototype.fixed32=function(){if(this.pos+4>this.len)throw Vo(this,4);return Xo(this.buf,this.pos+=4)},Ho.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Vo(this,4);return 0|Xo(this.buf,this.pos+=4)},Ho.prototype.float=function(){if(this.pos+4>this.len)throw Vo(this,4);var e=eC.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},Ho.prototype.double=function(){if(this.pos+8>this.len)throw Vo(this,4);var e=eC.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},Ho.prototype.bytes=function(){var e=this.uint32(),t=this.pos,a=this.pos+e;if(a>this.len)throw Vo(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,a):t===a?new this.buf.constructor(0):this._slice.call(this.buf,t,a)},Ho.prototype.string=function(){var e=this.bytes();return cC.read(e,0,e.length)},Ho.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw Vo(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Vo(this);while(128&this.buf[this.pos++]);return this},Ho.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:do{if(4==(e=7&this.uint32()))break;this.skipType(e)}while(!0);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos);}return this},Ho._configure=function(e){hC=e;var t=eC.Long?"toLong":"toNumber";eC.merge(Ho.prototype,{int64:function(){return Wo.call(this)[t](!1)},uint64:function(){return Wo.call(this)[t](!0)},sint64:function(){return Wo.call(this).zzDecode()[t](!1)},fixed64:function(){return Yo.call(this)[t](!0)},sfixed64:function(){return Yo.call(this)[t](!1)}})};var fC=$o;($o.prototype=Object.create(pC.prototype)).constructor=$o,eC.Buffer&&($o.prototype._slice=eC.Buffer.prototype.slice),$o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=vn(this.pos+e,this.len))};var mC=Ko;(Ko.prototype=Object.create(eC.EventEmitter.prototype)).constructor=Ko,Ko.prototype.rpcCall=function e(t,a,r,o,n){if(!o)throw TypeError("request must be specified");var i=this;if(!n)return eC.asPromise(e,i,t,a,r,o);if(!i.rpcImpl)return void setTimeout(function(){n(Error("already ended"))},0);try{return i.rpcImpl(t,a[i.requestDelimited?"encodeDelimited":"encode"](o).finish(),function(e,a){if(e)return i.emit("error",e,t),n(e);if(null===a)return void i.end(!0);if(!(a instanceof r))try{a=r[i.responseDelimited?"decodeDelimited":"decode"](a)}catch(e){return i.emit("error",e,t),n(e)}return i.emit("data",a,t),n(null,a)})}catch(e){return i.emit("error",e,t),void setTimeout(function(){n(e)},0)}},Ko.prototype.end=function(e){return this.rpcImpl&&(!e&&this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};var _C=se(function(e,t){t.Service=mC}),yC={},xC=se(function(e,t){function a(){r.Reader._configure(r.BufferReader),r.util._configure()}var r=t;r.build="minimal",r.Writer=tC,r.BufferWriter=lC,r.Reader=pC,r.BufferReader=fC,r.util=eC,r.rpc=_C,r.roots=yC,r.configure=a,r.Writer._configure(r.BufferWriter),a()}),vC=xC,bC=se(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Model=t.Weights=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}(vC),r=a.Reader,o=a.Writer,n=a.util,l=a.roots["default"]||(a.roots["default"]={});t.default=l;var i=l.Weights=function(){function e(e){if(this.shape=[],e)for(var t=Object.keys(e),a=0;a<t.length;++a)null!=e[t[a]]&&(this[t[a]]=e[t[a]])}return e.prototype.layerName="",e.prototype.weightName="",e.prototype.shape=n.emptyArray,e.prototype.type="",e.prototype.data=n.newBuffer([]),e.prototype.quantizeMin=0,e.prototype.quantizeMax=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.layerName&&e.hasOwnProperty("layerName")&&t.uint32(10).string(e.layerName),null!=e.weightName&&e.hasOwnProperty("weightName")&&t.uint32(18).string(e.weightName),null!=e.shape&&e.shape.length){t.uint32(26).fork();for(var a=0;a<e.shape.length;++a)t.uint32(e.shape[a]);t.ldelim()}return null!=e.type&&e.hasOwnProperty("type")&&t.uint32(34).string(e.type),null!=e.data&&e.hasOwnProperty("data")&&t.uint32(42).bytes(e.data),null!=e.quantizeMin&&e.hasOwnProperty("quantizeMin")&&t.uint32(53).float(e.quantizeMin),null!=e.quantizeMax&&e.hasOwnProperty("quantizeMax")&&t.uint32(61).float(e.quantizeMax),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var a=void 0===t?e.len:e.pos+t,o=new l.Weights,n;e.pos<a;)switch(n=e.uint32(),n>>>3){case 1:o.layerName=e.string();break;case 2:o.weightName=e.string();break;case 3:if(o.shape&&o.shape.length||(o.shape=[]),2==(7&n))for(var i=e.uint32()+e.pos;e.pos<i;)o.shape.push(e.uint32());else o.shape.push(e.uint32());break;case 4:o.type=e.string();break;case 5:o.data=e.bytes();break;case 6:o.quantizeMin=e.float();break;case 7:o.quantizeMax=e.float();break;default:e.skipType(7&n);}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==("undefined"==typeof e?"undefined":wn(e))||null===e)return"object expected";if(null!=e.layerName&&e.hasOwnProperty("layerName")&&!n.isString(e.layerName))return"layerName: string expected";if(null!=e.weightName&&e.hasOwnProperty("weightName")&&!n.isString(e.weightName))return"weightName: string expected";if(null!=e.shape&&e.hasOwnProperty("shape")){if(!Array.isArray(e.shape))return"shape: array expected";for(var t=0;t<e.shape.length;++t)if(!n.isInteger(e.shape[t]))return"shape: integer[] expected"}return null!=e.type&&e.hasOwnProperty("type")&&!n.isString(e.type)?"type: string expected":null!=e.data&&e.hasOwnProperty("data")&&!(e.data&&"number"==typeof e.data.length||n.isString(e.data))?"data: buffer expected":null!=e.quantizeMin&&e.hasOwnProperty("quantizeMin")&&"number"!=typeof e.quantizeMin?"quantizeMin: number expected":null!=e.quantizeMax&&e.hasOwnProperty("quantizeMax")&&"number"!=typeof e.quantizeMax?"quantizeMax: number expected":null},e.fromObject=function(e){if(e instanceof l.Weights)return e;var t=new l.Weights;if(null!=e.layerName&&(t.layerName=e.layerName+""),null!=e.weightName&&(t.weightName=e.weightName+""),e.shape){if(!Array.isArray(e.shape))throw TypeError(".Weights.shape: array expected");t.shape=[];for(var a=0;a<e.shape.length;++a)t.shape[a]=e.shape[a]>>>0}return null!=e.type&&(t.type=e.type+""),null!=e.data&&("string"==typeof e.data?n.base64.decode(e.data,t.data=n.newBuffer(n.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),null!=e.quantizeMin&&(t.quantizeMin=+e.quantizeMin),null!=e.quantizeMax&&(t.quantizeMax=+e.quantizeMax),t},e.toObject=function(e,t){t||(t={});var a={};if((t.arrays||t.defaults)&&(a.shape=[]),t.defaults&&(a.layerName="",a.weightName="",a.type="",a.data=t.bytes===String?"":[],a.quantizeMin=0,a.quantizeMax=0),null!=e.layerName&&e.hasOwnProperty("layerName")&&(a.layerName=e.layerName),null!=e.weightName&&e.hasOwnProperty("weightName")&&(a.weightName=e.weightName),e.shape&&e.shape.length){a.shape=[];for(var r=0;r<e.shape.length;++r)a.shape[r]=e.shape[r]}return null!=e.type&&e.hasOwnProperty("type")&&(a.type=e.type),null!=e.data&&e.hasOwnProperty("data")&&(a.data=t.bytes===String?n.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data),null!=e.quantizeMin&&e.hasOwnProperty("quantizeMin")&&(a.quantizeMin=t.json&&!isFinite(e.quantizeMin)?e.quantizeMin+"":e.quantizeMin),null!=e.quantizeMax&&e.hasOwnProperty("quantizeMax")&&(a.quantizeMax=t.json&&!isFinite(e.quantizeMax)?e.quantizeMax+"":e.quantizeMax),a},e.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},e}();t.Weights=i;var s=l.Model=function(){function e(e){if(this.modelWeights=[],e)for(var t=Object.keys(e),a=0;a<t.length;++a)null!=e[t[a]]&&(this[t[a]]=e[t[a]])}return e.prototype.id="",e.prototype.name="",e.prototype.kerasVersion="",e.prototype.backend="",e.prototype.modelConfig="",e.prototype.modelWeights=n.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.id&&e.hasOwnProperty("id")&&t.uint32(10).string(e.id),null!=e.name&&e.hasOwnProperty("name")&&t.uint32(18).string(e.name),null!=e.kerasVersion&&e.hasOwnProperty("kerasVersion")&&t.uint32(26).string(e.kerasVersion),null!=e.backend&&e.hasOwnProperty("backend")&&t.uint32(34).string(e.backend),null!=e.modelConfig&&e.hasOwnProperty("modelConfig")&&t.uint32(42).string(e.modelConfig),null!=e.modelWeights&&e.modelWeights.length)for(var a=0;a<e.modelWeights.length;++a)l.Weights.encode(e.modelWeights[a],t.uint32(50).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var a=void 0===t?e.len:e.pos+t,o=new l.Model,n;e.pos<a;)switch(n=e.uint32(),n>>>3){case 1:o.id=e.string();break;case 2:o.name=e.string();break;case 3:o.kerasVersion=e.string();break;case 4:o.backend=e.string();break;case 5:o.modelConfig=e.string();break;case 6:o.modelWeights&&o.modelWeights.length||(o.modelWeights=[]),o.modelWeights.push(l.Weights.decode(e,e.uint32()));break;default:e.skipType(7&n);}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==("undefined"==typeof e?"undefined":wn(e))||null===e)return"object expected";if(null!=e.id&&e.hasOwnProperty("id")&&!n.isString(e.id))return"id: string expected";if(null!=e.name&&e.hasOwnProperty("name")&&!n.isString(e.name))return"name: string expected";if(null!=e.kerasVersion&&e.hasOwnProperty("kerasVersion")&&!n.isString(e.kerasVersion))return"kerasVersion: string expected";if(null!=e.backend&&e.hasOwnProperty("backend")&&!n.isString(e.backend))return"backend: string expected";if(null!=e.modelConfig&&e.hasOwnProperty("modelConfig")&&!n.isString(e.modelConfig))return"modelConfig: string expected";if(null!=e.modelWeights&&e.hasOwnProperty("modelWeights")){if(!Array.isArray(e.modelWeights))return"modelWeights: array expected";for(var t=0,a;t<e.modelWeights.length;++t)if(a=l.Weights.verify(e.modelWeights[t]),a)return"modelWeights."+a}return null},e.fromObject=function(e){if(e instanceof l.Model)return e;var t=new l.Model;if(null!=e.id&&(t.id=e.id+""),null!=e.name&&(t.name=e.name+""),null!=e.kerasVersion&&(t.kerasVersion=e.kerasVersion+""),null!=e.backend&&(t.backend=e.backend+""),null!=e.modelConfig&&(t.modelConfig=e.modelConfig+""),e.modelWeights){if(!Array.isArray(e.modelWeights))throw TypeError(".Model.modelWeights: array expected");t.modelWeights=[];for(var a=0;a<e.modelWeights.length;++a){if("object"!==wn(e.modelWeights[a]))throw TypeError(".Model.modelWeights: object expected");t.modelWeights[a]=l.Weights.fromObject(e.modelWeights[a])}}return t},e.toObject=function(e,t){t||(t={});var a={};if((t.arrays||t.defaults)&&(a.modelWeights=[]),t.defaults&&(a.id="",a.name="",a.kerasVersion="",a.backend="",a.modelConfig=""),null!=e.id&&e.hasOwnProperty("id")&&(a.id=e.id),null!=e.name&&e.hasOwnProperty("name")&&(a.name=e.name),null!=e.kerasVersion&&e.hasOwnProperty("kerasVersion")&&(a.kerasVersion=e.kerasVersion),null!=e.backend&&e.hasOwnProperty("backend")&&(a.backend=e.backend),null!=e.modelConfig&&e.hasOwnProperty("modelConfig")&&(a.modelConfig=e.modelConfig),e.modelWeights&&e.modelWeights.length){a.modelWeights=[];for(var r=0;r<e.modelWeights.length;++r)a.modelWeights[r]=l.Weights.toObject(e.modelWeights[r],t)}return a},e.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},e}();t.Model=s});le(bC);var SC={},PC=Object.freeze({default:SC}),TC=PC&&SC||PC,wC=se(function(e,t){function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(X_),n=r(mv),i=r(hb),l=r(yb),s=r(Ob),u=r(uS),p=r(pS),d=r(VS),c=r(HS),g=a(Uk),h=a(qk),f=r(cP),m=r(bC),_=d.default.CancelToken.source(),y=function(){function e(){var t=this,a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};kn(this,e);var r=a.filepath,o=void 0===r?null:r,n=a.headers,i=void 0===n?{}:n,l=a.filesystem,s=a.gpu,u=a.transferLayerOutputs,p=a.pauseAfterLayerCalls,d=a.visualizations,c=void 0===d?[]:d;if(!o)throw new Error("[Model] path to protobuf-serialized model definition file is missing.");this.filepath=o,this.headers=i,this.filesystem="undefined"==typeof window&&void 0!==l&&l,this.events=new WS.EventEmitter,this.id=null,this.name=null,this.kerasVersion=null,this.backend=null,this.modelConfig={},this.modelWeights=[],this.gpu="undefined"!=typeof window&&XS.webgl2.isSupported&&void 0!==s&&s,this.transferLayerOutputs=void 0!==u&&u,this.pauseAfterLayerCalls=void 0!==p&&p,this.modelLayersInfo=[],this.modelLayersMap=new Map,this.inputTensorsMap=new Map,this.inputLayerNames=[],this.outputLayerNames=[],this.finishedLayerNames=[],this.isRunning=!1,this.runningProgress=0,this.predictStats={},this.visMap=new Map,c.forEach(function(e){if(e in h){var a=new h[e]({modelLayersMap:t.modelLayersMap,gpu:t.gpu});t.visMap.set(e,a)}}),this._ready=this._initialize()}return Cn(e,[{key:"checkGPUSupport",value:function(){return XS.webgl2.isSupported}},{key:"ready",value:function(){return this._ready}},{key:"_interrupt",value:function(){_.cancel()}},{key:"_initialize",value:async function(){var e=this;this.events.emit("loadingProgress",0);try{var t=this.filesystem?this._dataRequestFS():this._dataRequestHTTP(this.headers);await t}catch(e){console.log(e),this._interrupt()}this.events.emit("loadingProgress",100),this._buildDAG(),this.inputLayerNames.forEach(function(t){var a=e.modelLayersMap.get(t);a.call(e.inputTensorsMap.get(t)),a.hasOutput=!0,a.visited=!0});var a=this.pauseAfterLayerCalls;return this.pauseAfterLayerCalls=!0,this.runningProgress=0,this.events.emit("initProgress",0),await this._traverseDAG(this.inputLayerNames,"initProgress"),this.pauseAfterLayerCalls=a,this.finishedLayerNames=[],this.modelLayersMap.forEach(function(e){e.hasOutput=!1,e.visited=!1}),this.visMap.forEach(function(e){e.initialize()}),this.events.emit("initProgress",100),!0}},{key:"_dataRequestHTTP",value:async function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};try{var a=await d.default.get(this.filepath,{responseType:"arraybuffer",headers:e,onDownloadProgress:function(a){if(a.lengthComputable){var e=xn(100*a.loaded/a.total);t.events.emit("loadingProgress",e)}},cancelToken:_.token});this._decodeProtobuf(new Uint8Array(a.data))}catch(e){if(d.default.isCancel(e))console.log("[Model] Data request canceled",e.message);else throw e}}},{key:"_dataRequestFS",value:async function(){var e=p.default.promisify(TC.readFile);try{var t=await e(this.filepath);this._decodeProtobuf(t)}catch(e){throw e}}},{key:"_decodeProtobuf",value:function(e){var t=m.default.Model.verify(e);if(t)throw new Error("[Model] Invalid model - check protobuf serialization: {err}");var a=m.default.Model.decode(e);this.id=a.id,this.name=a.name,this.kerasVersion=a.kerasVersion,this.backend=a.backend,this.modelConfig=JSON.parse(a.modelConfig),this.modelWeights=a.modelWeights}},{key:"toggleGPU",value:function(e){var t=this;this.gpu="undefined"==typeof e?!this.gpu:e,this.modelLayersMap.forEach(function(e){e.toggleGPU(t.gpu)}),this.visMap.forEach(function(e){e.gpu=t.gpu}),this.resetInputTensors()}},{key:"resetInputTensors",value:function(){var e=this;this.inputLayerNames.forEach(function(t){var a=e.modelLayersMap.get(t);e.inputTensorsMap.set(t,new f.default([],a.shape))})}},{key:"_buildDAG",value:function(){var e=this,t=this.modelConfig.class_name,a=[];if("Sequential"===t?a=this.modelConfig.config:"Model"===t&&(a=this.modelConfig.config.layers),!(Array.isArray(a)&&a.length))throw new Error("[Model] Model configuration does not contain any layers.");a.forEach(function(r,o){var n=r.class_name,i=r.config;if("Model"===t&&"Sequential"===n)i.forEach(function(t,a){var o=t.class_name,n=t.config,l=0===a?r.inbound_nodes[0].map(function(e){return e[0]}):[i[a-1].config.name];e._createLayer(o,n,l)});else if(!(n in g))throw new Error("[Model] Layer "+n+" specified in model configuration is not implemented!");else{if("Sequential"===t&&0===o){var l="input",s=i.batch_input_shape.slice(1),u=new g.InputLayer({name:l,shape:s,gpu:e.gpu});e.modelLayersMap.set(l,u),e.inputTensorsMap.set(l,new f.default([],s)),e.inputLayerNames.push(l)}else if("Model"===t&&"InputLayer"===n){var p=i.batch_input_shape.slice(1);e.inputTensorsMap.set(i.name,new f.default([],p)),e.inputLayerNames.push(i.name)}var d=[];if("Sequential"===t)d=0===o?["input"]:[a[o-1].config.name];else if("Model"===t){var c=r.inbound_nodes;c&&c.length&&(d=c[0].map(function(e){return e[0]}))}e._createLayer(n,i,d)}}),this.modelLayersMap.forEach(function(t){e.modelLayersInfo.push((0,u.default)(t,["name","description","layerClass","inbound","outbound"])),0===t.outbound.length&&e.outputLayerNames.push(t.name)}),this.inputLayerNames.sort(),this.outputLayerNames.sort()}},{key:"_createLayer",value:function(e,t,a){var r=this,o=new g[e](Object.assign({},t,{gpu:this.gpu})),n=[];if("Bidirectional"===e){var i=o.forwardLayer.params.map(function(e){return t.name+"/forward_"+t.layer.config.name+"/"+e}),l=o.backwardLayer.params.map(function(e){return t.name+"/backward_"+t.layer.config.name+"/"+e});n=i.concat(l)}else n="TimeDistributed"===e?o.layer.params.map(function(e){return t.name+"/"+e}):o.params.map(function(e){return t.name+"/"+e});if(n&&n.length){var u=n.map(function(e){var t=(0,s.default)(r.modelWeights,function(t){var a=new RegExp("^.*"+e);return a.test(t.weightName)});if(!t)throw new Error("[Model] error loading weights.");var a=t.data,o=t.shape,n=t.type,l=new ArrayBuffer(a.byteLength),u=new Uint8Array(l);if(u.set(new Uint8Array(a.buffer,a.byteOffset,a.byteLength)),"uint8"===n){for(var p=t.quantizeMin,d=t.quantizeMax,c=new Float32Array(u),g=0,i=c.length;g<i;g++)c[g]*=(d-p)/255,c[g]+=p;return new f.default(c,o)}return new f.default(new Float32Array(l),o)});o.setWeights(u)}this.modelLayersMap.set(t.name,o),a.forEach(function(e){r.modelLayersMap.get(t.name).inbound.push(e),r.modelLayersMap.get(e).outbound.push(t.name)})}},{key:"_traverseDAG",value:async function(e,t){var a=this;if(0===e.length)return this.runningProgress=100,this.events.emit(t,100),!0;if(1===e.length){var r=e[0],o=this.modelLayersMap.get(r);if("InputLayer"===o.layerClass)this.finishedLayerNames.push(this.modelLayersMap.get(r).name);else{var n=this.modelLayersMap.get(r);if(n.visited)return!1;var s=n.inbound.map(function(e){return a.modelLayersMap.get(e)});if(!(0,l.default)((0,i.default)(s,"hasOutput")))return!1;n.isMergeLayer?n.call((0,i.default)(s,"output")):n.call(s[0].output),n.hasOutput=!0,n.visited=!0,this.finishedLayerNames.push(n.name),this.pauseAfterLayerCalls&&(await p.default.delay(0))}this.runningProgress+=100/this.modelLayersMap.size,this.events.emit(t,this.runningProgress),await this._traverseDAG(o.outbound,t)}else await p.default.all(e.map(function(e){return a._traverseDAG([e],t)}))}},{key:"_maybeTransferIntermediateOutputs",value:function(){this.gpu&&this.transferLayerOutputs&&this.modelLayersMap.forEach(function(e){e.output&&e.output.glTexture&&(XS.webgl2.bindOutputTexture(e.output.glTexture,e.output.glTextureShape),e.output.transferFromGLTexture(),e.output.is2DReshaped&&e.output.reshapeFrom2D())})}},{key:"loadData",value:function(e){var t=this;this.inputLayerNames.forEach(function(a){var r=t.modelLayersMap.get(a);t.inputTensorsMap.get(a).replaceTensorData(e[a]),r.call(t.inputTensorsMap.get(a)),r.hasOutput=!0,r.visited=!0})}},{key:"predict",value:async function(e){var t=this;if(this.isRunning=!0,this.runningProgress=0,this.events.emit("predictProgress",0),!(0,n.default)((0,o.default)(e).sort(),this.inputLayerNames))throw this.isRunning=!1,new Error("[Model] predict() must take an object where the keys are the named inputs of the model: "+JSON.stringify(this.inputLayerNames));if(!(0,l.default)(this.inputLayerNames,function(t){return e[t]instanceof Float32Array}))throw this.isRunning=!1,new Error("[Model] predict() must take an object where the values are the flattened data as Float32Array.");this.finishedLayerNames=[],this.modelLayersMap.forEach(function(e){e.hasOutput=!1,e.visited=!1});var a=(0,c.default)();this.loadData(e),this.predictStats.loadData=(0,c.default)()-a,a=(0,c.default)(),await this._traverseDAG(this.inputLayerNames,"predictProgress"),this.predictStats.forwardPass=(0,c.default)()-a,this._maybeTransferIntermediateOutputs();var r=this.modelConfig.class_name,i={};if("Sequential"===r){var s=this.modelLayersMap.get(this.outputLayerNames[0]);i.output=s.output.tensor.data}else"Model"===r&&this.outputLayerNames.forEach(function(e){var a=t.modelLayersMap.get(e);i[e]=a.output.tensor.data});return a=(0,c.default)(),this.visMap.forEach(function(e){e.update()}),this.predictStats.visualizations=(0,c.default)()-a,this.isRunning=!1,this.events.emit("predictProgress",100),i}},{key:"layerCall",value:function(e,t){if(this.modelLayersMap.has(e)){var a=t instanceof f.default?t:new f.default(t.data,t.shape);var r=this.modelLayersMap.get(e);return r.call(a)}}},{key:"cleanup",value:function(){XS.webgl2.clearRefs(),this.modelLayersMap.clear(),this.inputTensorsMap.clear(),this.visMap.clear(),delete this.modelWeights}}]),e}();t.default=y});le(wC);var kC=vm.isFinite,CC=Zo,FC=1/0,MC=Qo,EC=vP({args:["array","scalar","index"],body:function(e,t,a){var r=t,o;for(o=0;o<a.length-1;++o)r=r[a[o]];r[a[a.length-1]]=e}}),DC=function(e){var t=Lw(e.shape);return EC(e,t),t},IC=se(function(e,t){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.approxEquals=function(e,t){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1e-4,s=(0,o.default)((0,n.default)(e)),a=t;if(s.length!==a.length)return!1;for(var u=0;u<s.length;u++){if(!(0,r.default)(s[u]))return!1;if(s[u]<a[u]-l||s[u]>a[u]+l)return!1}return!0};var r=a(CC),o=a(MC),n=a(DC)});le(IC);var AC=se(function(e,t){function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};r.get||r.set?Object.defineProperty(t,a,r):t[a]=e[a]}return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Model",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"Tensor",{enumerable:!0,get:function(){return n.default}}),t.testUtils=t.layers=t.activations=t.default=t.GPU_SUPPORT=void 0;var o=r(wC),n=r(cP),i=a(EP);t.activations=i;var l=a(Uk);t.layers=l;var s=a(IC);t.testUtils=s;var u=XS.webgl2.isSupported;t.GPU_SUPPORT=u;var p={Model:o.default,Tensor:n.default,GPU_SUPPORT:u,activations:i,layers:l,testUtils:s};t.default=p}),RC=le(AC),OC=function(e,t,a,r){return new(a||(a=Promise))(function(o,n){function i(e){try{s(r.next(e))}catch(t){n(t)}}function l(e){try{s(r["throw"](e))}catch(t){n(t)}}function s(e){e.done?o(e.value):new a(function(t){t(e.value)}).then(i,l)}s((r=r.apply(e,t||[])).next())})},LC=!1;(function(){"undefined"!=typeof module&&module.exports&&(LC=!0)})();var jC=a("MODEL_PATH")||"/dist/model.bin",zC=new RC.Model({filepath:LC?__dirname+"/model.bin":jC,gpu:!1,filesystem:LC}),GC=function(e){function t(e){kn(this,t);var a=En(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.values=e,a}return Mn(t,e),t}(Ln);(function(e){e[e.TD=0]="TD",e[e.IHS=1]="IHS",e[e.HS=2]="HS",e[e.TU=3]="TU",e[e.DT=4]="DT",e[e.DB=5]="DB"})(e.AvailablePatterns||(e.AvailablePatterns={}));var UC=function(e){function t(){return kn(this,t),En(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return Mn(t,e),t}(jn);UC.predictPattern=tn,UC.hasDoubleBottom=an,UC.hasDoubleTop=rn,UC.hasHeadAndShoulder=on,UC.hasInverseHeadAndShoulder=nn,UC.isTrendingUp=ln,UC.isTrendingDown=sn;var NC=un();e.getAvailableIndicators=un,e.AvailableIndicators=NC,e.CandleData=An,e.CandleList=Rn,e.sma=o,e.SMA=Nn,e.ema=n,e.EMA=qn,e.wma=s,e.WMA=Bn,e.wema=u,e.WEMA=Vn,e.macd=p,e.MACD=Wn,e.rsi=g,e.RSI=Qn,e.bollingerbands=f,e.BollingerBands=oi,e.adx=y,e.ADX=hi,e.atr=x,e.ATR=mi,e.truerange=_,e.TrueRange=di,e.roc=v,e.ROC=yi,e.kst=b,e.KST=vi,e.psar=S,e.PSAR=Si,e.stochastic=P,e.Stochastic=Ti,e.williamsr=T,e.WilliamsR=ki,e.adl=w,e.ADL=Fi,e.obv=k,e.OBV=Ei,e.trix=C,e.TRIX=Ii,e.forceindex=F,e.ForceIndex=Ri,e.cci=M,e.CCI=Li,e.vwap=D,e.VWAP=zi,e.averagegain=d,e.AverageGain=Yn,e.averageloss=c,e.AverageLoss=Kn,e.sd=h,e.SD=ti,e.renko=I,e.HeikinAshi=qi,e.heikinashi=A,e.bullish=H,e.bearish=J,e.abandonedbaby=ee,e.doji=G,e.bearishengulfingpattern=W,e.bullishengulfingpattern=O,e.darkcloudcover=te,e.downsidetasukigap=N,e.dragonflydoji=ae,e.gravestonedoji=re,e.bullishharami=L,e.bearishharami=X,e.bullishharamicross=z,e.bearishharamicross=Y,e.eveningdojistar=$,e.eveningstar=K,e.morningdojistar=U,e.morningstar=R,e.bullishmarubozu=q,e.bearishmarubozu=Z,e.piercingline=B,e.bullishspinningtop=oe,e.bearishspinningtop=ne,e.threeblackcrows=Q,e.threewhitesoldiers=V,e.fibonacciretracement=ie,e.predictPattern=tn,e.PatternDetector=UC,e.hasDoubleBottom=an,e.hasDoubleTop=rn,e.hasHeadAndShoulder=on,e.hasInverseHeadAndShoulder=nn,e.isTrendingUp=ln,e.isTrendingDown=sn,e.setConfig=t,e.getConfig=a})(this.window=this.window||{});
//# sourceMappingURL=browser.js.map
